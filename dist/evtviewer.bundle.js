!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=28)}([function(e,t,n){var i;
/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(n,r){"use strict";var o=[],a=Object.getPrototypeOf,s=o.slice,l=o.flat?function(e){return o.flat.call(e)}:function(e){return o.concat.apply([],e)},c=o.push,u=o.indexOf,d={},h=d.toString,p=d.hasOwnProperty,f=p.toString,g=f.call(Object),m={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},b=n.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function x(e,t,n){var i,r,o=(n=n||b).createElement("script");if(o.text=e,t)for(i in _)(r=t[i]||t.getAttribute&&t.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?d[h.call(e)]||"object":typeof e}var S=/HTML$/i,T=function(e,t){return new T.fn.init(e,t)};function E(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function C(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}T.fn=T.prototype={jquery:"3.7.1",constructor:T,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=T.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return T.each(this,e)},map:function(e){return this.pushStack(T.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(T.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(T.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},T.extend=T.fn.extend=function(){var e,t,n,i,r,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)i=e[t],"__proto__"!==t&&a!==i&&(c&&i&&(T.isPlainObject(i)||(r=Array.isArray(i)))?(n=a[t],o=r&&!Array.isArray(n)?[]:r||T.isPlainObject(n)?n:{},r=!1,a[t]=T.extend(c,o,i)):void 0!==i&&(a[t]=i));return a},T.extend({expando:"jQuery"+("3.7.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==h.call(e))&&(!(t=a(e))||"function"==typeof(n=p.call(t,"constructor")&&t.constructor)&&f.call(n)===g)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){x(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,i=0;if(E(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},text:function(e){var t,n="",i=0,r=e.nodeType;if(!r)for(;t=e[i++];)n+=T.text(t);return 1===r||11===r?e.textContent:9===r?e.documentElement.textContent:3===r||4===r?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(E(Object(e))?T.merge(n,"string"==typeof e?[e]:e):c.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!S.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,a=!n;r<o;r++)!t(e[r],r)!==a&&i.push(e[r]);return i},map:function(e,t,n){var i,r,o=0,a=[];if(E(e))for(i=e.length;o<i;o++)null!=(r=t(e[o],o,n))&&a.push(r);else for(o in e)null!=(r=t(e[o],o,n))&&a.push(r);return l(a)},guid:1,support:m}),"function"==typeof Symbol&&(T.fn[Symbol.iterator]=o[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){d["[object "+t+"]"]=t.toLowerCase()}));var k=o.pop,L=o.sort,P=o.splice,A="[\\x20\\t\\r\\n\\f]",O=new RegExp("^"+A+"+|((?:^|[^\\\\])(?:\\\\.)*)"+A+"+$","g");T.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var I=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function D(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}T.escapeSelector=function(e){return(e+"").replace(I,D)};var $=b,N=c;!function(){var e,t,i,r,a,l,c,d,h,f,g=N,v=T.expando,y=0,b=0,_=ee(),x=ee(),w=ee(),S=ee(),E=function(e,t){return e===t&&(a=!0),0},I="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",D="(?:\\\\[\\da-fA-F]{1,6}"+A+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",M="\\["+A+"*("+D+")(?:"+A+"*([*^$|!~]?=)"+A+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+D+"))|)"+A+"*\\]",R=":("+D+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",B=new RegExp(A+"+","g"),H=new RegExp("^"+A+"*,"+A+"*"),z=new RegExp("^"+A+"*([>+~]|"+A+")"+A+"*"),F=new RegExp(A+"|>"),V=new RegExp(R),j=new RegExp("^"+D+"$"),U={ID:new RegExp("^#("+D+")"),CLASS:new RegExp("^\\.("+D+")"),TAG:new RegExp("^("+D+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+A+"*(even|odd|(([+-]|)(\\d*)n|)"+A+"*(?:([+-]|)"+A+"*(\\d+)|))"+A+"*\\)|)","i"),bool:new RegExp("^(?:"+I+")$","i"),needsContext:new RegExp("^"+A+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+A+"*((?:-\\d)?\\d*)"+A+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/[+~]/,X=new RegExp("\\\\[\\da-fA-F]{1,6}"+A+"?|\\\\([^\\r\\n\\f])","g"),Q=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},Y=function(){le()},K=he((function(e){return!0===e.disabled&&C(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{g.apply(o=s.call($.childNodes),$.childNodes),o[$.childNodes.length].nodeType}catch(e){g={apply:function(e,t){N.apply(e,s.call(t))},call:function(e){N.apply(e,s.call(arguments,1))}}}function J(e,t,n,i){var r,o,a,s,c,u,p,f=t&&t.ownerDocument,y=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==y&&9!==y&&11!==y)return n;if(!i&&(le(t),t=t||l,d)){if(11!==y&&(c=G.exec(e)))if(r=c[1]){if(9===y){if(!(a=t.getElementById(r)))return n;if(a.id===r)return g.call(n,a),n}else if(f&&(a=f.getElementById(r))&&J.contains(t,a)&&a.id===r)return g.call(n,a),n}else{if(c[2])return g.apply(n,t.getElementsByTagName(e)),n;if((r=c[3])&&t.getElementsByClassName)return g.apply(n,t.getElementsByClassName(r)),n}if(!(S[e+" "]||h&&h.test(e))){if(p=e,f=t,1===y&&(F.test(e)||z.test(e))){for((f=Z.test(e)&&se(t.parentNode)||t)==t&&m.scope||((s=t.getAttribute("id"))?s=T.escapeSelector(s):t.setAttribute("id",s=v)),o=(u=ue(e)).length;o--;)u[o]=(s?"#"+s:":scope")+" "+de(u[o]);p=u.join(",")}try{return g.apply(n,f.querySelectorAll(p)),n}catch(t){S(e,!0)}finally{s===v&&t.removeAttribute("id")}}}return ye(e.replace(O,"$1"),t,n,i)}function ee(){var e=[];return function n(i,r){return e.push(i+" ")>t.cacheLength&&delete n[e.shift()],n[i+" "]=r}}function te(e){return e[v]=!0,e}function ne(e){var t=l.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ie(e){return function(t){return C(t,"input")&&t.type===e}}function re(e){return function(t){return(C(t,"input")||C(t,"button"))&&t.type===e}}function oe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&K(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ae(e){return te((function(t){return t=+t,te((function(n,i){for(var r,o=e([],n.length,t),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))}))}))}function se(e){return e&&void 0!==e.getElementsByTagName&&e}function le(e){var n,i=e?e.ownerDocument||e:$;return i!=l&&9===i.nodeType&&i.documentElement?(c=(l=i).documentElement,d=!T.isXMLDoc(l),f=c.matches||c.webkitMatchesSelector||c.msMatchesSelector,c.msMatchesSelector&&$!=l&&(n=l.defaultView)&&n.top!==n&&n.addEventListener("unload",Y),m.getById=ne((function(e){return c.appendChild(e).id=T.expando,!l.getElementsByName||!l.getElementsByName(T.expando).length})),m.disconnectedMatch=ne((function(e){return f.call(e,"*")})),m.scope=ne((function(){return l.querySelectorAll(":scope")})),m.cssHas=ne((function(){try{return l.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),m.getById?(t.filter.ID=function(e){var t=e.replace(X,Q);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var n=t.getElementById(e);return n?[n]:[]}}):(t.filter.ID=function(e){var t=e.replace(X,Q);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var n,i,r,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(r=t.getElementsByName(e),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&d)return t.getElementsByClassName(e)},h=[],ne((function(e){var t;c.appendChild(e).innerHTML="<a id='"+v+"' href='' disabled='disabled'></a><select id='"+v+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+A+"*(?:value|"+I+")"),e.querySelectorAll("[id~="+v+"-]").length||h.push("~="),e.querySelectorAll("a#"+v+"+*").length||h.push(".#.+[+~]"),e.querySelectorAll(":checked").length||h.push(":checked"),(t=l.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),c.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&h.push(":enabled",":disabled"),(t=l.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||h.push("\\["+A+"*name"+A+"*="+A+"*(?:''|\"\")")})),m.cssHas||h.push(":has"),h=h.length&&new RegExp(h.join("|")),E=function(e,t){if(e===t)return a=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!m.sortDetached&&t.compareDocumentPosition(e)===n?e===l||e.ownerDocument==$&&J.contains($,e)?-1:t===l||t.ownerDocument==$&&J.contains($,t)?1:r?u.call(r,e)-u.call(r,t):0:4&n?-1:1)},l):l}for(e in J.matches=function(e,t){return J(e,null,null,t)},J.matchesSelector=function(e,t){if(le(e),d&&!S[t+" "]&&(!h||!h.test(t)))try{var n=f.call(e,t);if(n||m.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){S(t,!0)}return J(t,l,null,[e]).length>0},J.contains=function(e,t){return(e.ownerDocument||e)!=l&&le(e),T.contains(e,t)},J.attr=function(e,n){(e.ownerDocument||e)!=l&&le(e);var i=t.attrHandle[n.toLowerCase()],r=i&&p.call(t.attrHandle,n.toLowerCase())?i(e,n,!d):void 0;return void 0!==r?r:e.getAttribute(n)},J.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},T.uniqueSort=function(e){var t,n=[],i=0,o=0;if(a=!m.sortStable,r=!m.sortStable&&s.call(e,0),L.call(e,E),a){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)P.call(e,n[i],1)}return r=null,e},T.fn.uniqueSort=function(){return this.pushStack(T.uniqueSort(s.apply(this)))},(t=T.expr={cacheLength:50,createPseudo:te,match:U,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(X,Q),e[3]=(e[3]||e[4]||e[5]||"").replace(X,Q),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||J.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&J.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return U.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&V.test(n)&&(t=ue(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(X,Q).toLowerCase();return"*"===e?function(){return!0}:function(e){return C(e,t)}},CLASS:function(e){var t=_[e+" "];return t||(t=new RegExp("(^|"+A+")"+e+"("+A+"|$)"))&&_(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(i){var r=J.attr(i,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace(B," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var c,u,d,h,p,f=o!==a?"nextSibling":"previousSibling",g=t.parentNode,m=s&&t.nodeName.toLowerCase(),b=!l&&!s,_=!1;if(g){if(o){for(;f;){for(d=t;d=d[f];)if(s?C(d,m):1===d.nodeType)return!1;p=f="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&b){for(_=(h=(c=(u=g[v]||(g[v]={}))[e]||[])[0]===y&&c[1])&&c[2],d=h&&g.childNodes[h];d=++h&&d&&d[f]||(_=h=0)||p.pop();)if(1===d.nodeType&&++_&&d===t){u[e]=[y,h,_];break}}else if(b&&(_=h=(c=(u=t[v]||(t[v]={}))[e]||[])[0]===y&&c[1]),!1===_)for(;(d=++h&&d&&d[f]||(_=h=0)||p.pop())&&(!(s?C(d,m):1===d.nodeType)||!++_||(b&&((u=d[v]||(d[v]={}))[e]=[y,_]),d!==t)););return(_-=r)===i||_%i==0&&_/i>=0}}},PSEUDO:function(e,n){var i,r=t.pseudos[e]||t.setFilters[e.toLowerCase()]||J.error("unsupported pseudo: "+e);return r[v]?r(n):r.length>1?(i=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var i,o=r(e,n),a=o.length;a--;)e[i=u.call(e,o[a])]=!(t[i]=o[a])})):function(e){return r(e,0,i)}):r}},pseudos:{not:te((function(e){var t=[],n=[],i=ve(e.replace(O,"$1"));return i[v]?te((function(e,t,n,r){for(var o,a=i(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))})):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}})),has:te((function(e){return function(t){return J(e,t).length>0}})),contains:te((function(e){return e=e.replace(X,Q),function(t){return(t.textContent||T.text(t)).indexOf(e)>-1}})),lang:te((function(e){return j.test(e||"")||J.error("unsupported lang: "+e),e=e.replace(X,Q).toLowerCase(),function(t){var n;do{if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===c},focus:function(e){return e===function(){try{return l.activeElement}catch(e){}}()&&l.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:oe(!1),disabled:oe(!0),checked:function(e){return C(e,"input")&&!!e.checked||C(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return W.test(e.nodeName)},button:function(e){return C(e,"input")&&"button"===e.type||C(e,"button")},text:function(e){var t;return C(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ae((function(){return[0]})),last:ae((function(e,t){return[t-1]})),eq:ae((function(e,t,n){return[n<0?n+t:n]})),even:ae((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:ae((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:ae((function(e,t,n){var i;for(i=n<0?n+t:n>t?t:n;--i>=0;)e.push(i);return e})),gt:ae((function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e}))}}).pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=ie(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=re(e);function ce(){}function ue(e,n){var i,r,o,a,s,l,c,u=x[e+" "];if(u)return n?0:u.slice(0);for(s=e,l=[],c=t.preFilter;s;){for(a in i&&!(r=H.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),i=!1,(r=z.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(O," ")}),s=s.slice(i.length)),t.filter)!(r=U[a].exec(s))||c[a]&&!(r=c[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return n?s.length:s?J.error(e):x(e,l).slice(0)}function de(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function he(e,t,n){var i=t.dir,r=t.next,o=r||i,a=n&&"parentNode"===o,s=b++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||a)return e(t,n,r);return!1}:function(t,n,l){var c,u,d=[y,s];if(l){for(;t=t[i];)if((1===t.nodeType||a)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||a)if(u=t[v]||(t[v]={}),r&&C(t,r))t=t[i]||t;else{if((c=u[o])&&c[0]===y&&c[1]===s)return d[2]=c[2];if(u[o]=d,d[2]=e(t,n,l))return!0}return!1}}function pe(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function fe(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),c&&t.push(s)));return a}function ge(e,t,n,i,r,o){return i&&!i[v]&&(i=ge(i)),r&&!r[v]&&(r=ge(r,o)),te((function(o,a,s,l){var c,d,h,p,f=[],m=[],v=a.length,y=o||function(e,t,n){for(var i=0,r=t.length;i<r;i++)J(e,t[i],n);return n}(t||"*",s.nodeType?[s]:s,[]),b=!e||!o&&t?y:fe(y,f,e,s,l);if(n?n(b,p=r||(o?e:v||i)?[]:a,s,l):p=b,i)for(c=fe(p,m),i(c,[],s,l),d=c.length;d--;)(h=c[d])&&(p[m[d]]=!(b[m[d]]=h));if(o){if(r||e){if(r){for(c=[],d=p.length;d--;)(h=p[d])&&c.push(b[d]=h);r(null,p=[],c,l)}for(d=p.length;d--;)(h=p[d])&&(c=r?u.call(o,h):f[d])>-1&&(o[c]=!(a[c]=h))}}else p=fe(p===a?p.splice(v,p.length):p),r?r(null,a,p,l):g.apply(a,p)}))}function me(e){for(var n,r,o,a=e.length,s=t.relative[e[0].type],l=s||t.relative[" "],c=s?1:0,d=he((function(e){return e===n}),l,!0),h=he((function(e){return u.call(n,e)>-1}),l,!0),p=[function(e,t,r){var o=!s&&(r||t!=i)||((n=t).nodeType?d(e,t,r):h(e,t,r));return n=null,o}];c<a;c++)if(r=t.relative[e[c].type])p=[he(pe(p),r)];else{if((r=t.filter[e[c].type].apply(null,e[c].matches))[v]){for(o=++c;o<a&&!t.relative[e[o].type];o++);return ge(c>1&&pe(p),c>1&&de(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(O,"$1"),r,c<o&&me(e.slice(c,o)),o<a&&me(e=e.slice(o)),o<a&&de(e))}p.push(r)}return pe(p)}function ve(e,n){var r,o=[],a=[],s=w[e+" "];if(!s){for(n||(n=ue(e)),r=n.length;r--;)(s=me(n[r]))[v]?o.push(s):a.push(s);(s=w(e,function(e,n){var r=n.length>0,o=e.length>0,a=function(a,s,c,u,h){var p,f,m,v=0,b="0",_=a&&[],x=[],w=i,S=a||o&&t.find.TAG("*",h),E=y+=null==w?1:Math.random()||.1,C=S.length;for(h&&(i=s==l||s||h);b!==C&&null!=(p=S[b]);b++){if(o&&p){for(f=0,s||p.ownerDocument==l||(le(p),c=!d);m=e[f++];)if(m(p,s||l,c)){g.call(u,p);break}h&&(y=E)}r&&((p=!m&&p)&&v--,a&&_.push(p))}if(v+=b,r&&b!==v){for(f=0;m=n[f++];)m(_,x,s,c);if(a){if(v>0)for(;b--;)_[b]||x[b]||(x[b]=k.call(u));x=fe(x)}g.apply(u,x),h&&!a&&x.length>0&&v+n.length>1&&T.uniqueSort(u)}return h&&(y=E,i=w),_};return r?te(a):a}(a,o))).selector=e}return s}function ye(e,n,i,r){var o,a,s,l,c,u="function"==typeof e&&e,h=!r&&ue(e=u.selector||e);if(i=i||[],1===h.length){if((a=h[0]=h[0].slice(0)).length>2&&"ID"===(s=a[0]).type&&9===n.nodeType&&d&&t.relative[a[1].type]){if(!(n=(t.find.ID(s.matches[0].replace(X,Q),n)||[])[0]))return i;u&&(n=n.parentNode),e=e.slice(a.shift().value.length)}for(o=U.needsContext.test(e)?0:a.length;o--&&(s=a[o],!t.relative[l=s.type]);)if((c=t.find[l])&&(r=c(s.matches[0].replace(X,Q),Z.test(a[0].type)&&se(n.parentNode)||n))){if(a.splice(o,1),!(e=r.length&&de(a)))return g.apply(i,r),i;break}}return(u||ve(e,h))(r,n,!d,i,!n||Z.test(e)&&se(n.parentNode)||n),i}ce.prototype=t.filters=t.pseudos,t.setFilters=new ce,m.sortStable=v.split("").sort(E).join("")===v,le(),m.sortDetached=ne((function(e){return 1&e.compareDocumentPosition(l.createElement("fieldset"))})),T.find=J,T.expr[":"]=T.expr.pseudos,T.unique=T.uniqueSort,J.compile=ve,J.select=ye,J.setDocument=le,J.tokenize=ue,J.escape=T.escapeSelector,J.getText=T.text,J.isXML=T.isXMLDoc,J.selectors=T.expr,J.support=T.support,J.uniqueSort=T.uniqueSort}();var M=function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&T(e).is(n))break;i.push(e)}return i},R=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},B=T.expr.match.needsContext,H=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function z(e,t,n){return v(t)?T.grep(e,(function(e,i){return!!t.call(e,i,e)!==n})):t.nodeType?T.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?T.grep(e,(function(e){return u.call(t,e)>-1!==n})):T.filter(t,e,n)}T.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?T.find.matchesSelector(i,e)?[i]:[]:T.find.matches(e,T.grep(t,(function(e){return 1===e.nodeType})))},T.fn.extend({find:function(e){var t,n,i=this.length,r=this;if("string"!=typeof e)return this.pushStack(T(e).filter((function(){for(t=0;t<i;t++)if(T.contains(r[t],this))return!0})));for(n=this.pushStack([]),t=0;t<i;t++)T.find(e,r[t],n);return i>1?T.uniqueSort(n):n},filter:function(e){return this.pushStack(z(this,e||[],!1))},not:function(e){return this.pushStack(z(this,e||[],!0))},is:function(e){return!!z(this,"string"==typeof e&&B.test(e)?T(e):e||[],!1).length}});var F,V=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(T.fn.init=function(e,t,n){var i,r;if(!e)return this;if(n=n||F,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:V.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof T?t[0]:t,T.merge(this,T.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),H.test(i[1])&&T.isPlainObject(t))for(i in t)v(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(r=b.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(T):T.makeArray(e,this)}).prototype=T.fn,F=T(b);var j=/^(?:parents|prev(?:Until|All))/,U={children:!0,contents:!0,next:!0,prev:!0};function W(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}T.fn.extend({has:function(e){var t=T(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(T.contains(this,t[e]))return!0}))},closest:function(e,t){var n,i=0,r=this.length,o=[],a="string"!=typeof e&&T(e);if(!B.test(e))for(;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&T.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?T.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.call(T(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),T.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return M(e,"parentNode")},parentsUntil:function(e,t,n){return M(e,"parentNode",n)},next:function(e){return W(e,"nextSibling")},prev:function(e){return W(e,"previousSibling")},nextAll:function(e){return M(e,"nextSibling")},prevAll:function(e){return M(e,"previousSibling")},nextUntil:function(e,t,n){return M(e,"nextSibling",n)},prevUntil:function(e,t,n){return M(e,"previousSibling",n)},siblings:function(e){return R((e.parentNode||{}).firstChild,e)},children:function(e){return R(e.firstChild)},contents:function(e){return null!=e.contentDocument&&a(e.contentDocument)?e.contentDocument:(C(e,"template")&&(e=e.content||e),T.merge([],e.childNodes))}},(function(e,t){T.fn[e]=function(n,i){var r=T.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=T.filter(i,r)),this.length>1&&(U[e]||T.uniqueSort(r),j.test(e)&&r.reverse()),this.pushStack(r)}}));var q=/[^\x20\t\r\n\f]+/g;function G(e){return e}function Z(e){throw e}function X(e,t,n,i){var r;try{e&&v(r=e.promise)?r.call(e).done(t).fail(n):e&&v(r=e.then)?r.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}T.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return T.each(e.match(q)||[],(function(e,n){t[n]=!0})),t}(e):T.extend({},e);var t,n,i,r,o=[],a=[],s=-1,l=function(){for(r=r||e.once,i=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,r&&(o=n?[]:"")},c={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){T.each(n,(function(n,i){v(i)?e.unique&&c.has(i)||o.push(i):i&&i.length&&"string"!==w(i)&&t(i)}))}(arguments),n&&!t&&l()),this},remove:function(){return T.each(arguments,(function(e,t){for(var n;(n=T.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--})),this},has:function(e){return e?T.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=a=[],n||t||(o=n=""),this},locked:function(){return!!r},fireWith:function(e,n){return r||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},T.extend({Deferred:function(e){var t=[["notify","progress",T.Callbacks("memory"),T.Callbacks("memory"),2],["resolve","done",T.Callbacks("once memory"),T.Callbacks("once memory"),0,"resolved"],["reject","fail",T.Callbacks("once memory"),T.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return r.then(null,e)},pipe:function(){var e=arguments;return T.Deferred((function(n){T.each(t,(function(t,i){var r=v(e[i[4]])&&e[i[4]];o[i[1]]((function(){var e=r&&r.apply(this,arguments);e&&v(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[e]:arguments)}))})),e=null})).promise()},then:function(e,i,r){var o=0;function a(e,t,i,r){return function(){var s=this,l=arguments,c=function(){var n,c;if(!(e<o)){if((n=i.apply(s,l))===t.promise())throw new TypeError("Thenable self-resolution");c=n&&("object"==typeof n||"function"==typeof n)&&n.then,v(c)?r?c.call(n,a(o,t,G,r),a(o,t,Z,r)):(o++,c.call(n,a(o,t,G,r),a(o,t,Z,r),a(o,t,G,t.notifyWith))):(i!==G&&(s=void 0,l=[n]),(r||t.resolveWith)(s,l))}},u=r?c:function(){try{c()}catch(n){T.Deferred.exceptionHook&&T.Deferred.exceptionHook(n,u.error),e+1>=o&&(i!==Z&&(s=void 0,l=[n]),t.rejectWith(s,l))}};e?u():(T.Deferred.getErrorHook?u.error=T.Deferred.getErrorHook():T.Deferred.getStackHook&&(u.error=T.Deferred.getStackHook()),n.setTimeout(u))}}return T.Deferred((function(n){t[0][3].add(a(0,n,v(r)?r:G,n.notifyWith)),t[1][3].add(a(0,n,v(e)?e:G)),t[2][3].add(a(0,n,v(i)?i:Z))})).promise()},promise:function(e){return null!=e?T.extend(e,r):r}},o={};return T.each(t,(function(e,n){var a=n[2],s=n[5];r[n[1]]=a.add,s&&a.add((function(){i=s}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),a.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=a.fireWith})),r.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,i=Array(n),r=s.call(arguments),o=T.Deferred(),a=function(e){return function(n){i[e]=this,r[e]=arguments.length>1?s.call(arguments):n,--t||o.resolveWith(i,r)}};if(t<=1&&(X(e,o.done(a(n)).resolve,o.reject,!t),"pending"===o.state()||v(r[n]&&r[n].then)))return o.then();for(;n--;)X(r[n],a(n),o.reject);return o.promise()}});var Q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;T.Deferred.exceptionHook=function(e,t){n.console&&n.console.warn&&e&&Q.test(e.name)&&n.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},T.readyException=function(e){n.setTimeout((function(){throw e}))};var Y=T.Deferred();function K(){b.removeEventListener("DOMContentLoaded",K),n.removeEventListener("load",K),T.ready()}T.fn.ready=function(e){return Y.then(e).catch((function(e){T.readyException(e)})),this},T.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--T.readyWait:T.isReady)||(T.isReady=!0,!0!==e&&--T.readyWait>0||Y.resolveWith(b,[T]))}}),T.ready.then=Y.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?n.setTimeout(T.ready):(b.addEventListener("DOMContentLoaded",K),n.addEventListener("load",K));var J=function(e,t,n,i,r,o,a){var s=0,l=e.length,c=null==n;if("object"===w(n))for(s in r=!0,n)J(e,t,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,v(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(T(e),n)})),t))for(;s<l;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):l?t(e[0],n):o},ee=/^-ms-/,te=/-([a-z])/g;function ne(e,t){return t.toUpperCase()}function ie(e){return e.replace(ee,"ms-").replace(te,ne)}var re=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=T.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},re(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,r=this.cache(e);if("string"==typeof t)r[ie(t)]=n;else for(i in t)r[ie(i)]=t[i];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ie(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(ie):(t=ie(t))in i?[t]:t.match(q)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||T.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!T.isEmptyObject(t)}};var ae=new oe,se=new oe,le=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ce=/[A-Z]/g;function ue(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(ce,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:le.test(e)?JSON.parse(e):e)}(n)}catch(e){}se.set(e,t,n)}else n=void 0;return n}T.extend({hasData:function(e){return se.hasData(e)||ae.hasData(e)},data:function(e,t,n){return se.access(e,t,n)},removeData:function(e,t){se.remove(e,t)},_data:function(e,t,n){return ae.access(e,t,n)},_removeData:function(e,t){ae.remove(e,t)}}),T.fn.extend({data:function(e,t){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(r=se.get(o),1===o.nodeType&&!ae.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&(i=ie(i.slice(5)),ue(o,i,r[i]));ae.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each((function(){se.set(this,e)})):J(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=se.get(o,e))||void 0!==(n=ue(o,e))?n:void 0;this.each((function(){se.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){se.remove(this,e)}))}}),T.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=ae.get(e,t),n&&(!i||Array.isArray(n)?i=ae.access(e,t,T.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=T.queue(e,t),i=n.length,r=n.shift(),o=T._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,(function(){T.dequeue(e,t)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ae.get(e,n)||ae.access(e,n,{empty:T.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",n])}))})}}),T.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?T.queue(this[0],e):void 0===t?this:this.each((function(){var n=T.queue(this,e,t);T._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&T.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){T.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=T.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=ae.get(o[a],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(t)}});var de=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,he=new RegExp("^(?:([+-])=|)("+de+")([a-z%]*)$","i"),pe=["Top","Right","Bottom","Left"],fe=b.documentElement,ge=function(e){return T.contains(e.ownerDocument,e)},me={composed:!0};fe.getRootNode&&(ge=function(e){return T.contains(e.ownerDocument,e)||e.getRootNode(me)===e.ownerDocument});var ve=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ge(e)&&"none"===T.css(e,"display")};function ye(e,t,n,i){var r,o,a=20,s=i?function(){return i.cur()}:function(){return T.css(e,t,"")},l=s(),c=n&&n[3]||(T.cssNumber[t]?"":"px"),u=e.nodeType&&(T.cssNumber[t]||"px"!==c&&+l)&&he.exec(T.css(e,t));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;a--;)T.style(e,t,u+c),(1-o)*(1-(o=s()/l||.5))<=0&&(a=0),u/=o;u*=2,T.style(e,t,u+c),n=n||[]}return n&&(u=+u||+l||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=r)),r}var be={};function _e(e){var t,n=e.ownerDocument,i=e.nodeName,r=be[i];return r||(t=n.body.appendChild(n.createElement(i)),r=T.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),be[i]=r,r)}function xe(e,t){for(var n,i,r=[],o=0,a=e.length;o<a;o++)(i=e[o]).style&&(n=i.style.display,t?("none"===n&&(r[o]=ae.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&ve(i)&&(r[o]=_e(i))):"none"!==n&&(r[o]="none",ae.set(i,"display",n)));for(o=0;o<a;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}T.fn.extend({show:function(){return xe(this,!0)},hide:function(){return xe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ve(this)?T(this).show():T(this).hide()}))}});var we,Se,Te=/^(?:checkbox|radio)$/i,Ee=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;we=b.createDocumentFragment().appendChild(b.createElement("div")),(Se=b.createElement("input")).setAttribute("type","radio"),Se.setAttribute("checked","checked"),Se.setAttribute("name","t"),we.appendChild(Se),m.checkClone=we.cloneNode(!0).cloneNode(!0).lastChild.checked,we.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!we.cloneNode(!0).lastChild.defaultValue,we.innerHTML="<option></option>",m.option=!!we.lastChild;var ke={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Le(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&C(e,t)?T.merge([e],n):n}function Pe(e,t){for(var n=0,i=e.length;n<i;n++)ae.set(e[n],"globalEval",!t||ae.get(t[n],"globalEval"))}ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,m.option||(ke.optgroup=ke.option=[1,"<select multiple='multiple'>","</select>"]);var Ae=/<|&#?\w+;/;function Oe(e,t,n,i,r){for(var o,a,s,l,c,u,d=t.createDocumentFragment(),h=[],p=0,f=e.length;p<f;p++)if((o=e[p])||0===o)if("object"===w(o))T.merge(h,o.nodeType?[o]:o);else if(Ae.test(o)){for(a=a||d.appendChild(t.createElement("div")),s=(Ee.exec(o)||["",""])[1].toLowerCase(),l=ke[s]||ke._default,a.innerHTML=l[1]+T.htmlPrefilter(o)+l[2],u=l[0];u--;)a=a.lastChild;T.merge(h,a.childNodes),(a=d.firstChild).textContent=""}else h.push(t.createTextNode(o));for(d.textContent="",p=0;o=h[p++];)if(i&&T.inArray(o,i)>-1)r&&r.push(o);else if(c=ge(o),a=Le(d.appendChild(o),"script"),c&&Pe(a),n)for(u=0;o=a[u++];)Ce.test(o.type||"")&&n.push(o);return d}var Ie=/^([^.]*)(?:\.(.+)|)/;function De(){return!0}function $e(){return!1}function Ne(e,t,n,i,r,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(i=i||n,n=void 0),t)Ne(e,s,n,i,t[s],o);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=$e;else if(!r)return e;return 1===o&&(a=r,(r=function(e){return T().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=T.guid++)),e.each((function(){T.event.add(this,t,r,i,n)}))}function Me(e,t,n){n?(ae.set(e,t,!1),T.event.add(e,t,{namespace:!1,handler:function(e){var n,i=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(i)(T.event.special[t]||{}).delegateType&&e.stopPropagation();else if(i=s.call(arguments),ae.set(this,t,i),this[t](),n=ae.get(this,t),ae.set(this,t,!1),i!==n)return e.stopImmediatePropagation(),e.preventDefault(),n}else i&&(ae.set(this,t,T.event.trigger(i[0],i.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=De)}})):void 0===ae.get(e,t)&&T.event.add(e,t,De)}T.event={global:{},add:function(e,t,n,i,r){var o,a,s,l,c,u,d,h,p,f,g,m=ae.get(e);if(re(e))for(n.handler&&(n=(o=n).handler,r=o.selector),r&&T.find.matchesSelector(fe,r),n.guid||(n.guid=T.guid++),(l=m.events)||(l=m.events=Object.create(null)),(a=m.handle)||(a=m.handle=function(t){return void 0!==T&&T.event.triggered!==t.type?T.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(q)||[""]).length;c--;)p=g=(s=Ie.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),p&&(d=T.event.special[p]||{},p=(r?d.delegateType:d.bindType)||p,d=T.event.special[p]||{},u=T.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&T.expr.match.needsContext.test(r),namespace:f.join(".")},o),(h=l[p])||((h=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,i,f,a)||e.addEventListener&&e.addEventListener(p,a)),d.add&&(d.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,u):h.push(u),T.event.global[p]=!0)},remove:function(e,t,n,i,r){var o,a,s,l,c,u,d,h,p,f,g,m=ae.hasData(e)&&ae.get(e);if(m&&(l=m.events)){for(c=(t=(t||"").match(q)||[""]).length;c--;)if(p=g=(s=Ie.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),p){for(d=T.event.special[p]||{},h=l[p=(i?d.delegateType:d.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=h.length;o--;)u=h[o],!r&&g!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(h.splice(o,1),u.selector&&h.delegateCount--,d.remove&&d.remove.call(e,u));a&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,f,m.handle)||T.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)T.event.remove(e,p+t[c],n,i,!0);T.isEmptyObject(l)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,n,i,r,o,a,s=new Array(arguments.length),l=T.event.fix(e),c=(ae.get(this,"events")||Object.create(null))[l.type]||[],u=T.event.special[l.type]||{};for(s[0]=l,t=1;t<arguments.length;t++)s[t]=arguments[t];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(a=T.event.handlers.call(this,l,c),t=0;(r=a[t++])&&!l.isPropagationStopped();)for(l.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(i=((T.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(e,t){var n,i,r,o,a,s=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],a={},n=0;n<l;n++)void 0===a[r=(i=t[n]).selector+" "]&&(a[r]=i.needsContext?T(r,this).index(c)>-1:T.find(r,this,null,[c]).length),a[r]&&o.push(i);o.length&&s.push({elem:c,handlers:o})}return c=this,l<t.length&&s.push({elem:c,handlers:t.slice(l)}),s},addProp:function(e,t){Object.defineProperty(T.Event.prototype,e,{enumerable:!0,configurable:!0,get:v(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[T.expando]?e:new T.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return Te.test(t.type)&&t.click&&C(t,"input")&&Me(t,"click",!0),!1},trigger:function(e){var t=this||e;return Te.test(t.type)&&t.click&&C(t,"input")&&Me(t,"click"),!0},_default:function(e){var t=e.target;return Te.test(t.type)&&t.click&&C(t,"input")&&ae.get(t,"click")||C(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},T.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},T.Event=function(e,t){if(!(this instanceof T.Event))return new T.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?De:$e,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&T.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[T.expando]=!0},T.Event.prototype={constructor:T.Event,isDefaultPrevented:$e,isPropagationStopped:$e,isImmediatePropagationStopped:$e,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=De,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=De,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=De,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},T.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},T.event.addProp),T.each({focus:"focusin",blur:"focusout"},(function(e,t){function n(e){if(b.documentMode){var n=ae.get(this,"handle"),i=T.event.fix(e);i.type="focusin"===e.type?"focus":"blur",i.isSimulated=!0,n(e),i.target===i.currentTarget&&n(i)}else T.event.simulate(t,e.target,T.event.fix(e))}T.event.special[e]={setup:function(){var i;if(Me(this,e,!0),!b.documentMode)return!1;(i=ae.get(this,t))||this.addEventListener(t,n),ae.set(this,t,(i||0)+1)},trigger:function(){return Me(this,e),!0},teardown:function(){var e;if(!b.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,n),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},T.event.special[t]={setup:function(){var i=this.ownerDocument||this.document||this,r=b.documentMode?this:i,o=ae.get(r,t);o||(b.documentMode?this.addEventListener(t,n):i.addEventListener(e,n,!0)),ae.set(r,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=b.documentMode?this:i,o=ae.get(r,t)-1;o?ae.set(r,t,o):(b.documentMode?this.removeEventListener(t,n):i.removeEventListener(e,n,!0),ae.remove(r,t))}}})),T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){T.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return r&&(r===i||T.contains(i,r))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}})),T.fn.extend({on:function(e,t,n,i){return Ne(this,e,t,n,i)},one:function(e,t,n,i){return Ne(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,T(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=$e),this.each((function(){T.event.remove(this,e,n,t)}))}});var Re=/<script|<style|<link/i,Be=/checked\s*(?:[^=]|=\s*.checked.)/i,He=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function ze(e,t){return C(e,"table")&&C(11!==t.nodeType?t:t.firstChild,"tr")&&T(e).children("tbody")[0]||e}function Fe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Ve(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function je(e,t){var n,i,r,o,a,s;if(1===t.nodeType){if(ae.hasData(e)&&(s=ae.get(e).events))for(r in ae.remove(t,"handle events"),s)for(n=0,i=s[r].length;n<i;n++)T.event.add(t,r,s[r][n]);se.hasData(e)&&(o=se.access(e),a=T.extend({},o),se.set(t,a))}}function Ue(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Te.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function We(e,t,n,i){t=l(t);var r,o,a,s,c,u,d=0,h=e.length,p=h-1,f=t[0],g=v(f);if(g||h>1&&"string"==typeof f&&!m.checkClone&&Be.test(f))return e.each((function(r){var o=e.eq(r);g&&(t[0]=f.call(this,r,o.html())),We(o,t,n,i)}));if(h&&(o=(r=Oe(t,e[0].ownerDocument,!1,e,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(s=(a=T.map(Le(r,"script"),Fe)).length;d<h;d++)c=r,d!==p&&(c=T.clone(c,!0,!0),s&&T.merge(a,Le(c,"script"))),n.call(e[d],c,d);if(s)for(u=a[a.length-1].ownerDocument,T.map(a,Ve),d=0;d<s;d++)c=a[d],Ce.test(c.type||"")&&!ae.access(c,"globalEval")&&T.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?T._evalUrl&&!c.noModule&&T._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):x(c.textContent.replace(He,""),c,u))}return e}function qe(e,t,n){for(var i,r=t?T.filter(t,e):e,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||T.cleanData(Le(i)),i.parentNode&&(n&&ge(i)&&Pe(Le(i,"script")),i.parentNode.removeChild(i));return e}T.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var i,r,o,a,s=e.cloneNode(!0),l=ge(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||T.isXMLDoc(e)))for(a=Le(s),i=0,r=(o=Le(e)).length;i<r;i++)Ue(o[i],a[i]);if(t)if(n)for(o=o||Le(e),a=a||Le(s),i=0,r=o.length;i<r;i++)je(o[i],a[i]);else je(e,s);return(a=Le(s,"script")).length>0&&Pe(a,!l&&Le(e,"script")),s},cleanData:function(e){for(var t,n,i,r=T.event.special,o=0;void 0!==(n=e[o]);o++)if(re(n)){if(t=n[ae.expando]){if(t.events)for(i in t.events)r[i]?T.event.remove(n,i):T.removeEvent(n,i,t.handle);n[ae.expando]=void 0}n[se.expando]&&(n[se.expando]=void 0)}}}),T.fn.extend({detach:function(e){return qe(this,e,!0)},remove:function(e){return qe(this,e)},text:function(e){return J(this,(function(e){return void 0===e?T.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return We(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ze(this,e).appendChild(e)}))},prepend:function(){return We(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=ze(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return We(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return We(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(T.cleanData(Le(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return T.clone(this,e,t)}))},html:function(e){return J(this,(function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Re.test(e)&&!ke[(Ee.exec(e)||["",""])[1].toLowerCase()]){e=T.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(T.cleanData(Le(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return We(this,arguments,(function(t){var n=this.parentNode;T.inArray(this,e)<0&&(T.cleanData(Le(this)),n&&n.replaceChild(t,this))}),e)}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){T.fn[e]=function(e){for(var n,i=[],r=T(e),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),T(r[a])[t](n),c.apply(i,n.get());return this.pushStack(i)}}));var Ge=new RegExp("^("+de+")(?!px)[a-z%]+$","i"),Ze=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=n),t.getComputedStyle(e)},Qe=function(e,t,n){var i,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in i=n.call(e),t)e.style[r]=o[r];return i},Ye=new RegExp(pe.join("|"),"i");function Ke(e,t,n){var i,r,o,a,s=Ze.test(t),l=e.style;return(n=n||Xe(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace(O,"$1")||void 0),""!==a||ge(e)||(a=T.style(e,t)),!m.pixelBoxStyles()&&Ge.test(a)&&Ye.test(t)&&(i=l.width,r=l.minWidth,o=l.maxWidth,l.minWidth=l.maxWidth=l.width=a,a=n.width,l.width=i,l.minWidth=r,l.maxWidth=o)),void 0!==a?a+"":a}function Je(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",fe.appendChild(c).appendChild(u);var e=n.getComputedStyle(u);i="1%"!==e.top,l=12===t(e.marginLeft),u.style.right="60%",a=36===t(e.right),r=36===t(e.width),u.style.position="absolute",o=12===t(u.offsetWidth/3),fe.removeChild(c),u=null}}function t(e){return Math.round(parseFloat(e))}var i,r,o,a,s,l,c=b.createElement("div"),u=b.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===u.style.backgroundClip,T.extend(m,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,t,i,r;return null==s&&(e=b.createElement("table"),t=b.createElement("tr"),i=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",i.style.height="9px",i.style.display="block",fe.appendChild(e).appendChild(t).appendChild(i),r=n.getComputedStyle(t),s=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,fe.removeChild(e)),s}}))}();var et=["Webkit","Moz","ms"],tt=b.createElement("div").style,nt={};function it(e){var t=T.cssProps[e]||nt[e];return t||(e in tt?e:nt[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=et.length;n--;)if((e=et[n]+t)in tt)return e}(e)||e)}var rt=/^(none|table(?!-c[ea]).+)/,ot={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function st(e,t,n){var i=he.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function lt(e,t,n,i,r,o){var a="width"===t?1:0,s=0,l=0,c=0;if(n===(i?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(c+=T.css(e,n+pe[a],!0,r)),i?("content"===n&&(l-=T.css(e,"padding"+pe[a],!0,r)),"margin"!==n&&(l-=T.css(e,"border"+pe[a]+"Width",!0,r))):(l+=T.css(e,"padding"+pe[a],!0,r),"padding"!==n?l+=T.css(e,"border"+pe[a]+"Width",!0,r):s+=T.css(e,"border"+pe[a]+"Width",!0,r));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-s-.5))||0),l+c}function ct(e,t,n){var i=Xe(e),r=(!m.boxSizingReliable()||n)&&"border-box"===T.css(e,"boxSizing",!1,i),o=r,a=Ke(e,t,i),s="offset"+t[0].toUpperCase()+t.slice(1);if(Ge.test(a)){if(!n)return a;a="auto"}return(!m.boxSizingReliable()&&r||!m.reliableTrDimensions()&&C(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===T.css(e,"display",!1,i))&&e.getClientRects().length&&(r="border-box"===T.css(e,"boxSizing",!1,i),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+lt(e,t,n||(r?"border":"content"),o,i,a)+"px"}function ut(e,t,n,i,r){return new ut.prototype.init(e,t,n,i,r)}T.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ke(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=ie(t),l=Ze.test(t),c=e.style;if(l||(t=it(s)),a=T.cssHooks[t]||T.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(e,!1,i))?r:c[t];"string"===(o=typeof n)&&(r=he.exec(n))&&r[1]&&(n=ye(e,t,r),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=r&&r[3]||(T.cssNumber[s]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(l?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,i){var r,o,a,s=ie(t);return Ze.test(t)||(t=it(s)),(a=T.cssHooks[t]||T.cssHooks[s])&&"get"in a&&(r=a.get(e,!0,n)),void 0===r&&(r=Ke(e,t,i)),"normal"===r&&t in at&&(r=at[t]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),T.each(["height","width"],(function(e,t){T.cssHooks[t]={get:function(e,n,i){if(n)return!rt.test(T.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ct(e,t,i):Qe(e,ot,(function(){return ct(e,t,i)}))},set:function(e,n,i){var r,o=Xe(e),a=!m.scrollboxSize()&&"absolute"===o.position,s=(a||i)&&"border-box"===T.css(e,"boxSizing",!1,o),l=i?lt(e,t,i,s,o):0;return s&&a&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-lt(e,t,"border",!1,o)-.5)),l&&(r=he.exec(n))&&"px"!==(r[3]||"px")&&(e.style[t]=n,n=T.css(e,t)),st(0,n,l)}}})),T.cssHooks.marginLeft=Je(m.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Ke(e,"marginLeft"))||e.getBoundingClientRect().left-Qe(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),T.each({margin:"",padding:"",border:"Width"},(function(e,t){T.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[e+pe[i]+t]=o[i]||o[i-2]||o[0];return r}},"margin"!==e&&(T.cssHooks[e+t].set=st)})),T.fn.extend({css:function(e,t){return J(this,(function(e,t,n){var i,r,o={},a=0;if(Array.isArray(t)){for(i=Xe(e),r=t.length;a<r;a++)o[t[a]]=T.css(e,t[a],!1,i);return o}return void 0!==n?T.style(e,t,n):T.css(e,t)}),e,t,arguments.length>1)}}),T.Tween=ut,ut.prototype={constructor:ut,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||T.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(T.cssNumber[n]?"":"px")},cur:function(){var e=ut.propHooks[this.prop];return e&&e.get?e.get(this):ut.propHooks._default.get(this)},run:function(e){var t,n=ut.propHooks[this.prop];return this.options.duration?this.pos=t=T.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ut.propHooks._default.set(this),this}},ut.prototype.init.prototype=ut.prototype,ut.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=T.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){T.fx.step[e.prop]?T.fx.step[e.prop](e):1!==e.elem.nodeType||!T.cssHooks[e.prop]&&null==e.elem.style[it(e.prop)]?e.elem[e.prop]=e.now:T.style(e.elem,e.prop,e.now+e.unit)}}},ut.propHooks.scrollTop=ut.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},T.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},T.fx=ut.prototype.init,T.fx.step={};var dt,ht,pt=/^(?:toggle|show|hide)$/,ft=/queueHooks$/;function gt(){ht&&(!1===b.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(gt):n.setTimeout(gt,T.fx.interval),T.fx.tick())}function mt(){return n.setTimeout((function(){dt=void 0})),dt=Date.now()}function vt(e,t){var n,i=0,r={height:e};for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=pe[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function yt(e,t,n){for(var i,r=(bt.tweeners[t]||[]).concat(bt.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,t,e))return i}function bt(e,t,n){var i,r,o=0,a=bt.prefilters.length,s=T.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var t=dt||mt(),n=Math.max(0,c.startTime+c.duration-t),i=1-(n/c.duration||0),o=0,a=c.tweens.length;o<a;o++)c.tweens[o].run(i);return s.notifyWith(e,[c,i,n]),i<1&&a?n:(a||s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:T.extend({},t),opts:T.extend(!0,{specialEasing:{},easing:T.easing._default},n),originalProperties:t,originalOptions:n,startTime:dt||mt(),duration:n.duration,tweens:[],createTween:function(t,n){var i=T.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return t?(s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c,t])):s.rejectWith(e,[c,t]),this}}),u=c.props;for(!function(e,t){var n,i,r,o,a;for(n in e)if(r=t[i=ie(n)],o=e[n],Array.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(a=T.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=r);else t[i]=r}(u,c.opts.specialEasing);o<a;o++)if(i=bt.prefilters[o].call(c,e,u,c.opts))return v(i.stop)&&(T._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return T.map(u,yt,c),v(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),T.fx.timer(T.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}T.Animation=T.extend(bt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ye(n.elem,e,he.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(q);for(var n,i=0,r=e.length;i<r;i++)n=e[i],bt.tweeners[n]=bt.tweeners[n]||[],bt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,r,o,a,s,l,c,u,d="width"in t||"height"in t,h=this,p={},f=e.style,g=e.nodeType&&ve(e),m=ae.get(e,"fxshow");for(i in n.queue||(null==(a=T._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,h.always((function(){h.always((function(){a.unqueued--,T.queue(e,"fx").length||a.empty.fire()}))}))),t)if(r=t[i],pt.test(r)){if(delete t[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||T.style(e,i)}if((l=!T.isEmptyObject(t))||!T.isEmptyObject(p))for(i in d&&1===e.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=m&&m.display)&&(c=ae.get(e,"display")),"none"===(u=T.css(e,"display"))&&(c?u=c:(xe([e],!0),c=e.style.display||c,u=T.css(e,"display"),xe([e]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===T.css(e,"float")&&(l||(h.done((function(){f.display=c})),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=ae.access(e,"fxshow",{display:c}),o&&(m.hidden=!g),g&&xe([e],!0),h.done((function(){for(i in g||xe([e]),ae.remove(e,"fxshow"),p)T.style(e,i,p[i])}))),l=yt(g?m[i]:0,i,h),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?bt.prefilters.unshift(e):bt.prefilters.push(e)}}),T.speed=function(e,t,n){var i=e&&"object"==typeof e?T.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return T.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in T.fx.speeds?i.duration=T.fx.speeds[i.duration]:i.duration=T.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){v(i.old)&&i.old.call(this),i.queue&&T.dequeue(this,i.queue)},i},T.fn.extend({fadeTo:function(e,t,n,i){return this.filter(ve).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=T.isEmptyObject(e),o=T.speed(t,n,i),a=function(){var t=bt(this,T.extend({},e),o);(r||ae.get(this,"finish"))&&t.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,r=null!=e&&e+"queueHooks",o=T.timers,a=ae.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&ft.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));!t&&n||T.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=ae.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=T.timers,a=i?i.length:0;for(n.finish=!0,T.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish}))}}),T.each(["toggle","show","hide"],(function(e,t){var n=T.fn[t];T.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(vt(t,!0),e,i,r)}})),T.each({slideDown:vt("show"),slideUp:vt("hide"),slideToggle:vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){T.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}})),T.timers=[],T.fx.tick=function(){var e,t=0,n=T.timers;for(dt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||T.fx.stop(),dt=void 0},T.fx.timer=function(e){T.timers.push(e),T.fx.start()},T.fx.interval=13,T.fx.start=function(){ht||(ht=!0,gt())},T.fx.stop=function(){ht=null},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.delay=function(e,t){return e=T.fx&&T.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,i){var r=n.setTimeout(t,e);i.stop=function(){n.clearTimeout(r)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var _t,xt=T.expr.attrHandle;T.fn.extend({attr:function(e,t){return J(this,T.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){T.removeAttr(this,e)}))}}),T.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?T.prop(e,t,n):(1===o&&T.isXMLDoc(e)||(r=T.attrHooks[t.toLowerCase()]||(T.expr.match.bool.test(t)?_t:void 0)),void 0!==n?null===n?void T.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=T.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&C(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,r=t&&t.match(q);if(r&&1===e.nodeType)for(;n=r[i++];)e.removeAttribute(n)}}),_t={set:function(e,t,n){return!1===t?T.removeAttr(e,n):e.setAttribute(n,n),n}},T.each(T.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=xt[t]||T.find.attr;xt[t]=function(e,t,i){var r,o,a=t.toLowerCase();return i||(o=xt[a],xt[a]=r,r=null!=n(e,t,i)?a:null,xt[a]=o),r}}));var wt=/^(?:input|select|textarea|button)$/i,St=/^(?:a|area)$/i;function Tt(e){return(e.match(q)||[]).join(" ")}function Et(e){return e.getAttribute&&e.getAttribute("class")||""}function Ct(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(q)||[]}T.fn.extend({prop:function(e,t){return J(this,T.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[T.propFix[e]||e]}))}}),T.extend({prop:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&T.isXMLDoc(e)||(t=T.propFix[t]||t,r=T.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=T.find.attr(e,"tabindex");return t?parseInt(t,10):wt.test(e.nodeName)||St.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(T.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){T.propFix[this.toLowerCase()]=this})),T.fn.extend({addClass:function(e){var t,n,i,r,o,a;return v(e)?this.each((function(t){T(this).addClass(e.call(this,t,Et(this)))})):(t=Ct(e)).length?this.each((function(){if(i=Et(this),n=1===this.nodeType&&" "+Tt(i)+" "){for(o=0;o<t.length;o++)r=t[o],n.indexOf(" "+r+" ")<0&&(n+=r+" ");a=Tt(n),i!==a&&this.setAttribute("class",a)}})):this},removeClass:function(e){var t,n,i,r,o,a;return v(e)?this.each((function(t){T(this).removeClass(e.call(this,t,Et(this)))})):arguments.length?(t=Ct(e)).length?this.each((function(){if(i=Et(this),n=1===this.nodeType&&" "+Tt(i)+" "){for(o=0;o<t.length;o++)for(r=t[o];n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");a=Tt(n),i!==a&&this.setAttribute("class",a)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,i,r,o,a=typeof e,s="string"===a||Array.isArray(e);return v(e)?this.each((function(n){T(this).toggleClass(e.call(this,n,Et(this),t),t)})):"boolean"==typeof t&&s?t?this.addClass(e):this.removeClass(e):(n=Ct(e),this.each((function(){if(s)for(o=T(this),r=0;r<n.length;r++)i=n[r],o.hasClass(i)?o.removeClass(i):o.addClass(i);else void 0!==e&&"boolean"!==a||((i=Et(this))&&ae.set(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+Tt(Et(n))+" ").indexOf(t)>-1)return!0;return!1}});var kt=/\r/g;T.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=v(e),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?e.call(this,n,T(this).val()):e)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=T.map(r,(function(e){return null==e?"":e+""}))),(t=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))}))):r?(t=T.valHooks[r.type]||T.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(kt,""):null==n?"":n:void 0}}),T.extend({valHooks:{option:{get:function(e){var t=T.find.attr(e,"value");return null!=t?t:Tt(T.text(e))}},select:{get:function(e){var t,n,i,r=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],l=a?o+1:r.length;for(i=o<0?l:a?o:0;i<l;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!C(n.parentNode,"optgroup"))){if(t=T(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,i,r=e.options,o=T.makeArray(t),a=r.length;a--;)((i=r[a]).selected=T.inArray(T.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),T.each(["radio","checkbox"],(function(){T.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=T.inArray(T(e).val(),t)>-1}},m.checkOn||(T.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var Lt=n.location,Pt={guid:Date.now()},At=/\?/;T.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{t=(new n.DOMParser).parseFromString(e,"text/xml")}catch(e){}return i=t&&t.getElementsByTagName("parsererror")[0],t&&!i||T.error("Invalid XML: "+(i?T.map(i.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Ot=/^(?:focusinfocus|focusoutblur)$/,It=function(e){e.stopPropagation()};T.extend(T.event,{trigger:function(e,t,i,r){var o,a,s,l,c,u,d,h,f=[i||b],g=p.call(e,"type")?e.type:e,m=p.call(e,"namespace")?e.namespace.split("."):[];if(a=h=s=i=i||b,3!==i.nodeType&&8!==i.nodeType&&!Ot.test(g+T.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),c=g.indexOf(":")<0&&"on"+g,(e=e[T.expando]?e:new T.Event(g,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:T.makeArray(t,[e]),d=T.event.special[g]||{},r||!d.trigger||!1!==d.trigger.apply(i,t))){if(!r&&!d.noBubble&&!y(i)){for(l=d.delegateType||g,Ot.test(l+g)||(a=a.parentNode);a;a=a.parentNode)f.push(a),s=a;s===(i.ownerDocument||b)&&f.push(s.defaultView||s.parentWindow||n)}for(o=0;(a=f[o++])&&!e.isPropagationStopped();)h=a,e.type=o>1?l:d.bindType||g,(u=(ae.get(a,"events")||Object.create(null))[e.type]&&ae.get(a,"handle"))&&u.apply(a,t),(u=c&&a[c])&&u.apply&&re(a)&&(e.result=u.apply(a,t),!1===e.result&&e.preventDefault());return e.type=g,r||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),t)||!re(i)||c&&v(i[g])&&!y(i)&&((s=i[c])&&(i[c]=null),T.event.triggered=g,e.isPropagationStopped()&&h.addEventListener(g,It),i[g](),e.isPropagationStopped()&&h.removeEventListener(g,It),T.event.triggered=void 0,s&&(i[c]=s)),e.result}},simulate:function(e,t,n){var i=T.extend(new T.Event,n,{type:e,isSimulated:!0});T.event.trigger(i,null,t)}}),T.fn.extend({trigger:function(e,t){return this.each((function(){T.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return T.event.trigger(e,t,n,!0)}});var Dt=/\[\]$/,$t=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,Mt=/^(?:input|select|textarea|keygen)/i;function Rt(e,t,n,i){var r;if(Array.isArray(t))T.each(t,(function(t,r){n||Dt.test(e)?i(e,r):Rt(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,n,i)}));else if(n||"object"!==w(t))i(e,t);else for(r in t)Rt(e+"["+r+"]",t[r],n,i)}T.param=function(e,t){var n,i=[],r=function(e,t){var n=v(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!T.isPlainObject(e))T.each(e,(function(){r(this.name,this.value)}));else for(n in e)Rt(n,e[n],t,r);return i.join("&")},T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=T.prop(this,"elements");return e?T.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!T(this).is(":disabled")&&Mt.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!Te.test(e))})).map((function(e,t){var n=T(this).val();return null==n?null:Array.isArray(n)?T.map(n,(function(e){return{name:t.name,value:e.replace($t,"\r\n")}})):{name:t.name,value:n.replace($t,"\r\n")}})).get()}});var Bt=/%20/g,Ht=/#.*$/,zt=/([?&])_=[^&]*/,Ft=/^(.*?):[ \t]*([^\r\n]*)$/gm,Vt=/^(?:GET|HEAD)$/,jt=/^\/\//,Ut={},Wt={},qt="*/".concat("*"),Gt=b.createElement("a");function Zt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(q)||[];if(v(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function Xt(e,t,n,i){var r={},o=e===Wt;function a(s){var l;return r[s]=!0,T.each(e[s]||[],(function(e,s){var c=s(t,n,i);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)})),l}return a(t.dataTypes[0])||!r["*"]&&a("*")}function Qt(e,t){var n,i,r=T.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&T.extend(!0,e,i),e}Gt.href=Lt.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Lt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Lt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":qt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Qt(Qt(e,T.ajaxSettings),t):Qt(T.ajaxSettings,e)},ajaxPrefilter:Zt(Ut),ajaxTransport:Zt(Wt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,r,o,a,s,l,c,u,d,h,p=T.ajaxSetup({},t),f=p.context||p,g=p.context&&(f.nodeType||f.jquery)?T(f):T.event,m=T.Deferred(),v=T.Callbacks("once memory"),y=p.statusCode||{},_={},x={},w="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(c){if(!a)for(a={};t=Ft.exec(o);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(e,t){return null==c&&(e=x[e.toLowerCase()]=x[e.toLowerCase()]||e,_[e]=t),this},overrideMimeType:function(e){return null==c&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)S.always(e[S.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort:function(e){var t=e||w;return i&&i.abort(t),E(0,t),this}};if(m.promise(S),p.url=((e||p.url||Lt.href)+"").replace(jt,Lt.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(q)||[""],null==p.crossDomain){l=b.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Gt.protocol+"//"+Gt.host!=l.protocol+"//"+l.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=T.param(p.data,p.traditional)),Xt(Ut,p,t,S),c)return S;for(d in(u=T.event&&p.global)&&0==T.active++&&T.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Vt.test(p.type),r=p.url.replace(Ht,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Bt,"+")):(h=p.url.slice(r.length),p.data&&(p.processData||"string"==typeof p.data)&&(r+=(At.test(r)?"&":"?")+p.data,delete p.data),!1===p.cache&&(r=r.replace(zt,"$1"),h=(At.test(r)?"&":"?")+"_="+Pt.guid+++h),p.url=r+h),p.ifModified&&(T.lastModified[r]&&S.setRequestHeader("If-Modified-Since",T.lastModified[r]),T.etag[r]&&S.setRequestHeader("If-None-Match",T.etag[r])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&S.setRequestHeader("Content-Type",p.contentType),S.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+qt+"; q=0.01":""):p.accepts["*"]),p.headers)S.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(f,S,p)||c))return S.abort();if(w="abort",v.add(p.complete),S.done(p.success),S.fail(p.error),i=Xt(Wt,p,t,S)){if(S.readyState=1,u&&g.trigger("ajaxSend",[S,p]),c)return S;p.async&&p.timeout>0&&(s=n.setTimeout((function(){S.abort("timeout")}),p.timeout));try{c=!1,i.send(_,E)}catch(e){if(c)throw e;E(-1,e)}}else E(-1,"No Transport");function E(e,t,a,l){var d,h,b,_,x,w=t;c||(c=!0,s&&n.clearTimeout(s),i=void 0,o=l||"",S.readyState=e>0?4:0,d=e>=200&&e<300||304===e,a&&(_=function(e,t,n){for(var i,r,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),n[o]}(p,S,a)),!d&&T.inArray("script",p.dataTypes)>-1&&T.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),_=function(e,t,n,i){var r,o,a,s,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=u.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=c[l+" "+o]||c["* "+o]))for(r in c)if((s=r.split(" "))[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[r]:!0!==c[r]&&(o=s[0],u.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(p,_,S,d),d?(p.ifModified&&((x=S.getResponseHeader("Last-Modified"))&&(T.lastModified[r]=x),(x=S.getResponseHeader("etag"))&&(T.etag[r]=x)),204===e||"HEAD"===p.type?w="nocontent":304===e?w="notmodified":(w=_.state,h=_.data,d=!(b=_.error))):(b=w,!e&&w||(w="error",e<0&&(e=0))),S.status=e,S.statusText=(t||w)+"",d?m.resolveWith(f,[h,w,S]):m.rejectWith(f,[S,w,b]),S.statusCode(y),y=void 0,u&&g.trigger(d?"ajaxSuccess":"ajaxError",[S,p,d?h:b]),v.fireWith(f,[S,w]),u&&(g.trigger("ajaxComplete",[S,p]),--T.active||T.event.trigger("ajaxStop")))}return S},getJSON:function(e,t,n){return T.get(e,t,n,"json")},getScript:function(e,t){return T.get(e,void 0,t,"script")}}),T.each(["get","post"],(function(e,t){T[t]=function(e,n,i,r){return v(n)&&(r=r||i,i=n,n=void 0),T.ajax(T.extend({url:e,type:t,dataType:r,data:n,success:i},T.isPlainObject(e)&&e))}})),T.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),T._evalUrl=function(e,t,n){return T.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){T.globalEval(e,t,n)}})},T.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=T(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return v(e)?this.each((function(t){T(this).wrapInner(e.call(this,t))})):this.each((function(){var t=T(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=v(e);return this.each((function(n){T(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){T(this).replaceWith(this.childNodes)})),this}}),T.expr.pseudos.hidden=function(e){return!T.expr.pseudos.visible(e)},T.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},T.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(e){}};var Yt={0:200,1223:204},Kt=T.ajaxSettings.xhr();m.cors=!!Kt&&"withCredentials"in Kt,m.ajax=Kt=!!Kt,T.ajaxTransport((function(e){var t,i;if(m.cors||Kt&&!e.crossDomain)return{send:function(r,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)s.setRequestHeader(a,r[a]);t=function(e){return function(){t&&(t=i=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Yt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),i=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout((function(){t&&i()}))},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),T.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return T.globalEval(e),e}}}),T.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),T.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,r){t=T("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Jt,en=[],tn=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=en.pop()||T.expando+"_"+Pt.guid++;return this[e]=!0,e}}),T.ajaxPrefilter("json jsonp",(function(e,t,i){var r,o,a,s=!1!==e.jsonp&&(tn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&tn.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(tn,"$1"+r):!1!==e.jsonp&&(e.url+=(At.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||T.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=n[r],n[r]=function(){a=arguments},i.always((function(){void 0===o?T(n).removeProp(r):n[r]=o,e[r]&&(e.jsonpCallback=t.jsonpCallback,en.push(r)),a&&v(o)&&o(a[0]),a=o=void 0})),"script"})),m.createHTMLDocument=((Jt=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Jt.childNodes.length),T.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((i=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(i)):t=b),o=!n&&[],(r=H.exec(e))?[t.createElement(r[1])]:(r=Oe([e],t,o),o&&o.length&&T(o).remove(),T.merge([],r.childNodes)));var i,r,o},T.fn.load=function(e,t,n){var i,r,o,a=this,s=e.indexOf(" ");return s>-1&&(i=Tt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),a.length>0&&T.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done((function(e){o=arguments,a.html(i?T("<div>").append(T.parseHTML(e)).find(i):e)})).always(n&&function(e,t){a.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},T.expr.pseudos.animated=function(e){return T.grep(T.timers,(function(t){return e===t.elem})).length},T.offset={setOffset:function(e,t,n){var i,r,o,a,s,l,c=T.css(e,"position"),u=T(e),d={};"static"===c&&(e.style.position="relative"),s=u.offset(),o=T.css(e,"top"),l=T.css(e,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(a=(i=u.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),v(t)&&(t=t.call(e,n,T.extend({},s))),null!=t.top&&(d.top=t.top-s.top+a),null!=t.left&&(d.left=t.left-s.left+r),"using"in t?t.using.call(e,d):u.css(d)}},T.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){T.offset.setOffset(this,e,t)}));var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],r={top:0,left:0};if("fixed"===T.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===T.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((r=T(e).offset()).top+=T.css(e,"borderTopWidth",!0),r.left+=T.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-T.css(i,"marginTop",!0),left:t.left-r.left-T.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===T.css(e,"position");)e=e.offsetParent;return e||fe}))}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;T.fn[e]=function(i){return J(this,(function(e,i,r){var o;if(y(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r)return o?o[t]:e[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):e[i]=r}),e,i,arguments.length)}})),T.each(["top","left"],(function(e,t){T.cssHooks[t]=Je(m.pixelPosition,(function(e,n){if(n)return n=Ke(e,t),Ge.test(n)?T(e).position()[t]+"px":n}))})),T.each({Height:"height",Width:"width"},(function(e,t){T.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,i){T.fn[i]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===o?"margin":"border");return J(this,(function(t,n,r){var o;return y(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===r?T.css(t,n,s):T.style(t,n,r,s)}),t,a?r:void 0,a)}}))})),T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){T.fn[t]=function(e){return this.on(t,e)}})),T.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),T.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){T.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var nn=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;T.proxy=function(e,t){var n,i,r;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return i=s.call(arguments,2),(r=function(){return e.apply(t||this,i.concat(s.call(arguments)))}).guid=e.guid=e.guid||T.guid++,r},T.holdReady=function(e){e?T.readyWait++:T.ready(!0)},T.isArray=Array.isArray,T.parseJSON=JSON.parse,T.nodeName=C,T.isFunction=v,T.isWindow=y,T.camelCase=ie,T.type=w,T.now=Date.now,T.isNumeric=function(e){var t=T.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},T.trim=function(e){return null==e?"":(e+"").replace(nn,"$1")},void 0===(i=function(){return T}.apply(t,[]))||(e.exports=i);var rn=n.jQuery,on=n.$;return T.noConflict=function(e){return n.$===T&&(n.$=on),e&&n.jQuery===T&&(n.jQuery=rn),T},void 0===r&&(n.jQuery=n.$=T),T}))},function(e,t,n){var i,r,o;!function(a){"use strict";r=[n(0)],void 0===(o="function"==typeof(i=function(e){return e.ui=e.ui||{},e.ui.version="1.14.0"})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Widget 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){var t=0,n=Array.prototype.hasOwnProperty,i=Array.prototype.slice;return e.cleanData=function(t){return function(n){var i,r,o;for(o=0;null!=(r=n[o]);o++)(i=e._data(r,"events"))&&i.remove&&e(r).triggerHandler("remove");t(n)}}(e.cleanData),e.widget=function(t,n,i){var r,o,a,s={},l=t.split(".")[0],c=l+"-"+(t=t.split(".")[1]);return i||(i=n,n=e.Widget),Array.isArray(i)&&(i=e.extend.apply(null,[{}].concat(i))),e.expr.pseudos[c.toLowerCase()]=function(t){return!!e.data(t,c)},e[l]=e[l]||{},r=e[l][t],o=e[l][t]=function(e,t){if(!this||!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),(a=new n).options=e.widget.extend({},a.options),e.each(i,(function(e,t){s[e]="function"==typeof t?function(){function i(){return n.prototype[e].apply(this,arguments)}function r(t){return n.prototype[e].apply(this,t)}return function(){var e,n=this._super,o=this._superApply;return this._super=i,this._superApply=r,e=t.apply(this,arguments),this._super=n,this._superApply=o,e}}():t})),o.prototype=e.widget.extend(a,{widgetEventPrefix:r&&a.widgetEventPrefix||t},s,{constructor:o,namespace:l,widgetName:t,widgetFullName:c}),r?(e.each(r._childConstructors,(function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)})),delete r._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var r,o,a=i.call(arguments,1),s=0,l=a.length;s<l;s++)for(r in a[s])o=a[s][r],n.call(a[s],r)&&void 0!==o&&(e.isPlainObject(o)?t[r]=e.isPlainObject(t[r])?e.widget.extend({},t[r],o):e.widget.extend({},o):t[r]=o);return t},e.widget.bridge=function(t,n){var r=n.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,s=i.call(arguments,1),l=this;return a?this.length||"instance"!==o?this.each((function(){var n,i=e.data(this,r);return"instance"===o?(l=i,!1):i?"function"!=typeof i[o]||"_"===o.charAt(0)?e.error("no such method '"+o+"' for "+t+" widget instance"):(n=i[o].apply(i,s))!==i&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0:e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")})):l=void 0:(s.length&&(o=e.widget.extend.apply(null,[o].concat(s))),this.each((function(){var t=e.data(this,r);t?(t.option(o||{}),t._init&&t._init()):e.data(this,r,new n(o,this))}))),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(n,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),n),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var t=this;this._destroy(),e.each(this.classesElementLookup,(function(e,n){t._removeClass(n,e)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var i,r,o,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},i=t.split("."),t=i.shift(),i.length){for(r=a[t]=e.widget.extend({},this.options[t]),o=0;o<i.length-1;o++)r[i[o]]=r[i[o]]||{},r=r[i[o]];if(t=i.pop(),1===arguments.length)return void 0===r[t]?null:r[t];r[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(t){var n,i,r;for(n in t)r=this.classesElementLookup[n],t[n]!==this.options.classes[n]&&r&&r.length&&(i=e(r.get()),this._removeClass(r,n),i.addClass(this._classes({element:i,keys:n,classes:t,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){var n=[],i=this;function r(){var n=[];t.element.each((function(t,r){e.map(i.classesElementLookup,(function(e){return e})).some((function(e){return e.is(r)}))||n.push(r)})),i._on(e(n),{remove:"_untrackClassesElement"})}function o(o,a){var s,l;for(l=0;l<o.length;l++)s=i.classesElementLookup[o[l]]||e(),t.add?(r(),s=e(e.uniqueSort(s.get().concat(t.element.get())))):s=e(s.not(t.element).get()),i.classesElementLookup[o[l]]=s,n.push(o[l]),a&&t.classes[o[l]]&&n.push(t.classes[o[l]])}return(t=e.extend({element:this.element,classes:this.options.classes||{}},t)).keys&&o(t.keys.match(/\S+/g)||[],!0),t.extra&&o(t.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(t){var n=this;e.each(n.classesElementLookup,(function(i,r){-1!==e.inArray(t.target,r)&&(n.classesElementLookup[i]=e(r.not(t.target).get()))})),this._off(e(t.target))},_removeClass:function(e,t,n){return this._toggleClass(e,t,n,!1)},_addClass:function(e,t,n){return this._toggleClass(e,t,n,!0)},_toggleClass:function(e,t,n,i){i="boolean"==typeof i?i:n;var r="string"==typeof e||null===e,o={extra:r?t:n,keys:r?e:t,element:r?this.element:e,add:i};return o.element.toggleClass(this._classes(o),i),this},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,(function(i,a){function s(){if(t||!0!==o.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?o[a]:a).apply(o,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+o.eventNamespace,u=l[2];u?r.on(c,u,s):n.on(c,s)}))},_off:function(t,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(n),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){var n=this;return setTimeout((function(){return("string"==typeof e?n[e]:e).apply(n,arguments)}),t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(e(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(e(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,n,i){var r,o,a=this.options[t];if(i=i||{},(n=e.Event(n)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!("function"==typeof a&&!1===a.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},(function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){var a;"string"==typeof r&&(r={effect:r});var s=r?!0===r||"number"==typeof r?n:r.effect||n:t;"number"==typeof(r=r||{})?r={duration:r}:!0===r&&(r={}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),a&&e.effects&&e.effects.effect[s]?i[t](r):s!==t&&i[s]?i[s](r.duration,r.easing,o):i.queue((function(n){e(this)[t](),o&&o.call(i[0]),n()}))}})),e.widget})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){(function(i){var r,o,a;
/*!
 * jQuery UI Effects 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(s){"use strict";o=[n(0),n(69),n(70),n(1)],void 0===(a="function"==typeof(r=function(e){return e.effects={effect:{}},function(){var t,n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function o(e){var t,n,i,r=e.ownerDocument.defaultView.getComputedStyle(e),o={};for(n=r.length;n--;)"string"==typeof r[t=r[n]]&&(o[(i=t,i.replace(/-([\da-z])/gi,(function(e,t){return t.toUpperCase()})))]=r[t]);return o}e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(i.style(e.elem,n,e.end),e.setAttr=!0)}})),e.effects.animateClass=function(t,i,a,s){var l=e.speed(i,a,s);return this.queue((function(){var i,a=e(this),s=a.attr("class")||"",c=l.children?a.find("*").addBack():a;c=c.map((function(){return{el:e(this),start:o(this)}})),(i=function(){e.each(n,(function(e,n){t[n]&&a[n+"Class"](t[n])}))})(),c=c.map((function(){return this.end=o(this.el[0]),this.diff=function(t,n){var i,o,a={};for(i in n)o=n[i],t[i]!==o&&(r[i]||!e.fx.step[i]&&isNaN(parseFloat(o))||(a[i]=o));return a}(this.start,this.end),this})),a.attr("class",s),c=c.map((function(){var t=this,n=e.Deferred(),i=e.extend({},l,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,i),n.promise()})),e.when.apply(e,c.get()).done((function(){i(),e.each(arguments,(function(){var t=this.el;e.each(this.diff,(function(e){t.css(e,"")}))})),l.complete.call(a[0])}))}))},e.fn.extend({addClass:(t=e.fn.addClass,function(n,i,r,o){return i?e.effects.animateClass.call(this,{add:n},i,r,o):t.apply(this,arguments)}),removeClass:function(t){return function(n,i,r,o){return arguments.length>1?e.effects.animateClass.call(this,{remove:n},i,r,o):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(n,i,r,o,a){return"boolean"==typeof i||void 0===i?r?e.effects.animateClass.call(this,i?{add:n}:{remove:n},r,o,a):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:n},i,r,o)}}(e.fn.toggleClass),switchClass:function(t,n,i,r,o){return e.effects.animateClass.call(this,{add:n,remove:t},i,r,o)}})}(),function(){var t;function n(t,n,i,r){return e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},null==n&&(n={}),"function"==typeof n&&(r=n,i=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(r=i,i=n,n={}),"function"==typeof i&&(r=i,i=null),n&&e.extend(t,n),i=i||n.duration,t.duration=e.fx.off?0:"number"==typeof i?i:i in e.fx.speeds?e.fx.speeds[i]:e.fx.speeds._default,t.complete=r||n.complete,t}function i(t){return!(t&&"number"!=typeof t&&!e.fx.speeds[t])||("string"==typeof t&&!e.effects.effect[t]||("function"==typeof t||"object"==typeof t&&!t.effect))}function r(e,t){var n=t.outerWidth(),i=t.outerHeight(),r=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(e)||["",0,n,i,0];return{top:parseFloat(r[1])||0,right:"auto"===r[2]?n:parseFloat(r[2]),bottom:"auto"===r[3]?i:parseFloat(r[3]),left:parseFloat(r[4])||0}}e.expr&&e.expr.pseudos&&e.expr.pseudos.animated&&(e.expr.pseudos.animated=(t=e.expr.pseudos.animated,function(n){return!!e(n).data("ui-effects-animated")||t(n)})),!0===e.uiBackCompat&&e.extend(e.effects,{save:function(e,t){for(var n=0,i=t.length;n<i;n++)null!==t[n]&&e.data("ui-effects-"+t[n],e[0].style[t[n]])},restore:function(e,t){for(var n,i=0,r=t.length;i<r;i++)null!==t[i]&&(n=e.data("ui-effects-"+t[i]),e.css(t[i],n))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),float:t.css("float")},i=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r={width:t.width(),height:t.height()},o=document.activeElement;try{o.id}catch(e){o=document.body}return t.wrap(i),(t[0]===o||e.contains(t[0],o))&&e(o).trigger("focus"),i=t.parent(),"static"===t.css("position")?(i.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],(function(e,i){n[i]=t.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")})),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(r),i.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).trigger("focus")),t}}),e.extend(e.effects,{version:"1.14.0",define:function(t,n,i){return i||(i=n,n="effect"),e.effects.effect[t]=i,e.effects.effect[t].mode=n,i},scaledDimensions:function(e,t,n){if(0===t)return{height:0,width:0,outerHeight:0,outerWidth:0};var i="horizontal"!==n?(t||100)/100:1,r="vertical"!==n?(t||100)/100:1;return{height:e.height()*r,width:e.width()*i,outerHeight:e.outerHeight()*r,outerWidth:e.outerWidth()*i}},clipToBox:function(e){return{width:e.clip.right-e.clip.left,height:e.clip.bottom-e.clip.top,left:e.clip.left,top:e.clip.top}},unshift:function(e,t,n){var i=e.queue();t>1&&i.splice.apply(i,[1,0].concat(i.splice(t,n))),e.dequeue()},saveStyle:function(e){e.data("ui-effects-style",e[0].style.cssText)},restoreStyle:function(e){e[0].style.cssText=e.data("ui-effects-style")||"",e.removeData("ui-effects-style")},mode:function(e,t){var n=e.is(":hidden");return"toggle"===t&&(t=n?"show":"hide"),(n?"hide"===t:"show"===t)&&(t="none"),t},getBaseline:function(e,t){var n,i;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=e[1]/t.width}return{x:i,y:n}},createPlaceholder:function(t){var n,i=t.css("position"),r=t.position();return t.css({marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()),/^(static|relative)/.test(i)&&(i="absolute",n=e("<"+t[0].nodeName+">").insertAfter(t).css({display:/^(inline|ruby)/.test(t.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight"),float:t.css("float")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).addClass("ui-effects-placeholder"),t.data("ui-effects-placeholder",n)),t.css({position:i,left:r.left,top:r.top}),n},removePlaceholder:function(e){var t="ui-effects-placeholder",n=e.data(t);n&&(n.remove(),e.removeData(t))},cleanUp:function(t){e.effects.restoreStyle(t),e.effects.removePlaceholder(t)},setTransition:function(t,n,i,r){return r=r||{},e.each(n,(function(e,n){var o=t.cssUnit(n);o[0]>0&&(r[n]=o[0]*i+o[1])})),r}}),e.fn.extend({effect:function(){var t=n.apply(this,arguments),i=e.effects.effect[t.effect],r=i.mode,o=t.queue,a=o||"fx",s=t.complete,l=t.mode,c=[],u=function(t){var n=e(this),i=e.effects.mode(n,l)||r;n.data("ui-effects-animated",!0),c.push(i),r&&("show"===i||i===r&&"hide"===i)&&n.show(),r&&"none"===i||e.effects.saveStyle(n),"function"==typeof t&&t()};if(e.fx.off||!i)return l?this[l](t.duration,s):this.each((function(){s&&s.call(this)}));function d(n){var o=e(this);function a(){"function"==typeof s&&s.call(o[0]),"function"==typeof n&&n()}t.mode=c.shift(),!0!==e.uiBackCompat||r?"none"===t.mode?(o[l](),a()):i.call(o[0],t,(function(){o.removeData("ui-effects-animated"),e.effects.cleanUp(o),"hide"===t.mode&&o.hide(),a()})):(o.is(":hidden")?"hide"===l:"show"===l)?(o[l](),a()):i.call(o[0],t,a)}return!1===o?this.each(u).each(d):this.queue(a,u).queue(a,d)},show:function(e){return function(t){if(i(t))return e.apply(this,arguments);var r=n.apply(this,arguments);return r.mode="show",this.effect.call(this,r)}}(e.fn.show),hide:function(e){return function(t){if(i(t))return e.apply(this,arguments);var r=n.apply(this,arguments);return r.mode="hide",this.effect.call(this,r)}}(e.fn.hide),toggle:function(e){return function(t){if(i(t)||"boolean"==typeof t)return e.apply(this,arguments);var r=n.apply(this,arguments);return r.mode="toggle",this.effect.call(this,r)}}(e.fn.toggle),cssUnit:function(t){var n=this.css(t),i=[];return e.each(["em","px","%","pt"],(function(e,t){n.indexOf(t)>0&&(i=[parseFloat(n),t])})),i},cssClip:function(e){return e?this.css("clip","rect("+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px)"):r(this.css("clip"),this)},transfer:function(t,n){var i=e(this),r=e(t.to),o="fixed"===r.css("position"),a=e("body"),s=o?a.scrollTop():0,l=o?a.scrollLeft():0,c=r.offset(),u={top:c.top-s,left:c.left-l,height:r.innerHeight(),width:r.innerWidth()},d=i.offset(),h=e("<div class='ui-effects-transfer'></div>");h.appendTo("body").addClass(t.className).css({top:d.top-s,left:d.left-l,height:i.innerHeight(),width:i.innerWidth(),position:o?"fixed":"absolute"}).animate(u,t.duration,t.easing,(function(){h.remove(),"function"==typeof n&&n()}))}}),e.fx.step.clip=function(t){t.clipInit||(t.start=e(t.elem).cssClip(),"string"==typeof t.end&&(t.end=r(t.end,t.elem)),t.clipInit=!0),e(t.elem).cssClip({top:t.pos*(t.end.top-t.start.top)+t.start.top,right:t.pos*(t.end.right-t.start.right)+t.start.right,bottom:t.pos*(t.end.bottom-t.start.bottom)+t.start.bottom,left:t.pos*(t.end.left-t.start.left)+t.start.left})}}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],(function(e,n){t[n]=function(t){return Math.pow(t,e+2)}})),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,(function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(2*e)/2:1-n(-2*e+2)/2}}))}(),e.effects})?r.apply(t,o):r)||(e.exports=a)}()}).call(this,n(0))},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Keycode 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Mouse 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){var t=!1;return e(document).on("mouseup",(function(){t=!1})),e.widget("ui.mouse",{version:"1.14.0",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,(function(e){return t._mouseDown(e)})).on("click."+this.widgetName,(function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,r=1===n.which,o="string"==typeof this.options.cancel&&e(n.target).closest(this.options.cancel).length;return!(r&&!o&&this._mouseCapture(n))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){i.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=!1!==this._mouseStart(n),!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved&&!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e);return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(n){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&e.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,t=!1,n.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Unique ID 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.fn.extend({uniqueId:(t=0,function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++t)}))}),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")}))}});var t})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Position 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 *
 * https://api.jqueryui.com/position/
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return function(){var t,n=Math.max,i=Math.abs,r=/left|center|right/,o=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,c=e.fn.position;function u(e,t,n){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?n/100:1)]}function d(t,n){return parseInt(e.css(t,n),10)||0}function h(e){return null!=e&&e===e.window}function p(e){var t=e[0];return 9===t.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:h(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}e.position={scrollbarWidth:function(){if(void 0!==t)return t;var n,i,r=e("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>"),o=r.children()[0];return e("body").append(r),n=o.offsetWidth,r.css("overflow","scroll"),n===(i=o.offsetWidth)&&(i=r[0].clientWidth),r.remove(),t=n-i},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),r="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight?e.position.scrollbarWidth():0,height:r?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=h(n[0]),r=!!n[0]&&9===n[0].nodeType;return{element:n,isWindow:i,isDocument:r,offset:!i&&!r?e(t).offset():{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:n.outerWidth(),height:n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);var l,h,f,g,m,v,y="string"==typeof(t=e.extend({},t)).of?e(document).find(t.of):e(t.of),b=e.position.getWithinInfo(t.within),_=e.position.getScrollInfo(b),x=(t.collision||"flip").split(" "),w={};return v=p(y),y[0].preventDefault&&(t.at="left top"),h=v.width,f=v.height,g=v.offset,m=e.extend({},g),e.each(["my","at"],(function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):o.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=o.test(i[1])?i[1]:"center",e=a.exec(i[0]),n=a.exec(i[1]),w[this]=[e?e[0]:0,n?n[0]:0],t[this]=[s.exec(i[0])[0],s.exec(i[1])[0]]})),1===x.length&&(x[1]=x[0]),"right"===t.at[0]?m.left+=h:"center"===t.at[0]&&(m.left+=h/2),"bottom"===t.at[1]?m.top+=f:"center"===t.at[1]&&(m.top+=f/2),l=u(w.at,h,f),m.left+=l[0],m.top+=l[1],this.each((function(){var r,o,a=e(this),s=a.outerWidth(),c=a.outerHeight(),p=d(this,"marginLeft"),v=d(this,"marginTop"),S=s+p+d(this,"marginRight")+_.width,T=c+v+d(this,"marginBottom")+_.height,E=e.extend({},m),C=u(w.my,a.outerWidth(),a.outerHeight());"right"===t.my[0]?E.left-=s:"center"===t.my[0]&&(E.left-=s/2),"bottom"===t.my[1]?E.top-=c:"center"===t.my[1]&&(E.top-=c/2),E.left+=C[0],E.top+=C[1],r={marginLeft:p,marginTop:v},e.each(["left","top"],(function(n,i){e.ui.position[x[n]]&&e.ui.position[x[n]][i](E,{targetWidth:h,targetHeight:f,elemWidth:s,elemHeight:c,collisionPosition:r,collisionWidth:S,collisionHeight:T,offset:[l[0]+C[0],l[1]+C[1]],my:t.my,at:t.at,within:b,elem:a})})),t.using&&(o=function(e){var r=g.left-E.left,o=r+h-s,l=g.top-E.top,u=l+f-c,d={target:{element:y,left:g.left,top:g.top,width:h,height:f},element:{element:a,left:E.left,top:E.top,width:s,height:c},horizontal:o<0?"left":r>0?"right":"center",vertical:u<0?"top":l>0?"bottom":"middle"};h<s&&i(r+o)<h&&(d.horizontal="center"),f<c&&i(l+u)<f&&(d.vertical="middle"),n(i(r),i(o))>n(i(l),i(u))?d.important="horizontal":d.important="vertical",t.using.call(this,e,d)}),a.offset(e.extend(E,{using:o}))}))},e.ui.position={fit:{left:function(e,t){var i,r=t.within,o=r.isWindow?r.scrollLeft:r.offset.left,a=r.width,s=e.left-t.collisionPosition.marginLeft,l=o-s,c=s+t.collisionWidth-a-o;t.collisionWidth>a?l>0&&c<=0?(i=e.left+l+t.collisionWidth-a-o,e.left+=l-i):e.left=c>0&&l<=0?o:l>c?o+a-t.collisionWidth:o:l>0?e.left+=l:c>0?e.left-=c:e.left=n(e.left-s,e.left)},top:function(e,t){var i,r=t.within,o=r.isWindow?r.scrollTop:r.offset.top,a=t.within.height,s=e.top-t.collisionPosition.marginTop,l=o-s,c=s+t.collisionHeight-a-o;t.collisionHeight>a?l>0&&c<=0?(i=e.top+l+t.collisionHeight-a-o,e.top+=l-i):e.top=c>0&&l<=0?o:l>c?o+a-t.collisionHeight:o:l>0?e.top+=l:c>0?e.top-=c:e.top=n(e.top-s,e.top)}},flip:{left:function(e,t){var n,r,o=t.within,a=o.offset.left+o.scrollLeft,s=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,d=c+t.collisionWidth-s-l,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];u<0?((n=e.left+h+p+f+t.collisionWidth-s-a)<0||n<i(u))&&(e.left+=h+p+f):d>0&&((r=e.left-t.collisionPosition.marginLeft+h+p+f-l)>0||i(r)<d)&&(e.left+=h+p+f)},top:function(e,t){var n,r,o=t.within,a=o.offset.top+o.scrollTop,s=o.height,l=o.isWindow?o.scrollTop:o.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,d=c+t.collisionHeight-s-l,h="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,p="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,f=-2*t.offset[1];u<0?((r=e.top+h+p+f+t.collisionHeight-s-a)<0||r<i(u))&&(e.top+=h+p+f):d>0&&((n=e.top-t.collisionPosition.marginTop+h+p+f-l)>0||i(n)<d)&&(e.top+=h+p+f)}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}}}(),e.ui.position})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){n(17),e.exports=angular},function(e,t,n){var i,r,o;
/*!
 * jQuery UI :data 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.extend(e.expr.pseudos,{data:e.expr.createPseudo((function(t){return function(n){return!!e.data(n,t)}}))})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Focusable 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.ui.focusable=function(t,n){var i,r,o,a,s,l=t.nodeName.toLowerCase();return"area"===l?(r=(i=t.parentNode).name,!(!t.href||!r||"map"!==i.nodeName.toLowerCase())&&((o=e("img[usemap='#"+r+"']")).length>0&&o.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(l)?(a=!t.disabled)&&(s=e(t).closest("fieldset")[0])&&(a=!s.disabled):a="a"===l&&t.href||n,a&&e(t).is(":visible")&&"visible"===e(t).css("visibility"))},e.extend(e.expr.pseudos,{focusable:function(t){return e.ui.focusable(t,null!=e.attr(t,"tabindex"))}}),e.ui.focusable})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Form Reset Mixin 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.ui.formResetMixin={_formResetHandler:function(){var t=e(this);setTimeout((function(){var n=t.data("ui-form-reset-instances");e.each(n,(function(){this.refresh()}))}))},_bindFormResetHandler:function(){if(this.form=e(this.element.prop("form")),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var t=this.form.data("ui-form-reset-instances");t.splice(e.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}}})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Labels 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.fn.labels=function(){var e,t,n,i,r;return this.length?this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(i=this.eq(0).parents("label"),(n=this.attr("id"))&&(r=(e=this.eq(0).parents().last()).add(e.length?e.siblings():this.siblings()),t="label[for='"+CSS.escape(n)+"']",i=i.add(r.find(t).addBack(t))),this.pushStack(i)):this.pushStack([])}})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Scroll Parent 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.fn.scrollParent=function(t){var n=this.css("position"),i="absolute"===n,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter((function(){var t=e(this);return(!i||"static"!==t.css("position"))&&r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))})).eq(0);return"fixed"!==n&&o.length?o:e(this[0].ownerDocument||document)}})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Draggable 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(5),n(9),n(20),n(13),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"1.14.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(t){var n=this.options;return!(this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blurActiveElement(t),this._blockFrames(!0===n.iframeFix?"iframe":n.iframeFix),!0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map((function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var n=this.document[0].activeElement;e(t.target).closest(n).length||e(n).trigger("blur")},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===e(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp(new e.Event("mouseup",t)),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||"function"==typeof this.options.revert&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==n._trigger("stop",t)&&n._clear()})):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.trigger("focus"),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new e.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var n=this.options,i="function"==typeof n.helper,r=i?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),Array.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options,o=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),(i=(n=e(r.containment))[0])&&(t=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n)):this.containment=r.containment:this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,i,r,o,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),a.grid&&(r=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-a.grid[1]:r+a.grid[1]:r,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,i){var r=e.extend({},n,{item:i.element});i.sortables=[],e(i.options.connectToSortable).each((function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push(n),n.refreshPositions(),n._trigger("activate",t,r))}))},stop:function(t,n,i){var r=e.extend({},n,{item:i.element});i.cancelHelperRemoval=!1,e.each(i.sortables,(function(){this.isOver?(this.isOver=0,i.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(t),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",t,r))}))},drag:function(t,n,i){e.each(i.sortables,(function(){var r=!1,o=this;o.positionAbs=i.positionAbs,o.helperProportions=i.helperProportions,o.offset.click=i.offset.click,o._intersectsWith(o.containerCache)&&(r=!0,e.each(i.sortables,(function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&e.contains(o.element[0],this.element[0])&&(r=!1),r}))),r?(o.isOver||(o.isOver=1,i._parent=n.helper.parent(),o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},t.target=o.currentItem[0],o._mouseCapture(t,!0),o._mouseStart(t,!0,!0),o.offset.click.top=i.offset.click.top,o.offset.click.left=i.offset.click.left,o.offset.parent.left-=i.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=i.offset.parent.top-o.offset.parent.top,i._trigger("toSortable",t),i.dropped=o.element,e.each(i.sortables,(function(){this.refreshPositions()})),i.currentItem=i.element,o.fromOutside=i),o.currentItem&&(o._mouseDrag(t),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",t,o._uiHash(o)),o._mouseStop(t,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n.helper.appendTo(i._parent),i._refreshOffsets(t),n.position=i._generatePosition(t,!0),i._trigger("fromSortable",t),i.dropped=!1,e.each(i.sortables,(function(){this.refreshPositions()})))}))}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,i){var r=e("body"),o=i.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(t,n,i){var r=i.options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(t,n,i){var r=i.options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(t,n,i){var r=i.options,o=!1,a=i.scrollParentNotHidden[0],s=i.document[0];a!==s&&"HTML"!==a.tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+a.offsetHeight-t.pageY<r.scrollSensitivity?a.scrollTop=o=a.scrollTop+r.scrollSpeed:t.pageY-i.overflowOffset.top<r.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+a.offsetWidth-t.pageX<r.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+r.scrollSpeed:t.pageX-i.overflowOffset.left<r.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(s).scrollTop()<r.scrollSensitivity?o=e(s).scrollTop(e(s).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(s).scrollTop())<r.scrollSensitivity&&(o=e(s).scrollTop(e(s).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(s).scrollLeft()<r.scrollSensitivity?o=e(s).scrollLeft(e(s).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(s).scrollLeft())<r.scrollSensitivity&&(o=e(s).scrollLeft(e(s).scrollLeft()+r.scrollSpeed)))),!1!==o&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,i){var r=i.options;i.snapElements=[],e(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each((function(){var t=e(this),n=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})}))},drag:function(t,n,i){var r,o,a,s,l,c,u,d,h,p,f=i.options,g=f.snapTolerance,m=n.offset.left,v=m+i.helperProportions.width,y=n.offset.top,b=y+i.helperProportions.height;for(h=i.snapElements.length-1;h>=0;h--)c=(l=i.snapElements[h].left-i.margins.left)+i.snapElements[h].width,d=(u=i.snapElements[h].top-i.margins.top)+i.snapElements[h].height,v<l-g||m>c+g||b<u-g||y>d+g||!e.contains(i.snapElements[h].item.ownerDocument,i.snapElements[h].item)?(i.snapElements[h].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(r=Math.abs(u-b)<=g,o=Math.abs(d-y)<=g,a=Math.abs(l-v)<=g,s=Math.abs(c-m)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:d,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c}).left)),p=r||o||a||s,"outer"!==f.snapMode&&(r=Math.abs(u-y)<=g,o=Math.abs(d-b)<=g,a=Math.abs(l-m)<=g,s=Math.abs(c-v)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:d-i.helperProportions.height,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left)),!i.snapElements[h].snapping&&(r||o||a||s||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=r||o||a||s||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,i){var r,o=i.options,a=e.makeArray(e(o.stack)).sort((function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)}));a.length&&(r=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each((function(t){e(this).css("zIndex",r+t)})),this.css("zIndex",r+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(t,n,i){var r=i.options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}}),e.ui.draggable})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Menu 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(4),n(7),n(6),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.menu",{version:"1.14.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.lastMousePosition={x:null,y:null},this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault(),this._activateItem(e)},"click .ui-menu-item":function(t){var n=e(t.target),i=e(this.document[0].activeElement);!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),n.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&i.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this._menuItems().first();t||this.focus(e,n)},blur:function(t){this._delay((function(){!e.contains(this.element[0],this.document[0].activeElement)&&this.collapseAll(t)}))},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e,!0),this.mouseHandled=!1}})},_activateItem:function(t){if(!this.previousFilter&&(t.clientX!==this.lastMousePosition.x||t.clientY!==this.lastMousePosition.y)){this.lastMousePosition={x:t.clientX,y:t.clientY};var n=e(t.target).closest(".ui-menu-item"),i=e(t.currentTarget);n[0]===i[0]&&(i.is(".ui-state-active")||(this._removeClass(i.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(t,i)))}},_destroy:function(){var t=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),t.children().each((function(){var t=e(this);t.data("ui-menu-submenu-caret")&&t.remove()}))},_keydown:function(t){var n,i,r,o,a=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:a=!1,i=this.previousFilter||"",o=!1,r=t.keyCode>=96&&t.keyCode<=105?(t.keyCode-96).toString():String.fromCharCode(t.keyCode),clearTimeout(this.filterTimer),r===i?o=!0:r=i+r,n=this._filterMenuItems(r),(n=o&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n).length||(r=String.fromCharCode(t.keyCode),n=this._filterMenuItems(r)),n.length?(this.focus(t,n),this.previousFilter=r,this.filterTimer=this._delay((function(){delete this.previousFilter}),1e3)):delete this.previousFilter}a&&t.preventDefault()},_activate:function(e){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n,i,r,o=this,a=this.options.icons.submenu,s=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),n=s.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each((function(){var t=e(this),n=t.prev(),i=e("<span>").data("ui-menu-submenu-caret",!0);o._addClass(i,"ui-menu-icon","ui-icon "+a),n.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",n.attr("id"))})),this._addClass(n,"ui-menu","ui-widget ui-widget-content ui-front"),(t=s.add(this.element).find(this.options.items)).not(".ui-menu-item").each((function(){var t=e(this);o._isDivider(t)&&o._addClass(t,"ui-menu-divider","ui-widget-content")})),r=(i=t.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(i,"ui-menu-item")._addClass(r,"ui-menu-item-wrapper"),t.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if("icons"===e){var n=this.element.find(".ui-menu-icon");this._removeClass(n,null,this.options.icons.submenu)._addClass(n,null,t.submenu)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",String(e)),this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var n,i,r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children(".ui-menu-item-wrapper"),this._addClass(i,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),r=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(r,null,"ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay((function(){this._close()}),this.delay),(n=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,i,r,o,a,s;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,r=t.offset().top-this.activeMenu.offset().top-n-i,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),s=t.outerHeight(),r<0?this.activeMenu.scrollTop(o+r):r+s>a&&this.activeMenu.scrollTop(o+r-a+s))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",e,{item:this.active}),this.active=null)},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay((function(){this._close(),this._open(e)}),this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay((function(){var i=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this._removeClass(i.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=i}),n?0:this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this._menuItems(this.active.children(".ui-menu")).first();t&&t.length&&(this._open(t.parent()),this._delay((function(){this.focus(e,t)})))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(e){return(e||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(e,t,n){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").last():this.active[e+"All"](".ui-menu-item").first()),i&&i.length&&this.active||(i=this._menuItems(this.activeMenu)[t]()),this.focus(n,i)},nextPage:function(t){var n,i,r;this.active?this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.innerHeight(),0===e.fn.jquery.indexOf("3.2.")&&(r+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.nextAll(".ui-menu-item").each((function(){return(n=e(this)).offset().top-i-r<0})),this.focus(t,n)):this.focus(t,this._menuItems(this.activeMenu)[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var n,i,r;this.active?this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.innerHeight(),0===e.fn.jquery.indexOf("3.2.")&&(r+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.prevAll(".ui-menu-item").each((function(){return(n=e(this)).offset().top-i+r>0})),this.focus(t,n)):this.focus(t,this._menuItems(this.activeMenu).first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)},_filterMenuItems:function(t){var n=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=new RegExp("^"+n,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter((function(){return i.test(String.prototype.trim.call(e(this).children(".ui-menu-item-wrapper").text()))}))}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Button 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(22),n(23),n(4),n(2)],void 0===(o="function"==typeof(i=function(e){e.widget("ui.button",{version:"1.14.0",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var e,t=this._super()||{};return this.isInput=this.element.is("input"),null!=(e=this.element[0].disabled)&&(t.disabled=e),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(t.label=this.originalLabel),t},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===e.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,n){var i="iconPosition"!==t,r=i?this.options.iconPosition:n,o="top"===r||"bottom"===r;this.icon?i&&this._removeClass(this.icon,null,this.options.icon):(this.icon=e("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),i&&this._addClass(this.icon,null,n),this._attachIcon(r),o?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(r))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(e){this.icon[/^(?:end|bottom)/.test(e)?"before":"after"](this.iconSpace)},_attachIcon:function(e){this.element[/^(?:end|bottom)/.test(e)?"append":"prepend"](this.icon)},_setOptions:function(e){var t=void 0===e.showLabel?this.options.showLabel:e.showLabel,n=void 0===e.icon?this.options.icon:e.icon;t||n||(e.showLabel=!0),this._super(e)},_setOption:function(e,t){"icon"===e&&(t?this._updateIcon(e,t):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===e&&this._updateIcon(e,t),"showLabel"===e&&(this._toggleClass("ui-button-icon-only",null,!t),this._updateTooltip()),"label"===e&&(this.isInput?this.element.val(t):(this.element.html(t),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(e,t),"disabled"===e&&(this._toggleClass(null,"ui-state-disabled",t),this.element[0].disabled=t,t&&this.element.trigger("blur"))},refresh:function(){var e=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOptions({disabled:e}),this._updateTooltip()}}),!0===e.uiBackCompat&&(e.widget("ui.button",e.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(e,t){"text"!==e?("showLabel"===e&&(this.options.text=t),"icon"===e&&(this.options.icons.primary=t),"icons"===e&&(t.primary?(this._super("icon",t.primary),this._super("iconPosition","beginning")):t.secondary&&(this._super("icon",t.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",t)}}),e.fn.button=(t=e.fn.button,function(n){var i="string"==typeof n,r=Array.prototype.slice.call(arguments,1),o=this;return i?this.length||"instance"!==n?this.each((function(){var t,i=e(this).attr("type"),a="checkbox"!==i&&"radio"!==i?"button":"checkboxradio",s=e.data(this,"ui-"+a);return"instance"===n?(o=s,!1):s?"function"!=typeof s[n]||"_"===n.charAt(0)?e.error("no such method '"+n+"' for button widget instance"):(t=s[n].apply(s,r))!==s&&void 0!==t?(o=t&&t.jquery?o.pushStack(t.get()):t,!1):void 0:e.error("cannot call methods on button prior to initialization; attempted to call method '"+n+"'")})):o=void 0:(r.length&&(n=e.widget.extend.apply(null,[n].concat(r))),this.each((function(){var i=e(this).attr("type"),r="checkbox"!==i&&"radio"!==i?"button":"checkboxradio",o=e.data(this,"ui-"+r);if(o)o.option(n||{}),o._init&&o._init();else{if("button"===r)return void t.call(e(this),n);e(this).checkboxradio(e.extend({icon:!1},n))}}))),o}),e.fn.buttonset=function(){return e.ui.controlgroup||e.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))});var t;return e.ui.button})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){(function(e){
/**
 * @license AngularJS v1.3.15
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(t,n,i){"use strict";function r(e,t){return t=t||Error,function(){var n,i,r=arguments[0],o="["+(e?e+":":"")+r+"] ",a=arguments[1],s=arguments;for(n=(n=o+a.replace(/\{\d+\}/g,(function(e){var t=+e.slice(1,-1);return t+2<s.length?Pe(s[t+2]):e})))+"\nhttp://errors.angularjs.org/1.3.15/"+(e?e+"/":"")+r,i=2;i<arguments.length;i++)n=n+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(Pe(arguments[i]));return new t(n)}}var o=/^\/(.+)\/([a-z]*)$/,a=function(e){return N(e)?e.toLowerCase():e},s=Object.prototype.hasOwnProperty,l=function(e){return N(e)?e.toUpperCase():e};"i"!=="I".toLowerCase()&&(a=function(e){return N(e)?e.replace(/[A-Z]/g,(function(e){return String.fromCharCode(32|e.charCodeAt(0))})):e},l=function(e){return N(e)?e.replace(/[a-z]/g,(function(e){return String.fromCharCode(-33&e.charCodeAt(0))})):e});var c,u,d,h,p=[].slice,f=[].splice,g=[].push,m=Object.prototype.toString,v=r("ng"),y=t.angular||(t.angular={}),b=0;function _(e){if(null==e||F(e))return!1;var t=e.length;return!(e.nodeType!==ke||!t)||(N(e)||B(e)||0===t||"number"==typeof t&&t>0&&t-1 in e)}function x(e,t,n){var i,r;if(e)if(H(e))for(i in e)"prototype"==i||"length"==i||"name"==i||e.hasOwnProperty&&!e.hasOwnProperty(i)||t.call(n,e[i],i,e);else if(B(e)||_(e)){var o="object"!=typeof e;for(i=0,r=e.length;i<r;i++)(o||i in e)&&t.call(n,e[i],i,e)}else if(e.forEach&&e.forEach!==x)e.forEach(t,n,e);else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e);return e}function w(e){return Object.keys(e).sort()}function S(e){return function(t,n){e(n,t)}}function T(){return++b}function E(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function C(e){for(var t=e.$$hashKey,n=1,i=arguments.length;n<i;n++){var r=arguments[n];if(r)for(var o=Object.keys(r),a=0,s=o.length;a<s;a++){var l=o[a];e[l]=r[l]}}return E(e,t),e}function k(e){return parseInt(e,10)}function L(e,t){return C(Object.create(e),t)}function P(){}function A(e){return e}function O(e){return function(){return e}}function I(e){return void 0===e}function D(e){return void 0!==e}function $(e){return null!==e&&"object"==typeof e}function N(e){return"string"==typeof e}function M(e){return"number"==typeof e}function R(e){return"[object Date]"===m.call(e)}c=n.documentMode,P.$inject=[],A.$inject=[];var B=Array.isArray;function H(e){return"function"==typeof e}function z(e){return"[object RegExp]"===m.call(e)}function F(e){return e&&e.window===e}function V(e){return e&&e.$evalAsync&&e.$watch}function j(e){return"boolean"==typeof e}function U(e){return e&&H(e.then)}var W=function(e){return N(e)?e.trim():e},q=function(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};function G(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function Z(e){return a(e.nodeName||e[0]&&e[0].nodeName)}function X(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),t}function Q(e,t,n,i){if(F(e)||V(e))throw v("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(t){if(e===t)throw v("cpi","Can't copy! Source and destination are identical.");if(n=n||[],i=i||[],$(e)){var r=n.indexOf(e);if(-1!==r)return i[r];n.push(e),i.push(t)}var o;if(B(e)){t.length=0;for(var a=0;a<e.length;a++)o=Q(e[a],null,n,i),$(e[a])&&(n.push(e[a]),i.push(o)),t.push(o)}else{var s=t.$$hashKey;for(var l in B(t)?t.length=0:x(t,(function(e,n){delete t[n]})),e)e.hasOwnProperty(l)&&(o=Q(e[l],null,n,i),$(e[l])&&(n.push(e[l]),i.push(o)),t[l]=o);E(t,s)}}else if(t=e,e)if(B(e))t=Q(e,[],n,i);else if(R(e))t=new Date(e.getTime());else if(z(e))(t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0])).lastIndex=e.lastIndex;else if($(e)){var c=Object.create(Object.getPrototypeOf(e));t=Q(e,c,n,i)}return t}function Y(e,t){if(B(e)){t=t||[];for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}else if($(e))for(var r in t=t||{},e)"$"===r.charAt(0)&&"$"===r.charAt(1)||(t[r]=e[r]);return t||e}function K(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var n,i,r,o=typeof e;if(o==typeof t&&"object"==o){if(!B(e)){if(R(e))return!!R(t)&&K(e.getTime(),t.getTime());if(z(e))return!!z(t)&&e.toString()==t.toString();if(V(e)||V(t)||F(e)||F(t)||B(t)||R(t)||z(t))return!1;for(i in r={},e)if("$"!==i.charAt(0)&&!H(e[i])){if(!K(e[i],t[i]))return!1;r[i]=!0}for(i in t)if(!r.hasOwnProperty(i)&&"$"!==i.charAt(0)&&void 0!==t[i]&&!H(t[i]))return!1;return!0}if(!B(t))return!1;if((n=e.length)==t.length){for(i=0;i<n;i++)if(!K(e[i],t[i]))return!1;return!0}}return!1}var J=function(){if(D(J.isActive_))return J.isActive_;var e=!(!n.querySelector("[ng-csp]")&&!n.querySelector("[data-ng-csp]"));if(!e)try{new Function("")}catch(t){e=!0}return J.isActive_=e};function ee(e,t,n){return e.concat(p.call(t,n))}function te(e,t){return p.call(e,t||0)}function ne(e,t){var n=arguments.length>2?te(arguments,2):[];return!H(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,ee(n,arguments,0)):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function ie(e,t){var i=t;return"string"==typeof e&&"$"===e.charAt(0)&&"$"===e.charAt(1)?i=void 0:F(t)?i="$WINDOW":t&&n===t?i="$DOCUMENT":V(t)&&(i="$SCOPE"),i}function re(e,t){if(void 0!==e)return M(t)||(t=t?2:null),JSON.stringify(e,ie,t)}function oe(e){return N(e)?JSON.parse(e):e}function ae(e){e=u(e).clone();try{e.empty()}catch(e){}var t=u("<div>").append(e).html();try{return e[0].nodeType===Le?a(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,(function(e,t){return"<"+a(t)}))}catch(e){return a(t)}}function se(e){try{return decodeURIComponent(e)}catch(e){}}function le(e){var t,n,i={};return x((e||"").split("&"),(function(e){if(e&&(t=e.replace(/\+/g,"%20").split("="),D(n=se(t[0])))){var r=!D(t[1])||se(t[1]);s.call(i,n)?B(i[n])?i[n].push(r):i[n]=[i[n],r]:i[n]=r}})),i}function ce(e){var t=[];return x(e,(function(e,n){B(e)?x(e,(function(e){t.push(de(n,!0)+(!0===e?"":"="+de(e,!0)))})):t.push(de(n,!0)+(!0===e?"":"="+de(e,!0)))})),t.length?t.join("&"):""}function ue(e){return de(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function de(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,t?"%20":"+")}var he=["ng-","data-ng-","ng:","x-ng-"];function pe(e,t){var n,i,r={};x(he,(function(t){var r=t+"app";!n&&e.hasAttribute&&e.hasAttribute(r)&&(n=e,i=e.getAttribute(r))})),x(he,(function(t){var r,o=t+"app";!n&&(r=e.querySelector("["+o.replace(":","\\:")+"]"))&&(n=r,i=r.getAttribute(o))})),n&&(r.strictDi=null!==function(e,t){var n,i,r=he.length;for(e=u(e),i=0;i<r;++i)if(n=he[i]+t,N(n=e.attr(n)))return n;return null}(n,"strict-di"),t(n,i?[i]:[],r))}function fe(e,i,r){$(r)||(r={});r=C({strictDi:!1},r);var o=function(){if((e=u(e)).injector()){var t=e[0]===n?"document":ae(e);throw v("btstrpd","App Already Bootstrapped with this Element '{0}'",t.replace(/</,"&lt;").replace(/>/,"&gt;"))}(i=i||[]).unshift(["$provide",function(t){t.value("$rootElement",e)}]),r.debugInfoEnabled&&i.push(["$compileProvider",function(e){e.debugInfoEnabled(!0)}]),i.unshift("ng");var o=wt(i,r.strictDi);return o.invoke(["$rootScope","$rootElement","$compile","$injector",function(e,t,n,i){e.$apply((function(){t.data("$injector",i),n(t)(e)}))}]),o},a=/^NG_ENABLE_DEBUG_INFO!/,s=/^NG_DEFER_BOOTSTRAP!/;if(t&&a.test(t.name)&&(r.debugInfoEnabled=!0,t.name=t.name.replace(a,"")),t&&!s.test(t.name))return o();t.name=t.name.replace(s,""),y.resumeBootstrap=function(e){return x(e,(function(e){i.push(e)})),o()},H(y.resumeDeferredBootstrap)&&y.resumeDeferredBootstrap()}function ge(){t.name="NG_ENABLE_DEBUG_INFO!"+t.name,t.location.reload()}function me(e){var t=y.element(e).injector();if(!t)throw v("test","no injector found for element argument to getTestability");return t.get("$$testability")}var ve=/[A-Z]/g;function ye(e,t){return t=t||"_",e.replace(ve,(function(e,n){return(n?t:"")+e.toLowerCase()}))}var be,_e=!1;function xe(e,t,n){if(!e)throw v("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function we(e,t,n){return n&&B(e)&&(e=e[e.length-1]),xe(H(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function Se(e,t){if("hasOwnProperty"===e)throw v("badname","hasOwnProperty is not a valid {0} name",t)}function Te(e,t,n){if(!t)return e;for(var i,r=t.split("."),o=e,a=r.length,s=0;s<a;s++)i=r[s],e&&(e=(o=e)[i]);return!n&&H(e)?ne(o,e):e}function Ee(e){var t=e[0],n=e[e.length-1],i=[t];do{if(!(t=t.nextSibling))break;i.push(t)}while(t!==n);return u(i)}function Ce(){return Object.create(null)}var ke=1,Le=3;function Pe(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):void 0===e?"undefined":"string"!=typeof e?function(e){var t=[];return JSON.stringify(e,(function(e,n){if($(n=ie(e,n))){if(t.indexOf(n)>=0)return"<<already seen>>";t.push(n)}return n}))}(e):e}var Ae={full:"1.3.15",major:1,minor:3,dot:15,codeName:"locality-filtration"};Ze.expando="ng339";var Oe=Ze.cache={},Ie=1,De=function(e,t,n){e.addEventListener(t,n,!1)},$e=function(e,t,n){e.removeEventListener(t,n,!1)};Ze._data=function(e){return this.cache[e[this.expando]]||{}};var Ne=/([\:\-\_]+(.))/g,Me=/^moz([A-Z])/,Re={mouseleave:"mouseout",mouseenter:"mouseover"},Be=r("jqLite");function He(e){return e.replace(Ne,(function(e,t,n,i){return i?n.toUpperCase():n})).replace(Me,"Moz$1")}var ze=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Fe=/<|&#?\w+;/,Ve=/<([\w:]+)/,je=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ue={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function We(e){return!Fe.test(e)}function qe(e){var t=e.nodeType;return t===ke||!t||9===t}function Ge(e,t){var n,i,r,o,a=t.createDocumentFragment(),s=[];if(We(e))s.push(t.createTextNode(e));else{for(n=n||a.appendChild(t.createElement("div")),i=(Ve.exec(e)||["",""])[1].toLowerCase(),r=Ue[i]||Ue._default,n.innerHTML=r[1]+e.replace(je,"<$1></$2>")+r[2],o=r[0];o--;)n=n.lastChild;s=ee(s,n.childNodes),(n=a.firstChild).textContent=""}return a.textContent="",a.innerHTML="",x(s,(function(e){a.appendChild(e)})),a}function Ze(e){if(e instanceof Ze)return e;var t,i,r,o;if(N(e)&&(e=W(e),t=!0),!(this instanceof Ze)){if(t&&"<"!=e.charAt(0))throw Be("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new Ze(e)}rt(this,t?(i=e,r=r||n,(o=ze.exec(i))?[r.createElement(o[1])]:(o=Ge(i,r))?o.childNodes:[]):e)}function Xe(e){return e.cloneNode(!0)}function Qe(e,t){if(t||Ke(e),e.querySelectorAll)for(var n=e.querySelectorAll("*"),i=0,r=n.length;i<r;i++)Ke(n[i])}function Ye(e,t,n,i){if(D(i))throw Be("offargs","jqLite#off() does not support the `selector` argument");var r=Je(e),o=r&&r.events,a=r&&r.handle;if(a)if(t)x(t.split(" "),(function(t){if(D(n)){var i=o[t];if(X(i||[],n),i&&i.length>0)return}$e(e,t,a),delete o[t]}));else for(t in o)"$destroy"!==t&&$e(e,t,a),delete o[t]}function Ke(e,t){var n=e.ng339,i=n&&Oe[n];if(i){if(t)return void delete i.data[t];i.handle&&(i.events.$destroy&&i.handle({},"$destroy"),Ye(e)),delete Oe[n],e.ng339=void 0}}function Je(e,t){var n=e.ng339,i=n&&Oe[n];return t&&!i&&(e.ng339=n=++Ie,i=Oe[n]={events:{},data:{},handle:void 0}),i}function et(e,t,n){if(qe(e)){var i=D(n),r=!i&&t&&!$(t),o=!t,a=Je(e,!r),s=a&&a.data;if(i)s[t]=n;else{if(o)return s;if(r)return s&&s[t];C(s,t)}}}function tt(e,t){return!!e.getAttribute&&(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1}function nt(e,t){t&&e.setAttribute&&x(t.split(" "),(function(t){e.setAttribute("class",W((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+W(t)+" "," ")))}))}function it(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");x(t.split(" "),(function(e){e=W(e),-1===n.indexOf(" "+e+" ")&&(n+=e+" ")})),e.setAttribute("class",W(n))}}function rt(e,t){if(t)if(t.nodeType)e[e.length++]=t;else{var n=t.length;if("number"==typeof n&&t.window!==t){if(n)for(var i=0;i<n;i++)e[e.length++]=t[i]}else e[e.length++]=t}}function ot(e,t){return at(e,"$"+(t||"ngController")+"Controller")}function at(e,t,n){9==e.nodeType&&(e=e.documentElement);for(var i=B(t)?t:[t];e;){for(var r=0,o=i.length;r<o;r++)if(void 0!==(n=u.data(e,i[r])))return n;e=e.parentNode||11===e.nodeType&&e.host}}function st(e){for(Qe(e,!0);e.firstChild;)e.removeChild(e.firstChild)}function lt(e,t){t||Qe(e);var n=e.parentNode;n&&n.removeChild(e)}Ue.optgroup=Ue.option,Ue.tbody=Ue.tfoot=Ue.colgroup=Ue.caption=Ue.thead,Ue.th=Ue.td;var ct=Ze.prototype={ready:function(e){var i=!1;function r(){i||(i=!0,e())}"complete"===n.readyState?setTimeout(r):(this.on("DOMContentLoaded",r),Ze(t).on("load",r))},toString:function(){var e=[];return x(this,(function(t){e.push(""+t)})),"["+e.join(", ")+"]"},eq:function(e){return u(e>=0?this[e]:this[this.length+e])},length:0,push:g,sort:[].sort,splice:[].splice},ut={};x("multiple,selected,checked,disabled,readOnly,required,open".split(","),(function(e){ut[a(e)]=e}));var dt={};x("input,select,option,textarea,button,form,details".split(","),(function(e){dt[e]=!0}));var ht={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};function pt(e,t){var n=ut[t.toLowerCase()];return n&&dt[Z(e)]&&n}function ft(){this.$get=function(){return C(Ze,{hasClass:function(e,t){return e.attr&&(e=e[0]),tt(e,t)},addClass:function(e,t){return e.attr&&(e=e[0]),it(e,t)},removeClass:function(e,t){return e.attr&&(e=e[0]),nt(e,t)}})}}function gt(e,t){var n=e&&e.$$hashKey;if(n)return"function"==typeof n&&(n=e.$$hashKey()),n;var i=typeof e;return n="function"==i||"object"==i&&null!==e?e.$$hashKey=i+":"+(t||T)():i+":"+e}function mt(e,t){if(t){var n=0;this.nextUid=function(){return++n}}x(e,this.put,this)}x({data:et,removeData:Ke},(function(e,t){Ze[t]=e})),x({data:et,inheritedData:at,scope:function(e){return u.data(e,"$scope")||at(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return u.data(e,"$isolateScope")||u.data(e,"$isolateScopeNoTemplate")},controller:ot,injector:function(e){return at(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:tt,css:function(e,t,n){if(t=He(t),!D(n))return e.style[t];e.style[t]=n},attr:function(e,t,n){var i=a(t);if(ut[i]){if(!D(n))return e[t]||(e.attributes.getNamedItem(t)||P).specified?i:void 0;n?(e[t]=!0,e.setAttribute(t,i)):(e[t]=!1,e.removeAttribute(i))}else if(D(n))e.setAttribute(t,n);else if(e.getAttribute){var r=e.getAttribute(t,2);return null===r?void 0:r}},prop:function(e,t,n){if(!D(n))return e[t];e[t]=n},text:function(){return e.$dv="",e;function e(e,t){if(I(t)){var n=e.nodeType;return n===ke||n===Le?e.textContent:""}e.textContent=t}}(),val:function(e,t){if(I(t)){if(e.multiple&&"select"===Z(e)){var n=[];return x(e.options,(function(e){e.selected&&n.push(e.value||e.text)})),0===n.length?null:n}return e.value}e.value=t},html:function(e,t){if(I(t))return e.innerHTML;Qe(e,!0),e.innerHTML=t},empty:st},(function(e,t){Ze.prototype[t]=function(t,n){var i,r,o=this.length;if(e!==st&&void 0===(2==e.length&&e!==tt&&e!==ot?t:n)){if($(t)){for(i=0;i<o;i++)if(e===et)e(this[i],t);else for(r in t)e(this[i],r,t[r]);return this}for(var a=e.$dv,s=void 0===a?Math.min(o,1):o,l=0;l<s;l++){var c=e(this[l],t,n);a=a?a+c:c}return a}for(i=0;i<o;i++)e(this[i],t,n);return this}})),x({removeData:Ke,on:function e(t,n,i,r){if(D(r))throw Be("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(qe(t)){var o=Je(t,!0),a=o.events,s=o.handle;s||(s=o.handle=function(e,t){var n=function(n,i){n.isDefaultPrevented=function(){return n.defaultPrevented};var r=t[i||n.type],o=r?r.length:0;if(o){if(I(n.immediatePropagationStopped)){var a=n.stopImmediatePropagation;n.stopImmediatePropagation=function(){n.immediatePropagationStopped=!0,n.stopPropagation&&n.stopPropagation(),a&&a.call(n)}}n.isImmediatePropagationStopped=function(){return!0===n.immediatePropagationStopped},o>1&&(r=Y(r));for(var s=0;s<o;s++)n.isImmediatePropagationStopped()||r[s].call(e,n)}};return n.elem=e,n}(t,a));for(var l=n.indexOf(" ")>=0?n.split(" "):[n],c=l.length;c--;){var u=a[n=l[c]];u||(a[n]=[],"mouseenter"===n||"mouseleave"===n?e(t,Re[n],(function(e){var t=e.relatedTarget;t&&(t===this||this.contains(t))||s(e,n)})):"$destroy"!==n&&De(t,n,s),u=a[n]),u.push(i)}}},off:Ye,one:function(e,t,n){(e=u(e)).on(t,(function i(){e.off(t,n),e.off(t,i)})),e.on(t,n)},replaceWith:function(e,t){var n,i=e.parentNode;Qe(e),x(new Ze(t),(function(t){n?i.insertBefore(t,n.nextSibling):i.replaceChild(t,e),n=t}))},children:function(e){var t=[];return x(e.childNodes,(function(e){e.nodeType===ke&&t.push(e)})),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){var n=e.nodeType;if(n===ke||11===n)for(var i=0,r=(t=new Ze(t)).length;i<r;i++){var o=t[i];e.appendChild(o)}},prepend:function(e,t){if(e.nodeType===ke){var n=e.firstChild;x(new Ze(t),(function(t){e.insertBefore(t,n)}))}},wrap:function(e,t){t=u(t).eq(0).clone()[0];var n=e.parentNode;n&&n.replaceChild(t,e),t.appendChild(e)},remove:lt,detach:function(e){lt(e,!0)},after:function(e,t){for(var n=e,i=e.parentNode,r=0,o=(t=new Ze(t)).length;r<o;r++){var a=t[r];i.insertBefore(a,n.nextSibling),n=a}},addClass:it,removeClass:nt,toggleClass:function(e,t,n){t&&x(t.split(" "),(function(t){var i=n;I(i)&&(i=!tt(e,t)),(i?it:nt)(e,t)}))},parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},next:function(e){return e.nextElementSibling},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:Xe,triggerHandler:function(e,t,n){var i,r,o,a=t.type||t,s=Je(e),l=s&&s.events,c=l&&l[a];c&&(i={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:P,type:a,target:e},t.type&&(i=C(i,t)),r=Y(c),o=n?[i].concat(n):[i],x(r,(function(t){i.isImmediatePropagationStopped()||t.apply(e,o)})))}},(function(e,t){Ze.prototype[t]=function(t,n,i){for(var r,o=0,a=this.length;o<a;o++)I(r)?D(r=e(this[o],t,n,i))&&(r=u(r)):rt(r,e(this[o],t,n,i));return D(r)?r:this},Ze.prototype.bind=Ze.prototype.on,Ze.prototype.unbind=Ze.prototype.off})),mt.prototype={put:function(e,t){this[gt(e,this.nextUid)]=t},get:function(e){return this[gt(e,this.nextUid)]},remove:function(e){var t=this[e=gt(e,this.nextUid)];return delete this[e],t}};var vt=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,yt=/,/,bt=/^\s*(_?)(\S+?)\1\s*$/,_t=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,xt=r("$injector");function wt(e,t){t=!0===t;var n={},i=[],r=new mt([],!0),o={$provide:{provider:c(u),factory:c(p),service:c((function(e,t){return p(e,["$injector",function(e){return e.instantiate(t)}])})),value:c((function(e,t){return p(e,O(t),!1)})),constant:c((function(e,t){Se(e,"constant"),o[e]=t,s[e]=t})),decorator:function(e,t){var n=a.get(e+"Provider"),i=n.$get;n.$get=function(){var e=l.invoke(i,n);return l.invoke(t,null,{$delegate:e})}}}},a=o.$injector=f(o,(function(e,t){throw y.isString(t)&&i.push(t),xt("unpr","Unknown provider: {0}",i.join(" <- "))})),s={},l=s.$injector=f(s,(function(e,t){var n=a.get(e+"Provider",t);return l.invoke(n.$get,n,void 0,e)}));return x(function e(t){var n,i=[];return x(t,(function(t){if(!r.get(t)){r.put(t,!0);try{N(t)?(n=h(t),i=i.concat(e(n.requires)).concat(n._runBlocks),o(n._invokeQueue),o(n._configBlocks)):H(t)||B(t)?i.push(a.invoke(t)):we(t,"module")}catch(e){throw B(t)&&(t=t[t.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),xt("modulerr","Failed to instantiate module {0} due to:\n{1}",t,e.stack||e.message||e)}}function o(e){var t,n;for(t=0,n=e.length;t<n;t++){var i=e[t],r=a.get(i[0]);r[i[1]].apply(r,i[2])}}})),i}(e),(function(e){l.invoke(e||P)})),l;function c(e){return function(t,n){if(!$(t))return e(t,n);x(t,S(e))}}function u(e,t){if(Se(e,"service"),(H(t)||B(t))&&(t=a.instantiate(t)),!t.$get)throw xt("pget","Provider '{0}' must define $get factory method.",e);return o[e+"Provider"]=t}function d(e,t){return function(){var n=l.invoke(t,this);if(I(n))throw xt("undef","Provider '{0}' must return a value from $get factory method.",e);return n}}function p(e,t,n){return u(e,{$get:!1!==n?d(e,t):t})}function f(e,r){function a(t,o){if(e.hasOwnProperty(t)){if(e[t]===n)throw xt("cdep","Circular dependency found: {0}",t+" <- "+i.join(" <- "));return e[t]}try{return i.unshift(t),e[t]=n,e[t]=r(t,o)}catch(i){throw e[t]===n&&delete e[t],i}finally{i.shift()}}function s(e,n,i,r){"string"==typeof i&&(r=i,i=null);var o,s,l,c=[],u=wt.$$annotate(e,t,r);for(s=0,o=u.length;s<o;s++){if("string"!=typeof(l=u[s]))throw xt("itkn","Incorrect injection token! Expected service name as string, got {0}",l);c.push(i&&i.hasOwnProperty(l)?i[l]:a(l,r))}return B(e)&&(e=e[o]),e.apply(n,c)}return{invoke:s,instantiate:function(e,t,n){var i=Object.create((B(e)?e[e.length-1]:e).prototype||null),r=s(e,i,t,n);return $(r)||H(r)?r:i},get:a,annotate:wt.$$annotate,has:function(t){return o.hasOwnProperty(t+"Provider")||e.hasOwnProperty(t)}}}}function St(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(n,i,r){var o=n.document;function a(e){if(e){e.scrollIntoView();var t=function(){var e=s.yOffset;if(H(e))e=e();else if(G(e)){var t=e[0];e="fixed"!==n.getComputedStyle(t).position?0:t.getBoundingClientRect().bottom}else M(e)||(e=0);return e}();if(t){var i=e.getBoundingClientRect().top;n.scrollBy(0,i-t)}}else n.scrollTo(0,0)}function s(){var e,t,n,r=i.hash();r?(e=o.getElementById(r))?a(e):(t=o.getElementsByName(r),n=null,Array.prototype.some.call(t,(function(e){if("a"===Z(e))return n=e,!0})),(e=n)?a(e):"top"===r&&a(null)):a(null)}return e&&r.$watch((function(){return i.hash()}),(function(e,n){var i,o;e===n&&""===e||(i=function(){r.$evalAsync(s)},"complete"===(o=o||t).document.readyState?o.setTimeout(i):u(o).on("load",i))})),s}]}wt.$$annotate=function(e,t,n){var i,r;if("function"==typeof e){if(!(i=e.$inject)){if(i=[],e.length){if(t)throw N(n)&&n||(n=e.name||function(e){var t=e.toString().replace(_t,"").match(vt);return t?"function("+(t[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}(e)),xt("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",n);x(e.toString().replace(_t,"").match(vt)[1].split(yt),(function(e){e.replace(bt,(function(e,t,n){i.push(n)}))}))}e.$inject=i}}else B(e)?(we(e[r=e.length-1],"fn"),i=e.slice(0,r)):we(e,"fn",!0);return i};var Tt=r("$animate"),Et=["$provide",function(e){this.$$selectors={},this.register=function(t,n){var i=t+"-animation";if(t&&"."!=t.charAt(0))throw Tt("notcsel","Expecting class selector starting with '.' got '{0}'.",t);this.$$selectors[t.substr(1)]=i,e.factory(i,n)},this.classNameFilter=function(e){return 1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null),this.$$classNameFilter},this.$get=["$$q","$$asyncCallback","$rootScope",function(e,t,n){var i;function r(e,t,n){for(var i=0,r=t.length;i<r;++i){e[t[i]]=n}}function o(){return i||(i=e.defer(),t((function(){i.resolve(),i=null}))),i.promise}function a(e,t){if(y.isObject(t)){var n=C(t.from||{},t.to||{});e.css(n)}}return{animate:function(e,t,n){return a(e,{from:t,to:n}),o()},enter:function(e,t,n,i){return a(e,i),n?n.after(e):t.prepend(e),o()},leave:function(e,t){return a(e,t),e.remove(),o()},move:function(e,t,n,i){return this.enter(e,t,n,i)},addClass:function(e,t,n){return this.setClass(e,t,[],n)},$$addClassImmediately:function(e,t,n){return e=u(e),t=N(t)?t:B(t)?t.join(" "):"",x(e,(function(e){it(e,t)})),a(e,n),o()},removeClass:function(e,t,n){return this.setClass(e,[],t,n)},$$removeClassImmediately:function(e,t,n){return e=u(e),t=N(t)?t:B(t)?t.join(" "):"",x(e,(function(e){nt(e,t)})),a(e,n),o()},setClass:function(t,i,o,a){var s=this,l=!1,c=(t=u(t)).data("$$animateClasses");c?a&&c.options&&(c.options=y.extend(c.options||{},a)):(c={classes:{},options:a},l=!0);var d,h,p,f=c.classes;return i=B(i)?i:i.split(" "),o=B(o)?o:o.split(" "),r(f,i,!0),r(f,o,!1),l&&(c.promise=(d=function(e){var n=t.data("$$animateClasses");if(t.removeData("$$animateClasses"),n){var i=function(e,t){var n=[],i=[],r=Ce();return x((e.attr("class")||"").split(/\s+/),(function(e){r[e]=!0})),x(t,(function(e,t){var o=r[t];!1===e&&o?i.push(t):!0!==e||o||n.push(t)})),n.length+i.length>0&&[n.length?n:null,i.length?i:null]}(t,n.classes);i&&s.$$setClassImmediately(t,i[0],i[1],n.options)}e()},(p=e.defer()).promise.$$cancelFn=function(){h&&h()},n.$$postDigest((function(){h=d((function(){p.resolve()}))})),p.promise),t.data("$$animateClasses",c)),c.promise},$$setClassImmediately:function(e,t,n,i){return t&&this.$$addClassImmediately(e,t),n&&this.$$removeClassImmediately(e,n),a(e,i),o()},enabled:P,cancel:P}}]}];function Ct(){this.$get=["$$rAF","$timeout",function(e,t){return e.supported?function(t){return e(t)}:function(e){return t(e,0,!1)}}]}function kt(e,t,n,i){var r=this,o=t[0],a=e.location,s=e.history,l=e.setTimeout,c=e.clearTimeout,d={};r.isMock=!1;var h=0,p=[];function f(e){try{e.apply(null,te(arguments,1))}finally{if(0===--h)for(;p.length;)try{p.pop()()}catch(e){n.error(e)}}}r.$$completeOutstandingRequest=f,r.$$incOutstandingRequestCount=function(){h++},r.notifyWhenNoOutstandingRequests=function(e){x(m,(function(e){e()})),0===h?e():p.push(e)};var g,m=[];r.addPollFn=function(e){return I(g)&&function(e,t){!function n(){x(m,(function(e){e()})),g=t(n,e)}()}(100,l),m.push(e),e};var v,y,b=a.href,_=t.find("base"),w=null;k(),y=v,r.url=function(t,n,o){if(I(o)&&(o=null),a!==e.location&&(a=e.location),s!==e.history&&(s=e.history),t){var l=y===o;if(b===t&&(!i.history||l))return r;var c=b&&dn(b)===dn(t);return b=t,y=o,!i.history||c&&l?(c||(w=t),n?a.replace(t):c?a.hash=function(e){var t=e.indexOf("#");return-1===t?"":e.substr(t+1)}(t):a.href=t):(s[n?"replaceState":"pushState"](o,"",t),k(),y=v),r}return w||a.href.replace(/%27/g,"'")},r.state=function(){return v};var S=[],T=!1;function E(){k(),L()}var C=null;function k(){K(v=I(v=function(){try{return s.state}catch(e){}}())?null:v,C)&&(v=C),C=v}function L(){b===r.url()&&y===v||(b=r.url(),y=v,x(S,(function(e){e(r.url(),v)})))}r.onUrlChange=function(t){return T||(i.history&&u(e).on("popstate",E),u(e).on("hashchange",E),T=!0),S.push(t),t},r.$$checkUrlChange=L,r.baseHref=function(){var e=_.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var A={},O="",D=r.baseHref();function $(e){try{return decodeURIComponent(e)}catch(t){return e}}r.cookies=function(e,t){var i,r,a,s,l;if(!e){if(o.cookie!==O)for(r=(O=o.cookie).split("; "),A={},s=0;s<r.length;s++)(l=(a=r[s]).indexOf("="))>0&&(e=$(a.substring(0,l)),void 0===A[e]&&(A[e]=$(a.substring(l+1))));return A}void 0===t?o.cookie=encodeURIComponent(e)+"=;path="+D+";expires=Thu, 01 Jan 1970 00:00:00 GMT":N(t)&&(i=(o.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path="+D).length+1)>4096&&n.warn("Cookie '"+e+"' possibly not set or overflowed because it was too large ("+i+" > 4096 bytes)!")},r.defer=function(e,t){var n;return h++,n=l((function(){delete d[n],f(e)}),t||0),d[n]=!0,n},r.defer.cancel=function(e){return!!d[e]&&(delete d[e],c(e),f(P),!0)}}function Lt(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,i){return new kt(e,i,t,n)}]}function Pt(){this.$get=function(){var e={};function t(t,n){if(t in e)throw r("$cacheFactory")("iid","CacheId '{0}' is already taken!",t);var i=0,o=C({},n,{id:t}),a={},s=n&&n.capacity||Number.MAX_VALUE,l={},c=null,u=null;return e[t]={put:function(e,t){s<Number.MAX_VALUE&&d(l[e]||(l[e]={key:e}));if(!I(t))return e in a||i++,a[e]=t,i>s&&this.remove(u.key),t},get:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;d(t)}return a[e]},remove:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;t==c&&(c=t.p),t==u&&(u=t.n),h(t.n,t.p),delete l[e]}delete a[e],i--},removeAll:function(){a={},i=0,l={},c=u=null},destroy:function(){a=null,o=null,l=null,delete e[t]},info:function(){return C({},o,{size:i})}};function d(e){e!=c&&(u?u==e&&(u=e.n):u=e,h(e.n,e.p),h(e,c),(c=e).n=null)}function h(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}}return t.info=function(){var t={};return x(e,(function(e,n){t[n]=e.info()})),t},t.get=function(t){return e[t]},t}}function At(){this.$get=["$cacheFactory",function(e){return e("templates")}]}var Ot=r("$compile");function It(e,t){var i={},r=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,o=/(([\w\-]+)(?:\:([^;]+))?;?)/,s=function(e){var t,n={},i=e.split(",");for(t=0;t<i.length;t++)n[i[t]]=!0;return n}("ngSrc,ngSrcset,src,srcset"),l=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,c=/^(on[a-z]+|formaction)$/;this.directive=function t(n,r){return Se(n,"directive"),N(n)?(xe(r,"directiveFactory"),i.hasOwnProperty(n)||(i[n]=[],e.factory(n+"Directive",["$injector","$exceptionHandler",function(e,t){var r=[];return x(i[n],(function(i,o){try{var a=e.invoke(i);H(a)?a={compile:O(a)}:!a.compile&&a.link&&(a.compile=O(a.link)),a.priority=a.priority||0,a.index=o,a.name=a.name||n,a.require=a.require||a.controller&&a.name,a.restrict=a.restrict||"EA",$(a.scope)&&(a.$$isolateBindings=(s=a.scope,l=a.name,c=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,u={},x(s,(function(e,t){var n=e.match(c);if(!n)throw Ot("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",l,t,e);u[t]={mode:n[1][0],collection:"*"===n[2],optional:"?"===n[3],attrName:n[4]||t}})),u)),r.push(a)}catch(e){t(e)}var s,l,c,u})),r}])),i[n].push(r)):x(n,S(t)),this},this.aHrefSanitizationWhitelist=function(e){return D(e)?(t.aHrefSanitizationWhitelist(e),this):t.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return D(e)?(t.imgSrcSanitizationWhitelist(e),this):t.imgSrcSanitizationWhitelist()};var h=!0;this.debugInfoEnabled=function(e){return D(e)?(h=e,this):h},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(e,t,p,f,g,m,v,y,b,_,w){var S=function(e,t){if(t){var n,i,r,o=Object.keys(t);for(n=0,i=o.length;n<i;n++)this[r=o[n]]=t[r]}else this.$attr={};this.$$element=e};function T(e,t){try{e.addClass(t)}catch(e){}}S.prototype={$normalize:$t,$addClass:function(e){e&&e.length>0&&_.addClass(this.$$element,e)},$removeClass:function(e){e&&e.length>0&&_.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=Nt(e,t);n&&n.length&&_.addClass(this.$$element,n);var i=Nt(t,e);i&&i.length&&_.removeClass(this.$$element,i)},$set:function(e,t,n,i){var r,o=this.$$element[0],a=pt(o,e),s=function(e,t){var n=e.nodeName;return("INPUT"===n||"TEXTAREA"===n)&&ht[t]}(o,e),l=e;if(a?(this.$$element.prop(e,t),i=a):s&&(this[s]=t,l=s),this[e]=t,i?this.$attr[e]=i:(i=this.$attr[e])||(this.$attr[e]=i=ye(e,"-")),"a"===(r=Z(this.$$element))&&"href"===e||"img"===r&&"src"===e)this[e]=t=w(t,"src"===e);else if("img"===r&&"srcset"===e){for(var c="",u=W(t),d=/\s/.test(u)?/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/:/(,)/,h=u.split(d),f=Math.floor(h.length/2),g=0;g<f;g++){var m=2*g;c+=w(W(h[m]),!0),c+=" "+W(h[m+1])}var v=W(h[2*g]).split(/\s/);c+=w(W(v[0]),!0),2===v.length&&(c+=" "+W(v[1])),this[e]=t=c}!1!==n&&(null==t?this.$$element.removeAttr(i):this.$$element.attr(i,t));var y=this.$$observers;y&&x(y[l],(function(e){try{e(t)}catch(e){p(e)}}))},$observe:function(e,t){var n=this,i=n.$$observers||(n.$$observers=Ce()),r=i[e]||(i[e]=[]);return r.push(t),v.$evalAsync((function(){!r.$$inter&&n.hasOwnProperty(e)&&t(n[e])})),function(){X(r,t)}}};var E=t.startSymbol(),k=t.endSymbol(),O="{{"==E||"}}"==k?A:function(e){return e.replace(/\{\{/g,E).replace(/}}/g,k)},I=/^ngAttr[A-Z]/;return D.$$addBindingInfo=h?function(e,t){var n=e.data("$binding")||[];B(t)?n=n.concat(t):n.push(t),e.data("$binding",n)}:P,D.$$addBindingClass=h?function(e){T(e,"ng-binding")}:P,D.$$addScopeInfo=h?function(e,t,n,i){var r=n?i?"$isolateScopeNoTemplate":"$isolateScope":"$scope";e.data(r,t)}:P,D.$$addScopeClass=h?function(e,t){T(e,t?"ng-isolate-scope":"ng-scope")}:P,D;function D(e,t,n,i,r){e instanceof u||(e=u(e)),x(e,(function(t,n){t.nodeType==Le&&t.nodeValue.match(/\S+/)&&(e[n]=u(t).wrap("<span></span>").parent()[0])}));var o=M(e,t,e,n,i,r);D.$$addScopeClass(e);var a=null;return function(t,n,i){xe(t,"scope");var r,s,l,c=(i=i||{}).parentBoundTranscludeFn,d=i.transcludeControllers,h=i.futureParentElement;if(c&&c.$$boundTransclude&&(c=c.$$boundTransclude),a||(s=(r=h)&&r[0],a=s&&"foreignobject"!==Z(s)&&s.toString().match(/SVG/)?"svg":"html"),l="html"!==a?u(ie(a,u("<div>").append(e).html())):n?ct.clone.call(e):e,d)for(var p in d)l.data("$"+p+"Controller",d[p].instance);return D.$$addScopeInfo(l,t),n&&n(l,t),o&&o(t,l,l,c),l}}function M(e,t,n,i,r,o){for(var a,s,l,c,d,h,p,f=[],g=0;g<e.length;g++)a=new S,(l=(s=z(e[g],[],a,0===g?i:void 0,r)).length?U(s,e[g],a,t,n,null,[],[],o):null)&&l.scope&&D.$$addScopeClass(a.$$element),d=l&&l.terminal||!(c=e[g].childNodes)||!c.length?null:M(c,l?(l.transcludeOnThisElement||!l.templateOnThisElement)&&l.transclude:t),(l||d)&&(f.push(g,l,d),h=!0,p=p||l),o=null;return h?function(e,n,i,r){var o,a,s,l,c,d,h,g,m;if(p){var v=n.length;for(m=new Array(v),c=0;c<f.length;c+=3)h=f[c],m[h]=n[h]}else m=n;for(c=0,d=f.length;c<d;)s=m[f[c++]],o=f[c++],a=f[c++],o?(o.scope?(l=e.$new(),D.$$addScopeInfo(u(s),l)):l=e,g=o.transcludeOnThisElement?R(e,o.transclude,r,o.elementTranscludeOnThisElement):!o.templateOnThisElement&&r?r:!r&&t?R(e,t):null,o(a,l,s,i,g)):a&&a(e,s.childNodes,void 0,r)}:null}function R(e,t,n,i){return function(i,r,o,a,s){return i||((i=e.$new(!1,s)).$$transcluded=!0),t(i,r,{parentBoundTranscludeFn:n,transcludeControllers:o,futureParentElement:a})}}function z(e,n,i,a,s){var l,c,u=e.nodeType,d=i.$attr;switch(u){case ke:G(n,$t(Z(e)),"E",a,s);for(var h,p,f,g,m,v,y=e.attributes,b=0,_=y&&y.length;b<_;b++){var x=!1,w=!1;p=(h=y[b]).name,m=W(h.value),g=$t(p),(v=I.test(g))&&(p=p.replace(Dt,"").substr(8).replace(/_(.)/g,(function(e,t){return t.toUpperCase()})));var S=g.replace(/(Start|End)$/,"");Q(S)&&g===S+"Start"&&(x=p,w=p.substr(0,p.length-5)+"end",p=p.substr(0,p.length-6)),d[f=$t(p.toLowerCase())]=p,!v&&i.hasOwnProperty(f)||(i[f]=m,pt(e,f)&&(i[f]=!0)),re(e,n,m,f,v),G(n,f,"A",a,s,x,w)}if($(c=e.className)&&(c=c.animVal),N(c)&&""!==c)for(;l=o.exec(c);)G(n,f=$t(l[2]),"C",a,s)&&(i[f]=W(l[3])),c=c.substr(l.index+l[0].length);break;case Le:!function(e,n){var i=t(n,!0);i&&e.push({priority:0,compile:function(e){var t=e.parent(),n=!!t.length;return n&&D.$$addBindingClass(t),function(e,t){var r=t.parent();n||D.$$addBindingClass(r),D.$$addBindingInfo(r,i.expressions),e.$watch(i,(function(e){t[0].nodeValue=e}))}}})}(n,e.nodeValue);break;case 8:try{(l=r.exec(e.nodeValue))&&G(n,f=$t(l[1]),"M",a,s)&&(i[f]=W(l[2]))}catch(e){}}return n.sort(ee),n}function F(e,t,n){var i=[],r=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw Ot("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);e.nodeType==ke&&(e.hasAttribute(t)&&r++,e.hasAttribute(n)&&r--),i.push(e),e=e.nextSibling}while(r>0);else i.push(e);return u(i)}function j(e,t,n){return function(i,r,o,a,s){return r=F(r[0],t,n),e(i,r,o,a,s)}}function U(e,i,r,o,a,s,c,d,h){h=h||{};for(var f,v,y,b,_,w,T,E=-Number.MAX_VALUE,C=h.controllerDirectives,k=h.newIsolateScopeDirective,L=h.templateDirective,P=h.nonTlbTranscludeDirective,A=!1,I=!1,M=h.hasElementTranscludeDirective,R=r.$$element=u(i),U=s,G=o,Z=0,X=e.length;Z<X;Z++){var Q=(y=e[Z]).$$start,ee=y.$$end;if(Q&&(R=F(i,Q,ee)),_=void 0,E>y.priority)break;if((T=y.scope)&&(y.templateUrl||($(T)?(ne("new/isolated scope",k||f,y,R),k=y):ne("new/isolated scope",k,y,R)),f=f||y),b=y.name,!y.templateUrl&&y.controller&&(T=y.controller,ne("'"+b+"' controller",(C=C||{})[b],y,R),C[b]=y),(T=y.transclude)&&(A=!0,y.$$tlb||(ne("transclusion",P,y,R),P=y),"element"==T?(M=!0,E=y.priority,_=R,R=r.$$element=u(n.createComment(" "+b+": "+r[b]+" ")),i=R[0],oe(a,te(_),i),G=D(_,o,E,U&&U.name,{nonTlbTranscludeDirective:P})):(_=u(Xe(i)).contents(),R.empty(),G=D(_,o))),y.template)if(I=!0,ne("template",L,y,R),L=y,T=H(y.template)?y.template(R,r):y.template,T=O(T),y.replace){if(U=y,_=We(T)?[]:Mt(ie(y.templateNamespace,W(T))),i=_[0],1!=_.length||i.nodeType!==ke)throw Ot("tplrt","Template for directive '{0}' must have exactly one root element. {1}",b,"");oe(a,R,i);var re={$attr:{}},ce=z(i,[],re),ue=e.splice(Z+1,e.length-(Z+1));k&&q(ce),e=e.concat(ce).concat(ue),Y(r,re),X=e.length}else R.html(T);if(y.templateUrl)I=!0,ne("template",L,y,R),L=y,y.replace&&(U=y),pe=J(e.splice(Z,e.length-Z),R,r,a,A&&G,c,d,{controllerDirectives:C,newIsolateScopeDirective:k,templateDirective:L,nonTlbTranscludeDirective:P}),X=e.length;else if(y.compile)try{H(w=y.compile(R,r,G))?de(null,w,Q,ee):w&&de(w.pre,w.post,Q,ee)}catch(e){p(e,ae(R))}y.terminal&&(pe.terminal=!0,E=Math.max(E,y.priority))}return pe.scope=f&&!0===f.scope,pe.transcludeOnThisElement=A,pe.elementTranscludeOnThisElement=M,pe.templateOnThisElement=I,pe.transclude=G,h.hasElementTranscludeDirective=M,pe;function de(e,t,n,i){e&&(n&&(e=j(e,n,i)),e.require=y.require,e.directiveName=b,(k===y||y.$$isolateScope)&&(e=se(e,{isolateScope:!0})),c.push(e)),t&&(n&&(t=j(t,n,i)),t.require=y.require,t.directiveName=b,(k===y||y.$$isolateScope)&&(t=se(t,{isolateScope:!0})),d.push(t))}function he(e,t,n,i){var r,o,a="data",s=!1,c=n;if(N(t)){if(o=t.match(l),t=t.substring(o[0].length),o[3]&&(o[1]?o[3]=null:o[1]=o[3]),"^"===o[1]?a="inheritedData":"^^"===o[1]&&(a="inheritedData",c=n.parent()),"?"===o[2]&&(s=!0),r=null,i&&"data"===a&&(r=i[t])&&(r=r.instance),!(r=r||c[a]("$"+t+"Controller"))&&!s)throw Ot("ctreq","Controller '{0}', required by directive '{1}', can't be found!",t,e);return r||null}return B(t)&&(r=[],x(t,(function(t){r.push(he(e,t,n,i))}))),r}function pe(e,n,o,a,s){var l,h,p,f,y,b,_,w,T;if(i===o?(T=r,w=r.$$element):(w=u(o),T=new S(w,r)),k&&(y=n.$new(!0)),s&&((_=function(e,t,n){var i;V(e)||(n=t,t=e,e=void 0);M&&(i=b);n||(n=M?w.parent():w);return s(e,t,i,n,A)}).$$boundTransclude=s),C&&(v={},b={},x(C,(function(e){var t,i={$scope:e===k||e.$$isolateScope?y:n,$element:w,$attrs:T,$transclude:_};"@"==(f=e.controller)&&(f=T[e.name]),t=m(f,i,!0,e.controllerAs),b[e.name]=t,M||w.data("$"+e.name+"Controller",t.instance),v[e.name]=t}))),k){D.$$addScopeInfo(w,y,!0,!(L&&(L===k||L===k.$$originalDirective))),D.$$addScopeClass(w,!0);var E=v&&v[k.name],P=y;E&&E.identifier&&!0===k.bindToController&&(P=E.instance),x(y.$$isolateBindings=k.$$isolateBindings,(function(e,i){var r,o,a,s,l=e.attrName,c=e.optional;switch(e.mode){case"@":T.$observe(l,(function(e){P[i]=e})),T.$$observers[l].$$scope=n,T[l]&&(P[i]=t(T[l])(n));break;case"=":if(c&&!T[l])return;o=g(T[l]),s=o.literal?K:function(e,t){return e===t||e!=e&&t!=t},a=o.assign||function(){throw r=P[i]=o(n),Ot("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",T[l],k.name)},r=P[i]=o(n);var u,d=function(e){return s(e,P[i])||(s(e,r)?a(n,e=P[i]):P[i]=e),r=e};d.$stateful=!0,u=e.collection?n.$watchCollection(T[l],d):n.$watch(g(T[l],d),null,o.literal),y.$on("$destroy",u);break;case"&":o=g(T[l]),P[i]=function(e){return o(n,e)}}}))}for(v&&(x(v,(function(e){e()})),v=null),l=0,h=c.length;l<h;l++)le(p=c[l],p.isolateScope?y:n,w,T,p.require&&he(p.directiveName,p.require,w,b),_);var A=n;for(k&&(k.template||null===k.templateUrl)&&(A=y),e&&e(A,o.childNodes,void 0,s),l=d.length-1;l>=0;l--)le(p=d[l],p.isolateScope?y:n,w,T,p.require&&he(p.directiveName,p.require,w,b),_)}}function q(e){for(var t=0,n=e.length;t<n;t++)e[t]=L(e[t],{$$isolateScope:!0})}function G(t,n,r,o,a,s,l){if(n===a)return null;var c=null;if(i.hasOwnProperty(n))for(var u,d=e.get(n+"Directive"),h=0,f=d.length;h<f;h++)try{u=d[h],(void 0===o||o>u.priority)&&-1!=u.restrict.indexOf(r)&&(s&&(u=L(u,{$$start:s,$$end:l})),t.push(u),c=u)}catch(e){p(e)}return c}function Q(t){if(i.hasOwnProperty(t))for(var n=e.get(t+"Directive"),r=0,o=n.length;r<o;r++)if(n[r].multiElement)return!0;return!1}function Y(e,t){var n=t.$attr,i=e.$attr,r=e.$$element;x(e,(function(i,r){"$"!=r.charAt(0)&&(t[r]&&t[r]!==i&&(i+=("style"===r?";":" ")+t[r]),e.$set(r,i,!0,n[r]))})),x(t,(function(t,o){"class"==o?(T(r,t),e.class=(e.class?e.class+" ":"")+t):"style"==o?(r.attr("style",r.attr("style")+";"+t),e.style=(e.style?e.style+";":"")+t):"$"==o.charAt(0)||e.hasOwnProperty(o)||(e[o]=t,i[o]=n[o])}))}function J(e,t,n,i,r,o,a,s){var l,c,d=[],h=t[0],p=e.shift(),g=L(p,{templateUrl:null,transclude:null,replace:null,$$originalDirective:p}),m=H(p.templateUrl)?p.templateUrl(t,n):p.templateUrl,v=p.templateNamespace;return t.empty(),f(b.getTrustedResourceUrl(m)).then((function(f){var y,b,_,w;if(f=O(f),p.replace){if(_=We(f)?[]:Mt(ie(v,W(f))),y=_[0],1!=_.length||y.nodeType!==ke)throw Ot("tplrt","Template for directive '{0}' must have exactly one root element. {1}",p.name,m);b={$attr:{}},oe(i,t,y);var S=z(y,[],b);$(p.scope)&&q(S),e=S.concat(e),Y(n,b)}else y=h,t.html(f);for(e.unshift(g),l=U(e,y,n,r,t,p,o,a,s),x(i,(function(e,n){e==y&&(i[n]=t[0])})),c=M(t[0].childNodes,r);d.length;){var E=d.shift(),C=d.shift(),k=d.shift(),L=d.shift(),P=t[0];if(!E.$$destroyed){if(C!==h){var A=C.className;s.hasElementTranscludeDirective&&p.replace||(P=Xe(y)),oe(k,u(C),P),T(u(P),A)}w=l.transcludeOnThisElement?R(E,l.transclude,L):L,l(c,E,P,i,w)}}d=null})),function(e,t,n,i,r){var o=r;t.$$destroyed||(d?d.push(t,n,i,o):(l.transcludeOnThisElement&&(o=R(t,l.transclude,r)),l(c,t,n,i,o)))}}function ee(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function ne(e,t,n,i){if(t)throw Ot("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",t.name,n.name,e,ae(i))}function ie(e,t){switch(e=a(e||"html")){case"svg":case"math":var i=n.createElement("div");return i.innerHTML="<"+e+">"+t+"</"+e+">",i.childNodes[0].childNodes;default:return t}}function re(e,n,i,r,o){var a=function(e,t){if("srcdoc"==t)return b.HTML;var n=Z(e);return"xlinkHref"==t||"form"==n&&"action"==t||"img"!=n&&("src"==t||"ngSrc"==t)?b.RESOURCE_URL:void 0}(e,r);o=s[r]||o;var l=t(i,!0,a,o);if(l){if("multiple"===r&&"select"===Z(e))throw Ot("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",ae(e));n.push({priority:100,compile:function(){return{pre:function(e,n,s){var u=s.$$observers||(s.$$observers={});if(c.test(r))throw Ot("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var d=s[r];d!==i&&(l=d&&t(d,!0,a,o),i=d),l&&(s[r]=l(e),(u[r]||(u[r]=[])).$$inter=!0,(s.$$observers&&s.$$observers[r].$$scope||e).$watch(l,(function(e,t){"class"===r&&e!=t?s.$updateClass(e,t):s.$set(r,e)})))}}}})}}function oe(e,t,i){var r,o,a=t[0],s=t.length,l=a.parentNode;if(e)for(r=0,o=e.length;r<o;r++)if(e[r]==a){e[r++]=i;for(var c=r,h=c+s-1,p=e.length;c<p;c++,h++)h<p?e[c]=e[h]:delete e[c];e.length-=s-1,e.context===a&&(e.context=i);break}l&&l.replaceChild(i,a);var f=n.createDocumentFragment();f.appendChild(a),u(i).data(u(a).data()),d?(be=!0,d.cleanData([a])):delete u.cache[a[u.expando]];for(var g=1,m=t.length;g<m;g++){var v=t[g];u(v).remove(),f.appendChild(v),delete t[g]}t[0]=i,t.length=1}function se(e,t){return C((function(){return e.apply(null,arguments)}),e,t)}function le(e,t,n,i,r,o){try{e(t,n,i,r,o)}catch(e){p(e,ae(n))}}}]}It.$inject=["$provide","$$sanitizeUriProvider"];var Dt=/^((?:x|data)[\:\-_])/i;function $t(e){return He(e.replace(Dt,""))}function Nt(e,t){var n="",i=e.split(/\s+/),r=t.split(/\s+/);e:for(var o=0;o<i.length;o++){for(var a=i[o],s=0;s<r.length;s++)if(a==r[s])continue e;n+=(n.length>0?" ":"")+a}return n}function Mt(e){var t=(e=u(e)).length;if(t<=1)return e;for(;t--;){8===e[t].nodeType&&f.call(e,t,1)}return e}var Rt=r("$controller");function Bt(){var e={},t=!1,n=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(t,n){Se(t,"controller"),$(t)?C(e,t):e[t]=n},this.allowGlobals=function(){t=!0},this.$get=["$injector","$window",function(i,o){return function(r,s,l,c){var u,d,h,p;if(l=!0===l,c&&N(c)&&(p=c),N(r)){if(!(d=r.match(n)))throw Rt("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",r);h=d[1],p=p||d[3],we(r=e.hasOwnProperty(h)?e[h]:Te(s.$scope,h,!0)||(t?Te(o,h,!0):void 0),h,!0)}if(l){var f=(B(r)?r[r.length-1]:r).prototype;return u=Object.create(f||null),p&&a(s,p,u,h||r.name),C((function(){return i.invoke(r,u,s,h),u}),{instance:u,identifier:p})}return u=i.instantiate(r,s,h),p&&a(s,p,u,h||r.name),u};function a(e,t,n,i){if(!e||!$(e.$scope))throw r("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",i,t);e.$scope[t]=n}}]}function Ht(){this.$get=["$window",function(e){return u(e.document)}]}function zt(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}var Ft={"Content-Type":"application/json;charset=utf-8"},Vt=/^\[|^\{(?!\{)/,jt={"[":/]$/,"{":/}$/},Ut=/^\)\]\}',?\n/;function Wt(e,t){if(N(e)){var n=e.replace(Ut,"").trim();if(n){var i=t("Content-Type");(i&&0===i.indexOf("application/json")||(o=(r=n).match(Vt))&&jt[o[0]].test(r))&&(e=oe(n))}}var r,o;return e}function qt(e){var t,n,i,r=Ce();return e?(x(e.split("\n"),(function(e){i=e.indexOf(":"),t=a(W(e.substr(0,i))),n=W(e.substr(i+1)),t&&(r[t]=r[t]?r[t]+", "+n:n)})),r):r}function Gt(e){var t=$(e)?e:void 0;return function(n){if(t||(t=qt(e)),n){var i=t[a(n)];return void 0===i&&(i=null),i}return t}}function Zt(e,t,n,i){return H(i)?i(e,t,n):(x(i,(function(i){e=i(e,t,n)})),e)}function Xt(e){return 200<=e&&e<300}function Qt(){var e=this.defaults={transformResponse:[Wt],transformRequest:[function(e){return!$(e)||(t=e,"[object File]"===m.call(t))||function(e){return"[object Blob]"===m.call(e)}(e)||function(e){return"[object FormData]"===m.call(e)}(e)?e:re(e);var t}],headers:{common:{Accept:"application/json, text/plain, */*"},post:Y(Ft),put:Y(Ft),patch:Y(Ft)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},t=!1;this.useApplyAsync=function(e){return D(e)?(t=!!e,this):t};var n=this.interceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(i,o,s,c,u,d){var h=s("$http"),p=[];function f(n){if(!y.isObject(n))throw r("$http")("badreq","Http request configuration must be an object.  Received: {0}",n);var s=C({method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse},n);s.headers=function(t){var n,i,r,o=e.headers,s=C({},t.headers);o=C({},o.common,o[a(t.method)]);e:for(n in o){for(r in i=a(n),s)if(a(r)===i)continue e;s[n]=o[n]}return l=s,u={},x(l,(function(e,t){H(e)?null!=(c=e())&&(u[t]=c):u[t]=e})),u;var l,c,u}(n),s.method=l(s.method);var d=[function(n){var r=n.headers,s=Zt(n.data,Gt(r),void 0,n.transformRequest);return I(s)&&x(r,(function(e,t){"content-type"===a(t)&&delete r[t]})),I(n.withCredentials)&&!I(e.withCredentials)&&(n.withCredentials=e.withCredentials),function(n,r){var a,s,l=u.defer(),d=l.promise,p=n.headers,g=function(e,t){if(!t)return e;var n=[];(function(e,t,n){for(var i=w(e),r=0;r<i.length;r++)t.call(n,e[i[r]],i[r])})(t,(function(e,t){null===e||I(e)||(B(e)||(e=[e]),x(e,(function(e){$(e)&&(e=R(e)?e.toISOString():re(e)),n.push(de(t)+"="+de(e))})))})),n.length>0&&(e+=(-1==e.indexOf("?")?"?":"&")+n.join("&"));return e}(n.url,n.params);f.pendingRequests.push(n),d.then(b,b),!n.cache&&!e.cache||!1===n.cache||"GET"!==n.method&&"JSONP"!==n.method||(a=$(n.cache)?n.cache:$(e.cache)?e.cache:h);a&&(D(s=a.get(g))?U(s)?s.then(y,y):B(s)?v(s[1],s[0],Y(s[2]),s[3]):v(s,200,{},"OK"):a.put(g,d));if(I(s)){var m=ai(n.url)?o.cookies()[n.xsrfCookieName||e.xsrfCookieName]:void 0;m&&(p[n.xsrfHeaderName||e.xsrfHeaderName]=m),i(n.method,g,r,(function(e,n,i,r){a&&(Xt(e)?a.put(g,[e,n,qt(i),r]):a.remove(g));function o(){v(n,e,i,r)}t?c.$applyAsync(o):(o(),c.$$phase||c.$apply())}),p,n.timeout,n.withCredentials,n.responseType)}return d;function v(e,t,i,r){(Xt(t=Math.max(t,0))?l.resolve:l.reject)({data:e,status:t,headers:Gt(i),config:n,statusText:r})}function y(e){v(e.data,e.status,Y(e.headers()),e.statusText)}function b(){var e=f.pendingRequests.indexOf(n);-1!==e&&f.pendingRequests.splice(e,1)}}(n,s).then(b,b)},void 0],g=u.when(s);for(x(p,(function(e){(e.request||e.requestError)&&d.unshift(e.request,e.requestError),(e.response||e.responseError)&&d.push(e.response,e.responseError)}));d.length;){var m=d.shift(),v=d.shift();g=g.then(m,v)}return g.success=function(e){return g.then((function(t){e(t.data,t.status,t.headers,s)})),g},g.error=function(e){return g.then(null,(function(t){e(t.data,t.status,t.headers,s)})),g},g;function b(e){var t=C({},e);return e.data?t.data=Zt(e.data,e.headers,e.status,s.transformResponse):t.data=e.data,Xt(e.status)?t:u.reject(t)}}return x(n,(function(e){p.unshift(N(e)?d.get(e):d.invoke(e))})),f.pendingRequests=[],function(e){x(arguments,(function(e){f[e]=function(t,n){return f(C(n||{},{method:e,url:t}))}}))}("get","delete","head","jsonp"),function(e){x(arguments,(function(e){f[e]=function(t,n,i){return f(C(i||{},{method:e,url:t,data:n}))}}))}("post","put","patch"),f.defaults=e,f}]}function Yt(){return new t.XMLHttpRequest}function Kt(){this.$get=["$browser","$window","$document",function(e,t,n){return function(e,t,n,i,r){return function(o,s,l,c,u,d,h,p){if(e.$$incOutstandingRequestCount(),s=s||e.url(),"jsonp"==a(o)){var f="_"+(i.counter++).toString(36);i[f]=function(e){i[f].data=e,i[f].called=!0};var g=function(e,t,n){var o=r.createElement("script"),a=null;return o.type="text/javascript",o.src=e,o.async=!0,a=function(e){$e(o,"load",a),$e(o,"error",a),r.body.removeChild(o),o=null;var s=-1,l="unknown";e&&("load"!==e.type||i[t].called||(e={type:"error"}),l=e.type,s="error"===e.type?404:200),n&&n(s,l)},De(o,"load",a),De(o,"error",a),r.body.appendChild(o),a}(s.replace("JSON_CALLBACK","angular.callbacks."+f),f,(function(e,t){_(c,e,i[f].data,"",t),i[f]=P}))}else{var m=t();m.open(o,s,!0),x(u,(function(e,t){D(e)&&m.setRequestHeader(t,e)})),m.onload=function(){var e=m.statusText||"",t="response"in m?m.response:m.responseText,n=1223===m.status?204:m.status;0===n&&(n=t?200:"file"==oi(s).protocol?404:0),_(c,n,t,m.getAllResponseHeaders(),e)};var v=function(){_(c,-1,null,null,"")};if(m.onerror=v,m.onabort=v,h&&(m.withCredentials=!0),p)try{m.responseType=p}catch(e){if("json"!==p)throw e}m.send(l||null)}if(d>0)var y=n(b,d);else U(d)&&d.then(b);function b(){g&&g(),m&&m.abort()}function _(t,i,r,o,a){void 0!==y&&n.cancel(y),g=m=null,t(i,r,o,a),e.$$completeOutstandingRequest(P)}}}(e,Yt,e.defer,t.angular.callbacks,n[0])}]}var Jt=r("$interpolate");function en(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,i,r){var o=e.length,a=t.length,s=new RegExp(e.replace(/./g,c),"g"),l=new RegExp(t.replace(/./g,c),"g");function c(e){return"\\\\\\"+e}function u(c,u,d,h){h=!!h;for(var p,f,g,m=0,v=[],y=[],b=c.length,_=[],x=[];m<b;){if(-1==(p=c.indexOf(e,m))||-1==(f=c.indexOf(t,p+o))){m!==b&&_.push(E(c.substring(m)));break}m!==p&&_.push(E(c.substring(m,p))),g=c.substring(p+o,f),v.push(g),y.push(n(g,k)),m=f+a,x.push(_.length),_.push("")}if(d&&_.length>1)throw Jt("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",c);if(!u||v.length){var w=function(e){for(var t=0,n=v.length;t<n;t++){if(h&&I(e[t]))return;_[x[t]]=e[t]}return _.join("")},S=function(e){return d?r.getTrusted(d,e):r.valueOf(e)},T=function(e){if(null==e)return"";switch(typeof e){case"string":break;case"number":e=""+e;break;default:e=re(e)}return e};return C((function(e){var t=0,n=v.length,r=new Array(n);try{for(;t<n;t++)r[t]=y[t](e);return w(r)}catch(e){var o=Jt("interr","Can't interpolate: {0}\n{1}",c,e.toString());i(o)}}),{exp:c,expressions:v,$$watchDelegate:function(e,t,n){var i;return e.$watchGroup(y,(function(n,r){var o=w(n);H(t)&&t.call(this,o,n!==r?i:o,e),i=o}),n)}})}function E(n){return n.replace(s,e).replace(l,t)}function k(e){try{return e=S(e),h&&!D(e)?e:T(e)}catch(e){var t=Jt("interr","Can't interpolate: {0}\n{1}",c,e.toString());i(t)}}}return u.startSymbol=function(){return e},u.endSymbol=function(){return t},u}]}function tn(){this.$get=["$rootScope","$window","$q","$$q",function(e,t,n,i){var r={};function o(o,a,s,l){var c=t.setInterval,u=t.clearInterval,d=0,h=D(l)&&!l,p=(h?i:n).defer(),f=p.promise;return s=D(s)?s:0,f.then(null,null,o),f.$$intervalId=c((function(){p.notify(d++),s>0&&d>=s&&(p.resolve(d),u(f.$$intervalId),delete r[f.$$intervalId]),h||e.$apply()}),a),r[f.$$intervalId]=p,f}return o.cancel=function(e){return!(!e||!(e.$$intervalId in r))&&(r[e.$$intervalId].reject("canceled"),t.clearInterval(e.$$intervalId),delete r[e.$$intervalId],!0)},o}]}function nn(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"Â¤",posSuf:"",negPre:"(Â¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a",short:"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a",ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"]},pluralCat:function(e){return 1===e?"one":"other"}}}}var rn=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,on={http:80,https:443,ftp:21},an=r("$location");function sn(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=ue(t[n]);return t.join("/")}function ln(e,t){var n=oi(e);t.$$protocol=n.protocol,t.$$host=n.hostname,t.$$port=k(n.port)||on[n.protocol]||null}function cn(e,t){var n="/"!==e.charAt(0);n&&(e="/"+e);var i=oi(e);t.$$path=decodeURIComponent(n&&"/"===i.pathname.charAt(0)?i.pathname.substring(1):i.pathname),t.$$search=le(i.search),t.$$hash=decodeURIComponent(i.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function un(e,t){if(0===t.indexOf(e))return t.substr(e.length)}function dn(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function hn(e){return e.replace(/(#.+)|#$/,"$1")}function pn(e){return e.substr(0,dn(e).lastIndexOf("/")+1)}function fn(e,t){this.$$html5=!0,t=t||"";var n=pn(e);ln(e,this),this.$$parse=function(e){var t=un(n,e);if(!N(t))throw an("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',e,n);cn(t,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=ce(this.$$search),t=this.$$hash?"#"+ue(this.$$hash):"";this.$$url=sn(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=n+this.$$url.substr(1)},this.$$parseLinkUrl=function(i,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(void 0!==(o=un(e,i))?(a=o,s=void 0!==(o=un(t,o))?n+(un("/",o)||o):e+a):void 0!==(o=un(n,i))?s=n+o:n==i+"/"&&(s=n),s&&this.$$parse(s),!!s);var o,a,s}}function gn(e,t){var n=pn(e);ln(e,this),this.$$parse=function(i){var r,o=un(e,i)||un(n,i);"#"===o.charAt(0)?I(r=un(t,o))&&(r=o):r=this.$$html5?o:"",cn(r,this),this.$$path=function(e,t,n){var i,r=/^\/[A-Z]:(\/.*)/;0===t.indexOf(n)&&(t=t.replace(n,""));if(r.exec(t))return e;return(i=r.exec(e))?i[1]:e}(this.$$path,r,e),this.$$compose()},this.$$compose=function(){var n=ce(this.$$search),i=this.$$hash?"#"+ue(this.$$hash):"";this.$$url=sn(this.$$path)+(n?"?"+n:"")+i,this.$$absUrl=e+(this.$$url?t+this.$$url:"")},this.$$parseLinkUrl=function(t,n){return dn(e)==dn(t)&&(this.$$parse(t),!0)}}function mn(e,t){this.$$html5=!0,gn.apply(this,arguments);var n=pn(e);this.$$parseLinkUrl=function(i,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(e==dn(i)?o=i:(a=un(n,i))?o=e+t+a:n===i+"/"&&(o=n),o&&this.$$parse(o),!!o);var o,a},this.$$compose=function(){var n=ce(this.$$search),i=this.$$hash?"#"+ue(this.$$hash):"";this.$$url=sn(this.$$path)+(n?"?"+n:"")+i,this.$$absUrl=e+t+this.$$url}}var vn={$$html5:!1,$$replace:!1,absUrl:yn("$$absUrl"),url:function(e){if(I(e))return this.$$url;var t=rn.exec(e);return(t[1]||""===e)&&this.path(decodeURIComponent(t[1])),(t[2]||t[1]||""===e)&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:yn("$$protocol"),host:yn("$$host"),port:yn("$$port"),path:bn("$$path",(function(e){return"/"==(e=null!==e?e.toString():"").charAt(0)?e:"/"+e})),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(N(e)||M(e))e=e.toString(),this.$$search=le(e);else{if(!$(e))throw an("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");x(e=Q(e,{}),(function(t,n){null==t&&delete e[n]})),this.$$search=e}break;default:I(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:bn("$$hash",(function(e){return null!==e?e.toString():""})),replace:function(){return this.$$replace=!0,this}};function yn(e){return function(){return this[e]}}function bn(e,t){return function(n){return I(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function _n(){var e="",t={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(t){return D(t)?(e=t,this):e},this.html5Mode=function(e){return j(e)?(t.enabled=e,this):$(e)?(j(e.enabled)&&(t.enabled=e.enabled),j(e.requireBase)&&(t.requireBase=e.requireBase),j(e.rewriteLinks)&&(t.rewriteLinks=e.rewriteLinks),this):t},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(n,i,r,o,a){var s,l,c,d,h=i.baseHref(),p=i.url();if(t.enabled){if(!h&&t.requireBase)throw an("nobase","$location in HTML5 mode requires a <base> tag to be present!");c=(d=p).substring(0,d.indexOf("/",d.indexOf("//")+2))+(h||"/"),l=r.history?fn:mn}else c=dn(p),l=gn;(s=new l(c,"#"+e)).$$parseLinkUrl(p,p),s.$$state=i.state();var f=/^\s*(javascript|mailto):/i;function g(e,t,n){var r=s.url(),o=s.$$state;try{i.url(e,t,n),s.$$state=i.state()}catch(e){throw s.url(r),s.$$state=o,e}}o.on("click",(function(e){if(t.rewriteLinks&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&2!=e.which&&2!=e.button){for(var r=u(e.target);"a"!==Z(r[0]);)if(r[0]===o[0]||!(r=r.parent())[0])return;var l=r.prop("href"),c=r.attr("href")||r.attr("xlink:href");$(l)&&"[object SVGAnimatedString]"===l.toString()&&(l=oi(l.animVal).href),f.test(l)||!l||r.attr("target")||e.isDefaultPrevented()||s.$$parseLinkUrl(l,c)&&(e.preventDefault(),s.absUrl()!=i.url()&&(n.$apply(),a.angular["ff-684208-preventDefault"]=!0))}})),hn(s.absUrl())!=hn(p)&&i.url(s.absUrl(),!0);var m=!0;return i.onUrlChange((function(e,t){n.$evalAsync((function(){var i,r=s.absUrl(),o=s.$$state;s.$$parse(e),s.$$state=t,i=n.$broadcast("$locationChangeStart",e,r,t,o).defaultPrevented,s.absUrl()===e&&(i?(s.$$parse(r),s.$$state=o,g(r,!1,o)):(m=!1,v(r,o)))})),n.$$phase||n.$digest()})),n.$watch((function(){var e=hn(i.url()),t=hn(s.absUrl()),o=i.state(),a=s.$$replace,l=e!==t||s.$$html5&&r.history&&o!==s.$$state;(m||l)&&(m=!1,n.$evalAsync((function(){var t=s.absUrl(),i=n.$broadcast("$locationChangeStart",t,e,s.$$state,o).defaultPrevented;s.absUrl()===t&&(i?(s.$$parse(e),s.$$state=o):(l&&g(t,a,o===s.$$state?null:s.$$state),v(e,o)))}))),s.$$replace=!1})),s;function v(e,t){n.$broadcast("$locationChangeSuccess",s.absUrl(),e,s.$$state,t)}}]}function xn(){var e=!0,t=this;this.debugEnabled=function(t){return D(t)?(e=t,this):e},this.$get=["$window",function(n){return{log:o("log"),info:o("info"),warn:o("warn"),error:o("error"),debug:(i=o("debug"),function(){e&&i.apply(t,arguments)})};var i;function r(e){return e instanceof Error&&(e.stack?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}function o(e){var t=n.console||{},i=t[e]||t.log||P,o=!1;try{o=!!i.apply}catch(e){}return o?function(){var e=[];return x(arguments,(function(t){e.push(r(t))})),i.apply(t,e)}:function(e,t){i(e,null==t?"":t)}}}]}x([mn,gn,fn],(function(e){e.prototype=Object.create(vn),e.prototype.state=function(t){if(!arguments.length)return this.$$state;if(e!==fn||!this.$$html5)throw an("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=I(t)?null:t,this}}));var wn=r("$parse");function Sn(e,t){if("__defineGetter__"===e||"__defineSetter__"===e||"__lookupGetter__"===e||"__lookupSetter__"===e||"__proto__"===e)throw wn("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",t);return e}function Tn(e,t){if(e){if(e.constructor===e)throw wn("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e.window===e)throw wn("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw wn("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",t);if(e===Object)throw wn("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",t)}return e}var En=Function.prototype.call,Cn=Function.prototype.apply,kn=Function.prototype.bind;var Ln=Ce();x({null:function(){return null},true:function(){return!0},false:function(){return!1},undefined:function(){}},(function(e,t){e.constant=e.literal=e.sharedGetter=!0,Ln[t]=e})),Ln.this=function(e){return e},Ln.this.sharedGetter=!0;var Pn=C(Ce(),{"+":function(e,t,n,i){return n=n(e,t),i=i(e,t),D(n)?D(i)?n+i:n:D(i)?i:void 0},"-":function(e,t,n,i){return n=n(e,t),i=i(e,t),(D(n)?n:0)-(D(i)?i:0)},"*":function(e,t,n,i){return n(e,t)*i(e,t)},"/":function(e,t,n,i){return n(e,t)/i(e,t)},"%":function(e,t,n,i){return n(e,t)%i(e,t)},"===":function(e,t,n,i){return n(e,t)===i(e,t)},"!==":function(e,t,n,i){return n(e,t)!==i(e,t)},"==":function(e,t,n,i){return n(e,t)==i(e,t)},"!=":function(e,t,n,i){return n(e,t)!=i(e,t)},"<":function(e,t,n,i){return n(e,t)<i(e,t)},">":function(e,t,n,i){return n(e,t)>i(e,t)},"<=":function(e,t,n,i){return n(e,t)<=i(e,t)},">=":function(e,t,n,i){return n(e,t)>=i(e,t)},"&&":function(e,t,n,i){return n(e,t)&&i(e,t)},"||":function(e,t,n,i){return n(e,t)||i(e,t)},"!":function(e,t,n){return!n(e,t)},"=":!0,"|":!0}),An={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},On=function(e){this.options=e};function In(e){return e.constant}On.prototype={constructor:On,lex:function(e){for(this.text=e,this.index=0,this.tokens=[];this.index<this.text.length;){var t=this.text.charAt(this.index);if('"'===t||"'"===t)this.readString(t);else if(this.isNumber(t)||"."===t&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(t))this.readIdent();else if(this.is(t,"(){}[].,;:?"))this.tokens.push({index:this.index,text:t}),this.index++;else if(this.isWhitespace(t))this.index++;else{var n=t+this.peek(),i=n+this.peek(2),r=Pn[t],o=Pn[n],a=Pn[i];if(r||o||a){var s=a?i:o?n:t;this.tokens.push({index:this.index,text:s,operator:!0}),this.index+=s.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(e,t){return-1!==t.indexOf(e)},peek:function(e){var t=e||1;return this.index+t<this.text.length&&this.text.charAt(this.index+t)},isNumber:function(e){return"0"<=e&&e<="9"&&"string"==typeof e},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||"Â "===e},isIdent:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var i=D(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw wn("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,i,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=a(this.text.charAt(this.index));if("."==n||this.isNumber(n))e+=n;else{var i=this.peek();if("e"==n&&this.isExpOperator(i))e+=n;else if(this.isExpOperator(n)&&i&&this.isNumber(i)&&"e"==e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||i&&this.isNumber(i)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:t,text:e,constant:!0,value:Number(e)})},readIdent:function(){for(var e=this.index;this.index<this.text.length;){var t=this.text.charAt(this.index);if(!this.isIdent(t)&&!this.isNumber(t))break;this.index++}this.tokens.push({index:e,text:this.text.slice(e,this.index),identifier:!0})},readString:function(e){var t=this.index;this.index++;for(var n="",i=e,r=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);if(i+=o,r){if("u"===o){var a=this.text.substring(this.index+1,this.index+5);a.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+a+"]"),this.index+=4,n+=String.fromCharCode(parseInt(a,16))}else{n+=An[o]||o}r=!1}else if("\\"===o)r=!0;else{if(o===e)return this.index++,void this.tokens.push({index:t,text:i,constant:!0,value:n});n+=o}this.index++}this.throwError("Unterminated quote",t)}};var Dn=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n};function $n(e,t,n,i,r){Tn(e,r),Tn(t,r);for(var o,a=n.split("."),s=0;a.length>1;s++){o=Sn(a.shift(),r);var l=0===s&&t&&t[o]||e[o];l||(l={},e[o]=l),e=Tn(l,r)}return Tn(e[o=Sn(a.shift(),r)],r),e[o]=i,i}Dn.ZERO=C((function(){return 0}),{sharedGetter:!0,constant:!0}),Dn.prototype={constructor:Dn,parse:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t.literal=!!t.literal,t.constant=!!t.constant,t},primary:function(){var e,t,n;this.expect("(")?(e=this.filterChain(),this.consume(")")):this.expect("[")?e=this.arrayDeclaration():this.expect("{")?e=this.object():this.peek().identifier&&this.peek().text in Ln?e=Ln[this.consume().text]:this.peek().identifier?e=this.identifier():this.peek().constant?e=this.constant():this.throwError("not a primary expression",this.peek());for(;t=this.expect("(","[",".");)"("===t.text?(e=this.functionCall(e,n),n=null):"["===t.text?(n=e,e=this.objectIndex(e)):"."===t.text?(n=e,e=this.fieldAccess(e)):this.throwError("IMPOSSIBLE");return e},throwError:function(e,t){throw wn("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},peekToken:function(){if(0===this.tokens.length)throw wn("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,i){return this.peekAhead(0,e,t,n,i)},peekAhead:function(e,t,n,i,r){if(this.tokens.length>e){var o=this.tokens[e],a=o.text;if(a===t||a===n||a===i||a===r||!t&&!n&&!i&&!r)return o}return!1},expect:function(e,t,n,i){var r=this.peek(e,t,n,i);return!!r&&(this.tokens.shift(),r)},consume:function(e){if(0===this.tokens.length)throw wn("ueoe","Unexpected end of expression: {0}",this.text);var t=this.expect(e);return t||this.throwError("is unexpected, expecting ["+e+"]",this.peek()),t},unaryFn:function(e,t){var n=Pn[e];return C((function(e,i){return n(e,i,t)}),{constant:t.constant,inputs:[t]})},binaryFn:function(e,t,n,i){var r=Pn[t];return C((function(t,i){return r(t,i,e,n)}),{constant:e.constant&&n.constant,inputs:!i&&[e,n]})},identifier:function(){for(var e=this.consume().text;this.peek(".")&&this.peekAhead(1).identifier&&!this.peekAhead(2,"(");)e+=this.consume().text+this.consume().text;return function(e,t,n){var i=t.expensiveChecks,r=i?Mn:Nn,o=r[e];if(o)return o;var a=e.split("."),s=a.length;if(t.csp)o=s<6?Bn(a[0],a[1],a[2],a[3],a[4],n,i):function(e,t){var r,o=0;do{r=Bn(a[o++],a[o++],a[o++],a[o++],a[o++],n,i)(e,t),t=void 0,e=r}while(o<s);return r};else{var l="";i&&(l+="s = eso(s, fe);\nl = eso(l, fe);\n");var c=i;x(a,(function(e,t){Sn(e,n);var r=(t?"s":'((l&&l.hasOwnProperty("'+e+'"))?l:s)')+"."+e;(i||Rn(e))&&(r="eso("+r+", fe)",c=!0),l+="if(s == null) return undefined;\ns="+r+";\n"})),l+="return s;";var u=new Function("s","l","eso","fe",l);u.toString=O(l),c&&(u=function(e,t){return function(n,i){return e(n,i,Tn,t)}}(u,n)),o=u}return o.sharedGetter=!0,o.assign=function(t,n,i){return $n(t,i,e,n,e)},r[e]=o,o}(e,this.options,this.text)},constant:function(){var e=this.consume().value;return C((function(){return e}),{constant:!0,literal:!0})},statements:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.filterChain()),!this.expect(";"))return 1===e.length?e[0]:function(t,n){for(var i,r=0,o=e.length;r<o;r++)i=e[r](t,n);return i}},filterChain:function(){for(var e=this.expression();this.expect("|");)e=this.filter(e);return e},filter:function(e){var t,n,i=this.$filter(this.consume().text);if(this.peek(":"))for(t=[],n=[];this.expect(":");)t.push(this.expression());var r=[e].concat(t||[]);return C((function(r,o){var a=e(r,o);if(n){n[0]=a;for(var s=t.length;s--;)n[s+1]=t[s](r,o);return i.apply(void 0,n)}return i(a)}),{constant:!i.$stateful&&r.every(In),inputs:!i.$stateful&&r})},expression:function(){return this.assignment()},assignment:function(){var e,t,n=this.ternary();return(t=this.expect("="))?(n.assign||this.throwError("implies assignment but ["+this.text.substring(0,t.index)+"] can not be assigned to",t),e=this.ternary(),C((function(t,i){return n.assign(t,e(t,i),i)}),{inputs:[n,e]})):n},ternary:function(){var e,t=this.logicalOR();if(this.expect("?")&&(e=this.assignment(),this.consume(":"))){var n=this.assignment();return C((function(i,r){return t(i,r)?e(i,r):n(i,r)}),{constant:t.constant&&e.constant&&n.constant})}return t},logicalOR:function(){for(var e,t=this.logicalAND();e=this.expect("||");)t=this.binaryFn(t,e.text,this.logicalAND(),!0);return t},logicalAND:function(){for(var e,t=this.equality();e=this.expect("&&");)t=this.binaryFn(t,e.text,this.equality(),!0);return t},equality:function(){for(var e,t=this.relational();e=this.expect("==","!=","===","!==");)t=this.binaryFn(t,e.text,this.relational());return t},relational:function(){for(var e,t=this.additive();e=this.expect("<",">","<=",">=");)t=this.binaryFn(t,e.text,this.additive());return t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t=this.binaryFn(t,e.text,this.multiplicative());return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t=this.binaryFn(t,e.text,this.unary());return t},unary:function(){var e;return this.expect("+")?this.primary():(e=this.expect("-"))?this.binaryFn(Dn.ZERO,e.text,this.unary()):(e=this.expect("!"))?this.unaryFn(e.text,this.unary()):this.primary()},fieldAccess:function(e){var t=this.identifier();return C((function(n,i,r){var o=r||e(n,i);return null==o?void 0:t(o)}),{assign:function(n,i,r){var o=e(n,r);return o||e.assign(n,o={},r),t.assign(o,i)}})},objectIndex:function(e){var t=this.text,n=this.expression();return this.consume("]"),C((function(i,r){var o=e(i,r),a=n(i,r);if(Sn(a,t),o)return Tn(o[a],t)}),{assign:function(i,r,o){var a=Sn(n(i,o),t),s=Tn(e(i,o),t);return s||e.assign(i,s={},o),s[a]=r}})},functionCall:function(e,t){var n=[];if(")"!==this.peekToken().text)do{n.push(this.expression())}while(this.expect(","));this.consume(")");var i=this.text,r=n.length?[]:null;return function(o,a){var s=t?t(o,a):D(t)?void 0:o,l=e(o,a,s)||P;if(r)for(var c=n.length;c--;)r[c]=Tn(n[c](o,a),i);Tn(s,i),function(e,t){if(e){if(e.constructor===e)throw wn("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e===En||e===Cn||e===kn)throw wn("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",t)}}(l,i);var u=l.apply?l.apply(s,r):l(r[0],r[1],r[2],r[3],r[4]);return r&&(r.length=0),Tn(u,i)}},arrayDeclaration:function(){var e=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;e.push(this.expression())}while(this.expect(","));return this.consume("]"),C((function(t,n){for(var i=[],r=0,o=e.length;r<o;r++)i.push(e[r](t,n));return i}),{literal:!0,constant:e.every(In),inputs:e})},object:function(){var e=[],t=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var n=this.consume();n.constant?e.push(n.value):n.identifier?e.push(n.text):this.throwError("invalid key",n),this.consume(":"),t.push(this.expression())}while(this.expect(","));return this.consume("}"),C((function(n,i){for(var r={},o=0,a=t.length;o<a;o++)r[e[o]]=t[o](n,i);return r}),{literal:!0,constant:t.every(In),inputs:t})}};var Nn=Ce(),Mn=Ce();function Rn(e){return"constructor"==e}function Bn(e,t,n,i,r,o,a){Sn(e,o),Sn(t,o),Sn(n,o),Sn(i,o),Sn(r,o);var s=function(e){return Tn(e,o)},l=a||Rn(e)?s:A,c=a||Rn(t)?s:A,u=a||Rn(n)?s:A,d=a||Rn(i)?s:A,h=a||Rn(r)?s:A;return function(o,a){var s=a&&a.hasOwnProperty(e)?a:o;if(null==s)return s;if(s=l(s[e]),!t)return s;if(null!=s){if(s=c(s[t]),!n)return s;if(null!=s){if(s=u(s[n]),!i)return s;if(null!=s){if(s=d(s[i]),!r)return s;if(null!=s)return s=h(s[r])}}}}}var Hn=Object.prototype.valueOf;function zn(e){return H(e.valueOf)?e.valueOf():Hn.call(e)}function Fn(){var e=Ce(),t=Ce();this.$get=["$filter","$sniffer",function(n,i){var r={csp:i.csp,expensiveChecks:!1},o={csp:i.csp,expensiveChecks:!0};return function(i,a,h){var p,f,g;switch(typeof i){case"string":g=i=i.trim();var m=h?t:e;if(!(p=m[g])){":"===i.charAt(0)&&":"===i.charAt(1)&&(f=!0,i=i.substring(2));var v=h?o:r,y=new On(v);(p=new Dn(y,n,v).parse(i)).constant?p.$$watchDelegate=u:f?(p=function(e){var t=e;return e.sharedGetter&&((t=function(t,n){return e(t,n)}).literal=e.literal,t.constant=e.constant,t.assign=e.assign),t}(p)).$$watchDelegate=p.literal?c:l:p.inputs&&(p.$$watchDelegate=s),m[g]=p}return d(p,a);case"function":return d(i,a);default:return d(P,a)}};function a(e,t){return null==e||null==t?e===t:("object"!=typeof e||"object"!=typeof(e=zn(e)))&&(e===t||e!=e&&t!=t)}function s(e,t,n,i){var r,o=i.$$inputs||(i.$$inputs=function e(t,n){for(var i=0,r=t.length;i<r;i++){var o=t[i];o.constant||(o.inputs?e(o.inputs,n):-1===n.indexOf(o)&&n.push(o))}return n}(i.inputs,[]));if(1===o.length){var s=a;return o=o[0],e.$watch((function(e){var t=o(e);return a(t,s)||(r=i(e),s=t&&zn(t)),r}),t,n)}for(var l=[],c=0,u=o.length;c<u;c++)l[c]=a;return e.$watch((function(e){for(var t=!1,n=0,s=o.length;n<s;n++){var c=o[n](e);(t||(t=!a(c,l[n])))&&(l[n]=c&&zn(c))}return t&&(r=i(e)),r}),t,n)}function l(e,t,n,i){var r,o;return r=e.$watch((function(e){return i(e)}),(function(e,n,i){o=e,H(t)&&t.apply(this,arguments),D(e)&&i.$$postDigest((function(){D(o)&&r()}))}),n)}function c(e,t,n,i){var r,o;return r=e.$watch((function(e){return i(e)}),(function(e,n,i){o=e,H(t)&&t.call(this,e,n,i),a(e)&&i.$$postDigest((function(){a(o)&&r()}))}),n);function a(e){var t=!0;return x(e,(function(e){D(e)||(t=!1)})),t}}function u(e,t,n,i){var r;return r=e.$watch((function(e){return i(e)}),(function(e,n,i){H(t)&&t.apply(this,arguments),r()}),n)}function d(e,t){if(!t)return e;var n=e.$$watchDelegate,i=n!==c&&n!==l?function(n,i){var r=e(n,i);return t(r,n,i)}:function(n,i){var r=e(n,i),o=t(r,n,i);return D(r)?o:r};return e.$$watchDelegate&&e.$$watchDelegate!==s?i.$$watchDelegate=e.$$watchDelegate:t.$stateful||(i.$$watchDelegate=s,i.inputs=[e]),i}}]}function Vn(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return Un((function(t){e.$evalAsync(t)}),t)}]}function jn(){this.$get=["$browser","$exceptionHandler",function(e,t){return Un((function(t){e.defer(t)}),t)}]}function Un(e,t){var n=r("$q",TypeError);function i(){this.$$state={status:0}}function o(e,t){return function(n){t.call(e,n)}}function a(n){!n.processScheduled&&n.pending&&(n.processScheduled=!0,e((function(){!function(e){var n,i,r;r=e.pending,e.processScheduled=!1,e.pending=void 0;for(var o=0,a=r.length;o<a;++o){i=r[o][0],n=r[o][e.status];try{H(n)?i.resolve(n(e.value)):1===e.status?i.resolve(e.value):i.reject(e.value)}catch(e){i.reject(e),t(e)}}}(n)})))}function s(){this.promise=new i,this.resolve=o(this,this.resolve),this.reject=o(this,this.reject),this.notify=o(this,this.notify)}i.prototype={then:function(e,t,n){var i=new s;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([i,e,t,n]),this.$$state.status>0&&a(this.$$state),i.promise},catch:function(e){return this.then(null,e)},finally:function(e,t){return this.then((function(t){return c(t,!0,e)}),(function(t){return c(t,!1,e)}),t)}},s.prototype={resolve:function(e){this.promise.$$state.status||(e===this.promise?this.$$reject(n("qcycle","Expected promise to be resolved with value other than itself '{0}'",e)):this.$$resolve(e))},$$resolve:function(e){var n,i;i=function(e,t,n){var i=!1;function r(t){return function(n){i||(i=!0,t.call(e,n))}}return[r(t),r(n)]}(this,this.$$resolve,this.$$reject);try{($(e)||H(e))&&(n=e&&e.then),H(n)?(this.promise.$$state.status=-1,n.call(e,i[0],i[1],this.notify)):(this.promise.$$state.value=e,this.promise.$$state.status=1,a(this.promise.$$state))}catch(e){i[1](e),t(e)}},reject:function(e){this.promise.$$state.status||this.$$reject(e)},$$reject:function(e){this.promise.$$state.value=e,this.promise.$$state.status=2,a(this.promise.$$state)},notify:function(n){var i=this.promise.$$state.pending;this.promise.$$state.status<=0&&i&&i.length&&e((function(){for(var e,r,o=0,a=i.length;o<a;o++){r=i[o][0],e=i[o][3];try{r.notify(H(e)?e(n):n)}catch(e){t(e)}}}))}};var l=function(e,t){var n=new s;return t?n.resolve(e):n.reject(e),n.promise},c=function(e,t,n){var i=null;try{H(n)&&(i=n())}catch(e){return l(e,!1)}return U(i)?i.then((function(){return l(e,t)}),(function(e){return l(e,!1)})):l(e,t)},u=function(e,t,n,i){var r=new s;return r.resolve(e),r.promise.then(t,n,i)};var d=function e(t){if(!H(t))throw n("norslvr","Expected resolverFn, got '{0}'",t);if(!(this instanceof e))return new e(t);var i=new s;return t((function(e){i.resolve(e)}),(function(e){i.reject(e)})),i.promise};return d.defer=function(){return new s},d.reject=function(e){var t=new s;return t.reject(e),t.promise},d.when=u,d.all=function(e){var t=new s,n=0,i=B(e)?[]:{};return x(e,(function(e,r){n++,u(e).then((function(e){i.hasOwnProperty(r)||(i[r]=e,--n||t.resolve(i))}),(function(e){i.hasOwnProperty(r)||t.reject(e)}))})),0===n&&t.resolve(i),t.promise},d}function Wn(){this.$get=["$window","$timeout",function(e,t){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame,i=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,r=!!n,o=r?function(e){var t=n(e);return function(){i(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};return o.supported=r,o}]}function qn(){var e=10,t=r("$rootScope"),n=null,i=null;this.digestTtl=function(t){return arguments.length&&(e=t),e},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(r,o,a,l){function c(e){e.currentScope.$$destroyed=!0}function u(){this.$id=T(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings=null}u.prototype={constructor:u,$new:function(e,t){var n;return t=t||this,e?(n=new u).$root=this.$root:(this.$$ChildScope||(this.$$ChildScope=function(e){function t(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=T(),this.$$ChildScope=null}return t.prototype=e,t}(this)),n=new this.$$ChildScope),n.$parent=t,n.$$prevSibling=t.$$childTail,t.$$childHead?(t.$$childTail.$$nextSibling=n,t.$$childTail=n):t.$$childHead=t.$$childTail=n,(e||t!=this)&&n.$on("$destroy",c),n},$watch:function(e,t,i){var r=a(e);if(r.$$watchDelegate)return r.$$watchDelegate(this,t,i,r);var o=this.$$watchers,s={fn:t,last:y,get:r,exp:e,eq:!!i};return n=null,H(t)||(s.fn=P),o||(o=this.$$watchers=[]),o.unshift(s),function(){X(o,s),n=null}},$watchGroup:function(e,t){var n=new Array(e.length),i=new Array(e.length),r=[],o=this,a=!1,s=!0;if(!e.length){var l=!0;return o.$evalAsync((function(){l&&t(i,i,o)})),function(){l=!1}}if(1===e.length)return this.$watch(e[0],(function(e,r,o){i[0]=e,n[0]=r,t(i,e===r?i:n,o)}));function c(){a=!1,s?(s=!1,t(i,i,o)):t(i,n,o)}return x(e,(function(e,t){var s=o.$watch(e,(function(e,r){i[t]=e,n[t]=r,a||(a=!0,o.$evalAsync(c))}));r.push(s)})),function(){for(;r.length;)r.shift()()}},$watchCollection:function(e,t){g.$stateful=!0;var n,i,r,o=this,l=t.length>1,c=0,u=a(e,g),d=[],h={},p=!0,f=0;function g(e){var t,r,o,a;if(!I(n=e)){if($(n))if(_(n)){i!==d&&(f=(i=d).length=0,c++),t=n.length,f!==t&&(c++,i.length=f=t);for(var s=0;s<t;s++)a=i[s],o=n[s],a!=a&&o!=o||a===o||(c++,i[s]=o)}else{for(r in i!==h&&(i=h={},f=0,c++),t=0,n)n.hasOwnProperty(r)&&(t++,o=n[r],a=i[r],r in i?a!=a&&o!=o||a===o||(c++,i[r]=o):(f++,i[r]=o,c++));if(f>t)for(r in c++,i)n.hasOwnProperty(r)||(f--,delete i[r])}else i!==n&&(i=n,c++);return c}}return this.$watch(u,(function(){if(p?(p=!1,t(n,n,o)):t(n,r,o),l)if($(n))if(_(n)){r=new Array(n.length);for(var e=0;e<n.length;e++)r[e]=n[e]}else for(var i in r={},n)s.call(n,i)&&(r[i]=n[i]);else r=n}))},$digest:function(){var r,a,s,c,u,f,v,_,x,w,S=e,T=[];g("$digest"),l.$$checkUrlChange(),this===d&&null!==i&&(l.defer.cancel(i),b()),n=null;do{for(f=!1,_=this;h.length;){try{(w=h.shift()).scope.$eval(w.expression,w.locals)}catch(e){o(e)}n=null}e:do{if(c=_.$$watchers)for(u=c.length;u--;)try{if(r=c[u])if((a=r.get(_))===(s=r.last)||(r.eq?K(a,s):"number"==typeof a&&"number"==typeof s&&isNaN(a)&&isNaN(s))){if(r===n){f=!1;break e}}else f=!0,n=r,r.last=r.eq?Q(a,null):a,r.fn(a,s===y?a:s,_),S<5&&(T[x=4-S]||(T[x]=[]),T[x].push({msg:H(r.exp)?"fn: "+(r.exp.name||r.exp.toString()):r.exp,newVal:a,oldVal:s}))}catch(e){o(e)}if(!(v=_.$$childHead||_!==this&&_.$$nextSibling))for(;_!==this&&!(v=_.$$nextSibling);)_=_.$parent}while(_=v);if((f||h.length)&&!S--)throw m(),t("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",e,T)}while(f||h.length);for(m();p.length;)try{p.shift()()}catch(e){o(e)}},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;if(this.$broadcast("$destroy"),this.$$destroyed=!0,this!==d){for(var t in this.$$listenerCount)v(this,this.$$listenerCount[t],t);e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=P,this.$on=this.$watch=this.$watchGroup=function(){return P},this.$$listeners={},this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}}},$eval:function(e,t){return a(e)(this,t)},$evalAsync:function(e,t){d.$$phase||h.length||l.defer((function(){h.length&&d.$digest()})),h.push({scope:this,expression:e,locals:t})},$$postDigest:function(e){p.push(e)},$apply:function(e){try{return g("$apply"),this.$eval(e)}catch(e){o(e)}finally{m();try{d.$digest()}catch(e){throw o(e),e}}},$applyAsync:function(e){var t=this;e&&f.push((function(){t.$eval(e)})),null===i&&(i=l.defer((function(){d.$apply(b)})))},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);var i=this;do{i.$$listenerCount[e]||(i.$$listenerCount[e]=0),i.$$listenerCount[e]++}while(i=i.$parent);var r=this;return function(){var i=n.indexOf(t);-1!==i&&(n[i]=null,v(r,1,e))}},$emit:function(e,t){var n,i,r,a=[],s=this,l=!1,c={name:e,targetScope:s,stopPropagation:function(){l=!0},preventDefault:function(){c.defaultPrevented=!0},defaultPrevented:!1},u=ee([c],arguments,1);do{for(n=s.$$listeners[e]||a,c.currentScope=s,i=0,r=n.length;i<r;i++)if(n[i])try{n[i].apply(null,u)}catch(e){o(e)}else n.splice(i,1),i--,r--;if(l)return c.currentScope=null,c;s=s.$parent}while(s);return c.currentScope=null,c},$broadcast:function(e,t){var n=this,i=n,r=n,a={name:e,targetScope:n,preventDefault:function(){a.defaultPrevented=!0},defaultPrevented:!1};if(!n.$$listenerCount[e])return a;for(var s,l,c,u=ee([a],arguments,1);i=r;){for(a.currentScope=i,l=0,c=(s=i.$$listeners[e]||[]).length;l<c;l++)if(s[l])try{s[l].apply(null,u)}catch(e){o(e)}else s.splice(l,1),l--,c--;if(!(r=i.$$listenerCount[e]&&i.$$childHead||i!==n&&i.$$nextSibling))for(;i!==n&&!(r=i.$$nextSibling);)i=i.$parent}return a.currentScope=null,a}};var d=new u,h=d.$$asyncQueue=[],p=d.$$postDigestQueue=[],f=d.$$applyAsyncQueue=[];return d;function g(e){if(d.$$phase)throw t("inprog","{0} already in progress",d.$$phase);d.$$phase=e}function m(){d.$$phase=null}function v(e,t,n){do{e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n]}while(e=e.$parent)}function y(){}function b(){for(;f.length;)try{f.shift()()}catch(e){o(e)}i=null}}]}function Gn(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(t){return D(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return D(e)?(t=e,this):t},this.$get=function(){return function(n,i){var r,o=i?t:e;return""===(r=oi(n).href)||r.match(o)?n:"unsafe:"+r}}}var Zn=r("$sce"),Xn={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"};function Qn(e){var t=[];return D(e)&&x(e,(function(e){t.push(function(e){if("self"===e)return e;if(N(e)){if(e.indexOf("***")>-1)throw Zn("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=q(e).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+e+"$")}if(z(e))return new RegExp("^"+e.source+"$");throw Zn("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}(e))})),t}function Yn(){this.SCE_CONTEXTS=Xn;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=Qn(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=Qn(e)),t},this.$get=["$injector",function(n){var i=function(e){throw Zn("unsafe","Attempting to use an unsafe value in a safe context.")};function r(e,t){return"self"===e?ai(t):!!e.exec(t.href)}function o(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}n.has("$sanitize")&&(i=n.get("$sanitize"));var a=o(),s={};return s[Xn.HTML]=o(a),s[Xn.CSS]=o(a),s[Xn.URL]=o(a),s[Xn.JS]=o(a),s[Xn.RESOURCE_URL]=o(s[Xn.URL]),{trustAs:function(e,t){var n=s.hasOwnProperty(e)?s[e]:null;if(!n)throw Zn("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null==t||""===t)return t;if("string"!=typeof t)throw Zn("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new n(t)},getTrusted:function(n,o){if(null==o||""===o)return o;var a=s.hasOwnProperty(n)?s[n]:null;if(a&&o instanceof a)return o.$$unwrapTrustedValue();if(n===Xn.RESOURCE_URL){if(function(n){var i,o,a=oi(n.toString()),s=!1;for(i=0,o=e.length;i<o;i++)if(r(e[i],a)){s=!0;break}if(s)for(i=0,o=t.length;i<o;i++)if(r(t[i],a)){s=!1;break}return s}(o))return o;throw Zn("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",o.toString())}if(n===Xn.HTML)return i(o);throw Zn("unsafe","Attempting to use an unsafe value in a safe context.")},valueOf:function(e){return e instanceof a?e.$$unwrapTrustedValue():e}}}]}function Kn(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sceDelegate",function(t,n){if(e&&c<8)throw Zn("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var i=Y(Xn);i.isEnabled=function(){return e},i.trustAs=n.trustAs,i.getTrusted=n.getTrusted,i.valueOf=n.valueOf,e||(i.trustAs=i.getTrusted=function(e,t){return t},i.valueOf=A),i.parseAs=function(e,n){var r=t(n);return r.literal&&r.constant?r:t(n,(function(t){return i.getTrusted(e,t)}))};var r=i.parseAs,o=i.getTrusted,s=i.trustAs;return x(Xn,(function(e,t){var n=a(t);i[He("parse_as_"+n)]=function(t){return r(e,t)},i[He("get_trusted_"+n)]=function(t){return o(e,t)},i[He("trust_as_"+n)]=function(t){return s(e,t)}})),i}]}function Jn(){this.$get=["$window","$document",function(e,t){var n,i,r={},o=k((/android (\d+)/.exec(a((e.navigator||{}).userAgent))||[])[1]),s=/Boxee/i.test((e.navigator||{}).userAgent),l=t[0]||{},u=/^(Moz|webkit|ms)(?=[A-Z])/,d=l.body&&l.body.style,h=!1,p=!1;if(d){for(var f in d)if(i=u.exec(f)){n=(n=i[0]).substr(0,1).toUpperCase()+n.substr(1);break}n||(n="WebkitOpacity"in d&&"webkit"),h=!(!("transition"in d)&&!(n+"Transition"in d)),p=!(!("animation"in d)&&!(n+"Animation"in d)),!o||h&&p||(h=N(l.body.style.webkitTransition),p=N(l.body.style.webkitAnimation))}return{history:!(!e.history||!e.history.pushState||o<4||s),hasEvent:function(e){if("input"===e&&c<=11)return!1;if(I(r[e])){var t=l.createElement("div");r[e]="on"+e in t}return r[e]},csp:J(),vendorPrefix:n,transitions:h,animations:p,android:o}}]}Ot=r("$compile");function ei(){this.$get=["$templateCache","$http","$q",function(e,t,n){function i(r,o){i.totalPendingRequests++;var a=t.defaults&&t.defaults.transformResponse;B(a)?a=a.filter((function(e){return e!==Wt})):a===Wt&&(a=null);var s={cache:e,transformResponse:a};return t.get(r,s).finally((function(){i.totalPendingRequests--})).then((function(e){return e.data}),(function(e){if(!o)throw Ot("tpload","Failed to load template: {0}",r);return n.reject(e)}))}return i.totalPendingRequests=0,i}]}function ti(){this.$get=["$rootScope","$browser","$location",function(e,t,n){var i={findBindings:function(e,t,n){var i=e.getElementsByClassName("ng-binding"),r=[];return x(i,(function(e){var i=y.element(e).data("$binding");i&&x(i,(function(i){n?new RegExp("(^|\\s)"+q(t)+"(\\s|\\||$)").test(i)&&r.push(e):-1!=i.indexOf(t)&&r.push(e)}))})),r},findModels:function(e,t,n){for(var i=["ng-","data-ng-","ng\\:"],r=0;r<i.length;++r){var o="["+i[r]+"model"+(n?"=":"*=")+'"'+t+'"]',a=e.querySelectorAll(o);if(a.length)return a}},getLocation:function(){return n.url()},setLocation:function(t){t!==n.url()&&(n.url(t),e.$digest())},whenStable:function(e){t.notifyWhenNoOutstandingRequests(e)}};return i}]}function ni(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(e,t,n,i,r){var o={};function a(a,s,l){var c,u=D(l)&&!l,d=(u?i:n).defer(),h=d.promise;return c=t.defer((function(){try{d.resolve(a())}catch(e){d.reject(e),r(e)}finally{delete o[h.$$timeoutId]}u||e.$apply()}),s),h.$$timeoutId=c,o[c]=d,h}return a.cancel=function(e){return!(!e||!(e.$$timeoutId in o))&&(o[e.$$timeoutId].reject("canceled"),delete o[e.$$timeoutId],t.defer.cancel(e.$$timeoutId))},a}]}var ii=n.createElement("a"),ri=oi(t.location.href);function oi(e){var t=e;return c&&(ii.setAttribute("href",t),t=ii.href),ii.setAttribute("href",t),{href:ii.href,protocol:ii.protocol?ii.protocol.replace(/:$/,""):"",host:ii.host,search:ii.search?ii.search.replace(/^\?/,""):"",hash:ii.hash?ii.hash.replace(/^#/,""):"",hostname:ii.hostname,port:ii.port,pathname:"/"===ii.pathname.charAt(0)?ii.pathname:"/"+ii.pathname}}function ai(e){var t=N(e)?oi(e):e;return t.protocol===ri.protocol&&t.host===ri.host}function si(){this.$get=O(t)}function li(e){function t(n,i){if($(n)){var r={};return x(n,(function(e,n){r[n]=t(n,e)})),r}return e.factory(n+"Filter",i)}this.register=t,this.$get=["$injector",function(e){return function(t){return e.get(t+"Filter")}}],t("currency",di),t("date",Si),t("filter",ci),t("json",Ti),t("limitTo",ki),t("lowercase",Ei),t("number",hi),t("orderBy",Li),t("uppercase",Ci)}function ci(){return function(e,t,n){if(!B(e))return e;var i,r;switch(typeof t){case"function":i=t;break;case"boolean":case"number":case"string":r=!0;case"object":i=function(e,t,n){var i=$(e)&&"$"in e;!0===t?t=K:H(t)||(t=function(e,t){return!$(e)&&!$(t)&&(e=a(""+e),t=a(""+t),-1!==e.indexOf(t))});return function(r){return i&&!$(r)?ui(r,e.$,t,!1):ui(r,e,t,n)}}(t,n,r);break;default:return e}return e.filter(i)}}function ui(e,t,n,i,r){var o=null!==e?typeof e:"null",a=null!==t?typeof t:"null";if("string"===a&&"!"===t.charAt(0))return!ui(e,t.substring(1),n,i);if(B(e))return e.some((function(e){return ui(e,t,n,i)}));switch(o){case"object":var s;if(i){for(s in e)if("$"!==s.charAt(0)&&ui(e[s],t,n,!0))return!0;return!r&&ui(e,t,n,!1)}if("object"===a){for(s in t){var l=t[s];if(!H(l)&&!I(l)){var c="$"===s;if(!ui(c?e:e[s],l,n,c,c))return!1}}return!0}return n(e,t);case"function":return!1;default:return n(e,t)}}function di(e){var t=e.NUMBER_FORMATS;return function(e,n,i){return I(n)&&(n=t.CURRENCY_SYM),I(i)&&(i=t.PATTERNS[1].maxFrac),null==e?e:pi(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,i).replace(/\u00A4/g,n)}}function hi(e){var t=e.NUMBER_FORMATS;return function(e,n){return null==e?e:pi(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}li.$inject=["$provide"],di.$inject=["$locale"],hi.$inject=["$locale"];function pi(e,t,n,i,r){if(!isFinite(e)||$(e))return"";var o=e<0,a=(e=Math.abs(e))+"",s="",l=[],c=!1;if(-1!==a.indexOf("e")){var u=a.match(/([\d\.]+)e(-?)(\d+)/);u&&"-"==u[2]&&u[3]>r+1?e=0:(s=a,c=!0)}if(c)r>0&&e<1&&(s=e.toFixed(r),e=parseFloat(s));else{var d=(a.split(".")[1]||"").length;I(r)&&(r=Math.min(Math.max(t.minFrac,d),t.maxFrac));var h=(""+(e=+(Math.round(+(e.toString()+"e"+r)).toString()+"e"+-r))).split("."),p=h[0];h=h[1]||"";var f,g=0,m=t.lgSize,v=t.gSize;if(p.length>=m+v)for(g=p.length-m,f=0;f<g;f++)(g-f)%v==0&&0!==f&&(s+=n),s+=p.charAt(f);for(f=g;f<p.length;f++)(p.length-f)%m==0&&0!==f&&(s+=n),s+=p.charAt(f);for(;h.length<r;)h+="0";r&&"0"!==r&&(s+=i+h.substr(0,r))}return 0===e&&(o=!1),l.push(o?t.negPre:t.posPre,s,o?t.negSuf:t.posSuf),l.join("")}function fi(e,t,n){var i="";for(e<0&&(i="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),i+e}function gi(e,t,n,i){return n=n||0,function(r){var o=r["get"+e]();return(n>0||o>-n)&&(o+=n),0===o&&-12==n&&(o=12),fi(o,t,i)}}function mi(e,t){return function(n,i){var r=n["get"+e]();return i[l(t?"SHORT"+e:e)][r]}}function vi(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(t<=4?5:12)-t)}function yi(e){return function(t){var n,i=vi(t.getFullYear()),r=+(n=t,new Date(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay())))-+i;return fi(1+Math.round(r/6048e5),e)}}function bi(e,t){return e.getFullYear()<=0?t.ERAS[0]:t.ERAS[1]}var _i={yyyy:gi("FullYear",4),yy:gi("FullYear",2,0,!0),y:gi("FullYear",1),MMMM:mi("Month"),MMM:mi("Month",!0),MM:gi("Month",2,1),M:gi("Month",1,1),dd:gi("Date",2),d:gi("Date",1),HH:gi("Hours",2),H:gi("Hours",1),hh:gi("Hours",2,-12),h:gi("Hours",1,-12),mm:gi("Minutes",2),m:gi("Minutes",1),ss:gi("Seconds",2),s:gi("Seconds",1),sss:gi("Milliseconds",3),EEEE:mi("Day"),EEE:mi("Day",!0),a:function(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]},Z:function(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=fi(Math[t>0?"floor":"ceil"](t/60),2)+fi(Math.abs(t%60),2)},ww:yi(2),w:yi(1),G:bi,GG:bi,GGG:bi,GGGG:function(e,t){return e.getFullYear()<=0?t.ERANAMES[0]:t.ERANAMES[1]}},xi=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,wi=/^\-?\d+$/;function Si(e){var t=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,i,r){var o,a,s="",l=[];if(i=i||"mediumDate",i=e.DATETIME_FORMATS[i]||i,N(n)&&(n=wi.test(n)?k(n):function(e){var n;if(n=e.match(t)){var i=new Date(0),r=0,o=0,a=n[8]?i.setUTCFullYear:i.setFullYear,s=n[8]?i.setUTCHours:i.setHours;n[9]&&(r=k(n[9]+n[10]),o=k(n[9]+n[11])),a.call(i,k(n[1]),k(n[2])-1,k(n[3]));var l=k(n[4]||0)-r,c=k(n[5]||0)-o,u=k(n[6]||0),d=Math.round(1e3*parseFloat("0."+(n[7]||0)));return s.call(i,l,c,u,d),i}return e}(n)),M(n)&&(n=new Date(n)),!R(n))return n;for(;i;)(a=xi.exec(i))?i=(l=ee(l,a,1)).pop():(l.push(i),i=null);return r&&"UTC"===r&&(n=new Date(n.getTime())).setMinutes(n.getMinutes()+n.getTimezoneOffset()),x(l,(function(t){s+=(o=_i[t])?o(n,e.DATETIME_FORMATS):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")})),s}}function Ti(){return function(e,t){return I(t)&&(t=2),re(e,t)}}Si.$inject=["$locale"];var Ei=O(a),Ci=O(l);function ki(){return function(e,t){return M(e)&&(e=e.toString()),B(e)||N(e)?(t=Math.abs(Number(t))===1/0?Number(t):k(t))?t>0?e.slice(0,t):e.slice(t):N(e)?"":[]:e}}function Li(e){return function(t,n,i){return _(t)?(0===(n=B(n)?n:[n]).length&&(n=["+"]),n=n.map((function(t){var n=!1,i=t||A;if(N(t)){if("+"!=t.charAt(0)&&"-"!=t.charAt(0)||(n="-"==t.charAt(0),t=t.substring(1)),""===t)return r(s,n);if((i=e(t)).constant){var o=i();return r((function(e,t){return s(e[o],t[o])}),n)}}return r((function(e,t){return s(i(e),i(t))}),n)})),p.call(t).sort(r((function(e,t){for(var i=0;i<n.length;i++){var r=n[i](e,t);if(0!==r)return r}return 0}),i))):t;function r(e,t){return t?function(t,n){return e(n,t)}:e}function o(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}function a(e){return null===e?"null":"function"==typeof e.valueOf&&o(e=e.valueOf())||"function"==typeof e.toString&&o(e=e.toString())?e:""}function s(e,t){var n=typeof e,i=typeof t;return n===i&&"object"===n&&(e=a(e),t=a(t)),n===i?("string"===n&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t?0:e<t?-1:1):n<i?-1:1}}}function Pi(e){return H(e)&&(e={link:e}),e.restrict=e.restrict||"AC",O(e)}Li.$inject=["$parse"];var Ai=O({restrict:"E",compile:function(e,t){if(!t.href&&!t.xlinkHref&&!t.name)return function(e,t){if("a"===t[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===m.call(t.prop("href"))?"xlink:href":"href";t.on("click",(function(e){t.attr(n)||e.preventDefault()}))}}}}),Oi={};x(ut,(function(e,t){if("multiple"!=e){var n=$t("ng-"+t);Oi[n]=function(){return{restrict:"A",priority:100,link:function(e,i,r){e.$watch(r[n],(function(e){r.$set(t,!!e)}))}}}}})),x(ht,(function(e,t){Oi[t]=function(){return{priority:100,link:function(e,n,i){if("ngPattern"===t&&"/"==i.ngPattern.charAt(0)){var r=i.ngPattern.match(o);if(r)return void i.$set("ngPattern",new RegExp(r[1],r[2]))}e.$watch(i[t],(function(e){i.$set(t,e)}))}}}})),x(["src","srcset","href"],(function(e){var t=$t("ng-"+e);Oi[t]=function(){return{priority:99,link:function(n,i,r){var o=e,a=e;"href"===e&&"[object SVGAnimatedString]"===m.call(i.prop("href"))&&(a="xlinkHref",r.$attr[a]="xlink:href",o=null),r.$observe(t,(function(t){t?(r.$set(a,t),c&&o&&i.prop(o,r[a])):"href"===e&&r.$set(a,null)}))}}}}));var Ii={$addControl:P,$$renameControl:function(e,t){e.$name=t},$removeControl:P,$setValidity:P,$setDirty:P,$setPristine:P,$setSubmitted:P};function Di(e,t,n,i,r){var o=this,a=[],s=o.$$parentForm=e.parent().controller("form")||Ii;o.$error={},o.$$success={},o.$pending=void 0,o.$name=r(t.name||t.ngForm||"")(n),o.$dirty=!1,o.$pristine=!0,o.$valid=!0,o.$invalid=!1,o.$submitted=!1,s.$addControl(o),o.$rollbackViewValue=function(){x(a,(function(e){e.$rollbackViewValue()}))},o.$commitViewValue=function(){x(a,(function(e){e.$commitViewValue()}))},o.$addControl=function(e){Se(e.$name,"input"),a.push(e),e.$name&&(o[e.$name]=e)},o.$$renameControl=function(e,t){var n=e.$name;o[n]===e&&delete o[n],o[t]=e,e.$name=t},o.$removeControl=function(e){e.$name&&o[e.$name]===e&&delete o[e.$name],x(o.$pending,(function(t,n){o.$setValidity(n,null,e)})),x(o.$error,(function(t,n){o.$setValidity(n,null,e)})),x(o.$$success,(function(t,n){o.$setValidity(n,null,e)})),X(a,e)},kr({ctrl:this,$element:e,set:function(e,t,n){var i=e[t];i?-1===i.indexOf(n)&&i.push(n):e[t]=[n]},unset:function(e,t,n){var i=e[t];i&&(X(i,n),0===i.length&&delete e[t])},parentForm:s,$animate:i}),o.$setDirty=function(){i.removeClass(e,_r),i.addClass(e,xr),o.$dirty=!0,o.$pristine=!1,s.$setDirty()},o.$setPristine=function(){i.setClass(e,_r,xr+" ng-submitted"),o.$dirty=!1,o.$pristine=!0,o.$submitted=!1,x(a,(function(e){e.$setPristine()}))},o.$setUntouched=function(){x(a,(function(e){e.$setUntouched()}))},o.$setSubmitted=function(){i.addClass(e,"ng-submitted"),o.$submitted=!0,s.$setSubmitted()}}Di.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var $i=function(e){return["$timeout",function(t){return{name:"form",restrict:e?"EAC":"E",controller:Di,compile:function(n,i){n.addClass(_r).addClass(br);var r=i.name?"name":!(!e||!i.ngForm)&&"ngForm";return{pre:function(e,n,i,o){if(!("action"in i)){var a=function(t){e.$apply((function(){o.$commitViewValue(),o.$setSubmitted()})),t.preventDefault()};De(n[0],"submit",a),n.on("$destroy",(function(){t((function(){$e(n[0],"submit",a)}),0,!1)}))}var s=o.$$parentForm;r&&($n(e,null,o.$name,o,o.$name),i.$observe(r,(function(t){o.$name!==t&&($n(e,null,o.$name,void 0,o.$name),s.$$renameControl(o,t),$n(e,null,o.$name,o,o.$name))}))),n.on("$destroy",(function(){s.$removeControl(o),r&&$n(e,null,i[r],void 0,o.$name),C(o,Ii)}))}}}}}]},Ni=$i(),Mi=$i(!0),Ri=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,Bi=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Hi=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,zi=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Fi=/^(\d{4})-(\d{2})-(\d{2})$/,Vi=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,ji=/^(\d{4})-W(\d\d)$/,Ui=/^(\d{4})-(\d\d)$/,Wi=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,qi={text:function(e,t,n,i,r,o){Zi(e,t,n,i,r,o),Gi(i)},date:Qi("date",Fi,Xi(Fi,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":Qi("datetimelocal",Vi,Xi(Vi,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:Qi("time",Wi,Xi(Wi,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:Qi("week",ji,(function(e,t){if(R(e))return e;if(N(e)){ji.lastIndex=0;var n=ji.exec(e);if(n){var i=+n[1],r=+n[2],o=0,a=0,s=0,l=0,c=vi(i),u=7*(r-1);return t&&(o=t.getHours(),a=t.getMinutes(),s=t.getSeconds(),l=t.getMilliseconds()),new Date(i,0,c.getDate()+u,o,a,s,l)}}return NaN}),"yyyy-Www"),month:Qi("month",Ui,Xi(Ui,["yyyy","MM"]),"yyyy-MM"),number:function(e,t,n,i,r,o){if(Yi(e,t,n,i),Zi(e,t,n,i,r,o),i.$$parserName="number",i.$parsers.push((function(e){return i.$isEmpty(e)?null:zi.test(e)?parseFloat(e):void 0})),i.$formatters.push((function(e){if(!i.$isEmpty(e)){if(!M(e))throw wr("numfmt","Expected `{0}` to be a number",e);e=e.toString()}return e})),D(n.min)||n.ngMin){var a;i.$validators.min=function(e){return i.$isEmpty(e)||I(a)||e>=a},n.$observe("min",(function(e){D(e)&&!M(e)&&(e=parseFloat(e,10)),a=M(e)&&!isNaN(e)?e:void 0,i.$validate()}))}if(D(n.max)||n.ngMax){var s;i.$validators.max=function(e){return i.$isEmpty(e)||I(s)||e<=s},n.$observe("max",(function(e){D(e)&&!M(e)&&(e=parseFloat(e,10)),s=M(e)&&!isNaN(e)?e:void 0,i.$validate()}))}},url:function(e,t,n,i,r,o){Zi(e,t,n,i,r,o),Gi(i),i.$$parserName="url",i.$validators.url=function(e,t){var n=e||t;return i.$isEmpty(n)||Bi.test(n)}},email:function(e,t,n,i,r,o){Zi(e,t,n,i,r,o),Gi(i),i.$$parserName="email",i.$validators.email=function(e,t){var n=e||t;return i.$isEmpty(n)||Hi.test(n)}},radio:function(e,t,n,i){I(n.name)&&t.attr("name",T());t.on("click",(function(e){t[0].checked&&i.$setViewValue(n.value,e&&e.type)})),i.$render=function(){var e=n.value;t[0].checked=e==i.$viewValue},n.$observe("value",i.$render)},checkbox:function(e,t,n,i,r,o,a,s){var l=Ki(s,e,"ngTrueValue",n.ngTrueValue,!0),c=Ki(s,e,"ngFalseValue",n.ngFalseValue,!1);t.on("click",(function(e){i.$setViewValue(t[0].checked,e&&e.type)})),i.$render=function(){t[0].checked=i.$viewValue},i.$isEmpty=function(e){return!1===e},i.$formatters.push((function(e){return K(e,l)})),i.$parsers.push((function(e){return e?l:c}))},hidden:P,button:P,submit:P,reset:P,file:P};function Gi(e){e.$formatters.push((function(t){return e.$isEmpty(t)?t:t.toString()}))}function Zi(e,t,n,i,r,o){var s=a(t[0].type);if(!r.android){var l=!1;t.on("compositionstart",(function(e){l=!0})),t.on("compositionend",(function(){l=!1,c()}))}var c=function(e){if(u&&(o.defer.cancel(u),u=null),!l){var r=t.val(),a=e&&e.type;"password"===s||n.ngTrim&&"false"===n.ngTrim||(r=W(r)),(i.$viewValue!==r||""===r&&i.$$hasNativeValidators)&&i.$setViewValue(r,a)}};if(r.hasEvent("input"))t.on("input",c);else{var u,d=function(e,t,n){u||(u=o.defer((function(){u=null,t&&t.value===n||c(e)})))};t.on("keydown",(function(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||d(e,this,this.value)})),r.hasEvent("paste")&&t.on("paste cut",d)}t.on("change",c),i.$render=function(){t.val(i.$isEmpty(i.$viewValue)?"":i.$viewValue)}}function Xi(e,t){return function(n,i){var r,o;if(R(n))return n;if(N(n)){if('"'==n.charAt(0)&&'"'==n.charAt(n.length-1)&&(n=n.substring(1,n.length-1)),Ri.test(n))return new Date(n);if(e.lastIndex=0,r=e.exec(n))return r.shift(),o=i?{yyyy:i.getFullYear(),MM:i.getMonth()+1,dd:i.getDate(),HH:i.getHours(),mm:i.getMinutes(),ss:i.getSeconds(),sss:i.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},x(r,(function(e,n){n<t.length&&(o[t[n]]=+e)})),new Date(o.yyyy,o.MM-1,o.dd,o.HH,o.mm,o.ss||0,1e3*o.sss||0)}return NaN}}function Qi(e,t,n,i){return function(r,o,a,s,l,c,u){Yi(r,o,a,s),Zi(0,o,a,s,l,c);var d,h,p,f=s&&s.$options&&s.$options.timezone;(s.$$parserName=e,s.$parsers.push((function(e){if(s.$isEmpty(e))return null;if(t.test(e)){var i=n(e,d);return"UTC"===f&&i.setMinutes(i.getMinutes()-i.getTimezoneOffset()),i}})),s.$formatters.push((function(e){if(e&&!R(e))throw wr("datefmt","Expected `{0}` to be a date",e);if(g(e)){if((d=e)&&"UTC"===f){var t=6e4*d.getTimezoneOffset();d=new Date(d.getTime()+t)}return u("date")(e,i,f)}return d=null,""})),D(a.min)||a.ngMin)&&(s.$validators.min=function(e){return!g(e)||I(h)||n(e)>=h},a.$observe("min",(function(e){h=m(e),s.$validate()})));(D(a.max)||a.ngMax)&&(s.$validators.max=function(e){return!g(e)||I(p)||n(e)<=p},a.$observe("max",(function(e){p=m(e),s.$validate()})));function g(e){return e&&!(e.getTime&&e.getTime()!=e.getTime())}function m(e){return D(e)?R(e)?e:n(e):void 0}}}function Yi(e,t,n,i){var r=t[0];(i.$$hasNativeValidators=$(r.validity))&&i.$parsers.push((function(e){var n=t.prop("validity")||{};return n.badInput&&!n.typeMismatch?void 0:e}))}function Ki(e,t,n,i,o){var a;if(D(i)){if(!(a=e(i)).constant)throw r("ngModel")("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",n,i);return a(t)}return o}var Ji=["$browser","$sniffer","$filter","$parse",function(e,t,n,i){return{restrict:"E",require:["?ngModel"],link:{pre:function(r,o,s,l){l[0]&&(qi[a(s.type)]||qi.text)(r,o,s,l[0],t,e,n,i)}}}}],er=/^(true|false|\d+)$/,tr=function(){return{restrict:"A",priority:100,compile:function(e,t){return er.test(t.ngValue)?function(e,t,n){n.$set("value",e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,(function(e){n.$set("value",e)}))}}}},nr=["$compile",function(e){return{restrict:"AC",compile:function(t){return e.$$addBindingClass(t),function(t,n,i){e.$$addBindingInfo(n,i.ngBind),n=n[0],t.$watch(i.ngBind,(function(e){n.textContent=void 0===e?"":e}))}}}}],ir=["$interpolate","$compile",function(e,t){return{compile:function(n){return t.$$addBindingClass(n),function(n,i,r){var o=e(i.attr(r.$attr.ngBindTemplate));t.$$addBindingInfo(i,o.expressions),i=i[0],r.$observe("ngBindTemplate",(function(e){i.textContent=void 0===e?"":e}))}}}}],rr=["$sce","$parse","$compile",function(e,t,n){return{restrict:"A",compile:function(i,r){var o=t(r.ngBindHtml),a=t(r.ngBindHtml,(function(e){return(e||"").toString()}));return n.$$addBindingClass(i),function(t,i,r){n.$$addBindingInfo(i,r.ngBindHtml),t.$watch(a,(function(){i.html(e.getTrustedHtml(o(t))||"")}))}}}}],or=O({restrict:"A",require:"ngModel",link:function(e,t,n,i){i.$viewChangeListeners.push((function(){e.$eval(n.ngChange)}))}});function ar(e,t){return e="ngClass"+e,["$animate",function(n){return{restrict:"AC",link:function(o,a,s){var l;function c(e){var t=u(e,1);s.$addClass(t)}function u(e,t){var n=a.data("$classCounts")||{},i=[];return x(e,(function(e){(t>0||n[e])&&(n[e]=(n[e]||0)+t,n[e]===+(t>0)&&i.push(e))})),a.data("$classCounts",n),i.join(" ")}function d(e){if(!0===t||o.$index%2===t){var s=r(e||[]);if(l){if(!K(e,l)){!function(e,t){var r=i(t,e),o=i(e,t);r=u(r,1),o=u(o,-1),r&&r.length&&n.addClass(a,r),o&&o.length&&n.removeClass(a,o)}(r(l),s)}}else c(s)}l=Y(e)}o.$watch(s[e],d,!0),s.$observe("class",(function(t){d(o.$eval(s[e]))})),"ngClass"!==e&&o.$watch("$index",(function(n,i){var a=1&n;if(a!==(1&i)){var l=r(o.$eval(s[e]));a===t?c(l):function(e){var t=u(e,-1);s.$removeClass(t)}(l)}}))}};function i(e,t){var n=[];e:for(var i=0;i<e.length;i++){for(var r=e[i],o=0;o<t.length;o++)if(r==t[o])continue e;n.push(r)}return n}function r(e){if(B(e))return e;if(N(e))return e.split(" ");if($(e)){var t=[];return x(e,(function(e,n){e&&(t=t.concat(n.split(" ")))})),t}return e}}]}var sr=ar("",!0),lr=ar("Odd",0),cr=ar("Even",1),ur=Pi({compile:function(e,t){t.$set("ngCloak",void 0),e.removeClass("ng-cloak")}}),dr=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],hr={},pr={blur:!0,focus:!0};x("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),(function(e){var t=$t("ng-"+e);hr[t]=["$parse","$rootScope",function(n,i){return{restrict:"A",compile:function(r,o){var a=n(o[t],null,!0);return function(t,n){n.on(e,(function(n){var r=function(){a(t,{$event:n})};pr[e]&&i.$$phase?t.$evalAsync(r):t.$apply(r)}))}}}}]}));var fr=["$animate",function(e){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(t,i,r,o,a){var s,l,c;t.$watch(r.ngIf,(function(t){t?l||a((function(t,o){l=o,t[t.length++]=n.createComment(" end ngIf: "+r.ngIf+" "),s={clone:t},e.enter(t,i.parent(),i)})):(c&&(c.remove(),c=null),l&&(l.$destroy(),l=null),s&&(c=Ee(s.clone),e.leave(c).then((function(){c=null})),s=null))}))}}}],gr=["$templateRequest","$anchorScroll","$animate","$sce",function(e,t,n,i){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:y.noop,compile:function(r,o){var a=o.ngInclude||o.src,s=o.onload||"",l=o.autoscroll;return function(r,o,c,u,d){var h,p,f,g=0,m=function(){p&&(p.remove(),p=null),h&&(h.$destroy(),h=null),f&&(n.leave(f).then((function(){p=null})),p=f,f=null)};r.$watch(i.parseAsResourceUrl(a),(function(i){var a=function(){!D(l)||l&&!r.$eval(l)||t()},c=++g;i?(e(i,!0).then((function(e){if(c===g){var t=r.$new();u.template=e;var l=d(t,(function(e){m(),n.enter(e,null,o).then(a)}));f=l,(h=t).$emit("$includeContentLoaded",i),r.$eval(s)}}),(function(){c===g&&(m(),r.$emit("$includeContentError",i))})),r.$emit("$includeContentRequested",i)):(m(),u.template=null)}))}}}}],mr=["$compile",function(e){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(t,i,r,o){if(/SVG/.test(i[0].toString()))return i.empty(),void e(Ge(o.template,n).childNodes)(t,(function(e){i.append(e)}),{futureParentElement:i});i.html(o.template),e(i.contents())(t)}}}],vr=Pi({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),yr=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(e,t,n,i){var r=t.attr(n.$attr.ngList)||", ",o="false"!==n.ngTrim,a=o?W(r):r;i.$parsers.push((function(e){if(!I(e)){var t=[];return e&&x(e.split(a),(function(e){e&&t.push(o?W(e):e)})),t}})),i.$formatters.push((function(e){if(B(e))return e.join(r)})),i.$isEmpty=function(e){return!e||!e.length}}}},br="ng-valid",_r="ng-pristine",xr="ng-dirty",wr=new r("ngModel"),Sr=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(e,t,n,i,r,o,a,s,l,c){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=c(n.name||"",!1)(e);var u,d=r(n.ngModel),h=d.assign,p=d,f=h,g=null,m=this;this.$$setOptions=function(e){if(m.$options=e,e&&e.getterSetter){var t=r(n.ngModel+"()"),o=r(n.ngModel+"($$$p)");p=function(e){var n=d(e);return H(n)&&(n=t(e)),n},f=function(e,t){H(d(e))?o(e,{$$$p:m.$modelValue}):h(e,m.$modelValue)}}else if(!d.assign)throw wr("nonassign","Expression '{0}' is non-assignable. Element: {1}",n.ngModel,ae(i))},this.$render=P,this.$isEmpty=function(e){return I(e)||""===e||null===e||e!=e};var v=i.inheritedData("$formController")||Ii,y=0;kr({ctrl:this,$element:i,set:function(e,t){e[t]=!0},unset:function(e,t){delete e[t]},parentForm:v,$animate:o}),this.$setPristine=function(){m.$dirty=!1,m.$pristine=!0,o.removeClass(i,xr),o.addClass(i,_r)},this.$setDirty=function(){m.$dirty=!0,m.$pristine=!1,o.removeClass(i,_r),o.addClass(i,xr),v.$setDirty()},this.$setUntouched=function(){m.$touched=!1,m.$untouched=!0,o.setClass(i,"ng-untouched","ng-touched")},this.$setTouched=function(){m.$touched=!0,m.$untouched=!1,o.setClass(i,"ng-touched","ng-untouched")},this.$rollbackViewValue=function(){a.cancel(g),m.$viewValue=m.$$lastCommittedViewValue,m.$render()},this.$validate=function(){if(!M(m.$modelValue)||!isNaN(m.$modelValue)){var e=m.$$lastCommittedViewValue,t=m.$$rawModelValue,n=m.$valid,i=m.$modelValue,r=m.$options&&m.$options.allowInvalid;m.$$runValidators(t,e,(function(e){r||n===e||(m.$modelValue=e?t:void 0,m.$modelValue!==i&&m.$$writeModelToScope())}))}},this.$$runValidators=function(e,t,n){var i,r,o=++y;(function(){var e=m.$$parserName||"parse";if(void 0!==u)return u||(x(m.$validators,(function(e,t){a(t,null)})),x(m.$asyncValidators,(function(e,t){a(t,null)}))),a(e,u),u;a(e,null);return!0})()?!function(){var n=!0;if(x(m.$validators,(function(i,r){var o=i(e,t);n=n&&o,a(r,o)})),!n)return x(m.$asyncValidators,(function(e,t){a(t,null)})),!1;return!0}()?s(!1):(i=[],r=!0,x(m.$asyncValidators,(function(n,o){var s=n(e,t);if(!U(s))throw wr("$asyncValidators","Expected asynchronous validator to return a promise but got '{0}' instead.",s);a(o,void 0),i.push(s.then((function(){a(o,!0)}),(function(e){r=!1,a(o,!1)})))})),i.length?l.all(i).then((function(){s(r)}),P):s(!0)):s(!1);function a(e,t){o===y&&m.$setValidity(e,t)}function s(e){o===y&&n(e)}},this.$commitViewValue=function(){var e=m.$viewValue;a.cancel(g),(m.$$lastCommittedViewValue!==e||""===e&&m.$$hasNativeValidators)&&(m.$$lastCommittedViewValue=e,m.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){var t=m.$$lastCommittedViewValue;if(u=!I(t)||void 0)for(var n=0;n<m.$parsers.length;n++)if(I(t=m.$parsers[n](t))){u=!1;break}M(m.$modelValue)&&isNaN(m.$modelValue)&&(m.$modelValue=p(e));var i=m.$modelValue,r=m.$options&&m.$options.allowInvalid;function o(){m.$modelValue!==i&&m.$$writeModelToScope()}m.$$rawModelValue=t,r&&(m.$modelValue=t,o()),m.$$runValidators(t,m.$$lastCommittedViewValue,(function(e){r||(m.$modelValue=e?t:void 0,o())}))},this.$$writeModelToScope=function(){f(e,m.$modelValue),x(m.$viewChangeListeners,(function(e){try{e()}catch(e){t(e)}}))},this.$setViewValue=function(e,t){m.$viewValue=e,m.$options&&!m.$options.updateOnDefault||m.$$debounceViewValueCommit(t)},this.$$debounceViewValueCommit=function(t){var n,i=0,r=m.$options;r&&D(r.debounce)&&(M(n=r.debounce)?i=n:M(n[t])?i=n[t]:M(n.default)&&(i=n.default)),a.cancel(g),i?g=a((function(){m.$commitViewValue()}),i):s.$$phase?m.$commitViewValue():e.$apply((function(){m.$commitViewValue()}))},e.$watch((function(){var t=p(e);if(t!==m.$modelValue){m.$modelValue=m.$$rawModelValue=t,u=void 0;for(var n=m.$formatters,i=n.length,r=t;i--;)r=n[i](r);m.$viewValue!==r&&(m.$viewValue=m.$$lastCommittedViewValue=r,m.$render(),m.$$runValidators(t,r,P))}return t}))}],Tr=["$rootScope",function(e){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Sr,priority:1,compile:function(t){return t.addClass(_r).addClass("ng-untouched").addClass(br),{pre:function(e,t,n,i){var r=i[0],o=i[1]||Ii;r.$$setOptions(i[2]&&i[2].$options),o.$addControl(r),n.$observe("name",(function(e){r.$name!==e&&o.$$renameControl(r,e)})),e.$on("$destroy",(function(){o.$removeControl(r)}))},post:function(t,n,i,r){var o=r[0];o.$options&&o.$options.updateOn&&n.on(o.$options.updateOn,(function(e){o.$$debounceViewValueCommit(e&&e.type)})),n.on("blur",(function(n){o.$touched||(e.$$phase?t.$evalAsync(o.$setTouched):t.$apply(o.$setTouched))}))}}}}}],Er=/(\s+|^)default(\s+|$)/,Cr=function(){return{restrict:"A",controller:["$scope","$attrs",function(e,t){var n=this;this.$options=e.$eval(t.ngModelOptions),void 0!==this.$options.updateOn?(this.$options.updateOnDefault=!1,this.$options.updateOn=W(this.$options.updateOn.replace(Er,(function(){return n.$options.updateOnDefault=!0," "})))):this.$options.updateOnDefault=!0}]}};function kr(e){var t=e.ctrl,n=e.$element,i={},r=e.set,o=e.unset,a=e.parentForm,s=e.$animate;function l(e,t){t&&!i[e]?(s.addClass(n,e),i[e]=!0):!t&&i[e]&&(s.removeClass(n,e),i[e]=!1)}function c(e,t){e=e?"-"+ye(e,"-"):"",l(br+e,!0===t),l("ng-invalid"+e,!1===t)}i["ng-invalid"]=!(i[br]=n.hasClass(br)),t.$setValidity=function(e,n,i){void 0===n?function(e,n,i){t[e]||(t[e]={});r(t[e],n,i)}("$pending",e,i):function(e,n,i){t[e]&&o(t[e],n,i);Lr(t[e])&&(t[e]=void 0)}("$pending",e,i);j(n)?n?(o(t.$error,e,i),r(t.$$success,e,i)):(r(t.$error,e,i),o(t.$$success,e,i)):(o(t.$error,e,i),o(t.$$success,e,i));t.$pending?(l("ng-pending",!0),t.$valid=t.$invalid=void 0,c("",null)):(l("ng-pending",!1),t.$valid=Lr(t.$error),t.$invalid=!t.$valid,c("",t.$valid));var s;s=t.$pending&&t.$pending[e]?void 0:!t.$error[e]&&(!!t.$$success[e]||null);c(e,s),a.$setValidity(e,s,t)}}function Lr(e){if(e)for(var t in e)return!1;return!0}var Pr,Ar=Pi({terminal:!0,priority:1e3}),Or=["$locale","$interpolate",function(e,t){var n=/{}/g,i=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(r,o,s){var l,c=s.count,u=s.$attr.when&&o.attr(s.$attr.when),d=s.offset||0,h=r.$eval(u)||{},p={},f=t.startSymbol(),g=t.endSymbol(),m=f+c+"-"+d+g,v=y.noop;function b(e){o.text(e||"")}x(s,(function(e,t){var n=i.exec(t);if(n){var r=(n[1]?"-":"")+a(n[2]);h[r]=o.attr(s.$attr[t])}})),x(h,(function(e,i){p[i]=t(e.replace(n,m))})),r.$watch(c,(function(t){var n=parseFloat(t),i=isNaN(n);i||n in h||(n=e.pluralCat(n-d)),n===l||i&&isNaN(l)||(v(),v=r.$watch(p[n],b),l=n)}))}}}],Ir=["$parse","$animate",function(e,t){var i=r("ngRepeat"),o=function(e,t,n,i,r,o,a){e[n]=i,r&&(e[r]=o),e.$index=t,e.$first=0===t,e.$last=t===a-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=0==(1&t))},a=function(e){return e.clone[0]},s=function(e){return e.clone[e.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(r,l){var c=l.ngRepeat,d=n.createComment(" end ngRepeat: "+c+" "),h=c.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!h)throw i("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",c);var p=h[1],f=h[2],g=h[3],m=h[4];if(!(h=p.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/)))throw i("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",p);var v,y,b,w,S=h[3]||h[1],T=h[2];if(g&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(g)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(g)))throw i("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",g);var E={$id:gt};return m?v=e(m):(b=function(e,t){return gt(t)},w=function(e){return e}),function(e,n,r,l,h){v&&(y=function(t,n,i){return T&&(E[T]=t),E[S]=n,E.$index=i,v(e,E)});var p=Ce();e.$watchCollection(f,(function(r){var l,f,m,v,E,C,k,L,P,A,O,I,D=n[0],$=Ce();if(g&&(e[g]=r),_(r))P=r,L=y||b;else{for(var N in L=y||w,P=[],r)r.hasOwnProperty(N)&&"$"!=N.charAt(0)&&P.push(N);P.sort()}for(v=P.length,O=new Array(v),l=0;l<v;l++)if(E=r===P?l:P[l],C=r[E],k=L(E,C,l),p[k])A=p[k],delete p[k],$[k]=A,O[l]=A;else{if($[k])throw x(O,(function(e){e&&e.scope&&(p[e.id]=e)})),i("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",c,k,C);O[l]={id:k,scope:void 0,clone:void 0},$[k]=!0}for(var M in p){if(I=Ee((A=p[M]).clone),t.leave(I),I[0].parentNode)for(l=0,f=I.length;l<f;l++)I[l].$$NG_REMOVED=!0;A.scope.$destroy()}for(l=0;l<v;l++)if(E=r===P?l:P[l],C=r[E],(A=O[l]).scope){m=D;do{m=m.nextSibling}while(m&&m.$$NG_REMOVED);a(A)!=m&&t.move(Ee(A.clone),null,u(D)),D=s(A),o(A.scope,l,S,C,T,E,v)}else h((function(e,n){A.scope=n;var i=d.cloneNode(!1);e[e.length++]=i,t.enter(e,null,u(D)),D=i,A.clone=e,$[A.id]=A,o(A.scope,l,S,C,T,E,v)}));p=$}))}}}}],Dr=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,i){t.$watch(i.ngShow,(function(t){e[t?"removeClass":"addClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})}))}}}],$r=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,i){t.$watch(i.ngHide,(function(t){e[t?"addClass":"removeClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})}))}}}],Nr=Pi((function(e,t,n){e.$watchCollection(n.ngStyle,(function(e,n){n&&e!==n&&x(n,(function(e,n){t.css(n,"")})),e&&t.css(e)}))})),Mr=["$animate",function(e){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(t,i,r,o){var a=r.ngSwitch||r.on,s=[],l=[],c=[],u=[],d=function(e,t){return function(){e.splice(t,1)}};t.$watch(a,(function(t){var i,r;for(i=0,r=c.length;i<r;++i)e.cancel(c[i]);for(c.length=0,i=0,r=u.length;i<r;++i){var a=Ee(l[i].clone);u[i].$destroy(),(c[i]=e.leave(a)).then(d(c,i))}l.length=0,u.length=0,(s=o.cases["!"+t]||o.cases["?"])&&x(s,(function(t){t.transclude((function(i,r){u.push(r);var o=t.element;i[i.length++]=n.createComment(" end ngSwitchWhen: ");var a={clone:i};l.push(a),e.enter(i,o.parent(),o)}))}))}))}}}],Rr=Pi({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,i,r){i.cases["!"+n.ngSwitchWhen]=i.cases["!"+n.ngSwitchWhen]||[],i.cases["!"+n.ngSwitchWhen].push({transclude:r,element:t})}}),Br=Pi({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,i,r){i.cases["?"]=i.cases["?"]||[],i.cases["?"].push({transclude:r,element:t})}}),Hr=Pi({restrict:"EAC",link:function(e,t,n,i,o){if(!o)throw r("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",ae(t));o((function(e){t.empty(),t.append(e)}))}}),zr=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){if("text/ng-template"==n.type){var i=n.id,r=t[0].text;e.put(i,r)}}}}],Fr=r("ngOptions"),Vr=O({restrict:"A",terminal:!0}),jr=["$compile","$parse",function(e,t){var i=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,r={$setViewValue:P};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(e,t,n){var i,o=this,a={},s=r;o.databound=n.ngModel,o.init=function(e,t,n){s=e,t,i=n},o.addOption=function(t,n){Se(t,'"option value"'),a[t]=!0,s.$viewValue==t&&(e.val(t),i.parent()&&i.remove()),n&&n[0].hasAttribute("selected")&&(n[0].selected=!0)},o.removeOption=function(e){this.hasOption(e)&&(delete a[e],s.$viewValue===e&&this.renderUnknownOption(e))},o.renderUnknownOption=function(t){var n="? "+gt(t)+" ?";i.val(n),e.prepend(i),e.val(n),i.prop("selected",!0)},o.hasOption=function(e){return a.hasOwnProperty(e)},t.$on("$destroy",(function(){o.renderUnknownOption=P}))}],link:function(r,o,a,s){if(s[1]){for(var l,d=s[0],h=s[1],p=a.multiple,f=a.ngOptions,g=!1,m=!1,v=u(n.createElement("option")),y=u(n.createElement("optgroup")),b=v.clone(),_=0,S=o.children(),T=S.length;_<T;_++)if(""===S[_].value){l=g=S.eq(_);break}d.init(h,g,b),p&&(h.$isEmpty=function(e){return!e||0===e.length}),f?function(n,r,o){var a;if(!(a=f.match(i)))throw Fr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",f,ae(r));var s=t(a[2]||a[1]),l=a[4]||a[6],u=/ as /.test(a[0])&&a[1],h=u?t(u):null,b=a[5],_=t(a[3]||""),S=t(a[2]?a[1]:l),T=t(a[7]),E=a[8]?t(a[8]):null,C={},k=[[{element:r,label:""}]],L={};g&&(e(g)(n),g.removeClass("ng-scope"),g.remove());r.empty(),r.on("change",A),o.$render=M,n.$watchCollection(T,$),n.$watchCollection(I,$),p&&n.$watchCollection((function(){return o.$modelValue}),$);function P(e,t,i){return L[l]=i,b&&(L[b]=t),e(n,L)}function A(){n.$apply((function(){var e,t=T(n)||[];if(p)e=[],x(r.val(),(function(n){n=E?C[n]:n,e.push(O(n,t[n]))}));else{var i=E?C[r.val()]:r.val();e=O(i,t[i])}o.$setViewValue(e),M()}))}function O(e,t){if("?"!==e)return""===e?null:P(h||S,e,t)}function I(){var e,t=T(n);if(t&&B(t)){e=new Array(t.length);for(var i=0,r=t.length;i<r;i++)e[i]=P(s,i,t[i]);return e}if(t)for(var o in e={},t)t.hasOwnProperty(o)&&(e[o]=P(s,o,t[o]));return e}function $(){m||(n.$$postDigest(M),m=!0)}function N(e,t,n){e[t]=e[t]||0,e[t]+=n?1:-1}function M(){m=!1;var e,t,i,a,l,u,f,A,O,I,$,M,R,H,z,F,V,j={"":[]},U=[""],W=o.$viewValue,q=T(n)||[],G=b?w(q):q,Z={},X=function(e){var t;if(p)if(E&&B(e)){t=new mt([]);for(var n=0;n<e.length;n++)t.put(P(E,null,e[n]),!0)}else t=new mt(e);else E&&(e=P(E,null,e));return function(n,i){var r;return r=E||(h||S),p?D(t.remove(P(r,n,i))):e===P(r,n,i)}}(W),Q=!1;for(C={},M=0;M<(I=G.length);M++)f=M,b&&"$"===(f=G[M]).charAt(0)||(A=q[f],(t=j[e=P(_,f,A)||""])||(t=j[e]=[],U.push(e)),R=X(f,A),Q=Q||R,F=D(F=P(s,f,A))?F:"",V=E?E(n,L):b?G[M]:M,E&&(C[V]=f),t.push({id:V,label:F,selected:R}));for(p||(g||null===W?j[""].unshift({id:"",label:"",selected:!Q}):Q||j[""].unshift({id:"?",label:"",selected:!0})),$=0,O=U.length;$<O;$++){for(t=j[e=U[$]],k.length<=$?(l=[a={element:y.clone().attr("label",e),label:t.label}],k.push(l),r.append(a.element)):(a=(l=k[$])[0]).label!=e&&a.element.attr("label",a.label=e),H=null,M=0,I=t.length;M<I;M++)i=t[M],(u=l[M+1])?(H=u.element,u.label!==i.label&&(N(Z,u.label,!1),N(Z,i.label,!0),H.text(u.label=i.label),H.prop("label",u.label)),u.id!==i.id&&H.val(u.id=i.id),H[0].selected!==i.selected&&(H.prop("selected",u.selected=i.selected),c&&H.prop("selected",u.selected))):(""===i.id&&g?z=g:(z=v.clone()).val(i.id).prop("selected",i.selected).attr("selected",i.selected).prop("label",i.label).text(i.label),l.push(u={element:z,label:i.label,id:i.id,selected:i.selected}),N(Z,i.label,!0),H?H.after(z):a.element.append(z),H=z);for(M++;l.length>M;)N(Z,(i=l.pop()).label,!1),i.element.remove()}for(;k.length>$;){for(t=k.pop(),M=1;M<t.length;++M)N(Z,t[M].label,!1);t[0].element.remove()}x(Z,(function(e,t){e>0?d.addOption(t):e<0&&d.removeOption(t)}))}}(r,o,h):p?function(e,t,n){var i;n.$render=function(){var e=new mt(n.$viewValue);x(t.find("option"),(function(t){t.selected=D(e.get(t.value))}))},e.$watch((function(){K(i,n.$viewValue)||(i=Y(n.$viewValue),n.$render())})),t.on("change",(function(){e.$apply((function(){var e=[];x(t.find("option"),(function(t){t.selected&&e.push(t.value)})),n.$setViewValue(e)}))}))}(r,o,h):function(e,t,n,i){n.$render=function(){var e=n.$viewValue;i.hasOption(e)?(b.parent()&&b.remove(),t.val(e),""===e&&l.prop("selected",!0)):I(e)&&l?t.val(""):i.renderUnknownOption(e)},t.on("change",(function(){e.$apply((function(){b.parent()&&b.remove(),n.$setViewValue(t.val())}))}))}(r,o,h,d)}}}}],Ur=["$interpolate",function(e){var t={addOption:P,removeOption:P};return{restrict:"E",priority:100,compile:function(n,i){if(I(i.value)){var r=e(n.text(),!0);r||i.$set("value",n.text())}return function(e,n,i){var o=n.parent(),a=o.data("$selectController")||o.parent().data("$selectController");a&&a.databound||(a=t),r?e.$watch(r,(function(e,t){i.$set("value",e),t!==e&&a.removeOption(t),a.addOption(e,n)})):a.addOption(i.value,n),n.on("$destroy",(function(){a.removeOption(i.value)}))}}}}],Wr=O({restrict:"E",terminal:!1}),qr=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){i&&(n.required=!0,i.$validators.required=function(e,t){return!n.required||!i.$isEmpty(t)},n.$observe("required",(function(){i.$validate()})))}}},Gr=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var o,a=n.ngPattern||n.pattern;n.$observe("pattern",(function(e){if(N(e)&&e.length>0&&(e=new RegExp("^"+e+"$")),e&&!e.test)throw r("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",a,e,ae(t));o=e||void 0,i.$validate()})),i.$validators.pattern=function(e){return i.$isEmpty(e)||I(o)||o.test(e)}}}}},Zr=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var r=-1;n.$observe("maxlength",(function(e){var t=k(e);r=isNaN(t)?-1:t,i.$validate()})),i.$validators.maxlength=function(e,t){return r<0||i.$isEmpty(t)||t.length<=r}}}}},Xr=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var r=0;n.$observe("minlength",(function(e){r=k(e)||0,i.$validate()})),i.$validators.minlength=function(e,t){return i.$isEmpty(t)||t.length>=r}}}}};t.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):(_e||((d=e)&&d.fn.on?(u=d,C(d.fn,{scope:ct.scope,isolateScope:ct.isolateScope,controller:ct.controller,injector:ct.injector,inheritedData:ct.inheritedData}),Pr=d.cleanData,d.cleanData=function(e){var t;if(be)be=!1;else for(var n,i=0;null!=(n=e[i]);i++)(t=d._data(n,"events"))&&t.$destroy&&d(n).triggerHandler("$destroy");Pr(e)}):u=Ze,y.element=u,_e=!0),function(e){C(e,{bootstrap:fe,copy:Q,extend:C,equals:K,element:u,forEach:x,injector:wt,noop:P,bind:ne,toJson:re,fromJson:oe,identity:A,isUndefined:I,isDefined:D,isString:N,isFunction:H,isObject:$,isNumber:M,isElement:G,isArray:B,version:Ae,isDate:R,lowercase:a,uppercase:l,callbacks:{counter:0},getTestability:me,$$minErr:r,$$csp:J,reloadWithDebugInfo:ge}),h=function(e){var t=r("$injector"),n=r("ng");function i(e,t,n){return e[t]||(e[t]=n())}var o=i(e,"angular",Object);return o.$$minErr=o.$$minErr||r,i(o,"module",(function(){var e={};return function(r,o,a){return function(e,t){if("hasOwnProperty"===e)throw n("badname","hasOwnProperty is not a valid {0} name",t)}(r,"module"),o&&e.hasOwnProperty(r)&&(e[r]=null),i(e,r,(function(){if(!o)throw t("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",r);var e=[],n=[],i=[],s=c("$injector","invoke","push",n),l={_invokeQueue:e,_configBlocks:n,_runBlocks:i,requires:o,name:r,provider:c("$provide","provider"),factory:c("$provide","factory"),service:c("$provide","service"),value:c("$provide","value"),constant:c("$provide","constant","unshift"),animation:c("$animateProvider","register"),filter:c("$filterProvider","register"),controller:c("$controllerProvider","register"),directive:c("$compileProvider","directive"),config:s,run:function(e){return i.push(e),this}};return a&&s(a),l;function c(t,n,i,r){return r||(r=e),function(){return r[i||"push"]([t,n,arguments]),l}}}))}}))}(t);try{h("ngLocale")}catch(e){h("ngLocale",[]).provider("$locale",nn)}h("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:Gn}),e.provider("$compile",It).directive({a:Ai,input:Ji,textarea:Ji,form:Ni,script:zr,select:jr,style:Wr,option:Ur,ngBind:nr,ngBindHtml:rr,ngBindTemplate:ir,ngClass:sr,ngClassEven:cr,ngClassOdd:lr,ngCloak:ur,ngController:dr,ngForm:Mi,ngHide:$r,ngIf:fr,ngInclude:gr,ngInit:vr,ngNonBindable:Ar,ngPluralize:Or,ngRepeat:Ir,ngShow:Dr,ngStyle:Nr,ngSwitch:Mr,ngSwitchWhen:Rr,ngSwitchDefault:Br,ngOptions:Vr,ngTransclude:Hr,ngModel:Tr,ngList:yr,ngChange:or,pattern:Gr,ngPattern:Gr,required:qr,ngRequired:qr,minlength:Xr,ngMinlength:Xr,maxlength:Zr,ngMaxlength:Zr,ngValue:tr,ngModelOptions:Cr}).directive({ngInclude:mr}).directive(Oi).directive(hr),e.provider({$anchorScroll:St,$animate:Et,$browser:Lt,$cacheFactory:Pt,$controller:Bt,$document:Ht,$exceptionHandler:zt,$filter:li,$interpolate:en,$interval:tn,$http:Qt,$httpBackend:Kt,$location:_n,$log:xn,$parse:Fn,$rootScope:qn,$q:Vn,$$q:jn,$sce:Kn,$sceDelegate:Yn,$sniffer:Jn,$templateCache:At,$templateRequest:ei,$$testability:ti,$timeout:ni,$window:si,$$rAF:Wn,$$asyncCallback:Ct,$$jqLite:ft})}])}(y),u(n).ready((function(){pe(n,fe)})))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>')}).call(this,n(0))},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Disable Selection 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.fn.extend({disableSelection:(t="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(t+".ui-disableSelection",(function(e){e.preventDefault()}))}),enableSelection:function(){return this.off(".ui-disableSelection")}});var t})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Tabbable 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(10)],void 0===(o="function"==typeof(i=function(e){return e.extend(e.expr.pseudos,{tabbable:function(t){var n=e.attr(t,"tabindex"),i=null!=n;return(!i||n>=0)&&e.ui.focusable(t,i)}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){return e.ui.plugin={add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n,i){var r,o=e.plugins[t];if(o&&(i||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,n)}}})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Resizable 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(5),n(18),n(20),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.resizable",e.ui.mouse,{version:"1.14.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseFloat(e)||0},_isNumber:function(e){return!isNaN(parseFloat(e))},_hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;if(t[i]>0)return!0;try{t[i]=1,r=t[i]>0,t[i]=0}catch(e){}return r},_create:function(){var t,n=this.options,i=this;this._addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this._proportionallyResize()),this._setupHandles(),n.autoHide&&e(this.element).on("mouseenter",(function(){n.disabled||(i._removeClass("ui-resizable-autohide"),i._handles.show())})).on("mouseleave",(function(){n.disabled||i.resizing||(i._addClass("ui-resizable-autohide"),i._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy(),this._addedHandles.remove();var t,n=function(t){e(t).removeData("resizable").removeData("ui-resizable").off(".resizable")};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_setOption:function(e,t){switch(this._super(e,t),e){case"handles":this._removeHandles(),this._setupHandles();break;case"aspectRatio":this._aspectRatio=!!t}},_setupHandles:function(){var t,n,i,r,o,a=this.options,s=this;if(this.handles=a.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this._addedHandles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},n=0;n<i.length;n++)r="ui-resizable-"+(t=String.prototype.trim.call(i[n])),o=e("<div>"),this._addClass(o,"ui-resizable-handle "+r),o.css({zIndex:a.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.children(this.handles[t]).length||(this.element.append(o),this._addedHandles=this._addedHandles.add(o));this._renderAxis=function(t){var n,i,r,o;for(n in t=t||this.element,this.handles)this.handles[n].constructor===String?this.handles[n]=this.element.children(this.handles[n]).first().show():(this.handles[n].jquery||this.handles[n].nodeType)&&(this.handles[n]=e(this.handles[n]),this._on(this.handles[n],{mousedown:s._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=e(this.handles[n],this.element),o=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth(),r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(r,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[n])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",(function(){s.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=o&&o[1]?o[1]:"se")})),a.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(t){var n,i,r=!1;for(n in this.handles)((i=e(this.handles[n])[0])===t.target||e.contains(i,t.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(t){var n,i,r,o=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),n=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),o.containment&&(n+=e(o.containment).scrollLeft()||0,i+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:n,top:i},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===r?this.axis+"-resize":r),this._addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,i,r=this.originalMousePosition,o=this.axis,a=t.pageX-r.left||0,s=t.pageY-r.top||0,l=this._change[o];return this._updatePrevProperties(),!!l&&(n=l.apply(this,[t,a,s]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1)},_mouseStop:function(t){this.resizing=!1;var n,i,r,o,a,s,l,c=this.options;return this._helper&&(r=(i=(n=this._proportionallyResizeElements).length&&/textarea/i.test(n[0].nodeName))&&this._hasScroll(n[0],"left")?0:this.sizeDiff.height,o=i?0:this.sizeDiff.width,a={width:this.helper.width()-o,height:this.helper.height()-r},s=parseFloat(this.element.css("left"))+(this.position.left-this.originalPosition.left)||null,l=parseFloat(this.element.css("top"))+(this.position.top-this.originalPosition.top)||null,c.animate||this.element.css(e.extend(a,{top:l,left:s})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.helper.css(e),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px",this.helper.width(e.width)),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px",this.helper.height(e.height)),e},_updateVirtualBoundaries:function(e){var t,n,i,r,o,a=this.options;o={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,r=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),r<o.maxHeight&&(o.maxHeight=r)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,i=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===i&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===i&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,i=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,a=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,s=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,c=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return o&&(e.width=t.minWidth),a&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),r&&(e.height=t.maxHeight),o&&c&&(e.left=s-t.minWidth),i&&c&&(e.left=s-t.maxWidth),a&&u&&(e.top=l-t.minHeight),r&&u&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,n=[],i=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],r=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)n[t]=parseFloat(i[t])||0,n[t]+=parseFloat(r[t])||0;return{height:n[0]+n[2],width:n[1]+n[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,n=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:n.height()-this.outerDimensions.height||0,width:n.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div></div>").css({overflow:"hidden"}),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize;return{left:this.originalPosition.left+t,width:n.width-t}},n:function(e,t,n){var i=this.originalSize;return{top:this.originalPosition.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},sw:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,i]))},ne:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},nw:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,i]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).resizable("instance"),i=n.options,r=n._proportionallyResizeElements,o=r.length&&/textarea/i.test(r[0].nodeName),a=o&&n._hasScroll(r[0],"left")?0:n.sizeDiff.height,s=o?0:n.sizeDiff.width,l={width:n.size.width-s,height:n.size.height-a},c=parseFloat(n.element.css("left"))+(n.position.left-n.originalPosition.left)||null,u=parseFloat(n.element.css("top"))+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(l,u&&c?{top:u,left:c}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseFloat(n.element.css("width")),height:parseFloat(n.element.css("height")),top:parseFloat(n.element.css("top")),left:parseFloat(n.element.css("left"))};r&&r.length&&e(r[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,n,i,r,o,a,s,l=e(this).resizable("instance"),c=l.options,u=l.element,d=c.containment,h=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;h&&(l.containerElement=e(h),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(h),n=[],e(["Top","Right","Left","Bottom"]).each((function(e,i){n[e]=l._num(t.css("padding"+i))})),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-n[3],width:t.innerWidth()-n[1]},i=l.containerOffset,r=l.containerSize.height,o=l.containerSize.width,a=l._hasScroll(h,"left")?h.scrollWidth:o,s=l._hasScroll(h)?h.scrollHeight:r,l.parentData={element:h,left:i.left,top:i.top,width:a,height:s}))},resize:function(t){var n,i,r,o,a=e(this).resizable("instance"),s=a.options,l=a.containerOffset,c=a.position,u=a._aspectRatio||t.shiftKey,d={top:0,left:0},h=a.containerElement,p=!0;h[0]!==document&&/static/.test(h.css("position"))&&(d=l),c.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-d.left),u&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=s.helper?l.left:0),c.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),u&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?l.top:0),r=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),r&&o?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),n=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-d.left:a.offset.left-l.left)),i=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-d.top:a.offset.top-l.top)),n+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-n,u&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),i+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-i,u&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),n=t.options,i=t.containerOffset,r=t.containerPosition,o=t.containerElement,a=e(t.helper),s=a.offset(),l=a.outerWidth()-t.sizeDiff.width,c=a.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(o.css("position"))&&e(this).css({left:s.left-r.left-i.left,width:l,height:c}),t._helper&&!n.animate&&/static/.test(o.css("position"))&&e(this).css({left:s.left-r.left-i.left,width:l,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance").options;e(t.alsoResize).each((function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseFloat(t.css("width")),height:parseFloat(t.css("height")),left:parseFloat(t.css("left")),top:parseFloat(t.css("top"))})}))},resize:function(t,n){var i=e(this).resizable("instance"),r=i.options,o=i.originalSize,a=i.originalPosition,s={height:i.size.height-o.height||0,width:i.size.width-o.width||0,top:i.position.top-a.top||0,left:i.position.left-a.left||0};e(r.alsoResize).each((function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),r={},o=t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,(function(e,t){var n=(i[t]||0)+(s[t]||0);n&&n>=0&&(r[t]=n||null)})),t.css(r)}))},stop:function(){e(this).removeData("ui-resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}),t._addClass(t.ghost,"ui-resizable-ghost"),!0===e.uiBackCompat&&"string"==typeof t.options.ghost&&t.ghost.addClass(this.options.ghost),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,n=e(this).resizable("instance"),i=n.options,r=n.size,o=n.originalSize,a=n.originalPosition,s=n.axis,l="number"==typeof i.grid?[i.grid,i.grid]:i.grid,c=l[0]||1,u=l[1]||1,d=Math.round((r.width-o.width)/c)*c,h=Math.round((r.height-o.height)/u)*u,p=o.width+d,f=o.height+h,g=i.maxWidth&&i.maxWidth<p,m=i.maxHeight&&i.maxHeight<f,v=i.minWidth&&i.minWidth>p,y=i.minHeight&&i.minHeight>f;i.grid=l,v&&(p+=c),y&&(f+=u),g&&(p-=c),m&&(f-=u),/^(se|s|e)$/.test(s)?(n.size.width=p,n.size.height=f):/^(ne)$/.test(s)?(n.size.width=p,n.size.height=f,n.position.top=a.top-h):/^(sw)$/.test(s)?(n.size.width=p,n.size.height=f,n.position.left=a.left-d):((f-u<=0||p-c<=0)&&(t=n._getPaddingPlusBorderDimensions(this)),f-u>0?(n.size.height=f,n.position.top=a.top-h):(f=u-t.height,n.size.height=f,n.position.top=a.top+o.height-f),p-c>0?(n.size.width=p,n.position.left=a.left-d):(p=c-t.width,n.size.width=p,n.position.left=a.left+o.width-p))}}),e.ui.resizable})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Controlgroup 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(2)],void 0===(o="function"==typeof(i=function(e){var t=/ui-corner-([a-z]){2,6}/g;return e.widget("ui.controlgroup",{version:"1.14.0",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var t=this,n=[];e.each(this.options.items,(function(i,r){var o,a={};if(r)return"controlgroupLabel"===i?((o=t.element.find(r)).each((function(){var t=e(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")})),t._addClass(o,null,"ui-widget ui-widget-content ui-state-default"),void(n=n.concat(o.get()))):void(e.fn[i]&&(a=t["_"+i+"Options"]?t["_"+i+"Options"]("middle"):{classes:{}},t.element.find(r).each((function(){var r=e(this),o=r[i]("instance"),s=e.widget.extend({},a);if("button"!==i||!r.parent(".ui-spinner").length){o||(o=r[i]()[i]("instance")),o&&(s.classes=t._resolveClassesValues(s.classes,o)),r[i](s);var l=r[i]("widget");e.data(l[0],"ui-controlgroup-data",o||r[i]("instance")),n.push(l[0])}}))))})),this.childWidgets=e(e.uniqueSort(n)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(t){this.childWidgets.each((function(){var n=e(this).data("ui-controlgroup-data");n&&n[t]&&n[t]()}))},_updateCornerClass:function(e,t){var n=this._buildSimpleOptions(t,"label").classes.label;this._removeClass(e,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(e,null,n)},_buildSimpleOptions:function(e,t){var n="vertical"===this.options.direction,i={classes:{}};return i.classes[t]={middle:"",first:"ui-corner-"+(n?"top":"left"),last:"ui-corner-"+(n?"bottom":"right"),only:"ui-corner-all"}[e],i},_spinnerOptions:function(e){var t=this._buildSimpleOptions(e,"ui-spinner");return t.classes["ui-spinner-up"]="",t.classes["ui-spinner-down"]="",t},_buttonOptions:function(e){return this._buildSimpleOptions(e,"ui-button")},_checkboxradioOptions:function(e){return this._buildSimpleOptions(e,"ui-checkboxradio-label")},_selectmenuOptions:function(e){var t="vertical"===this.options.direction;return{width:!!t&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(t?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(t?"top":"left")},last:{"ui-selectmenu-button-open":t?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(t?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[e]}},_resolveClassesValues:function(n,i){var r={};return e.each(n,(function(e){var o=i.options.classes[e]||"";o=String.prototype.trim.call(o.replace(t,"")),r[e]=(o+" "+n[e]).replace(/\s+/g," ")})),r},_setOption:function(e,t){"direction"===e&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(e,t),"disabled"!==e?this.refresh():this._callChildMethod(t?"disable":"enable")},refresh:function(){var t,n=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),t=this.childWidgets,this.options.onlyVisible&&(t=t.filter(":visible")),t.length&&(e.each(["first","last"],(function(e,i){var r=t[i]().data("ui-controlgroup-data");if(r&&n["_"+r.widgetName+"Options"]){var o=n["_"+r.widgetName+"Options"](1===t.length?"only":i);o.classes=n._resolveClassesValues(o.classes,r),r.element[r.widgetName](o)}else n._updateCornerClass(t[i](),i)})),this._callChildMethod("refresh"))}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Checkboxradio 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(11),n(12),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.checkboxradio",[e.ui.formResetMixin,{version:"1.14.0",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,n,i,r=this._super()||{};return this._readType(),n=this.element.labels(),this.label=e(n[n.length-1]),this.label.length||e.error("No label found for checkboxradio widget"),this.originalLabel="",(i=this.label.contents().not(this.element[0])).length&&(this.originalLabel+=i.clone().wrapAll("<div></div>").parent().html()),this.originalLabel&&(r.label=this.originalLabel),null!=(t=this.element[0].disabled)&&(r.disabled=t),r},_create:function(){var e=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),e&&this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||e.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t=this.element[0].name,n="input[name='"+CSS.escape(t)+"']";return t?(this.form.length?e(this.form[0].elements).filter(n):e(n).filter((function(){return 0===e(e(this).prop("form")).length}))).not(this.element):e([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each((function(){var t=e(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")}))},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(e,t){if("label"!==e||t){if(this._super(e,t),"disabled"===e)return this._toggleClass(this.label,null,"ui-state-disabled",t),void(this.element[0].disabled=t);this.refresh()}},_updateIcon:function(t){var n="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=e("<span>"),this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(n+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):n+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",n),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var e=this.label.contents().not(this.element[0]);this.icon&&(e=e.not(this.icon[0])),this.iconSpace&&(e=e.not(this.iconSpace[0])),e.remove(),this.label.append(this.options.label)},refresh:function(){var e=this.element[0].checked,t=this.element[0].disabled;this._updateIcon(e),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),null!==this.options.label&&this._updateLabel(),t!==this.options.disabled&&this._setOptions({disabled:t})}}]),e.ui.checkboxradio})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Scale 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3),n(25)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("scale",(function(t,n){var i=e(this),r=t.mode,o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)||"effect"!==r?0:100),a=e.extend(!0,{from:e.effects.scaledDimensions(i),to:e.effects.scaledDimensions(i,o,t.direction||"both"),origin:t.origin||["middle","center"]},t);t.fade&&(a.from.opacity=1,a.to.opacity=0),e.effects.effect.size.call(this,a,n)}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Size 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("size",(function(t,n){var i,r,o,a=e(this),s=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],u=t.mode,d="effect"!==u,h=t.scale||"both",p=t.origin||["middle","center"],f=a.css("position"),g=a.position(),m=e.effects.scaledDimensions(a),v=t.from||m,y=t.to||e.effects.scaledDimensions(a,0);e.effects.createPlaceholder(a),"show"===u&&(o=v,v=y,y=o),r={from:{y:v.height/m.height,x:v.width/m.width},to:{y:y.height/m.height,x:y.width/m.width}},"box"!==h&&"both"!==h||(r.from.y!==r.to.y&&(v=e.effects.setTransition(a,l,r.from.y,v),y=e.effects.setTransition(a,l,r.to.y,y)),r.from.x!==r.to.x&&(v=e.effects.setTransition(a,c,r.from.x,v),y=e.effects.setTransition(a,c,r.to.x,y))),"content"!==h&&"both"!==h||r.from.y!==r.to.y&&(v=e.effects.setTransition(a,s,r.from.y,v),y=e.effects.setTransition(a,s,r.to.y,y)),p&&(i=e.effects.getBaseline(p,m),v.top=(m.outerHeight-v.outerHeight)*i.y+g.top,v.left=(m.outerWidth-v.outerWidth)*i.x+g.left,y.top=(m.outerHeight-y.outerHeight)*i.y+g.top,y.left=(m.outerWidth-y.outerWidth)*i.x+g.left),delete v.outerHeight,delete v.outerWidth,a.css(v),"content"!==h&&"both"!==h||(l=l.concat(["marginTop","marginBottom"]).concat(s),c=c.concat(["marginLeft","marginRight"]),a.find("*[width]").each((function(){var n=e(this),i=e.effects.scaledDimensions(n),o={height:i.height*r.from.y,width:i.width*r.from.x,outerHeight:i.outerHeight*r.from.y,outerWidth:i.outerWidth*r.from.x},a={height:i.height*r.to.y,width:i.width*r.to.x,outerHeight:i.height*r.to.y,outerWidth:i.width*r.to.x};r.from.y!==r.to.y&&(o=e.effects.setTransition(n,l,r.from.y,o),a=e.effects.setTransition(n,l,r.to.y,a)),r.from.x!==r.to.x&&(o=e.effects.setTransition(n,c,r.from.x,o),a=e.effects.setTransition(n,c,r.to.x,a)),d&&e.effects.saveStyle(n),n.css(o),n.animate(a,t.duration,t.easing,(function(){d&&e.effects.restoreStyle(n)}))}))),a.animate(y,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){var t=a.offset();0===y.opacity&&a.css("opacity",v.opacity),d||(a.css("position","static"===f?"relative":f).offset(t),e.effects.saveStyle(a)),n()}})}))})?i.apply(t,r):i)||(e.exports=o)}()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,$,fullScreenApi;//! openseadragon 2.4.2
//! Built on 2020-03-05
//! Git commit: v2.4.2-0-c450749
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function OpenSeadragon(e){return new OpenSeadragon.Viewer(e)}!function(e){e.version={versionStr:"2.4.2",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("2",10)};var t,n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},i=Object.prototype.toString,r=Object.prototype.hasOwnProperty;e.isFunction=function(t){return"function"===e.type(t)},e.isArray=Array.isArray||function(t){return"array"===e.type(t)},e.isWindow=function(e){return e&&"object"==typeof e&&"setInterval"in e},e.type=function(e){return null==e?String(e):n[i.call(e)]||"object"},e.isPlainObject=function(t){if(!t||"object"!==OpenSeadragon.type(t)||t.nodeType||e.isWindow(t))return!1;if(t.constructor&&!r.call(t,"constructor")&&!r.call(t.constructor.prototype,"isPrototypeOf"))return!1;var n;for(var i in t)n=i;return void 0===n||r.call(t,n)},e.isEmptyObject=function(e){for(var t in e)return!1;return!0},e.freezeObject=function(t){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(e){return e},e.freezeObject(t)},e.supportsCanvas=(t=document.createElement("canvas"),!(!e.isFunction(t.getContext)||!t.getContext("2d"))),e.isCanvasTainted=function(e){var t=!1;try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){t=!0}return t},e.pixelDensityRatio=function(){if(e.supportsCanvas){var t=document.createElement("canvas").getContext("2d"),n=window.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return Math.max(n,1)/i}return 1}()}(OpenSeadragon),function($){$.extend=function(){var e,t,n,i,r,o,a=arguments[0]||{},s=arguments.length,l=!1,c=1;for("boolean"==typeof a&&(l=a,a=arguments[1]||{},c=2),"object"==typeof a||OpenSeadragon.isFunction(a)||(a={}),s===c&&(a=this,--c);c<s;c++)if(null!==(e=arguments[c])||void 0!==e)for(t in e)n=a[t],a!==(i=e[t])&&(l&&i&&(OpenSeadragon.isPlainObject(i)||(r=OpenSeadragon.isArray(i)))?(r?(r=!1,o=n&&OpenSeadragon.isArray(n)?n:[]):o=n&&OpenSeadragon.isPlainObject(n)?n:{},a[t]=OpenSeadragon.extend(l,o,i)):void 0!==i&&(a[t]=i));return a};var isIOSDevice=function(){if("object"!=typeof navigator)return!1;var e=navigator.userAgent;return"string"==typeof e&&(-1!==e.indexOf("iPhone")||-1!==e.indexOf("iPad")||-1!==e.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(e,t){return function(){var n=arguments;return void 0===n&&(n=[]),t.apply(e,n)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return"string"==typeof e&&(e=document.getElementById(e)),e},getElementPosition:function(e){var t,n,i=new $.Point;for(n=getOffsetParent(e=$.getElement(e),t="fixed"==$.getElementStyle(e).position);n;)i.x+=e.offsetLeft,i.y+=e.offsetTop,t&&(i=i.plus($.getPageScroll())),n=getOffsetParent(e=n,t="fixed"==$.getElementStyle(e).position);return i},getElementOffset:function(e){var t,n,i=(e=$.getElement(e))&&e.ownerDocument,r={top:0,left:0};return i?(t=i.documentElement,void 0!==e.getBoundingClientRect&&(r=e.getBoundingClientRect()),n=i==i.window?i:9===i.nodeType&&(i.defaultView||i.parentWindow),new $.Point(r.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0),r.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0))):new $.Point},getElementSize:function(e){return e=$.getElement(e),new $.Point(e.clientWidth,e.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(e){return(e=$.getElement(e)).currentStyle}:function(e){return e=$.getElement(e),window.getComputedStyle(e,"")},getCssPropertyWithVendorPrefix:function(e){var t={};return $.getCssPropertyWithVendorPrefix=function(e){if(void 0!==t[e])return t[e];var n=document.createElement("div").style,i=null;if(void 0!==n[e])i=e;else for(var r=["Webkit","Moz","MS","O","webkit","moz","ms","o"],o=$.capitalizeFirstLetter(e),a=0;a<r.length;a++){var s=r[a]+o;if(void 0!==n[s]){i=s;break}}return t[e]=i,i},$.getCssPropertyWithVendorPrefix(e)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,t){var n=e%t;return n<0&&(n+=t),n},pointInElement:function(e,t){e=$.getElement(e);var n=$.getElementOffset(e),i=$.getElementSize(e);return t.x>=n.x&&t.x<n.x+i.x&&t.y<n.y+i.y&&t.y>=n.y},getEvent:function(e){return $.getEvent=e?function(e){return e}:function(){return window.event},$.getEvent(e)},getMousePosition:function(e){if("number"==typeof e.pageX)$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.pageX,t.y=e.pageY,t};else{if("number"!=typeof e.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop,t}}return $.getMousePosition(e)},getPageScroll:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(t.scrollLeft||t.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!e.scrollLeft&&!e.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(e){if(void 0!==window.scrollTo)$.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var t=$.getPageScroll();if(t.x===e.x&&t.y===e.y)return;document.body.scrollLeft=e.x,document.body.scrollTop=e.y;var n=$.getPageScroll();if(n.x!==t.x&&n.y!==t.y)return void($.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y});if(document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y,(n=$.getPageScroll()).x!==t.x&&n.y!==t.y)return void($.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y});$.setPageScroll=function(e){}}return $.setPageScroll(e)},getWindowSize:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(e.clientWidth||e.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!t.clientWidth&&!t.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(e){e=$.getElement(e);var t=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(t[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(t[1].style,{display:"table-row"}),$.extend(t[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),t[0].appendChild(t[1]),t[1].appendChild(t[2]),t[2].appendChild(e),t[0]},makeNeutralElement:function(e){var t=document.createElement(e),n=t.style;return n.background="transparent none",n.border="none",n.margin="0px",n.padding="0px",n.position="static",t},now:function(){return Date.now?$.now=Date.now:$.now=function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(e){return $.makeTransparentImage=function(e){var t=$.makeNeutralElement("img");return t.src=e,t},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(e){var t=$.makeNeutralElement("img"),n=null;return(n=$.makeNeutralElement("span")).style.display="inline-block",t.onload=function(){n.style.width=n.style.width||t.width+"px",n.style.height=n.style.height||t.height+"px",t.onload=null,t=null},t.src=e,n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale')",n}),$.makeTransparentImage(e)},setElementOpacity:function(e,t,n){var i;e=$.getElement(e),n&&!$.Browser.alpha&&(t=Math.round(t)),$.Browser.opacity?e.style.opacity=t<1?t:"":t<1?(i="alpha(opacity="+Math.round(100*t)+")",e.style.filter=i):e.style.filter=""},setElementTouchActionNone:function(e){void 0!==(e=$.getElement(e)).style.touchAction?e.style.touchAction="none":void 0!==e.style.msTouchAction&&(e.style.msTouchAction="none")},addClass:function(e,t){(e=$.getElement(e)).className?-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=" "+t):e.className=t},indexOf:function(e,t,n){return Array.prototype.indexOf?this.indexOf=function(e,t,n){return e.indexOf(t,n)}:this.indexOf=function(e,t,n){var i,r,o=n||0;if(!e)throw new TypeError;if(0===(r=e.length)||o>=r)return-1;for(o<0&&(o=r-Math.abs(o)),i=o;i<r;i++)if(e[i]===t)return i;return-1},this.indexOf(e,t,n)},removeClass:function(e,t){var n,i,r=[];for(n=(e=$.getElement(e)).className.split(/\s+/),i=0;i<n.length;i++)n[i]&&n[i]!==t&&r.push(n[i]);e.className=r.join(" ")},addEvent:function(){if(window.addEventListener)return function(e,t,n,i){(e=$.getElement(e)).addEventListener(t,n,i)};if(window.attachEvent)return function(e,t,n,i){(e=$.getElement(e)).attachEvent("on"+t,n)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(e,t,n,i){(e=$.getElement(e)).removeEventListener(t,n,i)};if(window.detachEvent)return function(e,t,n,i){(e=$.getElement(e)).detachEvent("on"+t,n)};throw new Error("No known event model.")}(),cancelEvent:function(e){(e=$.getEvent(e)).preventDefault?$.cancelEvent=function(e){e.preventDefault()}:$.cancelEvent=function(e){(e=$.getEvent(e)).cancel=!0,e.returnValue=!1},$.cancelEvent(e)},stopEvent:function(e){(e=$.getEvent(e)).stopPropagation?$.stopEvent=function(e){e.stopPropagation()}:$.stopEvent=function(e){(e=$.getEvent(e)).cancelBubble=!0},$.stopEvent(e)},createCallback:function(e,t){var n,i=[];for(n=2;n<arguments.length;n++)i.push(arguments[n]);return function(){var n,r=i.concat([]);for(n=0;n<arguments.length;n++)r.push(arguments[n]);return t.apply(e,r)}},getUrlParameter:function(e){var t=URLPARAMS[e];return t||null},getUrlProtocol:function(e){var t=e.match(/^([a-z]+:)\/\//i);return null===t?window.location.protocol:t[1].toLowerCase()},createAjaxRequest:function(e){var t;try{t=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}if(t)window.XMLHttpRequest?$.createAjaxRequest=function(e){return e?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(e)},makeAjaxRequest:function(e,t,n){var i,r,o;$.isPlainObject(e)&&(t=e.success,n=e.error,i=e.withCredentials,r=e.headers,o=e.responseType||null,e=e.url);var a=$.getUrlProtocol(e),s=$.createAjaxRequest("file:"===a);if(!$.isFunction(t))throw new Error("makeAjaxRequest requires a success callback");s.onreadystatechange=function(){4==s.readyState&&(s.onreadystatechange=function(){},s.status>=200&&s.status<300||0===s.status&&"http:"!==a&&"https:"!==a?t(s):($.console.log("AJAX request returned %d: %s",s.status,e),$.isFunction(n)&&n(s)))};try{if(s.open("GET",e,!0),o&&(s.responseType=o),r)for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&s.setRequestHeader(l,r[l]);i&&(s.withCredentials=!0),s.send(null)}catch(i){var c=i.message;if($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10&&void 0!==i.number&&-2147024891==i.number&&(c+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",i.name,c),s.onreadystatechange=function(){},window.XDomainRequest){var u=new window.XDomainRequest;if(u){u.onload=function(e){$.isFunction(t)&&t({responseText:u.responseText,status:200,statusText:"OK"})},u.onerror=function(e){$.isFunction(n)&&n({responseText:u.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{u.open("GET",e),u.send()}catch(e){$.isFunction(n)&&n(s,i)}}}else $.isFunction(n)&&n(s,i)}return s},jsonp:function(e){var t,n=e.url,i=document.head||document.getElementsByTagName("head")[0]||document.documentElement,r=e.callbackName||"openseadragon"+$.now(),o=window[r],a="$1"+r+"$2",s=e.param||"callback",l=e.callback;n=n.replace(/(\=)\?(&|$)|\?\?/i,a),n+=(/\?/.test(n)?"&":"?")+s+"="+r,window[r]=function(e){if(o)window[r]=o;else try{delete window[r]}catch(e){}l&&$.isFunction(l)&&l(e)},t=document.createElement("script"),void 0===e.async&&!1===e.async||(t.async="async"),e.scriptCharset&&(t.charset=e.scriptCharset),t.src=n,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,i&&t.parentNode&&i.removeChild(t),t=void 0)},i.insertBefore(t,i.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(e){if(window.DOMParser)$.parseXml=function(e){return(new DOMParser).parseFromString(e,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(e){var t=null;return(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t}}return $.parseXml(e)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(e){return!!FILEFORMATS[(e=e||"").toLowerCase()]}});var nullfunction=function(e){};$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};function getOffsetParent(e,t){return t&&e!=document.body?document.body:e.offsetParent}!function(){var e=navigator.appVersion,t=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(t.substring(t.indexOf("MSIE")+5,t.indexOf(";",t.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(t.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(t.substring(t.indexOf("Firefox")+8))):t.indexOf("Safari")>=0?($.Browser.vendor=t.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(t.substring(t.substring(0,t.indexOf("Safari")).lastIndexOf("/")+1,t.indexOf("Safari")))):null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(t)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1)));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(e)}var n,i,r,o=window.location.search.substring(1).split("&");for(r=0;r<o.length;r++)if((i=(n=o[r]).indexOf("="))>0){var a=n.substring(0,i),s=n.substring(i+1);try{URLPARAMS[a]=decodeURIComponent(s)}catch(e){$.console.error("Ignoring malformed URL parameter: %s=%s",a,s)}}$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)}(),function(e){var t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame,n=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.msCancelAnimationFrame;if(t&&n)$.requestAnimationFrame=function(){return t.apply(e,arguments)},$.cancelAnimationFrame=function(){return n.apply(e,arguments)};else{var i,r=[],o=[],a=0;$.requestAnimationFrame=function(e){return r.push([++a,e]),i||(i=setInterval((function(){if(r.length){var e=$.now(),t=o;for(o=r,r=t;o.length;)o.shift()[1](e)}else clearInterval(i),i=void 0}),20)),a},$.cancelAnimationFrame=function(e){var t,n;for(t=0,n=r.length;t<n;t+=1)if(r[t][0]===e)return void r.splice(t,1);for(t=0,n=o.length;t<n;t+=1)if(o[t][0]===e)return void o.splice(t,1)}}}(window)}(OpenSeadragon),__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(){return OpenSeadragon})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__),$=OpenSeadragon,fullScreenApi={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""},document.exitFullscreen?(fullScreenApi.supportsFullScreen=!0,fullScreenApi.getFullScreenElement=function(){return document.fullscreenElement},fullScreenApi.requestFullScreen=function(e){return e.requestFullscreen()},fullScreenApi.exitFullScreen=function(){document.exitFullscreen()},fullScreenApi.fullScreenEventName="fullscreenchange",fullScreenApi.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(fullScreenApi.supportsFullScreen=!0,fullScreenApi.getFullScreenElement=function(){return document.msFullscreenElement},fullScreenApi.requestFullScreen=function(e){return e.msRequestFullscreen()},fullScreenApi.exitFullScreen=function(){document.msExitFullscreen()},fullScreenApi.fullScreenEventName="MSFullscreenChange",fullScreenApi.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(fullScreenApi.supportsFullScreen=!0,fullScreenApi.getFullScreenElement=function(){return document.webkitFullscreenElement},fullScreenApi.requestFullScreen=function(e){return e.webkitRequestFullscreen()},fullScreenApi.exitFullScreen=function(){document.webkitExitFullscreen()},fullScreenApi.fullScreenEventName="webkitfullscreenchange",fullScreenApi.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(fullScreenApi.supportsFullScreen=!0,fullScreenApi.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},fullScreenApi.requestFullScreen=function(e){return e.webkitRequestFullScreen()},fullScreenApi.exitFullScreen=function(){document.webkitCancelFullScreen()},fullScreenApi.fullScreenEventName="webkitfullscreenchange",fullScreenApi.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(fullScreenApi.supportsFullScreen=!0,fullScreenApi.getFullScreenElement=function(){return document.mozFullScreenElement},fullScreenApi.requestFullScreen=function(e){return e.mozRequestFullScreen()},fullScreenApi.exitFullScreen=function(){document.mozCancelFullScreen()},fullScreenApi.fullScreenEventName="mozfullscreenchange",fullScreenApi.fullScreenErrorEventName="mozfullscreenerror"),fullScreenApi.isFullScreen=function(){return null!==fullScreenApi.getFullScreenElement()},fullScreenApi.cancelFullScreen=function(){$.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),fullScreenApi.exitFullScreen()},$.extend($,fullScreenApi),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addOnceHandler:function(e,t,n,i){var r=this;i=i||1;var o=0,a=function(n){++o===i&&r.removeHandler(e,a),t(n)};this.addHandler(e,a,n)},addHandler:function(t,n,i){var r=this.events[t];r||(this.events[t]=r=[]),n&&e.isFunction(n)&&(r[r.length]={handler:n,userData:i||null})},removeHandler:function(t,n){var i,r=this.events[t],o=[];if(r&&e.isArray(r)){for(i=0;i<r.length;i++)r[i].handler!==n&&o.push(r[i]);this.events[t]=o}},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var t in this.events)this.events[t]=[]},getHandler:function(e){var t=this.events[e];return t&&t.length?(t=1===t.length?[t[0]]:Array.apply(null,t),function(e,n){var i,r=t.length;for(i=0;i<r;i++)t[i]&&(n.eventSource=e,n.userData=t[i].userData,t[i].handler(n))}):null},raiseEvent:function(e,t){var n=this.getHandler(e);n&&(t||(t={}),n(this,t))}}}(OpenSeadragon),function(e){var t,n,i,r,o,a,s=[],l={};function c(t){var n,i=l[t.hash],r=i.activePointersLists.length;for(n=0;n<r;n++)i.activePointersLists[n].captureCount>0&&(e.removeEvent(e.MouseTracker.captureElement,"mousemove",i.mousemovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"mouseup",i.mouseupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",i.pointermovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",i.pointerupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchmove",i.touchmovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchend",i.touchendcaptured,!0),i.activePointersLists[n].captureCount=0);for(n=0;n<r;n++)i.activePointersLists.pop()}function u(t){var n,i,r=l[t.hash];if(r.tracking){for(i=0;i<e.MouseTracker.subscribeEvents.length;i++)n=e.MouseTracker.subscribeEvents[i],e.removeEvent(t.element,n,r[n],!1);c(t),r.tracking=!1}}function d(t,n){var i=l[t.hash];if("pointerevent"===n)return{upName:e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:i.pointerupcaptured,moveName:e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:i.pointermovecaptured};if("mouse"===n)return{upName:"mouseup",upHandler:i.mouseupcaptured,moveName:"mousemove",moveHandler:i.mousemovecaptured};if("touch"===n)return{upName:"touchend",upHandler:i.touchendcaptured,moveName:"touchmove",moveHandler:i.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function h(t,n,i){var r,o=t.getActivePointersListByType(n);o.captureCount+=i||1,1===o.captureCount&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?t.element.setCapture(!0):(r=d(t,e.MouseTracker.havePointerEvents?"pointerevent":n),ye&&be(window.top)&&e.addEvent(window.top,r.upName,r.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,r.upName,r.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,r.moveName,r.moveHandler,!0)))}function p(t,n,i){var r,o=t.getActivePointersListByType(n);o.captureCount-=i||1,0===o.captureCount&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?t.element.releaseCapture():(r=d(t,e.MouseTracker.havePointerEvents?"pointerevent":n),ye&&be(window.top)&&e.removeEvent(window.top,r.upName,r.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,r.moveName,r.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,r.upName,r.upHandler,!0)))}function f(t){var n;if(e.MouseTracker.unprefixedPointerEvents)n=t.pointerType;else switch(t.pointerType){case 2:n="touch";break;case 3:n="pen";break;case 4:n="mouse";break;default:n=""}return n}function g(t){return e.getMousePosition(t)}function m(e,t){return v(g(e),t)}function v(t,n){var i=e.getElementOffset(n);return t.minus(i)}function y(t,n){return new e.Point((t.x+n.x)/2,(t.y+n.y)/2)}function b(t,n){t.clickHandler&&e.cancelEvent(n)}function _(t,n){t.dblClickHandler&&e.cancelEvent(n)}function x(t,n){t.keyDownHandler&&(n=e.getEvent(n),t.keyDownHandler({eventSource:t,keyCode:n.keyCode?n.keyCode:n.charCode,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey,meta:n.metaKey,originalEvent:n,preventDefaultAction:!1,userData:t.userData})||e.cancelEvent(n))}function w(t,n){t.keyUpHandler&&(n=e.getEvent(n),t.keyUpHandler({eventSource:t,keyCode:n.keyCode?n.keyCode:n.charCode,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey,meta:n.metaKey,originalEvent:n,preventDefaultAction:!1,userData:t.userData})||e.cancelEvent(n))}function S(t,n){t.keyHandler&&(n=e.getEvent(n),t.keyHandler({eventSource:t,keyCode:n.keyCode?n.keyCode:n.charCode,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey,meta:n.metaKey,originalEvent:n,preventDefaultAction:!1,userData:t.userData})||e.cancelEvent(n))}function T(t,n){t.focusHandler&&(n=e.getEvent(n),!1===t.focusHandler({eventSource:t,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n))}function E(t,n){t.blurHandler&&(n=e.getEvent(n),!1===t.blurHandler({eventSource:t,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n))}function C(e,t){L(e,t,t)}function k(t,n){var i={target:(n=e.getEvent(n)).target||n.srcElement,type:"wheel",shiftKey:n.shiftKey||!1,clientX:n.clientX,clientY:n.clientY,pageX:n.pageX?n.pageX:n.clientX,pageY:n.pageY?n.pageY:n.clientY,deltaMode:"MozMousePixelScroll"==n.type?0:1,deltaX:0,deltaZ:0};"mousewheel"==e.MouseTracker.wheelEventName?i.deltaY=-n.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:i.deltaY=n.detail,L(t,i,n)}function L(t,n,i){var r;r=n.deltaY<0?1:-1,t.scrollHandler&&!1===t.scrollHandler({eventSource:t,pointerType:"mouse",position:m(n,t.element),scroll:r,shift:n.shiftKey,isTouchEvent:!1,originalEvent:i,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(i)}function P(e,t){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e}function A(t,n){I(t,n=e.getEvent(n))}function O(t,n){(n=e.getEvent(n)).currentTarget===n.relatedTarget||P(n.currentTarget,n.relatedTarget)||I(t,n)}function I(t,n){pe(t,n,[{id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(n),currentTime:e.now()}])}function D(t,n){N(t,n=e.getEvent(n))}function $(t,n){(n=e.getEvent(n)).currentTarget===n.relatedTarget||P(n.currentTarget,n.relatedTarget)||N(t,n)}function N(t,n){fe(t,n,[{id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(n),currentTime:e.now()}])}function M(t){return e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?1===t?0:2===t?2:4===t?1:-1:t}function R(t,n){ge(t,n=e.getEvent(n),[{id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(n),currentTime:e.now()}],M(n.button))&&(e.stopEvent(n),h(t,"mouse")),(t.clickHandler||t.dblClickHandler||t.pressHandler||t.dragHandler||t.dragEndHandler)&&e.cancelEvent(n)}function B(e,t){z(e,t)}function H(t,n){z(t,n),e.stopEvent(n)}function z(t,n){me(t,n=e.getEvent(n),[{id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(n),currentTime:e.now()}],M(n.button))&&p(t,"mouse")}function F(e,t){j(e,t)}function V(t,n){j(t,n),e.stopEvent(n)}function j(t,n){ve(t,n=e.getEvent(n),[{id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(n),currentTime:e.now()}])}function U(e,t,n){var i,r=n.getLength(),o=[];if("touch"===n.type||n.contacts>0){for(i=0;i<r;i++)o.push(n.getByIndex(i));o.length>0&&(me(e,t,o,0),n.captureCount=1,p(e,n.type),fe(e,t,o))}}function W(t,n){var i,r,o,a,l=n.changedTouches.length,c=[],u=t.getActivePointersListByType("touch");for(i=e.now(),u.getLength()>n.touches.length-l&&(e.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),U(t,n,u)),r=0;r<l;r++)c.push({id:n.changedTouches[r].identifier,type:"touch",currentPos:g(n.changedTouches[r]),currentTime:i});for(pe(t,n,c),r=0;r<s.length;r++)if(s[r]!==t&&s[r].isTracking()&&P(s[r].element,t.element)){for(a=[],o=0;o<l;o++)a.push({id:n.changedTouches[o].identifier,type:"touch",currentPos:g(n.changedTouches[o]),currentTime:i});pe(s[r],n,a)}ge(t,n,c,0)&&(e.stopEvent(n),h(t,"touch",l)),e.cancelEvent(n)}function q(e,t){Z(e,t)}function G(t,n){Z(t,n),e.stopEvent(n)}function Z(t,n){var i,r,o,a,l=n.changedTouches.length,c=[];for(i=e.now(),r=0;r<l;r++)c.push({id:n.changedTouches[r].identifier,type:"touch",currentPos:g(n.changedTouches[r]),currentTime:i});for(me(t,n,c,0)&&p(t,"touch",l),fe(t,n,c),r=0;r<s.length;r++)if(s[r]!==t&&s[r].isTracking()&&P(s[r].element,t.element)){for(a=[],o=0;o<l;o++)a.push({id:n.changedTouches[o].identifier,type:"touch",currentPos:g(n.changedTouches[o]),currentTime:i});fe(s[r],n,a)}e.cancelEvent(n)}function X(e,t){Y(e,t)}function Q(t,n){Y(t,n),e.stopEvent(n)}function Y(t,n){var i,r=n.changedTouches.length,o=[];for(i=0;i<r;i++)o.push({id:n.changedTouches[i].identifier,type:"touch",currentPos:g(n.changedTouches[i]),currentTime:e.now()});ve(t,n,o),e.cancelEvent(n)}function K(e,t){var n=e.getActivePointersListByType("touch");U(e,t,n)}function J(e,t){return t.stopPropagation(),t.preventDefault(),!1}function ee(e,t){return t.stopPropagation(),t.preventDefault(),!1}function te(t,n){n.currentTarget===n.relatedTarget||P(n.currentTarget,n.relatedTarget)||pe(t,n,[{id:n.pointerId,type:f(n),isPrimary:n.isPrimary,currentPos:g(n),currentTime:e.now()}])}function ne(t,n){n.currentTarget===n.relatedTarget||P(n.currentTarget,n.relatedTarget)||fe(t,n,[{id:n.pointerId,type:f(n),isPrimary:n.isPrimary,currentPos:g(n),currentTime:e.now()}])}function ie(t,n){var i;ge(t,n,[i={id:n.pointerId,type:f(n),isPrimary:n.isPrimary,currentPos:g(n),currentTime:e.now()}],n.button)&&(e.stopEvent(n),h(t,i.type)),(t.clickHandler||t.dblClickHandler||t.pressHandler||t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.cancelEvent(n)}function re(e,t){ae(e,t)}function oe(t,n){t.getActivePointersListByType(f(n)).getById(n.pointerId)&&ae(t,n),e.stopEvent(n)}function ae(t,n){var i;me(t,n,[i={id:n.pointerId,type:f(n),isPrimary:n.isPrimary,currentPos:g(n),currentTime:e.now()}],n.button)&&p(t,i.type)}function se(e,t){ce(e,t)}function le(t,n){t.getActivePointersListByType(f(n)).getById(n.pointerId)&&ce(t,n),e.stopEvent(n)}function ce(t,n){ve(t,n,[{id:n.pointerId,type:f(n),isPrimary:n.isPrimary,currentPos:g(n),currentTime:e.now()}])}function ue(e,t){!function(e,t,n){me(e,t,n,0),fe(e,t,n)}(e,t,[{id:t.pointerId,type:f(t)}])}function de(e,t){return Object.prototype.hasOwnProperty.call(t,"isPrimary")||(0===e.getLength()?t.isPrimary=!0:t.isPrimary=!1),t.speed=0,t.direction=0,t.contactPos=t.currentPos,t.contactTime=t.currentTime,t.lastPos=t.currentPos,t.lastTime=t.currentTime,e.add(t)}function he(e,t){var n,i;return e.getById(t.id)?(n=e.removeById(t.id),Object.prototype.hasOwnProperty.call(t,"isPrimary")||(i=e.getPrimary())||(i=e.getByIndex(0))&&(i.isPrimary=!0)):n=e.getLength(),n}function pe(t,n,i){var r,o,a,s=t.getActivePointersListByType(i[0].type),l=i.length;for(r=0;r<l;r++)o=i[r],(a=s.getById(o.id))?(a.insideElement=!0,a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=o.currentPos,a.currentTime=o.currentTime,o=a):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,de(s,o)),t.enterHandler&&!1===t.enterHandler({eventSource:t,pointerType:o.type,position:v(o.currentPos,t.element),buttons:s.buttons,pointers:t.getActivePointerCount(),insideElementPressed:o.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n)}function fe(t,n,i){var r,o,a,s=t.getActivePointersListByType(i[0].type),l=i.length;for(r=0;r<l;r++)o=i[r],(a=s.getById(o.id))&&(a.captured?(a.insideElement=!1,a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=o.currentPos,a.currentTime=o.currentTime):he(s,a),o=a),t.exitHandler&&!1===t.exitHandler({eventSource:t,pointerType:o.type,position:o.currentPos&&v(o.currentPos,t.element),buttons:s.buttons,pointers:t.getActivePointerCount(),insideElementPressed:!!a&&a.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n)}function ge(t,n,i,r){var o,a,s,c=l[t.hash],u=t.getActivePointersListByType(i[0].type),d=i.length;void 0!==n.buttons?u.buttons=n.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?0===r?u.buttons+=1:1===r?u.buttons+=4:2===r?u.buttons+=2:3===r?u.buttons+=8:4===r?u.buttons+=16:5===r&&(u.buttons+=32):0===r?u.buttons|=1:1===r?u.buttons|=4:2===r?u.buttons|=2:3===r?u.buttons|=8:4===r?u.buttons|=16:5===r&&(u.buttons|=32);var h=t.getActivePointersListsExceptType(i[0].type);for(o=0;o<h.length;o++)U(t,n,h[o]);if(0!==r)return t.nonPrimaryPressHandler&&!1===t.nonPrimaryPressHandler({eventSource:t,pointerType:i[0].type,position:v(i[0].currentPos,t.element),button:r,buttons:u.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n),!1;for(o=0;o<d;o++)a=i[o],(s=u.getById(a.id))?(s.captured=!0,s.insideElementPressed=!0,s.insideElement=!0,s.contactPos=a.currentPos,s.contactTime=a.currentTime,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=a.currentPos,s.currentTime=a.currentTime,a=s):(a.captured=!0,a.insideElementPressed=!0,a.insideElement=!0,de(u,a)),u.addContact(),(t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(t,a),1===u.contacts?t.pressHandler&&!1===t.pressHandler({eventSource:t,pointerType:a.type,position:v(a.contactPos,t.element),buttons:u.buttons,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n):2===u.contacts&&t.pinchHandler&&"touch"===a.type&&(c.pinchGPoints=u.asArray(),c.lastPinchDist=c.currentPinchDist=c.pinchGPoints[0].currentPos.distanceTo(c.pinchGPoints[1].currentPos),c.lastPinchCenter=c.currentPinchCenter=y(c.pinchGPoints[0].currentPos,c.pinchGPoints[1].currentPos));return!0}function me(t,n,i,r){var o,a,s,c,u,d,h=l[t.hash],p=t.getActivePointersListByType(i[0].type),f=i.length,g=!1,m=!1;if(void 0!==n.buttons?p.buttons=n.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?0===r?p.buttons-=1:1===r?p.buttons-=4:2===r?p.buttons-=2:3===r?p.buttons-=8:4===r?p.buttons-=16:5===r&&(p.buttons-=32):0===r?p.buttons^=-2:1===r?p.buttons^=-5:2===r?p.buttons^=-3:3===r?p.buttons^=-9:4===r?p.buttons^=-17:5===r&&(p.buttons^=-33),0!==r){t.nonPrimaryReleaseHandler&&!1===t.nonPrimaryReleaseHandler({eventSource:t,pointerType:i[0].type,position:v(i[0].currentPos,t.element),button:r,buttons:p.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n);var b=t.getActivePointersListByType("mouse");return U(t,n,b),!1}if(void 0===i[0].currentPos)return U(t,n,p),!1;for(s=0;s<f;s++)c=i[s],(u=p.getById(c.id))&&(u.captured&&(u.captured=!1,g=!0,m=!0),u.lastPos=u.currentPos,u.lastTime=u.currentTime,u.currentPos=c.currentPos,u.currentTime=c.currentTime,u.insideElement||he(p,u),o=u.currentPos,a=u.currentTime,m?(p.removeContact(),(t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(t,u),0===p.contacts?(t.releaseHandler&&!1===t.releaseHandler({eventSource:t,pointerType:u.type,position:v(o,t.element),buttons:p.buttons,insideElementPressed:u.insideElementPressed,insideElementReleased:u.insideElement,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n),t.dragEndHandler&&!u.currentPos.equals(u.contactPos)&&!1===t.dragEndHandler({eventSource:t,pointerType:u.type,position:v(u.currentPos,t.element),speed:u.speed,direction:u.direction,shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n),(t.clickHandler||t.dblClickHandler)&&u.insideElement&&(d=a-u.contactTime<=t.clickTimeThreshold&&u.contactPos.distanceTo(o)<=t.clickDistThreshold,t.clickHandler&&!1===t.clickHandler({eventSource:t,pointerType:u.type,position:v(u.currentPos,t.element),quick:d,shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n),t.dblClickHandler&&d&&(p.clicks++,1===p.clicks?(h.lastClickPos=o,h.dblClickTimeOut=setTimeout((function(){p.clicks=0}),t.dblClickTimeThreshold)):2===p.clicks&&(clearTimeout(h.dblClickTimeOut),p.clicks=0,h.lastClickPos.distanceTo(o)<=t.dblClickDistThreshold&&!1===t.dblClickHandler({eventSource:t,pointerType:u.type,position:v(u.currentPos,t.element),shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n),h.lastClickPos=null)))):2===p.contacts&&t.pinchHandler&&"touch"===u.type&&(h.pinchGPoints=p.asArray(),h.lastPinchDist=h.currentPinchDist=h.pinchGPoints[0].currentPos.distanceTo(h.pinchGPoints[1].currentPos),h.lastPinchCenter=h.currentPinchCenter=y(h.pinchGPoints[0].currentPos,h.pinchGPoints[1].currentPos))):t.releaseHandler&&!1===t.releaseHandler({eventSource:t,pointerType:u.type,position:v(o,t.element),buttons:p.buttons,insideElementPressed:u.insideElementPressed,insideElementReleased:u.insideElement,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n));return g}function ve(t,n,i){var r,o,a,s,c,u=l[t.hash],d=t.getActivePointersListByType(i[0].type),h=i.length;for(void 0!==n.buttons&&(d.buttons=n.buttons),r=0;r<h;r++)o=i[r],(a=d.getById(o.id))?(Object.prototype.hasOwnProperty.call(o,"isPrimary")&&(a.isPrimary=o.isPrimary),a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=o.currentPos,a.currentTime=o.currentTime):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,de(d,o));t.stopHandler&&"mouse"===i[0].type&&(clearTimeout(t.stopTimeOut),t.stopTimeOut=setTimeout((function(){!function(e,t,n){e.stopHandler&&e.stopHandler({eventSource:e,pointerType:n,position:m(t,e.element),buttons:e.getActivePointersListByType(n).buttons,isTouchEvent:"touch"===n,originalEvent:t,preventDefaultAction:!1,userData:e.userData})}(t,n,i[0].type)}),t.stopDelay)),0===d.contacts?t.moveHandler&&!1===t.moveHandler({eventSource:t,pointerType:i[0].type,position:v(i[0].currentPos,t.element),buttons:d.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n):1===d.contacts?(t.moveHandler&&(a=d.asArray()[0],!1===t.moveHandler({eventSource:t,pointerType:a.type,position:v(a.currentPos,t.element),buttons:d.buttons,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n)),t.dragHandler&&(c=(a=d.asArray()[0]).currentPos.minus(a.lastPos),!1===t.dragHandler({eventSource:t,pointerType:a.type,position:v(a.currentPos,t.element),buttons:d.buttons,delta:c,speed:a.speed,direction:a.direction,shift:n.shiftKey,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n))):2===d.contacts&&(t.moveHandler&&(s=d.asArray(),!1===t.moveHandler({eventSource:t,pointerType:s[0].type,position:v(y(s[0].currentPos,s[1].currentPos),t.element),buttons:d.buttons,isTouchEvent:"touch"===s[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n)),t.pinchHandler&&"touch"===i[0].type&&(c=u.pinchGPoints[0].currentPos.distanceTo(u.pinchGPoints[1].currentPos))!=u.currentPinchDist&&(u.lastPinchDist=u.currentPinchDist,u.currentPinchDist=c,u.lastPinchCenter=u.currentPinchCenter,u.currentPinchCenter=y(u.pinchGPoints[0].currentPos,u.pinchGPoints[1].currentPos),!1===t.pinchHandler({eventSource:t,pointerType:"touch",gesturePoints:u.pinchGPoints,lastCenter:v(u.lastPinchCenter,t.element),center:v(u.currentPinchCenter,t.element),lastDistance:u.lastPinchDist,distance:u.currentPinchDist,shift:n.shiftKey,originalEvent:n,preventDefaultAction:!1,userData:t.userData})&&e.cancelEvent(n)))}e.MouseTracker=function(t){s.push(this);var n=arguments;e.isPlainObject(t)||(t={element:n[0],clickTimeThreshold:n[1],clickDistThreshold:n[2]}),this.hash=Math.random(),this.element=e.getElement(t.element),this.clickTimeThreshold=t.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=t.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=t.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=t.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=t.userData||null,this.stopDelay=t.stopDelay||50,this.enterHandler=t.enterHandler||null,this.exitHandler=t.exitHandler||null,this.pressHandler=t.pressHandler||null,this.nonPrimaryPressHandler=t.nonPrimaryPressHandler||null,this.releaseHandler=t.releaseHandler||null,this.nonPrimaryReleaseHandler=t.nonPrimaryReleaseHandler||null,this.moveHandler=t.moveHandler||null,this.scrollHandler=t.scrollHandler||null,this.clickHandler=t.clickHandler||null,this.dblClickHandler=t.dblClickHandler||null,this.dragHandler=t.dragHandler||null,this.dragEndHandler=t.dragEndHandler||null,this.pinchHandler=t.pinchHandler||null,this.stopHandler=t.stopHandler||null,this.keyDownHandler=t.keyDownHandler||null,this.keyUpHandler=t.keyUpHandler||null,this.keyHandler=t.keyHandler||null,this.focusHandler=t.focusHandler||null,this.blurHandler=t.blurHandler||null;var i=this;l[this.hash]={click:function(e){b(i,e)},dblclick:function(e){_(i,e)},keydown:function(e){x(i,e)},keyup:function(e){w(i,e)},keypress:function(e){S(i,e)},focus:function(e){T(i,e)},blur:function(e){E(i,e)},wheel:function(e){C(i,e)},mousewheel:function(e){k(i,e)},DOMMouseScroll:function(e){k(i,e)},MozMousePixelScroll:function(e){k(i,e)},mouseenter:function(e){A(i,e)},mouseleave:function(e){D(i,e)},mouseover:function(e){O(i,e)},mouseout:function(e){$(i,e)},mousedown:function(e){R(i,e)},mouseup:function(e){B(i,e)},mouseupcaptured:function(e){H(i,e)},mousemove:function(e){F(i,e)},mousemovecaptured:function(e){V(i,e)},touchstart:function(e){W(i,e)},touchend:function(e){q(i,e)},touchendcaptured:function(e){G(i,e)},touchmove:function(e){X(i,e)},touchmovecaptured:function(e){Q(i,e)},touchcancel:function(e){K(i,e)},gesturestart:function(e){J(i,e)},gesturechange:function(e){ee(i,e)},pointerover:function(e){te(i,e)},MSPointerOver:function(e){te(i,e)},pointerout:function(e){ne(i,e)},MSPointerOut:function(e){ne(i,e)},pointerdown:function(e){ie(i,e)},MSPointerDown:function(e){ie(i,e)},pointerup:function(e){re(i,e)},MSPointerUp:function(e){re(i,e)},pointermove:function(e){se(i,e)},MSPointerMove:function(e){se(i,e)},pointercancel:function(e){ue(i,e)},MSPointerCancel:function(e){ue(i,e)},pointerupcaptured:function(e){oe(i,e)},pointermovecaptured:function(e){le(i,e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},t.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){var e;for(u(this),this.element=null,e=0;e<s.length;e++)if(s[e]===this){s.splice(e,1);break}l[this.hash]=null,delete l[this.hash]},isTracking:function(){return l[this.hash].tracking},setTracking:function(t){return t?function(t){var n,i,r=l[t.hash];if(!r.tracking){for(i=0;i<e.MouseTracker.subscribeEvents.length;i++)n=e.MouseTracker.subscribeEvents[i],e.addEvent(t.element,n,r[n],!1);c(t),r.tracking=!0}}(this):u(this),this},getActivePointersListsExceptType:function(e){for(var t=l[this.hash],n=[],i=0;i<t.activePointersLists.length;++i)t.activePointersLists[i].type!==e&&n.push(t.activePointersLists[i]);return n},getActivePointersListByType:function(t){var n,i,r=l[this.hash],o=r.activePointersLists.length;for(n=0;n<o;n++)if(r.activePointersLists[n].type===t)return r.activePointersLists[n];return i=new e.MouseTracker.GesturePointList(t),r.activePointersLists.push(i),i},getActivePointerCount:function(){var e,t=l[this.hash],n=t.activePointersLists.length,i=0;for(e=0;e<n;e++)i+=t.activePointersLists[e].getLength();return i},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},e.MouseTracker.resetAllMouseTrackers=function(){for(var e=0;e<s.length;e++)s[e].isTracking()&&(s[e].setTracking(!1),s[e].setTracking(!0))},e.MouseTracker.gesturePointVelocityTracker=(t=[],n=0,i=0,r=function(e,t){return e.hash.toString()+t.type+t.id.toString()},o=function(){var n,r,o,a,s,l,c=t.length,u=e.now();for(a=u-i,i=u,n=0;n<c;n++)(o=(r=t[n]).gPoint).direction=Math.atan2(o.currentPos.y-r.lastPos.y,o.currentPos.x-r.lastPos.x),s=r.lastPos.distanceTo(o.currentPos),r.lastPos=o.currentPos,l=1e3*s/(a+1),o.speed=.75*l+.25*o.speed},{addPoint:function(a,s){var l=r(a,s);t.push({guid:l,gPoint:s,lastPos:s.currentPos}),1===t.length&&(i=e.now(),n=window.setInterval(o,50))},removePoint:function(e,i){var o,a=r(e,i),s=t.length;for(o=0;o<s;o++)if(t[o].guid===a){t.splice(o,1),0==--s&&window.clearInterval(n);break}}}),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName=e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.MouseTracker.supportsMouseCapture=(a=document.createElement("div"),e.isFunction(a.setCapture)&&e.isFunction(a.releaseCapture)),e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",e.MouseTracker.wheelEventName],"DOMMouseScroll"==e.MouseTracker.wheelEventName&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||e.Browser.vendor!==e.BROWSERS.IE)?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),e.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):(e.MouseTracker.havePointerEvents=!1,e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?(e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),e.MouseTracker.haveMouseEnter=!0):(e.MouseTracker.subscribeEvents.push("mouseover","mouseout"),e.MouseTracker.haveMouseEnter=!1),e.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.maxTouchPoints=10),e.MouseTracker.GesturePointList=function(e){this._gPoints=[],this.type=e,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(e){return this._gPoints.push(e)},removeById:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].id===e){this._gPoints.splice(t,1);break}return this._gPoints.length},getByIndex:function(e){return e<this._gPoints.length?this._gPoints[e]:null},getById:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].id===e)return this._gPoints[t];return null},getPrimary:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].isPrimary)return this._gPoints[t];return null},addContact:function(){++this.contacts,this.contacts>1&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};var ye=function(){try{return window.self!==window.top}catch(e){return!0}}();function be(e){try{return e.addEventListener&&e.removeEventListener}catch(e){return!1}}}(OpenSeadragon),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(t,n,i){var r=t.parentNode;"number"==typeof n&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),n={anchor:n}),n.attachToViewer=void 0===n.attachToViewer||n.attachToViewer,this.autoFade=void 0===n.autoFade||n.autoFade,this.element=t,this.anchor=n.anchor,this.container=i,this.anchor==e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof n.top?n.top+"px":n.top,this.wrapper.style.left="number"==typeof n.left?n.left+"px":n.left,this.wrapper.style.height="number"==typeof n.height?n.height+"px":n.height,this.wrapper.style.width="number"==typeof n.width?n.width+"px":n.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),n.attachToViewer?this.anchor==e.ControlAnchor.TOP_RIGHT||this.anchor==e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):r.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(t){this.wrapper.style.display=t?this.anchor==e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(t){this.element[e.SIGNAL]&&e.Browser.vendor==e.BROWSERS.IE?e.setElementOpacity(this.element,t,!0):e.setElementOpacity(this.wrapper,t,!0)}}}(OpenSeadragon),function(e){function t(e,t){var n,i=e.controls;for(n=i.length-1;n>=0;n--)if(i[n].element==t)return n;return-1}e.ControlDock=function(t){var n,i,r=["topleft","topright","bottomright","bottomleft"];for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(1e6*Math.random()),container:e.makeNeutralElement("div"),controls:[]},t),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),i=0;i<r.length;i++)n=r[i],this.controls[n]=e.makeNeutralElement("div"),this.controls[n].style.position="absolute",n.match("left")&&(this.controls[n].style.left="0px"),n.match("right")&&(this.controls[n].style.right="0px"),n.match("top")&&(this.controls[n].style.top="0px"),n.match("bottom")&&(this.controls[n].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(n,i){var r=null;if(!(t(this,n=e.getElement(n))>=0)){switch(i.anchor){case e.ControlAnchor.TOP_RIGHT:r=this.controls.topright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:r=this.controls.bottomright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:r=this.controls.bottomleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:r=this.controls.topleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:r=this.container,n.style.margin="0px",n.style.padding="0px";break;default:case e.ControlAnchor.NONE:r=this.container,n.style.margin="0px",n.style.padding="0px"}this.controls.push(new e.Control(n,i,r)),n.style.display="inline-block"}},removeControl:function(n){var i=t(this,n=e.getElement(n));return i>=0&&(this.controls[i].destroy(),this.controls.splice(i,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var e;for(e=this.controls.length-1;e>=0;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){var t;for(t=this.controls.length-1;t>=0;t--)this.controls[t].setVisible(e);return this}}}(OpenSeadragon),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(e){var t={},n=1;function i(t){return t=e.getElement(t),new e.Point(0===t.clientWidth?1:t.clientWidth,0===t.clientHeight?1:t.clientHeight)}function r(t,n){if(n instanceof e.Overlay)return n;var i=null;if(n.element)i=e.getElement(n.element);else{var r=n.id?n.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());(i=e.getElement(n.id))||((i=document.createElement("a")).href="#/overlay/"+r),i.id=r,e.addClass(i,n.className?n.className:"openseadragon-overlay")}var o=n.location,a=n.width,s=n.height;if(!o){var l=n.x,c=n.y;if(void 0!==n.px){var u=t.viewport.imageToViewportRectangle(new e.Rect(n.px,n.py,a||0,s||0));l=u.x,c=u.y,a=void 0!==a?u.width:void 0,s=void 0!==s?u.height:void 0}o=new e.Point(l,c)}var d=n.placement;return d&&"string"===e.type(d)&&(d=e.Placement[n.placement.toUpperCase()]),new e.Overlay({element:i,location:o,placement:d,onDraw:n.onDraw,checkResize:n.checkResize,width:a,height:s,rotationMode:n.rotationMode})}function o(e,t){var n;for(n=e.length-1;n>=0;n--)if(e[n].element===t)return n;return-1}function a(t,n){return e.requestAnimationFrame((function(){n(t)}))}function s(t){e.requestAnimationFrame((function(){!function(t){var n,i,r,o;if(t.controlsShouldFade){for(n=e.now(),i=n-t.controlsFadeBeginTime,r=1-i/t.controlsFadeLength,r=Math.min(1,r),r=Math.max(0,r),o=t.controls.length-1;o>=0;o--)t.controls[o].autoFade&&t.controls[o].setOpacity(r);r>0&&s(t)}}(t)}))}function l(t){t.autoHideControls&&(t.controlsShouldFade=!0,t.controlsFadeBeginTime=e.now()+t.controlsFadeDelay,window.setTimeout((function(){s(t)}),t.controlsFadeDelay))}function c(e){var t;for(e.controlsShouldFade=!1,t=e.controls.length-1;t>=0;t--)e.controls[t].setOpacity(1)}function u(){c(this)}function d(){l(this)}function h(t){var n={originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction,preventVerticalPan:t.preventVerticalPan,preventHorizontalPan:t.preventHorizontalPan};if(this.raiseEvent("canvas-key",n),n.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 38:return n.preventVerticalPan||(t.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return n.preventVerticalPan||(t.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}}function p(t){var n={originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction,preventVerticalPan:t.preventVerticalPan,preventHorizontalPan:t.preventHorizontalPan};if(this.raiseEvent("canvas-key",n),n.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return n.preventVerticalPan||(t.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return n.preventVerticalPan||(t.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}}function f(e){var t;document.activeElement==this.canvas||this.canvas.focus(),this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var n={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-click",n),!n.preventDefaultAction&&this.viewport&&e.quick&&(t=this.gestureSettingsByDeviceType(e.pointerType)).clickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function g(e){var t,n={tracker:e.eventSource,position:e.position,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-double-click",n),!n.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType)).dblClickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function m(e){var t,n={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.raiseEvent("canvas-drag",n),!n.preventDefaultAction&&this.viewport){if(t=this.gestureSettingsByDeviceType(e.pointerType),this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.flipped&&(e.delta.x=-e.delta.x),this.constrainDuringPan){var i=this.viewport.deltaPointsFromPixels(e.delta.negate());this.viewport.centerSpringX.target.value+=i.x,this.viewport.centerSpringY.target.value+=i.y;var r=this.viewport.getBounds(),o=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=i.x,this.viewport.centerSpringY.target.value-=i.y,r.x!=o.x&&(e.delta.x=0),r.y!=o.y&&(e.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate()),t.flickEnabled&&!this.constrainDuringPan)}}function v(t){if(!t.preventDefaultAction&&this.viewport){var n=this.gestureSettingsByDeviceType(t.pointerType);if(n.flickEnabled&&t.speed>=n.flickMinSpeed){var i=0;this.panHorizontal&&(i=n.flickMomentum*t.speed*Math.cos(t.direction));var r=0;this.panVertical&&(r=n.flickMomentum*t.speed*Math.sin(t.direction));var o=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),a=this.viewport.pointFromPixel(new e.Point(o.x-i,o.y-r));this.viewport.panTo(a,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:t.eventSource,position:t.position,speed:t.speed,direction:t.direction,shift:t.shift,originalEvent:t.originalEvent})}function y(e){this.raiseEvent("canvas-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function b(t){window.location!=window.parent.location&&e.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function _(e){this.raiseEvent("canvas-press",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function x(e){this.raiseEvent("canvas-release",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function w(e){this.raiseEvent("canvas-nonprimary-press",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function S(e){this.raiseEvent("canvas-nonprimary-release",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function T(e){var t,n,i;if(!e.preventDefaultAction&&this.viewport&&((t=this.gestureSettingsByDeviceType(e.pointerType)).pinchToZoom&&(n=this.viewport.pointFromPixel(e.center,!0),i=this.viewport.pointFromPixel(e.lastCenter,!0).minus(n),this.panHorizontal||(i.x=0),this.panVertical||(i.y=0),this.viewport.zoomBy(e.distance/e.lastDistance,n,!0),t.zoomToRefPoint&&this.viewport.panBy(i,!0),this.viewport.applyConstraints()),t.pinchRotate)){var r=Math.atan2(e.gesturePoints[0].currentPos.y-e.gesturePoints[1].currentPos.y,e.gesturePoints[0].currentPos.x-e.gesturePoints[1].currentPos.x),o=Math.atan2(e.gesturePoints[0].lastPos.y-e.gesturePoints[1].lastPos.y,e.gesturePoints[0].lastPos.x-e.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(r-o)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:e.eventSource,gesturePoints:e.gesturePoints,lastCenter:e.lastCenter,center:e.center,lastDistance:e.lastDistance,distance:e.distance,shift:e.shift,originalEvent:e.originalEvent}),!1}function E(t){var n,i,r;if((r=e.now())-this._lastScrollTime>this.minScrollDeltaTime){if(this._lastScrollTime=r,this.viewport.flipped&&(t.position.x=this.viewport.getContainerSize().x-t.position.x),!t.preventDefaultAction&&this.viewport&&(n=this.gestureSettingsByDeviceType(t.pointerType)).scrollToZoom&&(i=Math.pow(this.zoomPerScroll,t.scroll),this.viewport.zoomBy(i,n.zoomToRefPoint?this.viewport.pointFromPixel(t.position,!0):null),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:t.eventSource,position:t.position,scroll:t.scroll,shift:t.shift,originalEvent:t.originalEvent}),n&&n.scrollToZoom)return!1}else if((n=this.gestureSettingsByDeviceType(t.pointerType))&&n.scrollToZoom)return!1}function C(e){t[this.hash].mouseInside=!0,c(this),this.raiseEvent("container-enter",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function k(e){e.pointers<1&&(t[this.hash].mouseInside=!1,t[this.hash].animating||l(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function L(e){!function(e){if(e._opening)return;if(e.autoResize){var n=i(e.container),r=t[e.hash].prevContainerSize;if(!n.equals(r)){var o=e.viewport;if(e.preserveImageSizeOnResize){var a=r.x/n.x,s=o.getZoom()*a,u=o.getCenter();o.resize(n,!1),o.zoomTo(s,null,!0),o.panTo(u,!0)}else{var d=o.getBounds();o.resize(n,!0),o.fitBoundsWithConstraints(d,!0)}t[e.hash].prevContainerSize=n,t[e.hash].forceRedraw=!0}}var h=e.viewport.update(),p=e.world.update()||h;h&&e.raiseEvent("viewport-change");e.referenceStrip&&(p=e.referenceStrip.update(e.viewport)||p);!t[e.hash].animating&&p&&(e.raiseEvent("animation-start"),c(e));(p||t[e.hash].forceRedraw||e.world.needsDraw())&&(!function(e){e.imageLoader.clear(),e.drawer.clear(),e.world.draw(),e.raiseEvent("update-viewport",{})}(e),e._drawOverlays(),e.navigator&&e.navigator.update(e.viewport),t[e.hash].forceRedraw=!1,p&&e.raiseEvent("animation"));t[e.hash].animating&&!p&&(e.raiseEvent("animation-finish"),t[e.hash].mouseInside||l(e));t[e.hash].animating=p}(e),e.isOpen()?e._updateRequestId=a(e,L):e._updateRequestId=!1}function P(e,t){return e?e+t:t}function A(){t[this.hash].lastZoomTime=e.now(),t[this.hash].zoomFactor=this.zoomPerSecond,t[this.hash].zooming=!0,D(this)}function O(){t[this.hash].lastZoomTime=e.now(),t[this.hash].zoomFactor=1/this.zoomPerSecond,t[this.hash].zooming=!0,D(this)}function I(){t[this.hash].zooming=!1}function D(t){e.requestAnimationFrame(e.delegate(t,$))}function $(){var n,i,r;t[this.hash].zooming&&this.viewport&&(i=(n=e.now())-t[this.hash].lastZoomTime,r=Math.pow(t[this.hash].zoomFactor,i/1e3),this.viewport.zoomBy(r),this.viewport.applyConstraints(),t[this.hash].lastZoomTime=n,D(this))}function N(){this.viewport&&(t[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function M(){this.viewport&&(t[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function R(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function B(){this.viewport&&this.viewport.goHome()}function H(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function z(){if(this.viewport){var t=this.viewport.getRotation();t=this.viewport.flipped?e.positiveModulo(t+this.rotationIncrement,360):e.positiveModulo(t-this.rotationIncrement,360),this.viewport.setRotation(t)}}function F(){if(this.viewport){var t=this.viewport.getRotation();t=this.viewport.flipped?e.positiveModulo(t-this.rotationIncrement,360):e.positiveModulo(t+this.rotationIncrement,360),this.viewport.setRotation(t)}}function V(){this.viewport.toggleFlip()}function j(){var e=this._sequenceIndex-1;this.navPrevNextWrap&&e<0&&(e+=this.tileSources.length),this.goToPage(e)}function U(){var e=this._sequenceIndex+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)}e.Viewer=function(r){var o,s,c=arguments,u=this;if(e.isPlainObject(r)||(r={id:c[0],xmlPath:c.length>1?c[1]:void 0,prefixUrl:c.length>2?c[2]:void 0,controls:c.length>3?c[3]:void 0,overlays:c.length>4?c[4]:void 0}),r.config&&(e.extend(!0,r,r.config),delete r.config),e.extend(!0,this,{id:r.id,hash:r.hash||n++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},e.DEFAULT_SETTINGS,r),void 0===this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(void 0!==t[this.hash]&&e.console.warn("Hash "+this.hash+" has already been used."),t[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",(function(t){var n=e.getString("Errors.OpenFailed",t.eventSource,t.message);u._showMessage(n)})),e.ControlDock.call(this,r),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(s=this.canvas.style).width="100%",s.height="100%",s.overflow="hidden",s.position="absolute",s.top="0px",s.left="0px",e.setElementTouchActionNone(this.canvas),""!==r.tabIndex&&(this.canvas.tabIndex=void 0===r.tabIndex?0:r.tabIndex),this.container.className="openseadragon-container",function(e){e.width="100%",e.height="100%",e.position="relative",e.overflow="hidden",e.left="0px",e.top="0px",e.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:e.delegate(this,h),keyHandler:e.delegate(this,p),clickHandler:e.delegate(this,f),dblClickHandler:e.delegate(this,g),dragHandler:e.delegate(this,m),dragEndHandler:e.delegate(this,v),enterHandler:e.delegate(this,y),exitHandler:e.delegate(this,b),pressHandler:e.delegate(this,_),releaseHandler:e.delegate(this,x),nonPrimaryPressHandler:e.delegate(this,w),nonPrimaryReleaseHandler:e.delegate(this,S),scrollHandler:e.delegate(this,E),pinchHandler:e.delegate(this,T)}),this.outerTracker=new e.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,C),exitHandler:e.delegate(this,k)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),t[this.hash].prevContainerSize=i(this.container),this.world=new e.World({viewer:this}),this.world.addHandler("add-item",(function(e){u.source=u.world.getItemAt(0).source,t[u.hash].forceRedraw=!0,u._updateRequestId||(u._updateRequestId=a(u,L))})),this.world.addHandler("remove-item",(function(e){u.world.getItemCount()?u.source=u.world.getItemAt(0).source:u.source=null,t[u.hash].forceRedraw=!0})),this.world.addHandler("metrics-change",(function(e){u.viewport&&u.viewport._setContentBounds(u.world.getHomeBounds(),u.world.getContentFactor())})),this.world.addHandler("item-index-change",(function(e){u.source=u.world.getItemAt(0).source})),this.viewport=new e.Viewport({containerSize:t[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:r.timeout}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new e.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(o=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(o,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(o=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(o,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new e.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),o=0;o<this.customControls.length;o++)this.addControl(this.customControls[o].id,{anchor:this.customControls[o].anchor});e.requestAnimationFrame((function(){l(u)})),void 0===this.imageSmoothingEnabled||this.imageSmoothingEnabled||this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled)},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(t){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(t)},openTileSource:function(t){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(t)},open:function(t,n){var i=this;if(this.close(),t){if(this.sequenceMode&&e.isArray(t))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0===n||isNaN(n)||(this.initialPage=n),this.tileSources=t,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(e.isArray(t)||(t=[t]),t.length){this._opening=!0;for(var o,a=t.length,s=0,l=0,c=function(){if(s+l===a)if(s){!i._firstOpen&&i.preserveViewport||(i.viewport.goHome(!0),i.viewport.update()),i._firstOpen=!1;var e=t[0];if(e.tileSource&&(e=e.tileSource),i.overlays&&!i.preserveOverlays)for(var n=0;n<i.overlays.length;n++)i.currentOverlays[n]=r(i,i.overlays[n]);i._drawOverlays(),i._opening=!1,i.raiseEvent("open",{source:e})}else i._opening=!1,i.raiseEvent("open-failed",o)},u=function(t){e.isPlainObject(t)&&t.tileSource||(t={tileSource:t}),void 0!==t.index&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete t.index),void 0===t.collectionImmediately&&(t.collectionImmediately=!0);var n=t.success;t.success=function(e){if(s++,t.tileSource.overlays)for(var r=0;r<t.tileSource.overlays.length;r++)i.addOverlay(t.tileSource.overlays[r]);n&&n(e),c()};var r=t.error;t.error=function(e){l++,o||(o=e),r&&r(e),c()},i.addTiledImage(t)},d=0;d<t.length;d++)u(t[d]);return this}}},close:function(){return t[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),t[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(t[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),t[this.hash]=null,delete t[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.outerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){var e,t=this.controls.length;for(e=0;e<this.controls.length;e++)t=t&&this.controls[e].isVisible();return t},setControlsEnabled:function(e){return e?c(this):l(this),this.raiseEvent("controls-enabled",{enabled:e}),this},setDebugMode:function(e){for(var t=0;t<this.world.getItemCount();t++)this.world.getItemAt(t).debugMode=e;this.debugMode=e,this.forceRedraw()},isFullPage:function(){return t[this.hash].fullPage},setFullPage:function(n){var i,r,o=document.body,a=o.style,s=document.documentElement.style,l=this;if(n==this.isFullPage())return this;var c={fullPage:n,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",c),c.preventDefaultAction)return this;if(n){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=a.margin,this.docMargin=s.margin,a.margin="0",s.margin="0",this.bodyPadding=a.padding,this.docPadding=s.padding,a.padding="0",s.padding="0",this.bodyWidth=a.width,this.docWidth=s.width,a.width="100%",s.width="100%",this.bodyHeight=a.height,this.docHeight=s.height,a.height="100%",s.height="100%",this.previousBody=[],t[this.hash].prevElementParent=this.element.parentNode,t[this.hash].prevNextSibling=this.element.nextSibling,t[this.hash].prevElementWidth=this.element.style.width,t[this.hash].prevElementHeight=this.element.style.height,i=o.childNodes.length,r=0;r<i;r++)this.previousBody.push(o.childNodes[0]),o.removeChild(o.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,o.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),o.appendChild(this.element),this.element.style.height=e.getWindowSize().y+"px",this.element.style.width=e.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),t[this.hash].fullPage=!0,e.delegate(this,C)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,a.margin=this.bodyMargin,s.margin=this.docMargin,a.padding=this.bodyPadding,s.padding=this.docPadding,a.width=this.bodyWidth,s.width=this.docWidth,a.height=this.bodyHeight,s.height=this.docHeight,o.removeChild(this.element),i=this.previousBody.length,r=0;r<i;r++)o.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),t[this.hash].prevElementParent.insertBefore(this.element,t[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(o.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=t[this.hash].prevElementWidth,this.element.style.height=t[this.hash].prevElementHeight;var u=0,d=function(){e.setPageScroll(l.pageScroll);var t=e.getPageScroll();++u<10&&(t.x!==l.pageScroll.x||t.y!==l.pageScroll.y)&&e.requestAnimationFrame(d)};e.requestAnimationFrame(d),t[this.hash].fullPage=!1,e.delegate(this,k)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:n}),this},setFullScreen:function(t){var n=this;if(!e.supportsFullScreen)return this.setFullPage(t);if(e.isFullScreen()===t)return this;var i={fullScreen:t,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",i),i.preventDefaultAction)return this;if(t){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var r=function(){var t=e.isFullScreen();t||(e.removeEvent(document,e.fullScreenEventName,r),e.removeEvent(document,e.fullScreenErrorEventName,r),n.setFullPage(!1),n.isFullPage()&&(n.element.style.width=n.fullPageStyleWidth,n.element.style.height=n.fullPageStyleHeight)),n.navigator&&n.viewport&&setTimeout((function(){n.navigator.update(n.viewport)})),n.raiseEvent("full-screen",{fullScreen:t})};e.addEvent(document,e.fullScreenEventName,r),e.addEvent(document,e.fullScreenErrorEventName,r),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},addTiledImage:function(t){e.console.assert(t,"[Viewer.addTiledImage] options is required"),e.console.assert(t.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!t.replace||t.index>-1&&t.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var n=this;t.replace&&(t.replaceItem=n.world.getItemAt(t.index)),this._hideMessage(),void 0===t.placeholderFillStyle&&(t.placeholderFillStyle=this.placeholderFillStyle),void 0===t.opacity&&(t.opacity=this.opacity),void 0===t.preload&&(t.preload=this.preload),void 0===t.compositeOperation&&(t.compositeOperation=this.compositeOperation),void 0===t.crossOriginPolicy&&(t.crossOriginPolicy=void 0!==t.tileSource.crossOriginPolicy?t.tileSource.crossOriginPolicy:this.crossOriginPolicy),void 0===t.ajaxWithCredentials&&(t.ajaxWithCredentials=this.ajaxWithCredentials),void 0===t.loadTilesWithAjax&&(t.loadTilesWithAjax=this.loadTilesWithAjax),void 0===t.ajaxHeaders||null===t.ajaxHeaders?t.ajaxHeaders=this.ajaxHeaders:e.isPlainObject(t.ajaxHeaders)&&e.isPlainObject(this.ajaxHeaders)&&(t.ajaxHeaders=e.extend({},this.ajaxHeaders,t.ajaxHeaders));var i={options:t};function r(e){for(var r=0;r<n._loadQueue.length;r++)if(n._loadQueue[r]===i){n._loadQueue.splice(r,1);break}0===n._loadQueue.length&&o(i),n.raiseEvent("add-item-failed",e),t.error&&t.error(e)}function o(e){n.collectionMode&&(n.world.arrange({immediately:e.options.collectionImmediately,rows:n.collectionRows,columns:n.collectionColumns,layout:n.collectionLayout,tileSize:n.collectionTileSize,tileMargin:n.collectionTileMargin}),n.world.setAutoRefigureSizes(!0))}function a(){for(var t,i,r;n._loadQueue.length&&(t=n._loadQueue[0]).tileSource;){if(n._loadQueue.splice(0,1),t.options.replace){var a=n.world.getIndexOfItem(t.options.replaceItem);-1!=a&&(t.options.index=a),n.world.removeItem(t.options.replaceItem)}i=new e.TiledImage({viewer:n,source:t.tileSource,viewport:n.viewport,drawer:n.drawer,tileCache:n.tileCache,imageLoader:n.imageLoader,x:t.options.x,y:t.options.y,width:t.options.width,height:t.options.height,fitBounds:t.options.fitBounds,fitBoundsPlacement:t.options.fitBoundsPlacement,clip:t.options.clip,placeholderFillStyle:t.options.placeholderFillStyle,opacity:t.options.opacity,preload:t.options.preload,degrees:t.options.degrees,compositeOperation:t.options.compositeOperation,springStiffness:n.springStiffness,animationTime:n.animationTime,minZoomImageRatio:n.minZoomImageRatio,wrapHorizontal:n.wrapHorizontal,wrapVertical:n.wrapVertical,immediateRender:n.immediateRender,blendTime:n.blendTime,alwaysBlend:n.alwaysBlend,minPixelRatio:n.minPixelRatio,smoothTileEdgesMinZoom:n.smoothTileEdgesMinZoom,iOSDevice:n.iOSDevice,crossOriginPolicy:t.options.crossOriginPolicy,ajaxWithCredentials:t.options.ajaxWithCredentials,loadTilesWithAjax:t.options.loadTilesWithAjax,ajaxHeaders:t.options.ajaxHeaders,debugMode:n.debugMode}),n.collectionMode&&n.world.setAutoRefigureSizes(!1),n.world.addItem(i,{index:t.options.index}),0===n._loadQueue.length&&o(t),1!==n.world.getItemCount()||n.preserveViewport||n.viewport.goHome(!0),n.navigator&&(r=e.extend({},t.options,{replace:!1,originalTiledImage:i,tileSource:t.tileSource}),n.navigator.addTiledImage(r)),t.options.success&&t.options.success({item:i})}}e.isArray(t.tileSource)?setTimeout((function(){r({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:t.tileSource,options:t})})):(this._loadQueue.push(i),function(t,n,i,r,o){var a=t;if("string"==e.type(n))if(n.match(/^\s*<.*>\s*$/))n=e.parseXml(n);else if(n.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var s=e.parseJSON(n);n=s}catch(e){}function l(e,t){e.ready?r(e):(e.addHandler("ready",(function(){r(e)})),e.addHandler("open-failed",(function(e){o({message:e.message,source:t})})))}setTimeout((function(){if("string"==e.type(n))(n=new e.TileSource({url:n,crossOriginPolicy:void 0!==i.crossOriginPolicy?i.crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,ajaxHeaders:t.ajaxHeaders,useCanvas:t.useCanvas,success:function(e){r(e.tileSource)}})).addHandler("open-failed",(function(e){o(e)}));else if(e.isPlainObject(n)||n.nodeType)if(void 0!==n.crossOriginPolicy||void 0===i.crossOriginPolicy&&void 0===t.crossOriginPolicy||(n.crossOriginPolicy=void 0!==i.crossOriginPolicy?i.crossOriginPolicy:t.crossOriginPolicy),void 0===n.ajaxWithCredentials&&(n.ajaxWithCredentials=t.ajaxWithCredentials),void 0===n.useCanvas&&(n.useCanvas=t.useCanvas),e.isFunction(n.getTileUrl)){var s=new e.TileSource(n);s.getTileUrl=n.getTileUrl,r(s)}else{var c=e.TileSource.determineType(a,n);if(!c)return void o({message:"Unable to load TileSource",source:n});var u=c.prototype.configure.apply(a,[n]);l(new c(u),n)}else l(n,n)}))}(this,t.tileSource,t,(function(e){i.tileSource=e,a()}),(function(e){e.options=t,r(e),a()})))},addSimpleImage:function(t){e.console.assert(t,"[Viewer.addSimpleImage] options is required"),e.console.assert(t.url,"[Viewer.addSimpleImage] options.url is required");var n=e.extend({},t,{tileSource:{type:"image",url:t.url}});delete n.url,this.addTiledImage(n)},addLayer:function(t){var n=this;e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var i=e.extend({},t,{success:function(e){n.raiseEvent("add-layer",{options:t,drawer:e.item})},error:function(e){n.raiseEvent("add-layer-failed",e)}});return this.addTiledImage(i),this},getLayerAtLevel:function(t){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(t)},getLevelOfLayer:function(t){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(t)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(t,n){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(t,n)},removeLayer:function(t){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(t)},forceRedraw:function(){return t[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var t=e.delegate(this,u),n=e.delegate(this,d),i=e.delegate(this,U),r=e.delegate(this,j),o=this.navImages,a=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(a=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:P(this.prefixUrl,o.previous.REST),srcGroup:P(this.prefixUrl,o.previous.GROUP),srcHover:P(this.prefixUrl,o.previous.HOVER),srcDown:P(this.prefixUrl,o.previous.DOWN),onRelease:r,onFocus:t,onBlur:n}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:P(this.prefixUrl,o.next.REST),srcGroup:P(this.prefixUrl,o.next.GROUP),srcHover:P(this.prefixUrl,o.next.HOVER),srcDown:P(this.prefixUrl,o.next.DOWN),onRelease:i,onFocus:t,onBlur:n}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),a&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var t=e.delegate(this,A),n=e.delegate(this,I),i=e.delegate(this,N),r=e.delegate(this,O),o=e.delegate(this,M),a=e.delegate(this,B),s=e.delegate(this,H),l=e.delegate(this,z),c=e.delegate(this,F),h=e.delegate(this,V),p=e.delegate(this,u),f=e.delegate(this,d),g=this.navImages,m=[],v=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(v=!1),this.showZoomControl&&(m.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:P(this.prefixUrl,g.zoomIn.REST),srcGroup:P(this.prefixUrl,g.zoomIn.GROUP),srcHover:P(this.prefixUrl,g.zoomIn.HOVER),srcDown:P(this.prefixUrl,g.zoomIn.DOWN),onPress:t,onRelease:n,onClick:i,onEnter:t,onExit:n,onFocus:p,onBlur:f})),m.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:P(this.prefixUrl,g.zoomOut.REST),srcGroup:P(this.prefixUrl,g.zoomOut.GROUP),srcHover:P(this.prefixUrl,g.zoomOut.HOVER),srcDown:P(this.prefixUrl,g.zoomOut.DOWN),onPress:r,onRelease:n,onClick:o,onEnter:r,onExit:n,onFocus:p,onBlur:f}))),this.showHomeControl&&m.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:P(this.prefixUrl,g.home.REST),srcGroup:P(this.prefixUrl,g.home.GROUP),srcHover:P(this.prefixUrl,g.home.HOVER),srcDown:P(this.prefixUrl,g.home.DOWN),onRelease:a,onFocus:p,onBlur:f})),this.showFullPageControl&&m.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:P(this.prefixUrl,g.fullpage.REST),srcGroup:P(this.prefixUrl,g.fullpage.GROUP),srcHover:P(this.prefixUrl,g.fullpage.HOVER),srcDown:P(this.prefixUrl,g.fullpage.DOWN),onRelease:s,onFocus:p,onBlur:f})),this.showRotationControl&&(m.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:P(this.prefixUrl,g.rotateleft.REST),srcGroup:P(this.prefixUrl,g.rotateleft.GROUP),srcHover:P(this.prefixUrl,g.rotateleft.HOVER),srcDown:P(this.prefixUrl,g.rotateleft.DOWN),onRelease:l,onFocus:p,onBlur:f})),m.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:P(this.prefixUrl,g.rotateright.REST),srcGroup:P(this.prefixUrl,g.rotateright.GROUP),srcHover:P(this.prefixUrl,g.rotateright.HOVER),srcDown:P(this.prefixUrl,g.rotateright.DOWN),onRelease:c,onFocus:p,onBlur:f}))),this.showFlipControl&&m.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:P(this.prefixUrl,g.flip.REST),srcGroup:P(this.prefixUrl,g.flip.GROUP),srcHover:P(this.prefixUrl,g.flip.HOVER),srcDown:P(this.prefixUrl,g.flip.DOWN),onRelease:h,onFocus:p,onBlur:f})),v&&(this.buttons=new e.ButtonGroup({buttons:m,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",e.delegate(this,R)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(e){return this.tileSources&&e>=0&&e<this.tileSources.length&&(this._sequenceIndex=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e),this.raiseEvent("page",{page:e})),this},addOverlay:function(t,n,i,a){var s;if(s=e.isPlainObject(t)?t:{element:t,location:n,placement:i,onDraw:a},t=e.getElement(s.element),o(this.currentOverlays,t)>=0)return this;var l=r(this,s);return this.currentOverlays.push(l),l.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:t,location:s.location,placement:s.placement}),this},updateOverlay:function(n,i,r){var a;return n=e.getElement(n),(a=o(this.currentOverlays,n))>=0&&(this.currentOverlays[a].update(i,r),t[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:n,location:i,placement:r})),this},removeOverlay:function(n){var i;return n=e.getElement(n),(i=o(this.currentOverlays,n))>=0&&(this.currentOverlays[i].destroy(),this.currentOverlays.splice(i,1),t[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:n})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return t[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(t){var n;return t=e.getElement(t),(n=o(this.currentOverlays,t))>=0?this.currentOverlays[n]:null},_updateSequenceButtons:function(e){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==e?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(e>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(t){this._hideMessage();var n=e.makeNeutralElement("div");n.appendChild(document.createTextNode(t)),this.messageDiv=e.makeCenteredNode(n),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)},gestureSettingsByDeviceType:function(e){switch(e){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var e,t=this.currentOverlays.length;for(e=0;e<t;e++)this.currentOverlays[e].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}})}(OpenSeadragon),function(e){function t(e){var t={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",t),!t.preventDefaultAction&&e.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var n=this.viewport.pointFromPixel(e.position);this.panVertical?this.panHorizontal||(n.x=this.viewer.viewport.getCenter(!0).x):n.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(n),this.viewer.viewport.applyConstraints()}}function n(e){var t={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",t),!t.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.flipped&&(e.delta.x=-e.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function i(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function r(e){return this.viewer.raiseEvent("navigator-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),!1}function o(e,t){a(e,"rotate("+t+"deg)")}function a(e,t){e.style.webkitTransform=t,e.style.mozTransform=t,e.style.msTransform=t,e.style.oTransform=t,e.style.transform=t}e.Navigator=function(a){var s,l,c,u,d=a.viewer,h=this;function p(e){o(h.displayRegionContainer,e),o(h.displayRegion,-e),h.viewport.setRotation(e)}(a.id?(this.element=document.getElementById(a.id),a.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(a.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),a.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:a.autoFade},a.position&&("BOTTOM_RIGHT"==a.position?a.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==a.position?a.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==a.position?a.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==a.position?a.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:"ABSOLUTE"==a.position&&(a.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,a.controlOptions.top=a.top,a.controlOptions.left=a.left,a.controlOptions.height=a.height,a.controlOptions.width=a.width))),this.element.id=a.id,this.element.className+=" navigator",(a=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},a,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:a.autoResize,minZoomImageRatio:1,background:a.background,opacity:a.opacity,borderColor:a.borderColor,displayRegionColor:a.displayRegionColor})).minPixelRatio=this.minPixelRatio=d.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),a.controlOptions.anchor!=e.ControlAnchor.NONE&&(c=this.element.style,u=this.borderWidth,c.margin="0px",c.border=u+"px solid "+a.borderColor,c.padding="0px",c.background=a.background,c.opacity=a.opacity,c.overflow="hidden"),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(e,t){e.position="relative",e.top="0px",e.left="0px",e.fontSize="0px",e.overflow="hidden",e.border=t+"px solid "+a.displayRegionColor,e.margin="0px",e.padding="0px",e.background="transparent",e.float="left",e.cssFloat="left",e.styleFloat="left",e.zIndex=999999999,e.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",d.addControl(this.element,a.controlOptions),this._resizeWithViewer=a.controlOptions.anchor!=e.ControlAnchor.ABSOLUTE&&a.controlOptions.anchor!=e.ControlAnchor.NONE,a.width&&a.height?(this.setWidth(a.width),this.setHeight(a.height)):this._resizeWithViewer&&(s=e.getElementSize(d.element),this.element.style.height=Math.round(s.y*a.sizeRatio)+"px",this.element.style.width=Math.round(s.x*a.sizeRatio)+"px",this.oldViewerSize=s,l=e.getElementSize(this.element),this.elementArea=l.x*l.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[a]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),a.navigatorRotate)&&(p(a.viewer.viewport?a.viewer.viewport.getRotation():a.viewer.degrees||0),a.viewer.addHandler("rotate",(function(e){p(e.degrees)})));this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,n),clickHandler:e.delegate(this,t),releaseHandler:e.delegate(this,i),scrollHandler:e.delegate(this,r)}),this.addHandler("reset-size",(function(){h.viewport&&h.viewport.goHome(!0)})),d.world.addHandler("item-index-change",(function(e){window.setTimeout((function(){var t=h.world.getItemAt(e.previousIndex);h.world.setItemIndex(t,e.newIndex)}),1)})),d.world.addHandler("remove-item",(function(e){var t=e.item,n=h._getMatchingItem(t);n&&h.world.removeItem(n)})),this.update(d.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var t=new e.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);t.equals(this.oldContainerSize)||(this.viewport.resize(t,!0),this.viewport.goHome(!0),this.oldContainerSize=t,this.drawer.clear(),this.world.draw())}},setWidth:function(e){this.width=e,this.element.style.width="number"==typeof e?e+"px":e,this._resizeWithViewer=!1},setHeight:function(e){this.height=e,this.element.style.height="number"==typeof e?e+"px":e,this._resizeWithViewer=!1},setFlip:function(e){return this.viewport.setFlip(e),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(e){a(this.displayRegion,e),a(this.canvas,e),a(this.element,e)},update:function(t){var n,i,r,o,a,s;if(n=e.getElementSize(this.viewer.element),this._resizeWithViewer&&n.x&&n.y&&!n.equals(this.oldViewerSize)&&(this.oldViewerSize=n,this.maintainSizeRatio||!this.elementArea?(i=n.x*this.sizeRatio,r=n.y*this.sizeRatio):(i=Math.sqrt(this.elementArea*(n.x/n.y)),r=this.elementArea/i),this.element.style.width=Math.round(i)+"px",this.element.style.height=Math.round(r)+"px",this.elementArea||(this.elementArea=i*r),this.updateSize()),t&&this.viewport){o=t.getBoundsNoRotate(!0),a=this.viewport.pixelFromPointNoRotate(o.getTopLeft(),!1),s=this.viewport.pixelFromPointNoRotate(o.getBottomRight(),!1).minus(this.totalBorderWidths);var l=this.displayRegion.style;l.display=this.world.getItemCount()?"block":"none",l.top=Math.round(a.y)+"px",l.left=Math.round(a.x)+"px";var c=Math.abs(a.x-s.x),u=Math.abs(a.y-s.y);l.width=Math.round(Math.max(c,0))+"px",l.height=Math.round(Math.max(u,0))+"px"}},addTiledImage:function(t){var n=this,i=t.originalTiledImage;delete t.original;var r=e.extend({},t,{success:function(e){var t=e.item;function r(){n._matchBounds(t,i)}t._originalForNavigator=i,n._matchBounds(t,i,!0),i.addHandler("bounds-change",r),i.addHandler("clip-change",r),i.addHandler("opacity-change",(function(){n._matchOpacity(t,i)})),i.addHandler("composite-operation-change",(function(){n._matchCompositeOperation(t,i)}))}});return e.Viewer.prototype.addTiledImage.apply(this,[r])},_getMatchingItem:function(e){for(var t,n=this.world.getItemCount(),i=0;i<n;i++)if((t=this.world.getItemAt(i))._originalForNavigator===e)return t;return null},_matchBounds:function(e,t,n){var i=t.getBoundsNoRotate();e.setPosition(i.getTopLeft(),n),e.setWidth(i.width,n),e.setRotation(t.getRotation(),n),e.setClip(t.getClip())},_matchOpacity:function(e,t){e.setOpacity(t.opacity)},_matchCompositeOperation:function(e,t){e.setCompositeOperation(t.compositeOperation)}})}(OpenSeadragon),function(e){var t={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(n){var i,r=n.split("."),o=null,a=arguments,s=t;for(i=0;i<r.length-1;i++)s=s[r[i]]||{};return"string"!=typeof(o=s[r[i]])&&(e.console.log("Untranslated source string:",n),o=""),o.replace(/\{\d+\}/g,(function(e){var t=parseInt(e.match(/\d+/),10)+1;return t<a.length?a[t]:""}))},setString:function(e,n){var i,r=e.split("."),o=t;for(i=0;i<r.length-1;i++)o[r[i]]||(o[r[i]]={}),o=o[r[i]];o[r[i]]=n}})}(OpenSeadragon),function(e){e.Point=function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(t){return new e.Point(this.x+t.x,this.y+t.y)},minus:function(t){return new e.Point(this.x-t.x,this.y-t.y)},times:function(t){return new e.Point(this.x*t,this.y*t)},divide:function(t){return new e.Point(this.x/t,this.y/t)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},squaredDistanceTo:function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},apply:function(t){return new e.Point(t(this.x),t(this.y))},equals:function(t){return t instanceof e.Point&&this.x===t.x&&this.y===t.y},rotate:function(t,n){var i,r;if(n=n||new e.Point(0,0),t%90==0){switch(e.positiveModulo(t,360)){case 0:i=1,r=0;break;case 90:i=0,r=1;break;case 180:i=-1,r=0;break;case 270:i=0,r=-1}}else{var o=t*Math.PI/180;i=Math.cos(o),r=Math.sin(o)}var a=i*(this.x-n.x)-r*(this.y-n.y)+n.x,s=r*(this.x-n.x)+i*(this.y-n.y)+n.y;return new e.Point(a,s)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(e){e.TileSource=function(t,n,i,r,o,a){var s,l,c=this,u=arguments;if(s=e.isPlainObject(t)?t:{width:u[0],height:u[1],tileSize:u[2],tileOverlap:u[3],minLevel:u[4],maxLevel:u[5]},e.EventSource.call(this),e.extend(!0,this,s),!this.success)for(l=0;l<arguments.length;l++)if(e.isFunction(arguments[l])){this.success=arguments[l];break}this.success&&this.addHandler("ready",(function(e){c.success(e)})),"string"==e.type(arguments[0])&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=s.width&&s.height?s.width/s.height:1,this.dimensions=new e.Point(s.width,s.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=s.tileOverlap?s.tileOverlap:0,this.minLevel=s.minLevel?s.minLevel:0,this.maxLevel=void 0!==s.maxLevel&&null!==s.maxLevel?s.maxLevel:s.width&&s.height?Math.ceil(Math.log(Math.max(s.width,s.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(t){return e.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(e){return this._tileWidth?this._tileWidth:this.getTileSize(e)},getTileHeight:function(e){return this._tileHeight?this._tileHeight:this.getTileSize(e)},getLevelScale:function(e){var t,n={};for(t=0;t<=this.maxLevel;t++)n[t]=1/Math.pow(2,this.maxLevel-t);return this.getLevelScale=function(e){return n[e]},this.getLevelScale(e)},getNumTiles:function(t){var n=this.getLevelScale(t),i=Math.ceil(n*this.dimensions.x/this.getTileWidth(t)),r=Math.ceil(n*this.dimensions.y/this.getTileHeight(t));return new e.Point(i,r)},getPixelRatio:function(t){var n=this.dimensions.times(this.getLevelScale(t)),i=1/n.x,r=1/n.y;return new e.Point(i,r)},getClosestLevel:function(){var e,t;for(e=this.minLevel+1;e<=this.maxLevel&&!((t=this.getNumTiles(e)).x>1||t.y>1);e++);return e-1},getTileAtPoint:function(t,n){var i=n.x>=0&&n.x<=1&&n.y>=0&&n.y<=1/this.aspectRatio;e.console.assert(i,"[TileSource.getTileAtPoint] must be called with a valid point.");var r=this.dimensions.x*this.getLevelScale(t),o=n.x*r,a=n.y*r,s=Math.floor(o/this.getTileWidth(t)),l=Math.floor(a/this.getTileHeight(t));n.x>=1&&(s=this.getNumTiles(t).x-1);return n.y>=1/this.aspectRatio-1e-15&&(l=this.getNumTiles(t).y-1),new e.Point(s,l)},getTileBounds:function(t,n,i,r){var o=this.dimensions.times(this.getLevelScale(t)),a=this.getTileWidth(t),s=this.getTileHeight(t),l=0===n?0:a*n-this.tileOverlap,c=0===i?0:s*i-this.tileOverlap,u=a+(0===n?1:2)*this.tileOverlap,d=s+(0===i?1:2)*this.tileOverlap,h=1/o.x;return u=Math.min(u,o.x-l),d=Math.min(d,o.y-c),r?new e.Rect(0,0,u,d):new e.Rect(l*h,c*h,u*h,d*h)},getImageInfo:function(t){var n,i,r,o,a,s,l,c=this;t&&(l=(s=(a=t.split("/"))[a.length-1]).lastIndexOf("."))>-1&&(a[a.length-1]=s.slice(0,l)),i=function(n){"string"==typeof n&&(n=e.parseXml(n));var i=e.TileSource.determineType(c,n,t);i?(void 0===(o=i.prototype.configure.apply(c,[n,t])).ajaxWithCredentials&&(o.ajaxWithCredentials=c.ajaxWithCredentials),r=new i(o),c.ready=!0,c.raiseEvent("ready",{tileSource:r})):c.raiseEvent("open-failed",{message:"Unable to load TileSource",source:t})},t.match(/\.js$/)?(n=t.split("/").pop().replace(".js",""),e.jsonp({url:t,async:!1,callbackName:n,callback:i})):e.makeAjaxRequest({url:t,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(t){var n=function(t){var n,i,r=t.responseText,o=t.status;if(!t)throw new Error(e.getString("Errors.Security"));if(200!==t.status&&0!==t.status)throw o=t.status,n=404==o?"Not Found":t.statusText,new Error(e.getString("Errors.Status",o,n));if(r.match(/\s*<.*/))try{i=t.responseXML&&t.responseXML.documentElement?t.responseXML:e.parseXml(r)}catch(e){i=t.responseText}else if(r.match(/\s*[\{\[].*/))try{i=e.parseJSON(r)}catch(e){i=r}else i=r;return i}(t);i(n)},error:function(e,n){var i;try{i="HTTP "+e.status+" attempting to load TileSource"}catch(e){i=(void 0!==n&&n.toString?n.toString():"Unknown error")+" attempting to load TileSource"}c.raiseEvent("open-failed",{message:i,source:t})}})},supports:function(e,t){return!1},configure:function(e,t){throw new Error("Method not implemented.")},getTileUrl:function(e,t,n){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(e,t,n){return{}},tileExists:function(e,t,n){var i=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&t>=0&&n>=0&&t<i.x&&n<i.y}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype),e.TileSource.determineType=function(t,n,i){var r;for(r in OpenSeadragon)if(r.match(/.+TileSource$/)&&e.isFunction(OpenSeadragon[r])&&e.isFunction(OpenSeadragon[r].prototype.supports)&&OpenSeadragon[r].prototype.supports.call(t,n,i))return OpenSeadragon[r];e.console.error("No TileSource was able to open %s %s",i,n)}}(OpenSeadragon),function(e){function t(t,n){var i,r,o=n.Image,a=o.Url,s=o.Format,l=o.Size,c=o.DisplayRect||[],u=parseInt(l.Width,10),d=parseInt(l.Height,10),h=parseInt(o.TileSize,10),p=parseInt(o.Overlap,10),f=[];for(r=0;r<c.length;r++)i=c[r].Rect,f.push(new e.DisplayRect(parseInt(i.X,10),parseInt(i.Y,10),parseInt(i.Width,10),parseInt(i.Height,10),parseInt(i.MinLevel,10),parseInt(i.MaxLevel,10)));return e.extend(!0,{width:u,height:d,tileSize:h,tileOverlap:p,minLevel:null,maxLevel:null,tilesUrl:a,fileFormat:s,displayRects:f},n)}e.DziTileSource=function(t,n,i,r,o,a,s,l,c){var u,d,h,p;if(p=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=p.tilesUrl,this.fileFormat=p.fileFormat,this.displayRects=p.displayRects,this.displayRects)for(u=this.displayRects.length-1;u>=0;u--)for(h=(d=this.displayRects[u]).minLevel;h<=d.maxLevel;h++)this._levelRects[h]||(this._levelRects[h]=[]),this._levelRects[h].push(d);e.TileSource.apply(this,[p])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){var n;return e.Image?n=e.Image.xmlns:e.documentElement&&("Image"!=e.documentElement.localName&&"Image"!=e.documentElement.tagName||(n=e.documentElement.namespaceURI)),-1!==(n=(n||"").toLowerCase()).indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==n.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(n,i){var r;return r=e.isPlainObject(n)?t(this,n):function(n,i){if(!i||!i.documentElement)throw new Error(e.getString("Errors.Xml"));var r,o,a,s,l,c=i.documentElement,u=c.localName||c.tagName,d=i.documentElement.namespaceURI,h=null,p=[];if("Image"==u)try{if(void 0===(s=c.getElementsByTagName("Size")[0])&&(s=c.getElementsByTagNameNS(d,"Size")[0]),h={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:c.getAttribute("Url"),Format:c.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(c.getAttribute("Overlap"),10),TileSize:parseInt(c.getAttribute("TileSize"),10),Size:{Height:parseInt(s.getAttribute("Height"),10),Width:parseInt(s.getAttribute("Width"),10)}}},!e.imageFormatSupported(h.Image.Format))throw new Error(e.getString("Errors.ImageFormat",h.Image.Format.toUpperCase()));for(void 0===(r=c.getElementsByTagName("DisplayRect"))&&(r=c.getElementsByTagNameNS(d,"DisplayRect")[0]),l=0;l<r.length;l++)o=r[l],void 0===(a=o.getElementsByTagName("Rect")[0])&&(a=o.getElementsByTagNameNS(d,"Rect")[0]),p.push({Rect:{X:parseInt(a.getAttribute("X"),10),Y:parseInt(a.getAttribute("Y"),10),Width:parseInt(a.getAttribute("Width"),10),Height:parseInt(a.getAttribute("Height"),10),MinLevel:parseInt(o.getAttribute("MinLevel"),10),MaxLevel:parseInt(o.getAttribute("MaxLevel"),10)}});return p.length&&(h.Image.DisplayRect=p),t(n,h)}catch(t){throw t instanceof Error?t:new Error(e.getString("Errors.Dzi"))}else{if("Collection"==u)throw new Error(e.getString("Errors.Dzc"));if("Error"==u){var f=c.getElementsByTagName("Message")[0].firstChild.nodeValue;throw new Error(f)}}throw new Error(e.getString("Errors.Dzi"))}(this,n),i&&!r.tilesUrl&&(r.tilesUrl=i.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),-1!=i.search(/\.(dzi|xml|js)\?/)?r.queryParams=i.match(/\?.*/):r.queryParams=""),r},getTileUrl:function(e,t,n){return[this.tilesUrl,e,"/",t,"_",n,".",this.fileFormat,this.queryParams].join("")},tileExists:function(e,t,n){var i,r,o,a,s,l,c,u=this._levelRects[e];if(this.minLevel&&e<this.minLevel||this.maxLevel&&e>this.maxLevel)return!1;if(!u||!u.length)return!0;for(c=u.length-1;c>=0;c--)if(!(e<(i=u[c]).minLevel||e>i.maxLevel)&&(r=this.getLevelScale(e),o=i.x*r,a=i.y*r,s=o+i.width*r,l=a+i.height*r,o=Math.floor(o/this._tileWidth),a=Math.floor(a/this._tileWidth),s=Math.ceil(s/this._tileWidth),l=Math.ceil(l/this._tileWidth),o<=t&&t<s&&a<=n&&n<l))return!0;return!1}})}(OpenSeadragon),function(e){function t(e){var t=Array.isArray(e.profile)?e.profile[0]:e.profile,n=-1!==["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"].indexOf(t),i=!1;return 2===e.version&&e.profile.length>1&&e.profile[1].supports&&(i=-1!==e.profile[1].supports.indexOf("sizeByW")),3===e.version&&e.extraFeatures&&(i=-1!==e.extraFeatures.indexOf("sizeByWh")),!n||i}function n(e){for(var t=[],n=0;n<e.sizes.length;n++)t.push({url:e["@id"]+"/full/"+e.sizes[n].width+","+(3===e.version?e.sizes[n].height:"")+"/0/default."+e.tileFormat,width:e.sizes[n].width,height:e.sizes[n].height});return t.sort((function(e,t){return e.width-t.width}))}e.IIIFTileSource=function(i){if(e.extend(!0,this,i),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(i.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=i.version,this.tile_width&&this.tile_height)i.tileWidth=this.tile_width,i.tileHeight=this.tile_height;else if(this.tile_width)i.tileSize=this.tile_width;else if(this.tile_height)i.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)i.tileWidth=this.tiles[0].width,i.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var r=0;r<this.tiles.length;r++)for(var o=0;o<this.tiles[r].scaleFactors.length;o++){var a=this.tiles[r].scaleFactors[o];this.scale_factors.push(a),i.tileSizePerScaleFactor[a]={width:this.tiles[r].width,height:this.tiles[r].height||this.tiles[r].width}}}else if(t(i)){for(var s=Math.min(this.height,this.width),l=[256,512,1024],c=[],u=0;u<l.length;u++)l[u]<=s&&c.push(l[u]);c.length>0?i.tileSize=Math.max.apply(null,c):i.tileSize=s}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,i.levels=n(this),e.extend(!0,i,{width:i.levels[i.levels.length-1].width,height:i.levels[i.levels.length-1].height,tileSize:Math.max(i.height,i.width),tileOverlap:0,minLevel:0,maxLevel:i.levels.length-1}),this.levels=i.levels):e.console.error("Nothing in the info.json to construct image pyramids from");if(!i.maxLevel&&!this.emulateLegacyImagePyramid)if(this.scale_factors){var d=Math.max.apply(null,this.scale_factors);i.maxLevel=Math.round(Math.log(d)*Math.LOG2E)}else i.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));e.TileSource.apply(this,[i])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return!(!e.protocol||"http://iiif.io/api/image"!=e.protocol)||(!(!e["@context"]||"http://library.stanford.edu/iiif/image-api/1.1/context.json"!=e["@context"]&&"http://iiif.io/api/image/1/context.json"!=e["@context"])||(!(!e.profile||0!==e.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html"))||(!!(e.identifier&&e.width&&e.height)||!(!e.documentElement||"info"!=e.documentElement.tagName||"http://library.stanford.edu/iiif/image-api/ns/"!=e.documentElement.namespaceURI))))},configure:function(t,n){if(e.isPlainObject(t)){if(t["@context"]){var i=t["@context"];if(Array.isArray(i))for(var r=0;r<i.length;r++)if("string"==typeof i[r]&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(i[r])||"http://library.stanford.edu/iiif/image-api/1.1/context.json"===i[r])){i=i[r];break}switch(i){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":t.version=1;break;case"http://iiif.io/api/image/2/context.json":t.version=2;break;case"http://iiif.io/api/image/3/context.json":t.version=3;break;default:e.console.error("Data has a @context property which contains no known IIIF context URI.")}}else t["@context"]="http://iiif.io/api/image/1.0/context.json",t["@id"]=n.replace("/info.json",""),t.version=1;if(!t["@id"]&&t.id&&(t["@id"]=t.id),t.preferredFormats)for(var o=0;o<t.preferredFormats.length;o++)if(OpenSeadragon.imageFormatSupported(t.preferredFormats[o])){t.tileFormat=t.preferredFormats[o];break}return t}var a=function(t){if(!t||!t.documentElement)throw new Error(e.getString("Errors.Xml"));var n=t.documentElement,i=n.tagName,r=null;if("info"==i)try{return function t(n,i,r){var o,a;if(3==n.nodeType&&r)(a=n.nodeValue.trim()).match(/^\d*$/)&&(a=Number(a)),i[r]?(e.isArray(i[r])||(i[r]=[i[r]]),i[r].push(a)):i[r]=a;else if(1==n.nodeType)for(o=0;o<n.childNodes.length;o++)t(n.childNodes[o],i,n.nodeName)}(n,r={}),r}catch(t){throw t instanceof Error?t:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}(t);return a["@context"]="http://iiif.io/api/image/1.0/context.json",a["@id"]=n.replace("/info.xml",""),a.version=1,a},getTileWidth:function(t){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,t);var n=Math.pow(2,this.maxLevel-t);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[n]?this.tileSizePerScaleFactor[n].width:this._tileWidth},getTileHeight:function(t){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,t);var n=Math.pow(2,this.maxLevel-t);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[n]?this.tileSizePerScaleFactor[n].height:this._tileHeight},getLevelScale:function(t){if(this.emulateLegacyImagePyramid){var n=NaN;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(n=this.levels[t].width/this.levels[this.maxLevel].width),n}return e.TileSource.prototype.getLevelScale.call(this,t)},getNumTiles:function(t){return this.emulateLegacyImagePyramid?this.getLevelScale(t)?new e.Point(1,1):new e.Point(0,0):e.TileSource.prototype.getNumTiles.call(this,t)},getTileAtPoint:function(t,n){return this.emulateLegacyImagePyramid?new e.Point(0,0):e.TileSource.prototype.getTileAtPoint.call(this,t,n)},getTileUrl:function(e,t,n){if(this.emulateLegacyImagePyramid){var i=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].url),i}var r,o,a,s,l,c,u,d,h,p,f,g,m,v=Math.pow(.5,this.maxLevel-e),y=Math.ceil(this.width*v),b=Math.ceil(this.height*v);return r=this.getTileWidth(e),o=this.getTileHeight(e),a=Math.ceil(r/v),s=Math.ceil(o/v),m=1===this.version?"native."+this.tileFormat:"default."+this.tileFormat,y<r&&b<o?(p=2===this.version&&y===this.width||3===this.version&&y===this.width&&b===this.height?"max":3===this.version?y+","+b:y+",",l="full"):(c=t*a,u=n*s,d=Math.min(a,this.width-c),h=Math.min(s,this.height-u),l=0===t&&0===n&&d===this.width&&h===this.height?"full":[c,u,d,h].join(","),f=Math.ceil(d*v),g=Math.ceil(h*v),p=2===this.version&&f===this.width||3===this.version&&f===this.width&&g===this.height?"max":3===this.version?f+","+g:f+","),[this["@id"],l,p,"0",m].join("/")},__testonly__:{canBeTiled:t,constructLevels:n}})}(OpenSeadragon),function(e){e.OsmTileSource=function(t,n,i,r,o){var a;(a=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]}).width&&a.height||(a.width=65572864,a.height=65572864),a.tileSize||(a.tileSize=256,a.tileOverlap=0),a.tilesUrl||(a.tilesUrl="http://tile.openstreetmap.org/"),a.minLevel=8,e.TileSource.apply(this,[a])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"openstreetmaps"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,n){return this.tilesUrl+(e-8)+"/"+t+"/"+n+".png"}})}(OpenSeadragon),function(e){e.TmsTileSource=function(t,n,i,r,o){var a;a=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var s,l=256*Math.ceil(a.width/256),c=256*Math.ceil(a.height/256);s=l>c?l/256:c/256,a.maxLevel=Math.ceil(Math.log(s)/Math.log(2))-1,a.tileSize=256,a.width=l,a.height=c,e.TileSource.apply(this,[a])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"tiledmapservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,n){var i=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+t+"/"+(i-n)+".png"}})}(OpenSeadragon),function(e){e.ZoomifyTileSource=function(e){e.tileSize=256;var t={x:e.width,y:e.height};for(e.imageSizes=[{x:e.width,y:e.height}],e.gridSize=[this._getGridSize(e.width,e.height,e.tileSize)];parseInt(t.x,10)>e.tileSize||parseInt(t.y,10)>e.tileSize;)t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),e.imageSizes.push({x:t.x,y:t.y}),e.gridSize.push(this._getGridSize(t.x,t.y,e.tileSize));e.imageSizes.reverse(),e.gridSize.reverse(),e.minLevel=0,e.maxLevel=e.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[e])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(e,t,n){return{x:Math.ceil(e/n),y:Math.ceil(t/n)}},_calculateAbsoluteTileNumber:function(e,t,n){for(var i=0,r={},o=0;o<e;o++)i+=(r=this.gridSize[o]).x*r.y;return i+=(r=this.gridSize[e]).x*n+t},supports:function(e,t){return e.type&&"zoomifytileservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,n){var i,r=this._calculateAbsoluteTileNumber(e,t,n);return i=Math.floor(r/256),this.tilesUrl+"TileGroup"+i+"/"+e+"-"+t+"-"+n+".jpg"}})}(OpenSeadragon),function(e){function t(e,t){return t.levels}e.LegacyTileSource=function(t){var n,i,r;e.isArray(t)&&(n={type:"legacy-image-pyramid",levels:t}),n.levels=function(t){var n,i,r=[];for(i=0;i<t.length;i++)(n=t[i]).height&&n.width&&n.url?r.push({url:n.url,width:Number(n.width),height:Number(n.height)}):e.console.error("Unsupported image format: %s",n.url?n.url:"<no URL>");return r.sort((function(e,t){return e.height-t.height}))}(n.levels),n.levels.length>0?(i=n.levels[n.levels.length-1].width,r=n.levels[n.levels.length-1].height):(i=0,r=0,e.console.error("No supported image formats found")),e.extend(!0,n,{width:i,height:r,tileSize:Math.max(r,i),tileOverlap:0,minLevel:0,maxLevel:n.levels.length>0?n.levels.length-1:0}),e.TileSource.apply(this,[n]),this.levels=n.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"legacy-image-pyramid"==e.type||e.documentElement&&"legacy-image-pyramid"==e.documentElement.getAttribute("type")},configure:function(n,i){return e.isPlainObject(n)?t(this,n):function(n,i){if(!i||!i.documentElement)throw new Error(e.getString("Errors.Xml"));var r,o,a=i.documentElement,s=a.tagName,l=null,c=[];if("image"==s)try{for(l={type:a.getAttribute("type"),levels:[]},c=a.getElementsByTagName("level"),o=0;o<c.length;o++)r=c[o],l.levels.push({url:r.getAttribute("url"),width:parseInt(r.getAttribute("width"),10),height:parseInt(r.getAttribute("height"),10)});return t(n,l)}catch(e){throw e instanceof Error?e:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==s)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==s)throw new Error("Error: "+i)}throw new Error("Unknown element "+s)}(this,n)},getLevelScale:function(e){var t=NaN;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(t){return this.getLevelScale(t)?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e,t,n){var i=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].url),i}})}(OpenSeadragon),function(e){e.ImageTileSource=function(t){t=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},t),e.TileSource.apply(this,[t])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"image"===e.type},configure:function(e,t){return e},getImageInfo:function(t){var n=this._image=new Image,i=this;this.crossOriginPolicy&&(n.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(n.useCredentials=this.ajaxWithCredentials),e.addEvent(n,"load",(function(){i.width=Object.prototype.hasOwnProperty.call(n,"naturalWidth")?n.naturalWidth:n.width,i.height=Object.prototype.hasOwnProperty.call(n,"naturalHeight")?n.naturalHeight:n.height,i.aspectRatio=i.width/i.height,i.dimensions=new e.Point(i.width,i.height),i._tileWidth=i.width,i._tileHeight=i.height,i.tileOverlap=0,i.minLevel=0,i.levels=i._buildLevels(),i.maxLevel=i.levels.length-1,i.ready=!0,i.raiseEvent("ready",{tileSource:i})})),e.addEvent(n,"error",(function(){i.raiseEvent("open-failed",{message:"Error loading image at "+t,source:t})})),n.src=t},getLevelScale:function(e){var t=NaN;return e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(t){return this.getLevelScale(t)?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e,t,n){var i=null;return e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].url),i},getContext2D:function(e,t,n){var i=null;return e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].context2D),i},_buildLevels:function(){var t=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!e.supportsCanvas||!this.useCanvas)return delete this._image,t;var n=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,i=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,r=document.createElement("canvas"),o=r.getContext("2d");if(r.width=n,r.height=i,o.drawImage(this._image,0,0,n,i),t[0].context2D=o,delete this._image,e.isCanvasTainted(r))return t;for(;n>=2&&i>=2;){n=Math.floor(n/2),i=Math.floor(i/2);var a=document.createElement("canvas"),s=a.getContext("2d");a.width=n,a.height=i,s.drawImage(r,0,0,n,i),t.splice(0,0,{context2D:s,width:n,height:i}),r=a,o=s}return t}})}(OpenSeadragon),function(e){e.TileSourceCollection=function(t,n,i,r){e.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(e){function t(n){e.requestAnimationFrame((function(){!function(n){var i,r,o;n.shouldFade&&(i=e.now(),r=i-n.fadeBeginTime,o=1-r/n.fadeLength,o=Math.min(1,o),o=Math.max(0,o),n.imgGroup&&e.setElementOpacity(n.imgGroup,o,!0),o>0&&t(n))}(n)}))}function n(t,n){t.element.disabled||(n>=e.ButtonState.GROUP&&t.currentState==e.ButtonState.REST&&(!function(t){t.shouldFade=!1,t.imgGroup&&e.setElementOpacity(t.imgGroup,1,!0)}(t),t.currentState=e.ButtonState.GROUP),n>=e.ButtonState.HOVER&&t.currentState==e.ButtonState.GROUP&&(t.imgHover&&(t.imgHover.style.visibility=""),t.currentState=e.ButtonState.HOVER),n>=e.ButtonState.DOWN&&t.currentState==e.ButtonState.HOVER&&(t.imgDown&&(t.imgDown.style.visibility=""),t.currentState=e.ButtonState.DOWN))}function i(n,i){n.element.disabled||(i<=e.ButtonState.HOVER&&n.currentState==e.ButtonState.DOWN&&(n.imgDown&&(n.imgDown.style.visibility="hidden"),n.currentState=e.ButtonState.HOVER),i<=e.ButtonState.GROUP&&n.currentState==e.ButtonState.HOVER&&(n.imgHover&&(n.imgHover.style.visibility="hidden"),n.currentState=e.ButtonState.GROUP),i<=e.ButtonState.REST&&n.currentState==e.ButtonState.GROUP&&(!function(n){n.shouldFade=!0,n.fadeBeginTime=e.now()+n.fadeDelay,window.setTimeout((function(){t(n)}),n.fadeDelay)}(n),n.currentState=e.ButtonState.REST))}e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(t){var r=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},t),this.element=t.element||e.makeNeutralElement("div"),t.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor==e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(t){t.insideElementPressed?(n(r,e.ButtonState.DOWN),r.raiseEvent("enter",{originalEvent:t.originalEvent})):t.buttonDownAny||n(r,e.ButtonState.HOVER)},focusHandler:function(e){this.enterHandler(e),r.raiseEvent("focus",{originalEvent:e.originalEvent})},exitHandler:function(t){i(r,e.ButtonState.GROUP),t.insideElementPressed&&r.raiseEvent("exit",{originalEvent:t.originalEvent})},blurHandler:function(e){this.exitHandler(e),r.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(t){n(r,e.ButtonState.DOWN),r.raiseEvent("press",{originalEvent:t.originalEvent})},releaseHandler:function(t){t.insideElementPressed&&t.insideElementReleased?(i(r,e.ButtonState.HOVER),r.raiseEvent("release",{originalEvent:t.originalEvent})):t.insideElementPressed?i(r,e.ButtonState.GROUP):n(r,e.ButtonState.HOVER)},clickHandler:function(e){e.quick&&r.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){return 13!==e.keyCode||(r.raiseEvent("click",{originalEvent:e.originalEvent}),r.raiseEvent("release",{originalEvent:e.originalEvent}),!1)}}),i(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){n(this,e.ButtonState.GROUP)},notifyGroupExit:function(){i(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(e){e.ButtonGroup=function(t){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},t);var n,i=this.buttons.concat([]),r=this;if(this.element=t.element||e.makeNeutralElement("div"),!t.group)for(this.element.style.display="inline-block",n=0;n<i.length;n++)this.element.appendChild(i[n].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){var t;for(t=0;t<r.buttons.length;t++)r.buttons[t].notifyGroupEnter()},exitHandler:function(e){var t;if(!e.insideElementPressed)for(t=0;t<r.buttons.length;t++)r.buttons[t].notifyGroupExit()}})},e.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(e){e.Rect=function(t,n,i,r,o){var a,s;this.x="number"==typeof t?t:0,this.y="number"==typeof n?n:0,this.width="number"==typeof i?i:0,this.height="number"==typeof r?r:0,this.degrees="number"==typeof o?o:0,this.degrees=e.positiveModulo(this.degrees,360),this.degrees>=270?(a=this.getTopRight(),this.x=a.x,this.y=a.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=270):this.degrees>=180?(a=this.getBottomRight(),this.x=a.x,this.y=a.y,this.degrees-=180):this.degrees>=90&&(a=this.getBottomLeft(),this.x=a.x,this.y=a.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=90)},e.Rect.fromSummits=function(t,n,i){var r=t.distanceTo(n),o=t.distanceTo(i),a=n.minus(t),s=Math.atan(a.y/a.x);return a.x<0?s+=Math.PI:a.y<0&&(s+=2*Math.PI),new e.Rect(t.x,t.y,r,o,s/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(t){return t instanceof e.Rect&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height&&this.degrees===t.degrees},times:function(t){return new e.Rect(this.x*t,this.y*t,this.width*t,this.height*t,this.degrees)},translate:function(t){return new e.Rect(this.x+t.x,this.y+t.y,this.width,this.height,this.degrees)},union:function(t){var n=this.getBoundingBox(),i=t.getBoundingBox(),r=Math.min(n.x,i.x),o=Math.min(n.y,i.y),a=Math.max(n.x+n.width,i.x+i.width),s=Math.max(n.y+n.height,i.y+i.height);return new e.Rect(r,o,a-r,s-o)},intersection:function(t){var n=[],i=this.getTopLeft();t.containsPoint(i,1e-10)&&n.push(i);var r=this.getTopRight();t.containsPoint(r,1e-10)&&n.push(r);var o=this.getBottomLeft();t.containsPoint(o,1e-10)&&n.push(o);var a=this.getBottomRight();t.containsPoint(a,1e-10)&&n.push(a);var s=t.getTopLeft();this.containsPoint(s,1e-10)&&n.push(s);var l=t.getTopRight();this.containsPoint(l,1e-10)&&n.push(l);var c=t.getBottomLeft();this.containsPoint(c,1e-10)&&n.push(c);var u=t.getBottomRight();this.containsPoint(u,1e-10)&&n.push(u);for(var d=this._getSegments(),h=t._getSegments(),p=0;p<d.length;p++)for(var f=d[p],g=0;g<h.length;g++){var m=h[g],v=y(f[0],f[1],m[0],m[1]);v&&n.push(v)}function y(t,n,i,r){var o=n.minus(t),a=r.minus(i),s=-a.x*o.y+o.x*a.y;if(0===s)return null;var l=(o.x*(t.y-i.y)-o.y*(t.x-i.x))/s,c=(a.x*(t.y-i.y)-a.y*(t.x-i.x))/s;return-1e-10<=l&&l<=1-1e-10&&-1e-10<=c&&c<=1-1e-10?new e.Point(t.x+c*o.x,t.y+c*o.y):null}if(0===n.length)return null;for(var b=n[0].x,_=n[0].x,x=n[0].y,w=n[0].y,S=1;S<n.length;S++){var T=n[S];T.x<b&&(b=T.x),T.x>_&&(_=T.x),T.y<x&&(x=T.y),T.y>w&&(w=T.y)}return new e.Rect(b,x,_-b,w-x)},_getSegments:function(){var e=this.getTopLeft(),t=this.getTopRight(),n=this.getBottomLeft(),i=this.getBottomRight();return[[e,t],[t,i],[i,n],[n,e]]},rotate:function(t,n){if(0===(t=e.positiveModulo(t,360)))return this.clone();n=n||this.getCenter();var i=this.getTopLeft().rotate(t,n),r=this.getTopRight().rotate(t,n).minus(i);r=r.apply((function(e){return Math.abs(e)<1e-15?0:e}));var o=Math.atan(r.y/r.x);return r.x<0?o+=Math.PI:r.y<0&&(o+=2*Math.PI),new e.Rect(i.x,i.y,this.width,this.height,o/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var t=this.getTopLeft(),n=this.getTopRight(),i=this.getBottomLeft(),r=this.getBottomRight(),o=Math.min(t.x,n.x,i.x,r.x),a=Math.max(t.x,n.x,i.x,r.x),s=Math.min(t.y,n.y,i.y,r.y),l=Math.max(t.y,n.y,i.y,r.y);return new e.Rect(o,s,a-o,l-s)},getIntegerBoundingBox:function(){var t=this.getBoundingBox(),n=Math.floor(t.x),i=Math.floor(t.y),r=Math.ceil(t.width+t.x-n),o=Math.ceil(t.height+t.y-i);return new e.Rect(n,i,r,o)},containsPoint:function(e,t){t=t||0;var n=this.getTopLeft(),i=this.getTopRight(),r=this.getBottomLeft(),o=i.minus(n),a=r.minus(n);return(e.x-n.x)*o.x+(e.y-n.y)*o.y>=-t&&(e.x-i.x)*o.x+(e.y-i.y)*o.y<=t&&(e.x-n.x)*a.x+(e.y-n.y)*a.y>=-t&&(e.x-r.x)*a.x+(e.y-r.y)*a.y<=t},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(e){var t={};function n(t){var n=Number(this.element.style.marginLeft.replace("px","")),i=Number(this.element.style.marginTop.replace("px","")),o=Number(this.element.style.width.replace("px","")),a=Number(this.element.style.height.replace("px","")),s=e.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-t.delta.x>0?n>-(o-s.x)&&(this.element.style.marginLeft=n+2*t.delta.x+"px",r(this,s.x,n+2*t.delta.x)):-t.delta.x<0&&n<0&&(this.element.style.marginLeft=n+2*t.delta.x+"px",r(this,s.x,n+2*t.delta.x)):-t.delta.y>0?i>-(a-s.y)&&(this.element.style.marginTop=i+2*t.delta.y+"px",r(this,s.y,i+2*t.delta.y)):-t.delta.y<0&&i<0&&(this.element.style.marginTop=i+2*t.delta.y+"px",r(this,s.y,i+2*t.delta.y))),!1}function i(t){var n=Number(this.element.style.marginLeft.replace("px","")),i=Number(this.element.style.marginTop.replace("px","")),o=Number(this.element.style.width.replace("px","")),a=Number(this.element.style.height.replace("px","")),s=e.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?t.scroll>0?n>-(o-s.x)&&(this.element.style.marginLeft=n-60*t.scroll+"px",r(this,s.x,n-60*t.scroll)):t.scroll<0&&n<0&&(this.element.style.marginLeft=n-60*t.scroll+"px",r(this,s.x,n-60*t.scroll)):t.scroll<0?i>s.y-a&&(this.element.style.marginTop=i+60*t.scroll+"px",r(this,s.y,i+60*t.scroll)):t.scroll>0&&i<0&&(this.element.style.marginTop=i+60*t.scroll+"px",r(this,s.y,i+60*t.scroll))),!1}function r(t,n,i){var r,o,a,s,l,c,u;for(r="horizontal"==t.scroll?t.panelWidth:t.panelHeight,o=Math.ceil(n/r)+5,c=o=(o=(a=Math.ceil((Math.abs(i)+n)/r)+1)-o)<0?0:o;c<a&&c<t.panels.length;c++)if(!(u=t.panels[c]).activePanel){var d,h=t.viewer.tileSources[c];d=h.referenceStripThumbnailUrl?{type:"image",url:h.referenceStripThumbnailUrl}:h,(s=new e.Viewer({id:u.id,tileSources:[d],element:u,navigatorSizeRatio:t.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:t.viewer.loadTilesWithAjax,ajaxHeaders:t.viewer.ajaxHeaders,useCanvas:t.useCanvas})).displayRegion=e.makeNeutralElement("div"),s.displayRegion.id=u.id+"-displayregion",s.displayRegion.className="displayregion",(l=s.displayRegion.style).position="relative",l.top="0px",l.left="0px",l.fontSize="0px",l.overflow="hidden",l.float="left",l.cssFloat="left",l.styleFloat="left",l.zIndex=999999999,l.cursor="default",l.width=t.panelWidth-4+"px",l.height=t.panelHeight-4+"px",s.displayRegion.innerTracker=new e.MouseTracker({element:s.displayRegion,startDisabled:!0}),u.getElementsByTagName("div")[0].appendChild(s.displayRegion),t.miniViewers[u.id]=s,u.activePanel=!0}}function o(e){var t=e.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="0px":t.style.marginLeft="0px",!1}function a(t){var n=t.eventSource.element;return"horizontal"==this.scroll?n.style.marginBottom="-"+e.getElementSize(n).y/2+"px":n.style.marginLeft="-"+e.getElementSize(n).x/2+"px",!1}function s(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:case 37:return i.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function l(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 61:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return i.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 97:return i.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}e.ReferenceStrip=function(c){var u,d,h,p=c.viewer,f=e.getElementSize(p.element);for(c.id||(c.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=c.id,this.element.className="referencestrip"),c=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},c,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),e.extend(this,c),t[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,(d=this.element.style).marginTop="0px",d.marginRight="0px",d.marginBottom="0px",d.marginLeft="0px",d.left="0px",d.bottom="0px",d.border="0px",d.background="#000",d.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=p,this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,n),scrollHandler:e.delegate(this,i),enterHandler:e.delegate(this,o),exitHandler:e.delegate(this,a),keyDownHandler:e.delegate(this,s),keyHandler:e.delegate(this,l)}),c.width&&c.height?(this.element.style.width=c.width+"px",this.element.style.height=c.height+"px",p.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):"horizontal"==c.scroll?(this.element.style.width=f.x*c.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.height=f.y*c.sizeRatio+"px",p.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=f.y*c.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.width=f.x*c.sizeRatio+"px",p.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=f.x*this.sizeRatio+8,this.panelHeight=f.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},h=0;h<p.tileSources.length;h++)(u=e.makeNeutralElement("div")).id=this.element.id+"-"+h,u.style.width=this.panelWidth+"px",u.style.height=this.panelHeight+"px",u.style.display="inline",u.style.float="left",u.style.cssFloat="left",u.style.styleFloat="left",u.style.padding="2px",e.setElementTouchActionNone(u),u.innerTracker=new e.MouseTracker({element:u,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(t){t.eventSource.dragging=e.now()},releaseHandler:function(t){var n=t.eventSource,i=n.element.id,r=Number(i.split("-")[2]),o=e.now();t.insideElementPressed&&t.insideElementReleased&&n.dragging&&o-n.dragging<n.clickTimeThreshold&&(n.dragging=null,p.goToPage(r))}}),this.element.appendChild(u),u.activePanel=!1,this.panels.push(u);r(this,"vertical"==this.scroll?f.y:f.x,0),this.setFocus(0)},e.extend(e.ReferenceStrip.prototype,e.EventSource.prototype,e.Viewer.prototype,{setFocus:function(t){var n,i=this.element.querySelector("#"+this.element.id+"-"+t),a=e.getElementSize(this.viewer.canvas),s=Number(this.element.style.width.replace("px","")),l=Number(this.element.style.height.replace("px","")),c=-Number(this.element.style.marginLeft.replace("px","")),u=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==i&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=i,this.currentSelected.style.background="#999","horizontal"==this.scroll?(n=Number(t)*(this.panelWidth+3))>c+a.x-this.panelWidth?(n=Math.min(n,s-a.x),this.element.style.marginLeft=-n+"px",r(this,a.x,-n)):n<c&&(n=Math.max(0,n-a.x/2),this.element.style.marginLeft=-n+"px",r(this,a.x,-n)):(n=Number(t)*(this.panelHeight+3))>u+a.y-this.panelHeight?(n=Math.min(n,l-a.y),this.element.style.marginTop=-n+"px",r(this,a.y,-n)):n<u&&(n=Math.max(0,n-a.y/2),this.element.style.marginTop=-n+"px",r(this,a.y,-n)),this.currentPage=t,o.call(this,{eventSource:this.innerTracker}))},update:function(){return!!t[this.id].animating&&(e.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var e in this.miniViewers)this.miniViewers[e].destroy();this.element&&this.element.parentNode.removeChild(this.element)}})}(OpenSeadragon),function(e){e.DisplayRect=function(t,n,i,r,o,a){e.Rect.apply(this,[t,n,i,r]),this.minLevel=o,this.maxLevel=a},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(OpenSeadragon),function(e){e.Spring=function(t){var n=arguments;"object"!=typeof t&&(t={initial:n.length&&"number"==typeof n[0]?n[0]:void 0,springStiffness:n.length>1?n[1].springStiffness:5,animationTime:n.length>1?n[1].animationTime:1.5}),e.console.assert("number"==typeof t.springStiffness&&0!==t.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert("number"==typeof t.animationTime&&t.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),t.exponential&&(this._exponential=!0,delete t.exponential),e.extend(!0,this,t),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(t){e.console.assert(!this._exponential||0!==t,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=t,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(t){e.console.assert(!this._exponential||0!==t,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=t,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(t){this.start.value+=t,this.target.value+=t,this._exponential&&(e.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(t){this._exponential=t,this._exponential&&(e.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){var t,n;this.current.time=e.now(),this._exponential?(t=this.start._logValue,n=this.target._logValue):(t=this.start.value,n=this.target.value);var i,r,o=this.current.time>=this.target.time?n:t+(n-t)*(i=this.springStiffness,r=(this.current.time-this.start.time)/(this.target.time-this.start.time),(1-Math.exp(i*-r))/(1-Math.exp(-i))),a=this.current.value;return this._exponential?this.current.value=Math.exp(o):this.current.value=o,a!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(e){function t(t){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null},t),this.image=null}t.prototype={errorMsg:null,start:function(){var t=this,n=this.abort;this.image=new Image,this.image.onload=function(){t.finish(!0)},this.image.onabort=this.image.onerror=function(){t.errorMsg="Image load aborted",t.finish(!1)},this.jobId=window.setTimeout((function(){t.errorMsg="Image load exceeded timeout ("+t.timeout+" ms)",t.finish(!1)}),this.timeout),this.loadWithAjax?(this.request=e.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(e){var n;try{n=new window.Blob([e.response])}catch(t){var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===t.name&&i){var r=new i;r.append(e.response),n=r.getBlob()}}0===n.size&&(t.errorMsg="Empty image response.",t.finish(!1));var o=(window.URL||window.webkitURL).createObjectURL(n);t.image.src=o},error:function(e){t.errorMsg="Image load aborted - XHR error",t.finish(!1)}}),this.abort=function(){t.request.abort(),"function"==typeof n&&n()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(e){this.image.onload=this.image.onerror=this.image.onabort=null,e||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(t){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},t)},e.ImageLoader.prototype={addJob:function(e){var n=this,i=new t({src:e.src,loadWithAjax:e.loadWithAjax,ajaxHeaders:e.loadWithAjax?e.ajaxHeaders:null,crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,callback:function(t){!function(e,t,n){e.jobsInProgress--,(!e.jobLimit||e.jobsInProgress<e.jobLimit)&&e.jobQueue.length>0&&(e.jobQueue.shift().start(),e.jobsInProgress++);n(t.image,t.errorMsg,t.request)}(n,t,e.callback)},abort:e.abort,timeout:this.timeout});!this.jobLimit||this.jobsInProgress<this.jobLimit?(i.start(),this.jobsInProgress++):this.jobQueue.push(i)},clear:function(){for(var e=0;e<this.jobQueue.length;e++){var t=this.jobQueue[e];"function"==typeof t.abort&&t.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(e){e.Tile=function(e,t,n,i,r,o,a,s,l,c){this.level=e,this.x=t,this.y=n,this.bounds=i,this.sourceBounds=c,this.exists=r,this.url=o,this.context2D=a,this.loadWithAjax=s,this.ajaxHeaders=l,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(t){this.cacheImageRecord?this.loaded?(this.element||(this.element=e.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=t&&t.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",e.setElementOpacity(this.element,this.opacity)):e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):e.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(t,n,i,r){var o,a,s,l=this.position.times(e.pixelDensityRatio),c=this.size.times(e.pixelDensityRatio);this.context2D||this.cacheImageRecord?(o=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&o?(t.save(),t.globalAlpha=this.opacity,"number"==typeof i&&1!==i&&(l=l.times(i),c=c.times(i)),r instanceof e.Point&&(l=l.plus(r)),1===t.globalAlpha&&this._hasTransparencyChannel()&&t.clearRect(l.x,l.y,c.x,c.y),n({context:t,tile:this,rendered:o}),this.sourceBounds?(a=Math.min(this.sourceBounds.width,o.canvas.width),s=Math.min(this.sourceBounds.height,o.canvas.height)):(a=o.canvas.width,s=o.canvas.height),t.drawImage(o.canvas,0,0,a,s,l.x,l.y,c.x,c.y),t.restore()):e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):e.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var t;if(this.cacheImageRecord)t=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;t=this.context2D}return t.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(t,n,i){var r=Math.max(1,Math.ceil((i.x-n.x)/2)),o=Math.max(1,Math.ceil((i.y-n.y)/2));return new e.Point(r,o).minus(this.position.times(e.pixelDensityRatio).times(t||1).apply((function(e){return e%1})))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(t,n,i){var r;r=e.isPlainObject(t)?t:{element:t,location:n,placement:i},this.element=r.element,this.style=r.element.style,this._init(r)},e.Overlay.prototype={_init:function(t){this.location=t.location,this.placement=void 0===t.placement?e.Placement.TOP_LEFT:t.placement,this.onDraw=t.onDraw,this.checkResize=void 0===t.checkResize||t.checkResize,this.width=void 0===t.width?null:t.width,this.height=void 0===t.height?null:t.height,this.rotationMode=t.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(t,n){var i=e.Placement.properties[this.placement];i&&(i.isHorizontallyCentered?t.x-=n.x/2:i.isRight&&(t.x-=n.x),i.isVerticallyCentered?t.y-=n.y/2:i.isBottom&&(t.y-=n.y))},destroy:function(){var t=this.element,n=this.style;t.parentNode&&(t.parentNode.removeChild(t),t.prevElementParent&&(n.display="none",document.body.appendChild(t))),this.onDraw=null,n.top="",n.left="",n.position="",null!==this.width&&(n.width=""),null!==this.height&&(n.height="");var i=e.getCssPropertyWithVendorPrefix("transformOrigin"),r=e.getCssPropertyWithVendorPrefix("transform");i&&r&&(n[i]="",n[r]="")},drawHTML:function(t,n){var i=this.element;i.parentNode!==t&&(i.prevElementParent=i.parentNode,i.prevNextSibling=i.nextSibling,t.appendChild(i),this.style.position="absolute",this.size=e.getElementSize(i));var r=this._getOverlayPositionAndSize(n),o=r.position,a=this.size=r.size,s=r.rotate;if(this.onDraw)this.onDraw(o,a,this.element);else{var l=this.style;l.left=o.x+"px",l.top=o.y+"px",null!==this.width&&(l.width=a.x+"px"),null!==this.height&&(l.height=a.y+"px");var c=e.getCssPropertyWithVendorPrefix("transformOrigin"),u=e.getCssPropertyWithVendorPrefix("transform");c&&u&&(s?(l[c]=this._getTransformOrigin(),l[u]="rotate("+s+"deg)"):(l[c]="",l[u]="")),"none"!==l.display&&(l.display="block")}},_getOverlayPositionAndSize:function(t){var n=t.pixelFromPoint(this.location,!0),i=this._getSizeInPixels(t);this.adjust(n,i);var r=0;if(t.degrees&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var o=new e.Rect(n.x,n.y,i.x,i.y),a=this._getBoundingBox(o,t.degrees);n=a.getTopLeft(),i=a.getSize()}else r=t.degrees;return{position:n,size:i,rotate:r}},_getSizeInPixels:function(t){var n=this.size.x,i=this.size.y;if(null!==this.width||null!==this.height){var r=t.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0);null!==this.width&&(n=r.x),null!==this.height&&(i=r.y)}if(this.checkResize&&(null===this.width||null===this.height)){var o=this.size=e.getElementSize(this.element);null===this.width&&(n=o.x),null===this.height&&(i=o.y)}return new e.Point(n,i)},_getBoundingBox:function(e,t){var n=this._getPlacementPoint(e);return e.rotate(t,n).getBoundingBox()},_getPlacementPoint:function(t){var n=new e.Point(t.x,t.y),i=e.Placement.properties[this.placement];return i&&(i.isHorizontallyCentered?n.x+=t.width/2:i.isRight&&(n.x+=t.width),i.isVerticallyCentered?n.y+=t.height/2:i.isBottom&&(n.y+=t.height)),n},_getTransformOrigin:function(){var t="",n=e.Placement.properties[this.placement];return n?(n.isLeft?t="left":n.isRight&&(t="right"),n.isTop?t+=" top":n.isBottom&&(t+=" bottom"),t):t},update:function(t,n){var i=e.isPlainObject(t)?t:{location:t,placement:n};this._init({location:i.location||this.location,placement:void 0!==i.placement?i.placement:this.placement,onDraw:i.onDraw||this.onDraw,checkResize:i.checkResize||this.checkResize,width:void 0!==i.width?i.width:this.width,height:void 0!==i.height?i.height:this.height,rotationMode:i.rotationMode||this.rotationMode})},getBounds:function(t){e.console.assert(t,"A viewport must now be passed to Overlay.getBounds.");var n=this.width,i=this.height;if(null===n||null===i){var r=t.deltaPointsFromPixelsNoRotate(this.size,!0);null===n&&(n=r.x),null===i&&(i=r.y)}var o=this.location.clone();return this.adjust(o,new e.Point(n,i)),this._adjustBoundsForRotation(t,new e.Rect(o.x,o.y,n,i))},_adjustBoundsForRotation:function(t,n){if(!t||0===t.degrees||this.rotationMode===e.OverlayRotationMode.EXACT)return n;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(null===this.width||null===this.height)return n;var i=this._getOverlayPositionAndSize(t);return t.viewerElementToViewportRectangle(new e.Rect(i.position.x,i.position.y,i.size.x,i.size.y))}return n.rotate(-t.degrees,this._getPlacementPoint(n))}}}(OpenSeadragon),function(e){e.Drawer=function(t){e.console.assert(t.viewer,"[Drawer] options.viewer is required");var n=arguments;if(e.isPlainObject(t)||(t={source:n[0],viewport:n[1],element:n[2]}),e.console.assert(t.viewport,"[Drawer] options.viewport is required"),e.console.assert(t.element,"[Drawer] options.element is required"),t.source&&e.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=t.viewer,this.viewport=t.viewport,this.debugGridColor="string"==typeof t.debugGridColor?[t.debugGridColor]:t.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,t.opacity&&e.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=e.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=e.getElement(t.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var i=this._calculateCanvasSize();this.canvas.width=i.x,this.canvas.height=i.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",e.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},e.Drawer.prototype={addOverlay:function(t,n,i,r){return e.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(t,n,i,r),this},updateOverlay:function(t,n,i){return e.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(t,n,i),this},removeOverlay:function(t){return e.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(t),this},clearOverlays:function(){return e.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(t){var n=this.viewport.pixelFromPointNoRotate(t,!0);return new e.Point(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio)},clipWithPolygons:function(e,t){if(this.useCanvas){var n=this._getContext(t);n.beginPath(),e.forEach((function(e){e.forEach((function(e,t){n[0===t?"moveTo":"lineTo"](e.x,e.y)}))})),n.clip()}},setOpacity:function(t){e.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var n=this.viewer.world,i=0;i<n.getItemCount();i++)n.getItemAt(i).setOpacity(t);return this},getOpacity:function(){e.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var t=this.viewer.world,n=0,i=0;i<t.getItemCount();i++){var r=t.getItemAt(i).getOpacity();r>n&&(n=r)}return n},needsUpdate:function(){return e.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return e.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return e.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return e.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var e=this._calculateCanvasSize();if((this.canvas.width!=e.x||this.canvas.height!=e.y)&&(this.canvas.width=e.x,this.canvas.height=e.y,this._updateImageSmoothingEnabled(this.context),null!==this.sketchCanvas)){var t=this._calculateSketchCanvasSize();this.sketchCanvas.width=t.x,this.sketchCanvas.height=t.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(e,t){if(this.useCanvas){var n=this._getContext(e);if(t)n.clearRect(t.x,t.y,t.width,t.height);else{var i=n.canvas;n.clearRect(0,0,i.width,i.height)}}},viewportToDrawerRectangle:function(t){var n=this.viewport.pixelFromPointNoRotate(t.getTopLeft(),!0),i=this.viewport.deltaPixelsFromPointsNoRotate(t.getSize(),!0);return new e.Rect(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio,i.x*e.pixelDensityRatio,i.y*e.pixelDensityRatio)},drawTile:function(t,n,i,r,o){if(e.console.assert(t,"[Drawer.drawTile] tile is required"),e.console.assert(n,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var a=this._getContext(i);r=r||1,t.drawCanvas(a,n,r,o)}else t.drawHTML(this.canvas)},_getContext:function(e){var t=this.context;if(e){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var n=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=n.x,this.sketchCanvas.height=n.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var i=this;this.viewer.addHandler("rotate",(function e(){if(0!==i.viewport.getRotation()){i.viewer.removeHandler("rotate",e);var t=i._calculateSketchCanvasSize();i.sketchCanvas.width=t.x,i.sketchCanvas.height=t.y}}))}this._updateImageSmoothingEnabled(this.sketchContext)}t=this.sketchContext}return t},saveContext:function(e){this.useCanvas&&this._getContext(e).save()},restoreContext:function(e){this.useCanvas&&this._getContext(e).restore()},setClip:function(e,t){if(this.useCanvas){var n=this._getContext(t);n.beginPath(),n.rect(e.x,e.y,e.width,e.height),n.clip()}},drawRectangle:function(e,t,n){if(this.useCanvas){var i=this._getContext(n);i.save(),i.fillStyle=t,i.fillRect(e.x,e.y,e.width,e.height),i.restore()}},blendSketch:function(t,n,i,r){var o=t;if(e.isPlainObject(o)||(o={opacity:t,scale:n,translate:i,compositeOperation:r}),this.useCanvas&&this.sketchCanvas){t=o.opacity,r=o.compositeOperation;var a=o.bounds;if(this.context.save(),this.context.globalAlpha=t,r&&(this.context.globalCompositeOperation=r),a)a.x<0&&(a.width+=a.x,a.x=0),a.x+a.width>this.canvas.width&&(a.width=this.canvas.width-a.x),a.y<0&&(a.height+=a.y,a.y=0),a.y+a.height>this.canvas.height&&(a.height=this.canvas.height-a.y),this.context.drawImage(this.sketchCanvas,a.x,a.y,a.width,a.height,a.x,a.y,a.width,a.height);else{n=o.scale||1;var s=(i=o.translate)instanceof e.Point?i:new e.Point(0,0),l=0,c=0;if(i){var u=this.sketchCanvas.width-this.canvas.width,d=this.sketchCanvas.height-this.canvas.height;l=Math.round(u/2),c=Math.round(d/2)}this.context.drawImage(this.sketchCanvas,s.x-l*n,s.y-c*n,(this.canvas.width+2*l)*n,(this.canvas.height+2*c)*n,-l,-c,this.canvas.width+2*l,this.canvas.height+2*c)}this.context.restore()}},drawDebugInfo:function(t,n,i,r){if(this.useCanvas){var o=this.viewer.world.getIndexOfItem(r)%this.debugGridColor.length,a=this.context;a.save(),a.lineWidth=2*e.pixelDensityRatio,a.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",a.strokeStyle=this.debugGridColor[o],a.fillStyle=this.debugGridColor[o],0!==this.viewport.degrees&&this._offsetForRotation({degrees:this.viewport.degrees}),r.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:r.getRotation(!0),point:r.viewport.pixelFromPointNoRotate(r._getRotationPoint(!0),!0)}),0===r.viewport.degrees&&r.getRotation(!0)%360==0&&r._drawer.viewer.viewport.getFlip()&&r._drawer._flip(),a.strokeRect(t.position.x*e.pixelDensityRatio,t.position.y*e.pixelDensityRatio,t.size.x*e.pixelDensityRatio,t.size.y*e.pixelDensityRatio);var s=(t.position.x+t.size.x/2)*e.pixelDensityRatio,l=(t.position.y+t.size.y/2)*e.pixelDensityRatio;a.translate(s,l),a.rotate(Math.PI/180*-this.viewport.degrees),a.translate(-s,-l),0===t.x&&0===t.y&&(a.fillText("Zoom: "+this.viewport.getZoom(),t.position.x*e.pixelDensityRatio,(t.position.y-30)*e.pixelDensityRatio),a.fillText("Pan: "+this.viewport.getBounds().toString(),t.position.x*e.pixelDensityRatio,(t.position.y-20)*e.pixelDensityRatio)),a.fillText("Level: "+t.level,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+20)*e.pixelDensityRatio),a.fillText("Column: "+t.x,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+30)*e.pixelDensityRatio),a.fillText("Row: "+t.y,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+40)*e.pixelDensityRatio),a.fillText("Order: "+i+" of "+n,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+50)*e.pixelDensityRatio),a.fillText("Size: "+t.size.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+60)*e.pixelDensityRatio),a.fillText("Position: "+t.position.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+70)*e.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),r.getRotation(!0)%360!=0&&this._restoreRotationChanges(),0===r.viewport.degrees&&r.getRotation(!0)%360==0&&r._drawer.viewer.viewport.getFlip()&&r._drawer._flip(),a.restore()}},debugRect:function(t){if(this.useCanvas){var n=this.context;n.save(),n.lineWidth=2*e.pixelDensityRatio,n.strokeStyle=this.debugGridColor[0],n.fillStyle=this.debugGridColor[0],n.strokeRect(t.x*e.pixelDensityRatio,t.y*e.pixelDensityRatio,t.width*e.pixelDensityRatio,t.height*e.pixelDensityRatio),n.restore()}},setImageSmoothingEnabled:function(e){this.useCanvas&&(this._imageSmoothingEnabled=e,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(e){e.msImageSmoothingEnabled=this._imageSmoothingEnabled,e.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(t){var n=this._getContext(t).canvas;return new e.Point(n.width,n.height)},getCanvasCenter:function(){return new e.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(t){var n=t.point?t.point.times(e.pixelDensityRatio):this.getCanvasCenter(),i=this._getContext(t.useSketch);i.save(),i.translate(n.x,n.y),this.viewer.viewport.flipped?(i.rotate(Math.PI/180*-t.degrees),i.scale(-1,1)):i.rotate(Math.PI/180*t.degrees),i.translate(-n.x,-n.y)},_flip:function(t){var n=(t=t||{}).point?t.point.times(e.pixelDensityRatio):this.getCanvasCenter(),i=this._getContext(t.useSketch);i.translate(n.x,0),i.scale(-1,1),i.translate(-n.x,0)},_restoreRotationChanges:function(e){this._getContext(e).restore()},_calculateCanvasSize:function(){var t=e.pixelDensityRatio,n=this.viewport.getContainerSize();return{x:Math.round(n.x*t),y:Math.round(n.y*t)}},_calculateSketchCanvasSize:function(){var e=this._calculateCanvasSize();if(0===this.viewport.getRotation())return e;var t=Math.ceil(Math.sqrt(e.x*e.x+e.y*e.y));return{x:t,y:t}}}}(OpenSeadragon),function(e){e.Viewport=function(t){var n=arguments;n.length&&n[0]instanceof e.Point&&(t={containerSize:n[0],contentSize:n[1],config:n[2]}),t.config&&(e.extend(!0,t,t.config),delete t.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t.margins||{}),delete t.margins,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,degrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer},t),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={resetContentSize:function(t){return e.console.assert(t,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(t instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(t.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(t.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,t.y/t.x),t.x),this},setHomeBounds:function(t,n){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(t,n)},_setContentBounds:function(t,n){e.console.assert(t,"[Viewport._setContentBounds] bounds is required"),e.console.assert(t instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(t.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(t.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=t.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(n),this._contentBounds=t.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(n),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:n,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var e=this._contentAspectRatio/this.getAspectRatio();return(this.homeFillsViewer?e>=1?e:1:e>=1?1:e)/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var t=this._contentBounds.getCenter(),n=1/this.getHomeZoom(),i=n/this.getAspectRatio();return new e.Rect(t.x-n/2,t.y-i/2,n,i)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom();return this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*e},getMaxZoom:function(){var e=this.maxZoomLevel;return e||(e=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,e/=this._contentBounds.width),Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(t){e.console.assert("object"===e.type(t),"[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(-this.getRotation())},getBoundsNoRotate:function(t){var n=this.getCenter(t),i=1/this.getZoom(t),r=i/this.getAspectRatio();return new e.Rect(n.x-i/2,n.y-r/2,i,r)},getBoundsWithMargins:function(e){return this.getBoundsNoRotateWithMargins(e).rotate(-this.getRotation(),this.getCenter(e))},getBoundsNoRotateWithMargins:function(e){var t=this.getBoundsNoRotate(e),n=this._containerInnerSize.x*this.getZoom(e);return t.x-=this._margins.left/n,t.y-=this._margins.top/n,t.width+=(this._margins.left+this._margins.right)/n,t.height+=(this._margins.top+this._margins.bottom)/n,t},getCenter:function(t){var n,i,r,o,a,s,l=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),c=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return t?l:this.zoomPoint?(n=this.pixelFromPoint(this.zoomPoint,!0),o=(r=1/(i=this.getZoom()))/this.getAspectRatio(),a=new e.Rect(l.x-r/2,l.y-o/2,r,o),s=this._pixelFromPoint(this.zoomPoint,a).minus(n).divide(this._containerInnerSize.x*i),c.plus(s)):c},getZoom:function(e){return e?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(e){return Math.max(Math.min(e,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(t){var n=new e.Rect(t.x,t.y,t.width,t.height);if(this.wrapHorizontal);else{var i=this.visibilityRatio*n.width,r=n.x+n.width,o=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,a=this._contentBoundsNoRotate.x-r+i,s=o-n.x-i;i>this._contentBoundsNoRotate.width?n.x+=(a+s)/2:s<0?n.x+=s:a>0&&(n.x+=a)}if(this.wrapVertical);else{var l=this.visibilityRatio*n.height,c=n.y+n.height,u=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,d=this._contentBoundsNoRotate.y-c+l,h=u-n.y-l;l>this._contentBoundsNoRotate.height?n.y+=(d+h)/2:h<0?n.y+=h:d>0&&(n.y+=d)}return n},_raiseConstraintsEvent:function(e){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e})},applyConstraints:function(e){var t=this.getZoom(),n=this._applyZoomConstraints(t);t!==n&&this.zoomTo(n,this.zoomPoint,e);var i=this.getBoundsNoRotate(),r=this._applyBoundaryConstraints(i);return this._raiseConstraintsEvent(e),(i.x!==r.x||i.y!==r.y||e)&&this.fitBounds(r.rotate(-this.getRotation()),e),this},ensureVisible:function(e){return this.applyConstraints(e)},_fitBounds:function(t,n){var i=(n=n||{}).immediately||!1,r=n.constraints||!1,o=this.getAspectRatio(),a=t.getCenter(),s=new e.Rect(t.x,t.y,t.width,t.height,t.degrees+this.getRotation()).getBoundingBox();s.getAspectRatio()>=o?s.height=s.width/o:s.width=s.height*o,s.x=a.x-s.width/2,s.y=a.y-s.height/2;var l=1/s.width;if(r){var c=s.getAspectRatio(),u=this._applyZoomConstraints(l);l!==u&&(l=u,s.width=1/l,s.x=a.x-s.width/2,s.height=s.width/c,s.y=a.y-s.height/2),a=(s=this._applyBoundaryConstraints(s)).getCenter(),this._raiseConstraintsEvent(i)}if(i)return this.panTo(a,!0),this.zoomTo(l,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var d=this.getBounds(),h=this.getZoom();if(0===h||Math.abs(l/h-1)<1e-8)return this.zoomTo(l,!0),this.panTo(a,i);var p=(s=s.rotate(-this.getRotation())).getTopLeft().times(l).minus(d.getTopLeft().times(h)).divide(l-h);return this.zoomTo(l,p,i)},fitBounds:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!1})},fitBoundsWithConstraints:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!0})},fitVertically:function(t){var n=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(n,t)},fitHorizontally:function(t){var n=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(n,t)},getConstrainedBounds:function(e){var t;return t=this.getBounds(e),this._applyBoundaryConstraints(t)},panBy:function(t,n){var i=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(i.plus(t),n)},panTo:function(e,t){return t?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:t}),this},zoomBy:function(e,t,n){return this.zoomTo(this.zoomSpring.target.value*e,t,n)},zoomTo:function(t,n,i){var r=this;return this.zoomPoint=n instanceof e.Point&&!isNaN(n.x)&&!isNaN(n.y)?n:null,i?this._adjustCenterSpringsForZoomPoint((function(){r.zoomSpring.resetTo(t)})):this.zoomSpring.springTo(t),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:t,refPoint:n,immediately:i}),this},setRotation:function(t){return this.viewer&&this.viewer.drawer.canRotate()?(this.degrees=e.positiveModulo(t,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:t}),this):this},getRotation:function(){return this.degrees},resize:function(e,t){var n,i=this.getBoundsNoRotate(),r=i;return this.containerSize.x=e.x,this.containerSize.y=e.y,this._updateContainerInnerSize(),t&&(n=e.x/this.containerSize.x,r.width=i.width*n,r.height=r.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:e,maintain:t}),this.fitBounds(r,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var e=this;this._adjustCenterSpringsForZoomPoint((function(){e.zoomSpring.update()})),this.centerSpringX.update(),this.centerSpringY.update();var t=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,t},_adjustCenterSpringsForZoomPoint:function(e){if(this.zoomPoint){var t=this.pixelFromPoint(this.zoomPoint,!0);e();var n=this.pixelFromPoint(this.zoomPoint,!0).minus(t),i=this.deltaPointsFromPixels(n,!0);this.centerSpringX.shiftBy(i.x),this.centerSpringY.shiftBy(i.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else e()},deltaPixelsFromPointsNoRotate:function(e,t){return e.times(this._containerInnerSize.x*this.getZoom(t))},deltaPixelsFromPoints:function(e,t){return this.deltaPixelsFromPointsNoRotate(e.rotate(this.getRotation()),t)},deltaPointsFromPixelsNoRotate:function(e,t){return e.divide(this._containerInnerSize.x*this.getZoom(t))},deltaPointsFromPixels:function(e,t){return this.deltaPointsFromPixelsNoRotate(e,t).rotate(-this.getRotation())},pixelFromPointNoRotate:function(e,t){return this._pixelFromPointNoRotate(e,this.getBoundsNoRotate(t))},pixelFromPoint:function(e,t){return this._pixelFromPoint(e,this.getBoundsNoRotate(t))},_pixelFromPointNoRotate:function(t,n){return t.minus(n.getTopLeft()).times(this._containerInnerSize.x/n.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(e,t){return this._pixelFromPointNoRotate(e.rotate(this.getRotation(),this.getCenter(!0)),t)},pointFromPixelNoRotate:function(t,n){var i=this.getBoundsNoRotate(n);return t.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/i.width).plus(i.getTopLeft())},pointFromPixel:function(e,t){return this.pointFromPixelNoRotate(e,t).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(t,n){var i=this._contentBoundsNoRotate.width;return new e.Point(t*this._contentSizeNoRotate.x/i,n*this._contentSizeNoRotate.x/i)},viewportToImageCoordinates:function(t,n){if(t instanceof e.Point)return this.viewportToImageCoordinates(t.x,t.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===i){return this.viewer.world.getItemAt(0).viewportToImageCoordinates(t,n,!0)}}return this._viewportToImageDelta(t-this._contentBoundsNoRotate.x,n-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(t,n){var i=this._contentBoundsNoRotate.width;return new e.Point(t/this._contentSizeNoRotate.x*i,n/this._contentSizeNoRotate.x*i)},imageToViewportCoordinates:function(t,n){if(t instanceof e.Point)return this.imageToViewportCoordinates(t.x,t.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===i){return this.viewer.world.getItemAt(0).imageToViewportCoordinates(t,n,!0)}}var r=this._imageToViewportDelta(t,n);return r.x+=this._contentBoundsNoRotate.x,r.y+=this._contentBoundsNoRotate.y,r},imageToViewportRectangle:function(t,n,i,r){var o=t;if(o instanceof e.Rect||(o=new e.Rect(t,n,i,r)),this.viewer){var a=this.viewer.world.getItemCount();if(a>1)e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===a){return this.viewer.world.getItemAt(0).imageToViewportRectangle(t,n,i,r,!0)}}var s=this.imageToViewportCoordinates(o.x,o.y),l=this._imageToViewportDelta(o.width,o.height);return new e.Rect(s.x,s.y,l.x,l.y,o.degrees)},viewportToImageRectangle:function(t,n,i,r){var o=t;if(o instanceof e.Rect||(o=new e.Rect(t,n,i,r)),this.viewer){var a=this.viewer.world.getItemCount();if(a>1)e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===a){return this.viewer.world.getItemAt(0).viewportToImageRectangle(t,n,i,r,!0)}}var s=this.viewportToImageCoordinates(o.x,o.y),l=this._viewportToImageDelta(o.width,o.height);return new e.Rect(s.x,s.y,l.x,l.y,o.degrees)},viewerElementToImageCoordinates:function(e){var t=this.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.pixelFromPoint(t,!0)},windowToImageCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var n=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(n)},imageToWindowCoordinates:function(t){return e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer."),this.imageToViewerElementCoordinates(t).plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},viewerElementToViewportRectangle:function(t){return e.Rect.fromSummits(this.pointFromPixel(t.getTopLeft(),!0),this.pointFromPixel(t.getTopRight(),!0),this.pointFromPixel(t.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(t){return e.Rect.fromSummits(this.pixelFromPoint(t.getTopLeft(),!0),this.pixelFromPoint(t.getTopRight(),!0),this.pixelFromPoint(t.getBottomLeft(),!0))},windowToViewportCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var n=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(n)},viewportToWindowCoordinates:function(t){return e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer."),this.viewportToViewerElementCoordinates(t).plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(t){if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===n){return this.viewer.world.getItemAt(0).viewportToImageZoom(t)}}var i=this._contentSizeNoRotate.x;return t*(this._containerInnerSize.x/i*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(t){if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===n){return this.viewer.world.getItemAt(0).imageToViewportZoom(t)}}return t*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(e){return this.flipped===e||(this.flipped=e,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:e})),this}}}(OpenSeadragon),function(e){function t(e,t,i,r,o,a,l,c,u){var d=l.getBoundingBox().getTopLeft(),h=l.getBoundingBox().getBottomRight();e.viewer&&e.viewer.raiseEvent("update-level",{tiledImage:e,havedrawn:t,level:r,opacity:o,visibility:a,drawArea:l,topleft:d,bottomright:h,currenttime:c,best:u}),s(e.coverage,r),s(e.loadingCoverage,r);for(var p=e._getCornerTiles(r,d,h),f=p.topLeft,g=p.bottomRight,m=e.source.getNumTiles(r),v=e.viewport.pixelFromPoint(e.viewport.getCenter()),y=f.x;y<=g.x;y++)for(var b=f.y;b<=g.y;b++){if(!e.wrapHorizontal&&!e.wrapVertical){var _=e.source.getTileBounds(r,y,b);if(null===l.intersection(_))continue}u=n(e,i,t,y,b,r,o,a,v,m,c,u)}return u}function n(t,n,r,s,l,c,u,d,h,p,f,g){var m=function(t,n,i,r,o,a,s,l,c,u){var d,h,p,f,g,m,v,y,b;a[i]||(a[i]={});a[i][t]||(a[i][t]={});a[i][t][n]||(d=(l.x+t%l.x)%l.x,h=(l.y+n%l.y)%l.y,p=o.getTileBounds(i,d,h),f=o.getTileBounds(i,d,h,!0),g=o.tileExists(i,d,h),m=o.getTileUrl(i,d,h),r.loadTilesWithAjax?(v=o.getTileAjaxHeaders(i,d,h),e.isPlainObject(r.ajaxHeaders)&&(v=e.extend({},r.ajaxHeaders,v))):v=null,y=o.getContext2D?o.getContext2D(i,d,h):void 0,p.x+=(t-d)/l.x,p.y+=u/c*((n-h)/l.y),b=new e.Tile(i,t,n,p,g,m,y,r.loadTilesWithAjax,v,f),d===l.x-1&&(b.isRightMost=!0),h===l.y-1&&(b.isBottomMost=!0),a[i][t][n]=b);return(b=a[i][t][n]).lastTouchTime=s,b}(s,l,c,t,t.source,t.tilesMatrix,f,p,t._worldWidthCurrent,t._worldHeightCurrent),v=r;t.viewer&&t.viewer.raiseEvent("update-tile",{tiledImage:t,tile:m}),a(t.coverage,c,s,l,!1);var y=m.loaded||m.loading||o(t.loadingCoverage,c,s,l);if(a(t.loadingCoverage,c,s,l,y),!m.exists)return g;if(n&&!v&&(o(t.coverage,c,s,l)?a(t.coverage,c,s,l,!0):v=!0),!v)return g;if(function(t,n,i,r,o,a){var s=t.bounds.getTopLeft();s.x*=a._scaleSpring.current.value,s.y*=a._scaleSpring.current.value,s.x+=a._xSpring.current.value,s.y+=a._ySpring.current.value;var l=t.bounds.getSize();l.x*=a._scaleSpring.current.value,l.y*=a._scaleSpring.current.value;var c=i.pixelFromPointNoRotate(s,!0),u=i.pixelFromPointNoRotate(s,!1),d=i.deltaPixelsFromPointsNoRotate(l,!0),h=i.deltaPixelsFromPointsNoRotate(l,!1),p=u.plus(h.divide(2)),f=r.squaredDistanceTo(p);n||(d=d.plus(new e.Point(1,1)));t.isRightMost&&a.wrapHorizontal&&(d.x+=.75);t.isBottomMost&&a.wrapVertical&&(d.y+=.75);t.position=c,t.size=d,t.squaredDistance=f,t.visibility=o}(m,t.source.tileOverlap,t.viewport,h,d,t),!m.loaded)if(m.context2D)i(t,m);else{var b=t._tileCache.getImageRecord(m.cacheKey);if(b)i(t,m,b.getImage())}m.loaded?function(e,t,n,i,r,o,s){var l,c,u=1e3*e.blendTime;t.blendStart||(t.blendStart=s);l=s-t.blendStart,c=u?Math.min(1,l/u):1,e.alwaysBlend&&(c*=o);if(t.opacity=c,e.lastDrawn.push(t),1===c)a(e.coverage,r,n,i,!0),e._hasOpaqueTile=!0;else if(l<u)return!0;return!1}(t,m,s,l,c,u,f)&&(t._needsDraw=!0):m.loading?t._tilesLoading++:y||(g=function(e,t){if(!e)return t;if(t.visibility>e.visibility)return t;if(t.visibility==e.visibility&&t.squaredDistance<e.squaredDistance)return t;return e}(g,m));return g}function i(e,t,n,i,r){var o=0;function a(){return o++,s}function s(){0===--o&&(t.loading=!1,t.loaded=!0,t.context2D||e._tileCache.cacheTile({image:n,tile:t,cutoff:i,tiledImage:e}),e._needsDraw=!0)}e.viewer.raiseEvent("tile-loaded",{tile:t,tiledImage:e,tileRequest:r,image:n,getCompletionCallback:a}),a()()}function r(e,t,n,i){var r,o,a,s;if(!e[t])return!1;if(void 0===n||void 0===i){for(a in r=e[t])if(Object.prototype.hasOwnProperty.call(r,a))for(s in o=r[a])if(Object.prototype.hasOwnProperty.call(o,s)&&!o[s])return!1;return!0}return void 0===e[t][n]||void 0===e[t][n][i]||!0===e[t][n][i]}function o(e,t,n,i){return void 0===n||void 0===i?r(e,t+1):r(e,t+1,2*n,2*i)&&r(e,t+1,2*n,2*i+1)&&r(e,t+1,2*n+1,2*i)&&r(e,t+1,2*n+1,2*i+1)}function a(t,n,i,r,o){t[n]?(t[n][i]||(t[n][i]={}),t[n][i][r]=o):e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",n)}function s(e,t){e[t]={}}e.TiledImage=function(t){var n=this;e.console.assert(t.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(t.drawer,"[TiledImage] options.drawer is required"),e.console.assert(t.viewer,"[TiledImage] options.viewer is required"),e.console.assert(t.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(t.source,"[TiledImage] options.source is required"),e.console.assert(!t.clip||t.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=t.tileCache,delete t.tileCache,this._drawer=t.drawer,delete t.drawer,this._imageLoader=t.imageLoader,delete t.imageLoader,t.clip instanceof e.Rect&&(this._clip=t.clip.clone()),delete t.clip;var i=t.x||0;delete t.x;var r=t.y||0;delete t.y,this.normHeight=t.source.dimensions.y/t.source.dimensions.x,this.contentAspectX=t.source.dimensions.x/t.source.dimensions.y;var o=1;t.width?(o=t.width,delete t.width,t.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete t.height)):t.height&&(o=t.height/this.normHeight,delete t.height);var a=t.fitBounds;delete t.fitBounds;var s=t.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete t.fitBoundsPlacement;var l=t.degrees||0;delete t.degrees,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation},t),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:r,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:o,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:l,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),a&&this.fitBounds(a,s,!0),this._drawingHandler=function(t){n.viewer.raiseEvent("tile-drawing",e.extend({tiledImage:n},t))}},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(e){e!==this._fullyLoaded&&(this._fullyLoaded=e,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(){var e=this._xSpring.update(),t=this._ySpring.update(),n=this._scaleSpring.update(),i=this._degreesSpring.update();return!!(e||t||n||i)&&(this._updateForScale(),this._needsDraw=!0,!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(this.getRotation(e),this._getRotationPoint(e))},getBoundsNoRotate:function(t){return t?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(t){var n=this.getBoundsNoRotate(t);if(this._clip){var i=(t?this._worldWidthCurrent:this._worldWidthTarget)/this.source.dimensions.x,r=this._clip.times(i);n=new e.Rect(n.x+r.x,n.y+r.y,r.width,r.height)}return n.rotate(this.getRotation(t),this._getRotationPoint(t))},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(t,n,i){var r=i?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(t*(this.source.dimensions.x/r),n*(this.source.dimensions.y*this.contentAspectX/r))},viewportToImageCoordinates:function(t,n,i){var r;return t instanceof e.Point?(i=n,r=t):r=new e.Point(t,n),r=r.rotate(-this.getRotation(i),this._getRotationPoint(i)),i?this._viewportToImageDelta(r.x-this._xSpring.current.value,r.y-this._ySpring.current.value):this._viewportToImageDelta(r.x-this._xSpring.target.value,r.y-this._ySpring.target.value)},_imageToViewportDelta:function(t,n,i){var r=i?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(t/this.source.dimensions.x*r,n/this.source.dimensions.y/this.contentAspectX*r)},imageToViewportCoordinates:function(t,n,i){t instanceof e.Point&&(i=n,n=t.y,t=t.x);var r=this._imageToViewportDelta(t,n);return i?(r.x+=this._xSpring.current.value,r.y+=this._ySpring.current.value):(r.x+=this._xSpring.target.value,r.y+=this._ySpring.target.value),r.rotate(this.getRotation(i),this._getRotationPoint(i))},imageToViewportRectangle:function(t,n,i,r,o){var a=t;a instanceof e.Rect?o=n:a=new e.Rect(t,n,i,r);var s=this.imageToViewportCoordinates(a.getTopLeft(),o),l=this._imageToViewportDelta(a.width,a.height,o);return new e.Rect(s.x,s.y,l.x,l.y,a.degrees+this.getRotation(o))},viewportToImageRectangle:function(t,n,i,r,o){var a=t;t instanceof e.Rect?o=n:a=new e.Rect(t,n,i,r);var s=this.viewportToImageCoordinates(a.getTopLeft(),o),l=this._viewportToImageDelta(a.width,a.height,o);return new e.Rect(s.x,s.y,l.x,l.y,a.degrees-this.getRotation(o))},viewerElementToImageCoordinates:function(e){var t=this.viewport.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.viewport.pixelFromPoint(t,!0)},windowToImageCoordinates:function(e){var t=e.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(e){return this.imageToViewerElementCoordinates(e).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(t){var n=this._scaleSpring.current.value;return t=t.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((t.x-this._xSpring.current.value)/n,(t.y-this._ySpring.current.value)/n,t.width/n,t.height/n,t.degrees)},viewportToImageZoom:function(e){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*e},imageToViewportZoom:function(e){return e/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(e,t){var n=this._xSpring.target.value===e.x&&this._ySpring.target.value===e.y;if(t){if(n&&this._xSpring.current.value===e.x&&this._ySpring.current.value===e.y)return;this._xSpring.resetTo(e.x),this._ySpring.resetTo(e.y),this._needsDraw=!0}else{if(n)return;this._xSpring.springTo(e.x),this._ySpring.springTo(e.y),this._needsDraw=!0}n||this._raiseBoundsChange()},setWidth:function(e,t){this._setScale(e,t)},setHeight:function(e,t){this._setScale(e/this.normHeight,t)},setCroppingPolygons:function(t){var n=function(t){return t.map((function(t){try{if(function(t){return t instanceof e.Point||"number"==typeof t.x&&"number"==typeof t.y}(t))return{x:t.x,y:t.y};throw new Error}catch(e){throw new Error("A Provided cropping polygon point is not supported")}}))};try{if(!e.isArray(t))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=t.map((function(e){return n(e)}))}catch(t){e.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),e.console.error(t),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(t,n,i){n=n||e.Placement.CENTER;var r=e.Placement.properties[n],o=this.contentAspectX,a=0,s=0,l=1,c=1;if(this._clip&&(o=this._clip.getAspectRatio(),l=this._clip.width/this.source.dimensions.x,c=this._clip.height/this.source.dimensions.y,t.getAspectRatio()>o?(a=this._clip.x/this._clip.height*t.height,s=this._clip.y/this._clip.height*t.height):(a=this._clip.x/this._clip.width*t.width,s=this._clip.y/this._clip.width*t.width)),t.getAspectRatio()>o){var u=t.height/c,d=0;r.isHorizontallyCentered?d=(t.width-t.height*o)/2:r.isRight&&(d=t.width-t.height*o),this.setPosition(new e.Point(t.x-a+d,t.y-s),i),this.setHeight(u,i)}else{var h=t.width/l,p=0;r.isVerticallyCentered?p=(t.height-t.width/o)/2:r.isBottom&&(p=t.height-t.width/o),this.setPosition(new e.Point(t.x-a,t.y-s+p),i),this.setWidth(h,i)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(t){e.console.assert(!t||t instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),t instanceof e.Rect?this._clip=t.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(e){e!==this.opacity&&(this.opacity=e,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(e){this._preload=!!e,this._needsDraw=!0},getRotation:function(e){return e?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(e,t){this._degreesSpring.target.value===e&&this._degreesSpring.isAtTargetValue()||(t?this._degreesSpring.resetTo(e):this._degreesSpring.springTo(e),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(e){return this.getBoundsNoRotate(e).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(e){e!==this.compositeOperation&&(this.compositeOperation=e,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(e,t){var n=this._scaleSpring.target.value===e;if(t){if(n&&this._scaleSpring.current.value===e)return;this._scaleSpring.resetTo(e),this._updateForScale(),this._needsDraw=!0}else{if(n)return;this._scaleSpring.springTo(e),this._updateForScale(),this._needsDraw=!0}n||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var e=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),t=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,n=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(t/this.minPixelRatio)/Math.log(2))));return n=Math.max(n,this.source.minLevel||0),{lowestLevel:e=Math.min(e,n),highestLevel:n}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){this.lastDrawn.pop().beingDrawn=!1}var n=this.viewport,o=this._viewportToTiledImageRectangle(n.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var a=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(o=o.intersection(a)))return}for(var s=this._getLevelsInterval(),l=s.lowestLevel,c=s.highestLevel,u=null,d=!1,h=e.now(),p=c;p>=l;p--){var f=!1,g=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(p),!0).x*this._scaleSpring.current.value;if(p===l||!d&&g>=this.minPixelRatio)f=!0,d=!0;else if(!d)continue;var m=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(p),!1).x*this._scaleSpring.current.value,v=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,y=this.immediateRender?1:v;if(u=t(this,d,f,p,Math.min(1,(g-.5)/.5),y/Math.abs(y-m),o,h,u),r(this.coverage,p))break}!function(t,n){if(0===t.opacity||0===n.length&&!t.placeholderFillStyle)return;var i,r,o,a=n[0];a&&(i=t.opacity<1||t.compositeOperation&&"source-over"!==t.compositeOperation||!t._isBottomItem()&&a._hasTransparencyChannel());var s,l=t.viewport.getZoom(!0),c=t.viewportToImageZoom(l);n.length>1&&c>t.smoothTileEdgesMinZoom&&!t.iOSDevice&&t.getRotation(!0)%360==0&&e.supportsCanvas&&(i=!0,r=a.getScaleForEdgeSmoothing(),o=a.getTranslationForEdgeSmoothing(r,t._drawer.getCanvasSize(!1),t._drawer.getCanvasSize(!0)));i&&(r||(s=t.viewport.viewportToViewerElementRectangle(t.getClippedBounds(!0)).getIntegerBoundingBox(),t._drawer.viewer.viewport.getFlip()&&(0===t.viewport.degrees&&t.getRotation(!0)%360==0||(s.x=t._drawer.viewer.container.clientWidth-(s.x+s.width))),s=s.times(e.pixelDensityRatio)),t._drawer._clear(!0,s));r||(0!==t.viewport.degrees&&t._drawer._offsetForRotation({degrees:t.viewport.degrees,useSketch:i}),t.getRotation(!0)%360!=0&&t._drawer._offsetForRotation({degrees:t.getRotation(!0),point:t.viewport.pixelFromPointNoRotate(t._getRotationPoint(!0),!0),useSketch:i}),0===t.viewport.degrees&&t.getRotation(!0)%360==0&&t._drawer.viewer.viewport.getFlip()&&t._drawer._flip());var u=!1;if(t._clip){t._drawer.saveContext(i);var d=t.imageToViewportRectangle(t._clip,!0);d=d.rotate(-t.getRotation(!0),t._getRotationPoint(!0));var h=t._drawer.viewportToDrawerRectangle(d);r&&(h=h.times(r)),o&&(h=h.translate(o)),t._drawer.setClip(h,i),u=!0}if(t._croppingPolygons){t._drawer.saveContext(i);try{var p=t._croppingPolygons.map((function(e){return e.map((function(e){var n=t.imageToViewportCoordinates(e.x,e.y,!0).rotate(-t.getRotation(!0),t._getRotationPoint(!0)),i=t._drawer.viewportCoordToDrawerCoord(n);return r&&(i=i.times(r)),i}))}));t._drawer.clipWithPolygons(p,i)}catch(t){e.console.error(t)}u=!0}if(t.placeholderFillStyle&&!1===t._hasOpaqueTile){var f=t._drawer.viewportToDrawerRectangle(t.getBounds(!0));r&&(f=f.times(r)),o&&(f=f.translate(o));var g=null;g="function"==typeof t.placeholderFillStyle?t.placeholderFillStyle(t,t._drawer.context):t.placeholderFillStyle,t._drawer.drawRectangle(f,g,i)}for(var m=n.length-1;m>=0;m--)a=n[m],t._drawer.drawTile(a,t._drawingHandler,i,r,o),a.beingDrawn=!0,t.viewer&&t.viewer.raiseEvent("tile-drawn",{tiledImage:t,tile:a});u&&t._drawer.restoreContext(i);r||(t.getRotation(!0)%360!=0&&t._drawer._restoreRotationChanges(i),0!==t.viewport.degrees&&t._drawer._restoreRotationChanges(i));i&&(r&&(0!==t.viewport.degrees&&t._drawer._offsetForRotation({degrees:t.viewport.degrees,useSketch:!1}),t.getRotation(!0)%360!=0&&t._drawer._offsetForRotation({degrees:t.getRotation(!0),point:t.viewport.pixelFromPointNoRotate(t._getRotationPoint(!0),!0),useSketch:!1})),t._drawer.blendSketch({opacity:t.opacity,scale:r,translate:o,compositeOperation:t.compositeOperation,bounds:s}),r&&(t.getRotation(!0)%360!=0&&t._drawer._restoreRotationChanges(!1),0!==t.viewport.degrees&&t._drawer._restoreRotationChanges(!1)));r||0===t.viewport.degrees&&t.getRotation(!0)%360==0&&t._drawer.viewer.viewport.getFlip()&&t._drawer._flip();!function(t,n){if(t.debugMode)for(var i=n.length-1;i>=0;i--){var r=n[i];try{t._drawer.drawDebugInfo(r,n.length,i,t)}catch(t){e.console.error(t)}}}(t,n)}(this,this.lastDrawn),u&&!u.context2D?(!function(t,n,r){n.loading=!0,t._imageLoader.addJob({src:n.url,loadWithAjax:n.loadWithAjax,ajaxHeaders:n.ajaxHeaders,crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,callback:function(o,a,s){!function(t,n,r,o,a,s){if(!o)return e.console.log("Tile %s failed to load: %s - error: %s",n,n.url,a),t.viewer.raiseEvent("tile-load-failed",{tile:n,tiledImage:t,time:r,message:a,tileRequest:s}),n.loading=!1,void(n.exists=!1);if(r<t.lastResetTime)return e.console.log("Ignoring tile %s loaded before reset: %s",n,n.url),void(n.loading=!1);var l=function(){var e=t.source.getClosestLevel();i(t,n,o,e,s)};t._midDraw?window.setTimeout(l,1):l()}(t,n,r,o,a,s)},abort:function(){n.loading=!1}})}(this,u,h),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(t,n,i){var r,o,a,s;this.wrapHorizontal?(r=e.positiveModulo(n.x,1),o=e.positiveModulo(i.x,1)):(r=Math.max(0,n.x),o=Math.min(1,i.x));var l=1/this.source.aspectRatio;this.wrapVertical?(a=e.positiveModulo(n.y,l),s=e.positiveModulo(i.y,l)):(a=Math.max(0,n.y),s=Math.min(l,i.y));var c=this.source.getTileAtPoint(t,new e.Point(r,a)),u=this.source.getTileAtPoint(t,new e.Point(o,s)),d=this.source.getNumTiles(t);return this.wrapHorizontal&&(c.x+=d.x*Math.floor(n.x),u.x+=d.x*Math.floor(i.x)),this.wrapVertical&&(c.y+=d.y*Math.floor(n.y/l),u.y+=d.y*Math.floor(i.y/l)),{topLeft:c,bottomRight:u}}})}(OpenSeadragon),function(e){var t=function(t){e.console.assert(t,"[TileCache.cacheTile] options is required"),e.console.assert(t.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(t.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=t.tile,this.tiledImage=t.tiledImage},n=function(t){e.console.assert(t,"[ImageRecord] options is required"),e.console.assert(t.image,"[ImageRecord] options.image is required"),this._image=t.image,this._tiles=[]};n.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var e=document.createElement("canvas");e.width=this._image.width,e.height=this._image.height,this._renderedContext=e.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(t){e.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=t},addTile:function(t){e.console.assert(t,"[ImageRecord.addTile] tile is required"),this._tiles.push(t)},removeTile:function(t){for(var n=0;n<this._tiles.length;n++)if(this._tiles[n]===t)return void this._tiles.splice(n,1);e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",t)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(t){t=t||{},this._maxImageCacheCount=t.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(i){e.console.assert(i,"[TileCache.cacheTile] options is required"),e.console.assert(i.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(i.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(i.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var r=i.cutoff||0,o=this._tilesLoaded.length,a=this._imagesLoaded[i.tile.cacheKey];if(a||(e.console.assert(i.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),a=this._imagesLoaded[i.tile.cacheKey]=new n({image:i.image}),this._imagesLoadedCount++),a.addTile(i.tile),i.tile.cacheImageRecord=a,this._imagesLoadedCount>this._maxImageCacheCount){for(var s,l,c,u,d,h,p=null,f=-1,g=null,m=this._tilesLoaded.length-1;m>=0;m--)(s=(h=this._tilesLoaded[m]).tile).level<=r||s.beingDrawn||(p?(u=s.lastTouchTime,l=p.lastTouchTime,d=s.level,c=p.level,(u<l||u==l&&d>c)&&(p=s,f=m,g=h)):(p=s,f=m,g=h));p&&f>=0&&(this._unloadTile(g),o=f)}this._tilesLoaded[o]=new t({tile:i.tile,tiledImage:i.tiledImage})},clearTilesFor:function(t){var n;e.console.assert(t,"[TileCache.clearTilesFor] tiledImage is required");for(var i=0;i<this._tilesLoaded.length;++i)(n=this._tilesLoaded[i]).tiledImage===t&&(this._unloadTile(n),this._tilesLoaded.splice(i,1),i--)},getImageRecord:function(t){return e.console.assert(t,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[t]},_unloadTile:function(t){e.console.assert(t,"[TileCache._unloadTile] tileRecord is required");var n=t.tile,i=t.tiledImage;n.unload(),n.cacheImageRecord=null;var r=this._imagesLoaded[n.cacheKey];r.removeTile(n),r.getTileCount()||(r.destroy(),delete this._imagesLoaded[n.cacheKey],this._imagesLoadedCount--),i.viewer.raiseEvent("tile-unloaded",{tile:n,tiledImage:i})}}}(OpenSeadragon),function(e){e.World=function(t){var n=this;e.console.assert(t.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=t.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(e){n._autoRefigureSizes?n._figureSizes():n._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(t,n){if(e.console.assert(t,"[World.addItem] item is required"),e.console.assert(t instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),void 0!==(n=n||{}).index){var i=Math.max(0,Math.min(this._items.length,n.index));this._items.splice(i,0,t)}else this._items.push(t);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,t.addHandler("bounds-change",this._delegatedFigureSizes),t.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:t})},getItemAt:function(t){return e.console.assert(void 0!==t,"[World.getItemAt] index is required"),this._items[t]},getIndexOfItem:function(t){return e.console.assert(t,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,t)},getItemCount:function(){return this._items.length},setItemIndex:function(t,n){e.console.assert(t,"[World.setItemIndex] item is required"),e.console.assert(void 0!==n,"[World.setItemIndex] index is required");var i=this.getIndexOfItem(t);if(n>=this._items.length)throw new Error("Index bigger than number of layers.");n!==i&&-1!==i&&(this._items.splice(i,1),this._items.splice(n,0,t),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:t,previousIndex:i,newIndex:n}))},removeItem:function(t){e.console.assert(t,"[World.removeItem] item is required");var n=e.indexOf(this._items,t);-1!==n&&(t.removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy(),this._items.splice(n,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(t))},removeAll:function(){var e,t;for(this.viewer._cancelPendingImages(),t=0;t<this._items.length;t++)(e=this._items[t]).removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy();var n=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,t=0;t<n.length;t++)e=n[t],this._raiseRemoveItem(e)},resetItems:function(){for(var e=0;e<this._items.length;e++)this._items[e].reset()},update:function(){for(var e=!1,t=0;t<this._items.length;t++)e=this._items[t].update()||e;return e},draw:function(){for(var e=0;e<this._items.length;e++)this._items[e].draw();this._needsDraw=!1},needsDraw:function(){for(var e=0;e<this._items.length;e++)if(this._items[e].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(e){this._autoRefigureSizes=e,e&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(t){var n,i=(t=t||{}).immediately||!1,r=t.layout||e.DEFAULT_SETTINGS.collectionLayout,o=t.rows||e.DEFAULT_SETTINGS.collectionRows,a=t.columns||e.DEFAULT_SETTINGS.collectionColumns,s=t.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,l=s+(t.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin);n=!t.rows&&a?a:Math.ceil(this._items.length/o);var c,u,d,h,p,f=0,g=0;this.setAutoRefigureSizes(!1);for(var m=0;m<this._items.length;m++)m&&m%n==0&&("horizontal"===r?(g+=l,f=0):(f+=l,g=0)),h=(d=(u=(c=this._items[m]).getBounds()).width>u.height?s:s*(u.width/u.height))*(u.height/u.width),p=new e.Point(f+(s-d)/2,g+(s-h)/2),c.setPosition(p,i),c.setWidth(d,i),"horizontal"===r?f+=l:g+=l;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var t=this._homeBounds?this._homeBounds.clone():null,n=this._contentSize?this._contentSize.clone():null,i=this._contentFactor||0;if(this._items.length){var r=this._items[0],o=r.getBounds();this._contentFactor=r.getContentSize().x/o.width;for(var a=r.getClippedBounds().getBoundingBox(),s=a.x,l=a.y,c=a.x+a.width,u=a.y+a.height,d=1;d<this._items.length;d++)o=(r=this._items[d]).getBounds(),this._contentFactor=Math.max(this._contentFactor,r.getContentSize().x/o.width),a=r.getClippedBounds().getBoundingBox(),s=Math.min(s,a.x),l=Math.min(l,a.y),c=Math.max(c,a.x+a.width),u=Math.max(u,a.y+a.height);this._homeBounds=new e.Rect(s,l,c-s,u-l),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;this._contentFactor===i&&this._homeBounds.equals(t)&&this._contentSize.equals(n)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(e){this.raiseEvent("remove-item",{item:e})}})}(OpenSeadragon)},function(e,t,n){var i,r;
/**
 * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 2.3.9
 * Copyright (C) 2020 Oliver Nightingale
 * @license MIT
 */!function(){var o,a,s,l,c,u,d,h,p,f,g,m,v,y,b,_,x,w,S,T,E,C,k,L,P,A,O=function(e){var t=new O.Builder;return t.pipeline.add(O.trimmer,O.stopWordFilter,O.stemmer),t.searchPipeline.add(O.stemmer),e.call(t,t),t.build()};O.version="2.3.9"
/*!
 * lunr.utils
 * Copyright (C) 2020 Oliver Nightingale
 */,O.utils={},O.utils.warn=(o=this,function(e){o.console&&console.warn&&console.warn(e)}),O.utils.asString=function(e){return null==e?"":e.toString()},O.utils.clone=function(e){if(null==e)return e;for(var t=Object.create(null),n=Object.keys(e),i=0;i<n.length;i++){var r=n[i],o=e[r];if(Array.isArray(o))t[r]=o.slice();else{if("string"!=typeof o&&"number"!=typeof o&&"boolean"!=typeof o)throw new TypeError("clone is not deep and does not support nested objects");t[r]=o}}return t},O.FieldRef=function(e,t,n){this.docRef=e,this.fieldName=t,this._stringValue=n},O.FieldRef.joiner="/",O.FieldRef.fromString=function(e){var t=e.indexOf(O.FieldRef.joiner);if(-1===t)throw"malformed field ref string";var n=e.slice(0,t),i=e.slice(t+1);return new O.FieldRef(i,n,e)},O.FieldRef.prototype.toString=function(){return null==this._stringValue&&(this._stringValue=this.fieldName+O.FieldRef.joiner+this.docRef),this._stringValue}
/*!
 * lunr.Set
 * Copyright (C) 2020 Oliver Nightingale
 */,O.Set=function(e){if(this.elements=Object.create(null),e){this.length=e.length;for(var t=0;t<this.length;t++)this.elements[e[t]]=!0}else this.length=0},O.Set.complete={intersect:function(e){return e},union:function(){return this},contains:function(){return!0}},O.Set.empty={intersect:function(){return this},union:function(e){return e},contains:function(){return!1}},O.Set.prototype.contains=function(e){return!!this.elements[e]},O.Set.prototype.intersect=function(e){var t,n,i,r=[];if(e===O.Set.complete)return this;if(e===O.Set.empty)return e;this.length<e.length?(t=this,n=e):(t=e,n=this),i=Object.keys(t.elements);for(var o=0;o<i.length;o++){var a=i[o];a in n.elements&&r.push(a)}return new O.Set(r)},O.Set.prototype.union=function(e){return e===O.Set.complete?O.Set.complete:e===O.Set.empty?this:new O.Set(Object.keys(this.elements).concat(Object.keys(e.elements)))},O.idf=function(e,t){var n=0;for(var i in e)"_index"!=i&&(n+=Object.keys(e[i]).length);var r=(t-n+.5)/(n+.5);return Math.log(1+Math.abs(r))},O.Token=function(e,t){this.str=e||"",this.metadata=t||{}},O.Token.prototype.toString=function(){return this.str},O.Token.prototype.update=function(e){return this.str=e(this.str,this.metadata),this},O.Token.prototype.clone=function(e){return e=e||function(e){return e},new O.Token(e(this.str,this.metadata),this.metadata)}
/*!
 * lunr.tokenizer
 * Copyright (C) 2020 Oliver Nightingale
 */,O.tokenizer=function(e,t){if(null==e||null==e)return[];if(Array.isArray(e))return e.map((function(e){return new O.Token(O.utils.asString(e).toLowerCase(),O.utils.clone(t))}));for(var n=e.toString().toLowerCase(),i=n.length,r=[],o=0,a=0;o<=i;o++){var s=o-a;if(n.charAt(o).match(O.tokenizer.separator)||o==i){if(s>0){var l=O.utils.clone(t)||{};l.position=[a,s],l.index=r.length,r.push(new O.Token(n.slice(a,o),l))}a=o+1}}return r},O.tokenizer.separator=/[\s\-]+/
/*!
 * lunr.Pipeline
 * Copyright (C) 2020 Oliver Nightingale
 */,O.Pipeline=function(){this._stack=[]},O.Pipeline.registeredFunctions=Object.create(null),O.Pipeline.registerFunction=function(e,t){t in this.registeredFunctions&&O.utils.warn("Overwriting existing registered function: "+t),e.label=t,O.Pipeline.registeredFunctions[e.label]=e},O.Pipeline.warnIfFunctionNotRegistered=function(e){e.label&&e.label in this.registeredFunctions||O.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",e)},O.Pipeline.load=function(e){var t=new O.Pipeline;return e.forEach((function(e){var n=O.Pipeline.registeredFunctions[e];if(!n)throw new Error("Cannot load unregistered function: "+e);t.add(n)})),t},O.Pipeline.prototype.add=function(){var e=Array.prototype.slice.call(arguments);e.forEach((function(e){O.Pipeline.warnIfFunctionNotRegistered(e),this._stack.push(e)}),this)},O.Pipeline.prototype.after=function(e,t){O.Pipeline.warnIfFunctionNotRegistered(t);var n=this._stack.indexOf(e);if(-1==n)throw new Error("Cannot find existingFn");n+=1,this._stack.splice(n,0,t)},O.Pipeline.prototype.before=function(e,t){O.Pipeline.warnIfFunctionNotRegistered(t);var n=this._stack.indexOf(e);if(-1==n)throw new Error("Cannot find existingFn");this._stack.splice(n,0,t)},O.Pipeline.prototype.remove=function(e){var t=this._stack.indexOf(e);-1!=t&&this._stack.splice(t,1)},O.Pipeline.prototype.run=function(e){for(var t=this._stack.length,n=0;n<t;n++){for(var i=this._stack[n],r=[],o=0;o<e.length;o++){var a=i(e[o],o,e);if(null!=a&&""!==a)if(Array.isArray(a))for(var s=0;s<a.length;s++)r.push(a[s]);else r.push(a)}e=r}return e},O.Pipeline.prototype.runString=function(e,t){var n=new O.Token(e,t);return this.run([n]).map((function(e){return e.toString()}))},O.Pipeline.prototype.reset=function(){this._stack=[]},O.Pipeline.prototype.toJSON=function(){return this._stack.map((function(e){return O.Pipeline.warnIfFunctionNotRegistered(e),e.label}))}
/*!
 * lunr.Vector
 * Copyright (C) 2020 Oliver Nightingale
 */,O.Vector=function(e){this._magnitude=0,this.elements=e||[]},O.Vector.prototype.positionForIndex=function(e){if(0==this.elements.length)return 0;for(var t=0,n=this.elements.length/2,i=n-t,r=Math.floor(i/2),o=this.elements[2*r];i>1&&(o<e&&(t=r),o>e&&(n=r),o!=e);)i=n-t,r=t+Math.floor(i/2),o=this.elements[2*r];return o==e||o>e?2*r:o<e?2*(r+1):void 0},O.Vector.prototype.insert=function(e,t){this.upsert(e,t,(function(){throw"duplicate index"}))},O.Vector.prototype.upsert=function(e,t,n){this._magnitude=0;var i=this.positionForIndex(e);this.elements[i]==e?this.elements[i+1]=n(this.elements[i+1],t):this.elements.splice(i,0,e,t)},O.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var e=0,t=this.elements.length,n=1;n<t;n+=2){var i=this.elements[n];e+=i*i}return this._magnitude=Math.sqrt(e)},O.Vector.prototype.dot=function(e){for(var t=0,n=this.elements,i=e.elements,r=n.length,o=i.length,a=0,s=0,l=0,c=0;l<r&&c<o;)(a=n[l])<(s=i[c])?l+=2:a>s?c+=2:a==s&&(t+=n[l+1]*i[c+1],l+=2,c+=2);return t},O.Vector.prototype.similarity=function(e){return this.dot(e)/this.magnitude()||0},O.Vector.prototype.toArray=function(){for(var e=new Array(this.elements.length/2),t=1,n=0;t<this.elements.length;t+=2,n++)e[n]=this.elements[t];return e},O.Vector.prototype.toJSON=function(){return this.elements}
/*!
 * lunr.stemmer
 * Copyright (C) 2020 Oliver Nightingale
 * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt
 */,O.stemmer=(a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},s={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},l="[aeiouy]",c="[^aeiou][^aeiouy]*",u=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),d=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),h=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$"),p=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy]"),f=/^(.+?)(ss|i)es$/,g=/^(.+?)([^s])s$/,m=/^(.+?)eed$/,v=/^(.+?)(ed|ing)$/,y=/.$/,b=/(at|bl|iz)$/,_=new RegExp("([^aeiouylsz])\\1$"),x=new RegExp("^"+c+l+"[^aeiouwxy]$"),w=/^(.+?[^aeiou])y$/,S=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,T=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,E=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,C=/^(.+?)(s|t)(ion)$/,k=/^(.+?)e$/,L=/ll$/,P=new RegExp("^"+c+l+"[^aeiouwxy]$"),A=function(e){var t,n,i,r,o,l,c;if(e.length<3)return e;if("y"==(i=e.substr(0,1))&&(e=i.toUpperCase()+e.substr(1)),o=g,(r=f).test(e)?e=e.replace(r,"$1$2"):o.test(e)&&(e=e.replace(o,"$1$2")),o=v,(r=m).test(e)){var A=r.exec(e);(r=u).test(A[1])&&(r=y,e=e.replace(r,""))}else o.test(e)&&(t=(A=o.exec(e))[1],(o=p).test(t)&&(l=_,c=x,(o=b).test(e=t)?e+="e":l.test(e)?(r=y,e=e.replace(r,"")):c.test(e)&&(e+="e")));return(r=w).test(e)&&(e=(t=(A=r.exec(e))[1])+"i"),(r=S).test(e)&&(t=(A=r.exec(e))[1],n=A[2],(r=u).test(t)&&(e=t+a[n])),(r=T).test(e)&&(t=(A=r.exec(e))[1],n=A[2],(r=u).test(t)&&(e=t+s[n])),o=C,(r=E).test(e)?(t=(A=r.exec(e))[1],(r=d).test(t)&&(e=t)):o.test(e)&&(t=(A=o.exec(e))[1]+A[2],(o=d).test(t)&&(e=t)),(r=k).test(e)&&(t=(A=r.exec(e))[1],o=h,l=P,((r=d).test(t)||o.test(t)&&!l.test(t))&&(e=t)),o=d,(r=L).test(e)&&o.test(e)&&(r=y,e=e.replace(r,"")),"y"==i&&(e=i.toLowerCase()+e.substr(1)),e},function(e){return e.update(A)}),O.Pipeline.registerFunction(O.stemmer,"stemmer")
/*!
 * lunr.stopWordFilter
 * Copyright (C) 2020 Oliver Nightingale
 */,O.generateStopWordFilter=function(e){var t=e.reduce((function(e,t){return e[t]=t,e}),{});return function(e){if(e&&t[e.toString()]!==e.toString())return e}},O.stopWordFilter=O.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),O.Pipeline.registerFunction(O.stopWordFilter,"stopWordFilter")
/*!
 * lunr.trimmer
 * Copyright (C) 2020 Oliver Nightingale
 */,O.trimmer=function(e){return e.update((function(e){return e.replace(/^\W+/,"").replace(/\W+$/,"")}))},O.Pipeline.registerFunction(O.trimmer,"trimmer")
/*!
 * lunr.TokenSet
 * Copyright (C) 2020 Oliver Nightingale
 */,O.TokenSet=function(){this.final=!1,this.edges={},this.id=O.TokenSet._nextId,O.TokenSet._nextId+=1},O.TokenSet._nextId=1,O.TokenSet.fromArray=function(e){for(var t=new O.TokenSet.Builder,n=0,i=e.length;n<i;n++)t.insert(e[n]);return t.finish(),t.root},O.TokenSet.fromClause=function(e){return"editDistance"in e?O.TokenSet.fromFuzzyString(e.term,e.editDistance):O.TokenSet.fromString(e.term)},O.TokenSet.fromFuzzyString=function(e,t){for(var n=new O.TokenSet,i=[{node:n,editsRemaining:t,str:e}];i.length;){var r=i.pop();if(r.str.length>0){var o,a=r.str.charAt(0);a in r.node.edges?o=r.node.edges[a]:(o=new O.TokenSet,r.node.edges[a]=o),1==r.str.length&&(o.final=!0),i.push({node:o,editsRemaining:r.editsRemaining,str:r.str.slice(1)})}if(0!=r.editsRemaining){if("*"in r.node.edges)var s=r.node.edges["*"];else{s=new O.TokenSet;r.node.edges["*"]=s}if(0==r.str.length&&(s.final=!0),i.push({node:s,editsRemaining:r.editsRemaining-1,str:r.str}),r.str.length>1&&i.push({node:r.node,editsRemaining:r.editsRemaining-1,str:r.str.slice(1)}),1==r.str.length&&(r.node.final=!0),r.str.length>=1){if("*"in r.node.edges)var l=r.node.edges["*"];else{l=new O.TokenSet;r.node.edges["*"]=l}1==r.str.length&&(l.final=!0),i.push({node:l,editsRemaining:r.editsRemaining-1,str:r.str.slice(1)})}if(r.str.length>1){var c,u=r.str.charAt(0),d=r.str.charAt(1);d in r.node.edges?c=r.node.edges[d]:(c=new O.TokenSet,r.node.edges[d]=c),1==r.str.length&&(c.final=!0),i.push({node:c,editsRemaining:r.editsRemaining-1,str:u+r.str.slice(2)})}}}return n},O.TokenSet.fromString=function(e){for(var t=new O.TokenSet,n=t,i=0,r=e.length;i<r;i++){var o=e[i],a=i==r-1;if("*"==o)t.edges[o]=t,t.final=a;else{var s=new O.TokenSet;s.final=a,t.edges[o]=s,t=s}}return n},O.TokenSet.prototype.toArray=function(){for(var e=[],t=[{prefix:"",node:this}];t.length;){var n=t.pop(),i=Object.keys(n.node.edges),r=i.length;n.node.final&&(n.prefix.charAt(0),e.push(n.prefix));for(var o=0;o<r;o++){var a=i[o];t.push({prefix:n.prefix.concat(a),node:n.node.edges[a]})}}return e},O.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var e=this.final?"1":"0",t=Object.keys(this.edges).sort(),n=t.length,i=0;i<n;i++){var r=t[i];e=e+r+this.edges[r].id}return e},O.TokenSet.prototype.intersect=function(e){for(var t=new O.TokenSet,n=void 0,i=[{qNode:e,output:t,node:this}];i.length;){n=i.pop();for(var r=Object.keys(n.qNode.edges),o=r.length,a=Object.keys(n.node.edges),s=a.length,l=0;l<o;l++)for(var c=r[l],u=0;u<s;u++){var d=a[u];if(d==c||"*"==c){var h=n.node.edges[d],p=n.qNode.edges[c],f=h.final&&p.final,g=void 0;d in n.output.edges?(g=n.output.edges[d]).final=g.final||f:((g=new O.TokenSet).final=f,n.output.edges[d]=g),i.push({qNode:p,output:g,node:h})}}}return t},O.TokenSet.Builder=function(){this.previousWord="",this.root=new O.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},O.TokenSet.Builder.prototype.insert=function(e){var t,n=0;if(e<this.previousWord)throw new Error("Out of order word insertion");for(var i=0;i<e.length&&i<this.previousWord.length&&e[i]==this.previousWord[i];i++)n++;this.minimize(n),t=0==this.uncheckedNodes.length?this.root:this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(i=n;i<e.length;i++){var r=new O.TokenSet,o=e[i];t.edges[o]=r,this.uncheckedNodes.push({parent:t,char:o,child:r}),t=r}t.final=!0,this.previousWord=e},O.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},O.TokenSet.Builder.prototype.minimize=function(e){for(var t=this.uncheckedNodes.length-1;t>=e;t--){var n=this.uncheckedNodes[t],i=n.child.toString();i in this.minimizedNodes?n.parent.edges[n.char]=this.minimizedNodes[i]:(n.child._str=i,this.minimizedNodes[i]=n.child),this.uncheckedNodes.pop()}}
/*!
 * lunr.Index
 * Copyright (C) 2020 Oliver Nightingale
 */,O.Index=function(e){this.invertedIndex=e.invertedIndex,this.fieldVectors=e.fieldVectors,this.tokenSet=e.tokenSet,this.fields=e.fields,this.pipeline=e.pipeline},O.Index.prototype.search=function(e){return this.query((function(t){new O.QueryParser(e,t).parse()}))},O.Index.prototype.query=function(e){for(var t=new O.Query(this.fields),n=Object.create(null),i=Object.create(null),r=Object.create(null),o=Object.create(null),a=Object.create(null),s=0;s<this.fields.length;s++)i[this.fields[s]]=new O.Vector;e.call(t,t);for(s=0;s<t.clauses.length;s++){var l=t.clauses[s],c=null,u=O.Set.empty;c=l.usePipeline?this.pipeline.runString(l.term,{fields:l.fields}):[l.term];for(var d=0;d<c.length;d++){var h=c[d];l.term=h;var p=O.TokenSet.fromClause(l),f=this.tokenSet.intersect(p).toArray();if(0===f.length&&l.presence===O.Query.presence.REQUIRED){for(var g=0;g<l.fields.length;g++){o[I=l.fields[g]]=O.Set.empty}break}for(var m=0;m<f.length;m++){var v=f[m],y=this.invertedIndex[v],b=y._index;for(g=0;g<l.fields.length;g++){var _=y[I=l.fields[g]],x=Object.keys(_),w=v+"/"+I,S=new O.Set(x);if(l.presence==O.Query.presence.REQUIRED&&(u=u.union(S),void 0===o[I]&&(o[I]=O.Set.complete)),l.presence!=O.Query.presence.PROHIBITED){if(i[I].upsert(b,l.boost,(function(e,t){return e+t})),!r[w]){for(var T=0;T<x.length;T++){var E,C=x[T],k=new O.FieldRef(C,I),L=_[C];void 0===(E=n[k])?n[k]=new O.MatchData(v,I,L):E.add(v,I,L)}r[w]=!0}}else void 0===a[I]&&(a[I]=O.Set.empty),a[I]=a[I].union(S)}}}if(l.presence===O.Query.presence.REQUIRED)for(g=0;g<l.fields.length;g++){o[I=l.fields[g]]=o[I].intersect(u)}}var P=O.Set.complete,A=O.Set.empty;for(s=0;s<this.fields.length;s++){var I;o[I=this.fields[s]]&&(P=P.intersect(o[I])),a[I]&&(A=A.union(a[I]))}var D=Object.keys(n),$=[],N=Object.create(null);if(t.isNegated()){D=Object.keys(this.fieldVectors);for(s=0;s<D.length;s++){k=D[s];var M=O.FieldRef.fromString(k);n[k]=new O.MatchData}}for(s=0;s<D.length;s++){var R=(M=O.FieldRef.fromString(D[s])).docRef;if(P.contains(R)&&!A.contains(R)){var B,H=this.fieldVectors[M],z=i[M.fieldName].similarity(H);if(void 0!==(B=N[R]))B.score+=z,B.matchData.combine(n[M]);else{var F={ref:R,score:z,matchData:n[M]};N[R]=F,$.push(F)}}}return $.sort((function(e,t){return t.score-e.score}))},O.Index.prototype.toJSON=function(){var e=Object.keys(this.invertedIndex).sort().map((function(e){return[e,this.invertedIndex[e]]}),this),t=Object.keys(this.fieldVectors).map((function(e){return[e,this.fieldVectors[e].toJSON()]}),this);return{version:O.version,fields:this.fields,fieldVectors:t,invertedIndex:e,pipeline:this.pipeline.toJSON()}},O.Index.load=function(e){var t={},n={},i=e.fieldVectors,r=Object.create(null),o=e.invertedIndex,a=new O.TokenSet.Builder,s=O.Pipeline.load(e.pipeline);e.version!=O.version&&O.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+O.version+"' does not match serialized index '"+e.version+"'");for(var l=0;l<i.length;l++){var c=(d=i[l])[0],u=d[1];n[c]=new O.Vector(u)}for(l=0;l<o.length;l++){var d,h=(d=o[l])[0],p=d[1];a.insert(h),r[h]=p}return a.finish(),t.fields=e.fields,t.fieldVectors=n,t.invertedIndex=r,t.tokenSet=a.root,t.pipeline=s,new O.Index(t)}
/*!
 * lunr.Builder
 * Copyright (C) 2020 Oliver Nightingale
 */,O.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=O.tokenizer,this.pipeline=new O.Pipeline,this.searchPipeline=new O.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},O.Builder.prototype.ref=function(e){this._ref=e},O.Builder.prototype.field=function(e,t){if(/\//.test(e))throw new RangeError("Field '"+e+"' contains illegal character '/'");this._fields[e]=t||{}},O.Builder.prototype.b=function(e){this._b=e<0?0:e>1?1:e},O.Builder.prototype.k1=function(e){this._k1=e},O.Builder.prototype.add=function(e,t){var n=e[this._ref],i=Object.keys(this._fields);this._documents[n]=t||{},this.documentCount+=1;for(var r=0;r<i.length;r++){var o=i[r],a=this._fields[o].extractor,s=a?a(e):e[o],l=this.tokenizer(s,{fields:[o]}),c=this.pipeline.run(l),u=new O.FieldRef(n,o),d=Object.create(null);this.fieldTermFrequencies[u]=d,this.fieldLengths[u]=0,this.fieldLengths[u]+=c.length;for(var h=0;h<c.length;h++){var p=c[h];if(null==d[p]&&(d[p]=0),d[p]+=1,null==this.invertedIndex[p]){var f=Object.create(null);f._index=this.termIndex,this.termIndex+=1;for(var g=0;g<i.length;g++)f[i[g]]=Object.create(null);this.invertedIndex[p]=f}null==this.invertedIndex[p][o][n]&&(this.invertedIndex[p][o][n]=Object.create(null));for(var m=0;m<this.metadataWhitelist.length;m++){var v=this.metadataWhitelist[m],y=p.metadata[v];null==this.invertedIndex[p][o][n][v]&&(this.invertedIndex[p][o][n][v]=[]),this.invertedIndex[p][o][n][v].push(y)}}}},O.Builder.prototype.calculateAverageFieldLengths=function(){for(var e=Object.keys(this.fieldLengths),t=e.length,n={},i={},r=0;r<t;r++){var o=O.FieldRef.fromString(e[r]),a=o.fieldName;i[a]||(i[a]=0),i[a]+=1,n[a]||(n[a]=0),n[a]+=this.fieldLengths[o]}var s=Object.keys(this._fields);for(r=0;r<s.length;r++){var l=s[r];n[l]=n[l]/i[l]}this.averageFieldLength=n},O.Builder.prototype.createFieldVectors=function(){for(var e={},t=Object.keys(this.fieldTermFrequencies),n=t.length,i=Object.create(null),r=0;r<n;r++){for(var o=O.FieldRef.fromString(t[r]),a=o.fieldName,s=this.fieldLengths[o],l=new O.Vector,c=this.fieldTermFrequencies[o],u=Object.keys(c),d=u.length,h=this._fields[a].boost||1,p=this._documents[o.docRef].boost||1,f=0;f<d;f++){var g,m,v,y=u[f],b=c[y],_=this.invertedIndex[y]._index;void 0===i[y]?(g=O.idf(this.invertedIndex[y],this.documentCount),i[y]=g):g=i[y],m=g*((this._k1+1)*b)/(this._k1*(1-this._b+this._b*(s/this.averageFieldLength[a]))+b),m*=h,m*=p,v=Math.round(1e3*m)/1e3,l.insert(_,v)}e[o]=l}this.fieldVectors=e},O.Builder.prototype.createTokenSet=function(){this.tokenSet=O.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},O.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new O.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},O.Builder.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this),e.apply(this,t)},O.MatchData=function(e,t,n){for(var i=Object.create(null),r=Object.keys(n||{}),o=0;o<r.length;o++){var a=r[o];i[a]=n[a].slice()}this.metadata=Object.create(null),void 0!==e&&(this.metadata[e]=Object.create(null),this.metadata[e][t]=i)},O.MatchData.prototype.combine=function(e){for(var t=Object.keys(e.metadata),n=0;n<t.length;n++){var i=t[n],r=Object.keys(e.metadata[i]);null==this.metadata[i]&&(this.metadata[i]=Object.create(null));for(var o=0;o<r.length;o++){var a=r[o],s=Object.keys(e.metadata[i][a]);null==this.metadata[i][a]&&(this.metadata[i][a]=Object.create(null));for(var l=0;l<s.length;l++){var c=s[l];null==this.metadata[i][a][c]?this.metadata[i][a][c]=e.metadata[i][a][c]:this.metadata[i][a][c]=this.metadata[i][a][c].concat(e.metadata[i][a][c])}}}},O.MatchData.prototype.add=function(e,t,n){if(!(e in this.metadata))return this.metadata[e]=Object.create(null),void(this.metadata[e][t]=n);if(t in this.metadata[e])for(var i=Object.keys(n),r=0;r<i.length;r++){var o=i[r];o in this.metadata[e][t]?this.metadata[e][t][o]=this.metadata[e][t][o].concat(n[o]):this.metadata[e][t][o]=n[o]}else this.metadata[e][t]=n},O.Query=function(e){this.clauses=[],this.allFields=e},O.Query.wildcard=new String("*"),O.Query.wildcard.NONE=0,O.Query.wildcard.LEADING=1,O.Query.wildcard.TRAILING=2,O.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},O.Query.prototype.clause=function(e){return"fields"in e||(e.fields=this.allFields),"boost"in e||(e.boost=1),"usePipeline"in e||(e.usePipeline=!0),"wildcard"in e||(e.wildcard=O.Query.wildcard.NONE),e.wildcard&O.Query.wildcard.LEADING&&e.term.charAt(0)!=O.Query.wildcard&&(e.term="*"+e.term),e.wildcard&O.Query.wildcard.TRAILING&&e.term.slice(-1)!=O.Query.wildcard&&(e.term=e.term+"*"),"presence"in e||(e.presence=O.Query.presence.OPTIONAL),this.clauses.push(e),this},O.Query.prototype.isNegated=function(){for(var e=0;e<this.clauses.length;e++)if(this.clauses[e].presence!=O.Query.presence.PROHIBITED)return!1;return!0},O.Query.prototype.term=function(e,t){if(Array.isArray(e))return e.forEach((function(e){this.term(e,O.utils.clone(t))}),this),this;var n=t||{};return n.term=e.toString(),this.clause(n),this},O.QueryParseError=function(e,t,n){this.name="QueryParseError",this.message=e,this.start=t,this.end=n},O.QueryParseError.prototype=new Error,O.QueryLexer=function(e){this.lexemes=[],this.str=e,this.length=e.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},O.QueryLexer.prototype.run=function(){for(var e=O.QueryLexer.lexText;e;)e=e(this)},O.QueryLexer.prototype.sliceString=function(){for(var e=[],t=this.start,n=this.pos,i=0;i<this.escapeCharPositions.length;i++)n=this.escapeCharPositions[i],e.push(this.str.slice(t,n)),t=n+1;return e.push(this.str.slice(t,this.pos)),this.escapeCharPositions.length=0,e.join("")},O.QueryLexer.prototype.emit=function(e){this.lexemes.push({type:e,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},O.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},O.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return O.QueryLexer.EOS;var e=this.str.charAt(this.pos);return this.pos+=1,e},O.QueryLexer.prototype.width=function(){return this.pos-this.start},O.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},O.QueryLexer.prototype.backup=function(){this.pos-=1},O.QueryLexer.prototype.acceptDigitRun=function(){var e,t;do{t=(e=this.next()).charCodeAt(0)}while(t>47&&t<58);e!=O.QueryLexer.EOS&&this.backup()},O.QueryLexer.prototype.more=function(){return this.pos<this.length},O.QueryLexer.EOS="EOS",O.QueryLexer.FIELD="FIELD",O.QueryLexer.TERM="TERM",O.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",O.QueryLexer.BOOST="BOOST",O.QueryLexer.PRESENCE="PRESENCE",O.QueryLexer.lexField=function(e){return e.backup(),e.emit(O.QueryLexer.FIELD),e.ignore(),O.QueryLexer.lexText},O.QueryLexer.lexTerm=function(e){if(e.width()>1&&(e.backup(),e.emit(O.QueryLexer.TERM)),e.ignore(),e.more())return O.QueryLexer.lexText},O.QueryLexer.lexEditDistance=function(e){return e.ignore(),e.acceptDigitRun(),e.emit(O.QueryLexer.EDIT_DISTANCE),O.QueryLexer.lexText},O.QueryLexer.lexBoost=function(e){return e.ignore(),e.acceptDigitRun(),e.emit(O.QueryLexer.BOOST),O.QueryLexer.lexText},O.QueryLexer.lexEOS=function(e){e.width()>0&&e.emit(O.QueryLexer.TERM)},O.QueryLexer.termSeparator=O.tokenizer.separator,O.QueryLexer.lexText=function(e){for(;;){var t=e.next();if(t==O.QueryLexer.EOS)return O.QueryLexer.lexEOS;if(92!=t.charCodeAt(0)){if(":"==t)return O.QueryLexer.lexField;if("~"==t)return e.backup(),e.width()>0&&e.emit(O.QueryLexer.TERM),O.QueryLexer.lexEditDistance;if("^"==t)return e.backup(),e.width()>0&&e.emit(O.QueryLexer.TERM),O.QueryLexer.lexBoost;if("+"==t&&1===e.width())return e.emit(O.QueryLexer.PRESENCE),O.QueryLexer.lexText;if("-"==t&&1===e.width())return e.emit(O.QueryLexer.PRESENCE),O.QueryLexer.lexText;if(t.match(O.QueryLexer.termSeparator))return O.QueryLexer.lexTerm}else e.escapeCharacter()}},O.QueryParser=function(e,t){this.lexer=new O.QueryLexer(e),this.query=t,this.currentClause={},this.lexemeIdx=0},O.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var e=O.QueryParser.parseClause;e;)e=e(this);return this.query},O.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},O.QueryParser.prototype.consumeLexeme=function(){var e=this.peekLexeme();return this.lexemeIdx+=1,e},O.QueryParser.prototype.nextClause=function(){var e=this.currentClause;this.query.clause(e),this.currentClause={}},O.QueryParser.parseClause=function(e){var t=e.peekLexeme();if(null!=t)switch(t.type){case O.QueryLexer.PRESENCE:return O.QueryParser.parsePresence;case O.QueryLexer.FIELD:return O.QueryParser.parseField;case O.QueryLexer.TERM:return O.QueryParser.parseTerm;default:var n="expected either a field or a term, found "+t.type;throw t.str.length>=1&&(n+=" with value '"+t.str+"'"),new O.QueryParseError(n,t.start,t.end)}},O.QueryParser.parsePresence=function(e){var t=e.consumeLexeme();if(null!=t){switch(t.str){case"-":e.currentClause.presence=O.Query.presence.PROHIBITED;break;case"+":e.currentClause.presence=O.Query.presence.REQUIRED;break;default:var n="unrecognised presence operator'"+t.str+"'";throw new O.QueryParseError(n,t.start,t.end)}var i=e.peekLexeme();if(null==i){n="expecting term or field, found nothing";throw new O.QueryParseError(n,t.start,t.end)}switch(i.type){case O.QueryLexer.FIELD:return O.QueryParser.parseField;case O.QueryLexer.TERM:return O.QueryParser.parseTerm;default:n="expecting term or field, found '"+i.type+"'";throw new O.QueryParseError(n,i.start,i.end)}}},O.QueryParser.parseField=function(e){var t=e.consumeLexeme();if(null!=t){if(-1==e.query.allFields.indexOf(t.str)){var n=e.query.allFields.map((function(e){return"'"+e+"'"})).join(", "),i="unrecognised field '"+t.str+"', possible fields: "+n;throw new O.QueryParseError(i,t.start,t.end)}e.currentClause.fields=[t.str];var r=e.peekLexeme();if(null==r){i="expecting term, found nothing";throw new O.QueryParseError(i,t.start,t.end)}switch(r.type){case O.QueryLexer.TERM:return O.QueryParser.parseTerm;default:i="expecting term, found '"+r.type+"'";throw new O.QueryParseError(i,r.start,r.end)}}},O.QueryParser.parseTerm=function(e){var t=e.consumeLexeme();if(null!=t){e.currentClause.term=t.str.toLowerCase(),-1!=t.str.indexOf("*")&&(e.currentClause.usePipeline=!1);var n=e.peekLexeme();if(null!=n)switch(n.type){case O.QueryLexer.TERM:return e.nextClause(),O.QueryParser.parseTerm;case O.QueryLexer.FIELD:return e.nextClause(),O.QueryParser.parseField;case O.QueryLexer.EDIT_DISTANCE:return O.QueryParser.parseEditDistance;case O.QueryLexer.BOOST:return O.QueryParser.parseBoost;case O.QueryLexer.PRESENCE:return e.nextClause(),O.QueryParser.parsePresence;default:var i="Unexpected lexeme type '"+n.type+"'";throw new O.QueryParseError(i,n.start,n.end)}else e.nextClause()}},O.QueryParser.parseEditDistance=function(e){var t=e.consumeLexeme();if(null!=t){var n=parseInt(t.str,10);if(isNaN(n)){var i="edit distance must be numeric";throw new O.QueryParseError(i,t.start,t.end)}e.currentClause.editDistance=n;var r=e.peekLexeme();if(null!=r)switch(r.type){case O.QueryLexer.TERM:return e.nextClause(),O.QueryParser.parseTerm;case O.QueryLexer.FIELD:return e.nextClause(),O.QueryParser.parseField;case O.QueryLexer.EDIT_DISTANCE:return O.QueryParser.parseEditDistance;case O.QueryLexer.BOOST:return O.QueryParser.parseBoost;case O.QueryLexer.PRESENCE:return e.nextClause(),O.QueryParser.parsePresence;default:i="Unexpected lexeme type '"+r.type+"'";throw new O.QueryParseError(i,r.start,r.end)}else e.nextClause()}},O.QueryParser.parseBoost=function(e){var t=e.consumeLexeme();if(null!=t){var n=parseInt(t.str,10);if(isNaN(n)){var i="boost must be numeric";throw new O.QueryParseError(i,t.start,t.end)}e.currentClause.boost=n;var r=e.peekLexeme();if(null!=r)switch(r.type){case O.QueryLexer.TERM:return e.nextClause(),O.QueryParser.parseTerm;case O.QueryLexer.FIELD:return e.nextClause(),O.QueryParser.parseField;case O.QueryLexer.EDIT_DISTANCE:return O.QueryParser.parseEditDistance;case O.QueryLexer.BOOST:return O.QueryParser.parseBoost;case O.QueryLexer.PRESENCE:return e.nextClause(),O.QueryParser.parsePresence;default:i="Unexpected lexeme type '"+r.type+"'";throw new O.QueryParseError(i,r.start,r.end)}else e.nextClause()}},void 0===(r="function"==typeof(i=function(){return O})?i.call(t,n,t,e):i)||(e.exports=r)}()},function(e,t,n){e.exports=n(29)},function(e,t,n){"use strict";n.r(t);n(30);n(17),n(31),n(32),n(33),n(34),n(35),n(36),n(37),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(51),n(52),n(53),n(54),n(55),n(103),n(105),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(135),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),n(153),n(154),n(156),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(177),n(178),n(179),n(180),n(181),n(183),n(184),n(185),n(187),n(188),n(189),n(190),n(191),n(193),n(194),n(195),n(197),n(198),n(199),n(200),n(202),n(203),n(205),n(206),n(207),n(208),n(209),n(210),n(212),n(214),n(215),n(216),n(217),n(218),n(220),n(221),n(222),n(223),n(225),n(226),n(227),n(228),n(230),n(231),n(232),n(233),n(235),n(236),n(237),n(238),n(239),n(241),n(242),n(243),n(244),n(245),n(247),n(249),n(250),n(251),n(253),n(254),n(255),n(256),n(257),n(259),n(260),n(261),n(262),n(263),n(265),n(266),n(267),n(268),n(269),n(271),n(272),n(273),n(274),n(276),n(277),n(278),n(279),n(281),n(282),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(297),n(298),n(299),n(301),n(302),n(303),n(304),n(305),n(307),n(309),n(311),n(312),n(313),n(314),n(316),n(317),n(318),n(319),n(320),n(321),n(323),n(324),n(325),n(326),n(327),angular.module("evtviewer",["ngAnimate","ngCookies","ngMessages","ngResource","ngSanitize","ngTouch","ngRoute","rzModule","xml","prettyXml","infinite-scroll","pascalprecht.translate","oc.lazyLoad","evtviewer.core","evtviewer.communication","evtviewer.translation","evtviewer.dataHandler","evtviewer.interface","evtviewer.box","evtviewer.select","evtviewer.buttonSwitch","evtviewer.popover","evtviewer.namedEntity","evtviewer.criticalApparatusEntry","evtviewer.reading","evtviewer.dialog","evtviewer.bibliography","evtviewer.reference","evtviewer.list","evtviewer.quote","evtviewer.tabsContainer","evtviewer.sourcesApparatusEntry","evtviewer.analogue","evtviewer.analoguesApparatusEntry","evtviewer.apparatuses","evtviewer.versionReading","evtviewer.versionApparatusEntry","evtviewer.UItools","evtviewer.navBar","evtviewer.visColl","evtviewer.search","evtviewer.imageViewer","evtviewer.toc","nemLogging","ui-leaflet","evtviewer.tdhop"])},function(e,t,n){},function(e,t){
/**
 * @license AngularJS v1.3.0
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e,t,n){"use strict";t.module("ngAnimate",["ng"]).directive("ngAnimateChildren",(function(){return function(e,n,i){var r=i.ngAnimateChildren;t.isString(r)&&0===r.length?n.data("$$ngAnimateChildren",!0):e.$watch(r,(function(e){n.data("$$ngAnimateChildren",!!e)}))}})).factory("$$animateReflow",["$$rAF","$document",function(e,t){var n=t[0].body;return function(t){return e((function(){n.offsetWidth;t()}))}}]).config(["$provide","$animateProvider",function(n,i){var r=t.noop,o=t.forEach,a=i.$$selectors,s=t.isArray,l=t.isString,c=t.isObject,u="$$ngAnimateState",d={running:!0};function h(e){for(var t=0;t<e.length;t++){var n=e[t];if(1==n.nodeType)return n}}function p(e){return e&&t.element(e)}function f(e){return t.element(h(e))}function g(e,t){return h(e)==h(t)}n.decorator("$animate",["$delegate","$$q","$injector","$sniffer","$rootElement","$$asyncCallback","$rootScope","$document","$templateRequest",function(e,n,m,v,y,b,_,x,w){y.data(u,d);var S=_.$watch((function(){return w.totalPendingRequests}),(function(e,t){0===e&&(S(),_.$$postDigest((function(){_.$$postDigest((function(){d.running=!1}))})))})),T=0,E=i.classNameFilter(),C=E?function(e){return E.test(e)}:function(){return!0};function k(e,t){var n=e.data(u)||{};return t&&(n.running=!0,n.structural=!0,e.data(u,n)),n.disabled||n.running&&n.structural}function L(e){var t,i=n.defer();return i.promise.$$cancelFn=function(){t&&t()},_.$$postDigest((function(){t=e((function(){i.resolve()}))})),i.promise}function P(e){if(c(e))return e.tempClasses&&l(e.tempClasses)&&(e.tempClasses=e.tempClasses.split(/\s+/)),e}function A(e,n,i,l){var c=e[0];if(c){var u,d;l&&(l.to=l.to||{},l.from=l.from||{}),s(i)&&(u=i[0],d=i[1],u?d?i=u+" "+d:(i=u,n="addClass"):(i=d,n="removeClass"));var h="setClass"==n,p=h||"addClass"==n||"removeClass"==n||"animate"==n,f=e.attr("class")+" "+i;if(C(f)){var g=r,y=[],b=[],_=r,x=[],w=[],S=(" "+f).replace(/\s+/g,".");return o(function(e){if(e){var t=[],n={},i=e.substr(1).split(".");(v.transitions||v.animations)&&t.push(m.get(a[""]));for(var r=0;r<i.length;r++){var o=i[r],s=a[o];s&&!n[o]&&(t.push(m.get(s)),n[o]=!0)}return t}}(S),(function(e){!T(e,n)&&h&&(T(e,"addClass"),T(e,"removeClass"))})),{node:c,event:n,className:i,isClassBased:p,isSetClassOperation:h,applyStyles:function(){l&&e.css(t.extend(l.from||{},l.to||{}))},before:function(e){g=e,E(b,y,(function(){g=r,e()}))},after:function(e){_=e,E(w,x,(function(){_=r,e()}))},cancel:function(){y&&(o(y,(function(e){(e||r)(!0)})),g(!0)),x&&(o(x,(function(e){(e||r)(!0)})),_(!0))}}}}function T(e,t){var n=e[t],i=e["before"+t.charAt(0).toUpperCase()+t.substr(1)];if(n||i)return"leave"==t&&(i=n,n=null),w.push({event:t,fn:n}),b.push({event:t,fn:i}),!0}function E(t,n,a){var s=[];o(t,(function(e){e.fn&&s.push(e)}));var c=0;o(s,(function(t,o){var h=function(){!function(e){if(n){if((n[e]||r)(),++c<s.length)return;n=null}a()}(o)};switch(t.event){case"setClass":n.push(t.fn(e,u,d,h,l));break;case"animate":n.push(t.fn(e,i,l.from,l.to,h));break;case"addClass":n.push(t.fn(e,u||i,h,l));break;case"removeClass":n.push(t.fn(e,d||i,h,l));break;default:n.push(t.fn(e,h,l))}})),n&&0===n.length&&a()}}return{animate:function(e,t,n,i,o){return i=i||"ng-inline-animate",(o=P(o)||{}).from=n?t:null,o.to=n||t,L((function(t){return O("animate",i,f(e),null,null,r,o,t)}))},enter:function(n,i,o,a){return a=P(a),n=t.element(n),i=p(i),o=p(o),k(n,!0),e.enter(n,i,o),L((function(e){return O("enter","ng-enter",f(n),i,o,r,a,e)}))},leave:function(n,i){return i=P(i),I(n=t.element(n)),k(n,!0),L((function(t){return O("leave","ng-leave",f(n),null,null,(function(){e.leave(n)}),i,t)}))},move:function(n,i,o,a){return a=P(a),n=t.element(n),i=p(i),o=p(o),I(n),k(n,!0),e.move(n,i,o),L((function(e){return O("move","ng-move",f(n),i,o,r,a,e)}))},addClass:function(e,t,n){return this.setClass(e,t,[],n)},removeClass:function(e,t,n){return this.setClass(e,[],t,n)},setClass:function(n,i,r,a){a=P(a);if(k(n=f(n=t.element(n))))return e.$$setClassImmediately(n,i,r,a);var l,c=n.data("$$animateClasses"),d=!!c;return c||((c={}).classes={}),l=c.classes,i=s(i)?i:i.split(" "),o(i,(function(e){e&&e.length&&(l[e]=!0)})),r=s(r)?r:r.split(" "),o(r,(function(e){e&&e.length&&(l[e]=!1)})),d?(a&&c.options&&(c.options=t.extend(c.options||{},a)),c.promise):(n.data("$$animateClasses",c={classes:l,options:a}),c.promise=L((function(t){var i=n.parent(),r=h(n),a=r.parentNode;if(a&&!a.$$NG_REMOVED&&!r.$$NG_REMOVED){var s=n.data("$$animateClasses");n.removeData("$$animateClasses");var l=n.data(u)||{},c=function(e,t,n){var i={};o(n=n||{},(function(e,t){o(t.split(" "),(function(t){i[t]=e}))}));var r=Object.create(null);o((e.attr("class")||"").split(/\s+/),(function(e){r[e]=!0}));var a=[],s=[];return o(t.classes,(function(e,t){var n=r[t],o=i[t]||{};!1===e?(n||"addClass"==o.event)&&s.push(t):!0===e&&(n&&"removeClass"!=o.event||a.push(t))})),a.length+s.length>0&&[a.join(" "),s.join(" ")]}(n,s,l.active);return c?O("setClass",c,n,i,null,(function(){c[0]&&e.$$addClassImmediately(n,c[0]),c[1]&&e.$$removeClassImmediately(n,c[1])}),s.options,t):t()}t()})))},cancel:function(e){e.$$cancelFn()},enabled:function(e,t){switch(arguments.length){case 2:if(e)D(t);else{var n=t.data(u)||{};n.disabled=!0,t.data(u,n)}break;case 1:d.disabled=!e;break;default:e=!d.disabled}return!!e}};function O(e,n,i,a,s,l,c,h){var p=r,f=A(i,e,n,c);if(!f)return N(),O(),I(),M(),p;e=f.event,n=f.className;var m=t.element._data(f.node);if(m=m&&m.events,a||(a=s?s.parent():i.parent()),function(e,n){if(d.disabled)return!0;if(g(e,y))return d.running;var i,r,o;do{if(0===n.length)break;var a=g(n,y),s=a?d:n.data(u)||{};if(s.disabled)return!0;if(a&&(o=!0),!1!==i){var l=n.data("$$ngAnimateChildren");t.isDefined(l)&&(i=l)}r=r||s.running||s.last&&!s.last.isClassBased}while(n=n.parent());return!o||!i&&r}(i,a))return N(),O(),I(),M(),p;var v=i.data(u)||{},_=v.active||{},x=v.totalActive||0,w=v.last,S=!1;if(x>0){var E=[];if(f.isClassBased){if("setClass"==w.event)E.push(w),D(i,n);else if(_[n]){var C=_[n];C.event==e?S=!0:(E.push(C),D(i,n))}}else if("leave"==e&&_["ng-leave"])S=!0;else{for(var k in _)E.push(_[k]);v={},D(i,!0)}E.length>0&&o(E,(function(e){e.cancel()}))}if(!f.isClassBased||f.isSetClassOperation||"animate"==e||S||(S="addClass"==e==i.hasClass(n)),S)return N(),O(),I(),$(),p;_=v.active||{},x=v.totalActive||0,"leave"==e&&i.one("$destroy",(function(e){var n=t.element(this),i=n.data(u);if(i){var r=i.active["ng-leave"];r&&(r.cancel(),D(n,"ng-leave"))}})),i.addClass("ng-animate"),c&&c.tempClasses&&o(c.tempClasses,(function(e){i.addClass(e)}));var L=T++;return x++,_[n]=f,i.data(u,{last:f,active:_,index:L,totalActive:x}),O(),f.before((function(t){var r=i.data(u);t=t||!r||!r.active[n]||f.isClassBased&&r.active[n].event!=e,N(),!0===t?M():(I(),f.after(M))})),f.cancel;function P(t){var r="$animate:"+t;m&&m[r]&&m[r].length>0&&b((function(){i.triggerHandler(r,{event:e,className:n})}))}function O(){P("before")}function I(){P("after")}function $(){P("close"),h()}function N(){N.hasBeenRun||(N.hasBeenRun=!0,l())}function M(){if(!M.hasBeenRun){f&&f.applyStyles(),M.hasBeenRun=!0,c&&c.tempClasses&&o(c.tempClasses,(function(e){i.removeClass(e)}));var e=i.data(u);e&&(f&&f.isClassBased?D(i,n):(b((function(){var e=i.data(u)||{};L==e.index&&D(i,n)})),i.data(u,e))),$()}}}function I(e){var n=h(e);if(n){var i=t.isFunction(n.getElementsByClassName)?n.getElementsByClassName("ng-animate"):n.querySelectorAll(".ng-animate");o(i,(function(e){var n=(e=t.element(e)).data(u);n&&n.active&&o(n.active,(function(e){e.cancel()}))}))}}function D(e,t){if(g(e,y))d.disabled||(d.running=!1,d.structural=!1);else if(t){var n=e.data(u)||{},i=!0===t;!i&&n.active&&n.active[t]&&(n.totalActive--,delete n.active[t]),!i&&n.totalActive||(e.removeClass("ng-animate"),e.removeData(u))}}}]),i.register("",["$window","$sniffer","$timeout","$$animateReflow",function(n,i,a,c){var u,d,p,f,g="";void 0===e.ontransitionend&&void 0!==e.onwebkittransitionend?(g="-webkit-",u="WebkitTransition",d="webkitTransitionEnd transitionend"):(u="transition",d="transitionend"),void 0===e.onanimationend&&void 0!==e.onwebkitanimationend?(g="-webkit-",p="WebkitAnimation",f="webkitAnimationEnd animationend"):(p="animation",f="animationend");var m,v={},y=0,b=[];function _(){m||(m=c((function(){b=[],m=null,v={}})))}function x(e,t){m&&m(),b.push(t),m=c((function(){o(b,(function(e){e()})),b=[],m=null,v={}}))}var w=null,S=0,T=[];function E(e,n){var i=h(e);e=t.element(i),T.push(e);var r=Date.now()+n;r<=S||(a.cancel(w),S=r,w=a((function(){o(T,(function(e){var t=e.data("$$ngAnimateCSS3Data");t&&o(t.closeAnimationFns,(function(e){e()}))})),T=[]}),n,!1))}function C(e,t){var i=t?v[t]:null;if(!i){var r=0,a=0,s=0,l=0;o(e,(function(e){if(1==e.nodeType){var t=n.getComputedStyle(e)||{},i=t[u+"Duration"];r=Math.max(k(i),r);var o=t[u+"Delay"];a=Math.max(k(o),a);t[p+"Delay"];l=Math.max(k(t[p+"Delay"]),l);var c=k(t[p+"Duration"]);c>0&&(c*=parseInt(t[p+"IterationCount"],10)||1),s=Math.max(c,s)}})),i={total:0,transitionDelay:a,transitionDuration:r,animationDelay:l,animationDuration:s},t&&(v[t]=i)}return i}function k(e){var t=0,n=l(e)?e.split(/\s*,\s*/):[];return o(n,(function(e){t=Math.max(parseFloat(e)||0,t)})),t}function L(e,t,n,i){var r=["ng-enter","ng-leave","ng-move"].indexOf(n)>=0,o=function(e){var t=e.parent(),n=t.data("$$ngAnimateKey");return n||(t.data("$$ngAnimateKey",++y),n=y),n+"-"+h(e).getAttribute("class")}(t),a=o+" "+n,s=v[a]?++v[a].total:0,l={};if(s>0){var c=n+"-stagger",u=o+" "+c,d=!v[u];d&&t.addClass(c),l=C(t,u),d&&t.removeClass(c)}t.addClass(n);var p=t.data("$$ngAnimateCSS3Data")||{},f=C(t,a),g=f.transitionDuration,m=f.animationDuration;if(r&&0===g&&0===m)return t.removeClass(n),!1;var b=i||r&&g>0,_=m>0&&l.animationDelay>0&&0===l.animationDuration,x=p.closeAnimationFns||[];t.data("$$ngAnimateCSS3Data",{stagger:l,cacheKey:a,running:p.running||0,itemIndex:s,blockTransition:b,closeAnimationFns:x});var w=h(t);return b&&(P(w,!0),i&&t.css(i)),_&&A(w,!0),!0}function P(e,t){e.style[u+"Property"]=t?"none":""}function A(e,t){e.style[p+"PlayState"]=t?"paused":""}function O(e,t,n,i){if(L(0,t,n,i))return function(e){e&&$(t,n)}}function I(e,t,n,i,r){if(t.data("$$ngAnimateCSS3Data"))return function(e,t,n,i,r){var s=h(t),l=t.data("$$ngAnimateCSS3Data");if(-1!=s.getAttribute("class").indexOf(n)&&l){var c="",u="";o(n.split(" "),(function(e,t){var n=(t>0?" ":"")+e;c+=n+"-active",u+=n+"-pending"}));var p=[],m=l.itemIndex,v=l.stagger,y=0;if(m>0){var b=0;v.transitionDelay>0&&0===v.transitionDuration&&(b=v.transitionDelay*m);var _=0;v.animationDelay>0&&0===v.animationDuration&&(_=v.animationDelay*m,p.push(g+"animation-play-state")),y=Math.round(100*Math.max(b,_))/100}y||(t.addClass(c),l.blockTransition&&P(s,!1));var x=l.cacheKey+" "+c,w=C(t,x),S=Math.max(w.transitionDuration,w.animationDuration);if(0===S)return t.removeClass(c),$(t,n),void i();!y&&r&&(w.transitionDuration||(t.css("transition",w.animationDuration+"s linear all"),p.push("transition")),t.css(r));var T=Math.max(w.transitionDelay,w.animationDelay),k=1e3*T;if(p.length>0){var L=s.getAttribute("style")||"";";"!==L.charAt(L.length-1)&&(L+=";"),s.setAttribute("style",L+" ")}var O,I=Date.now(),D=f+" "+d,N=1e3*(y+1.5*(T+S));return y>0&&(t.addClass(u),O=a((function(){O=null,w.transitionDuration>0&&P(s,!1),w.animationDuration>0&&A(s,!1),t.addClass(c),t.removeClass(u),r&&(0===w.transitionDuration&&t.css("transition",w.animationDuration+"s linear all"),t.css(r),p.push("transition"))}),1e3*y,!1)),t.on(D,R),l.closeAnimationFns.push((function(){M(),i()})),l.running++,E(t,N),M}function M(){t.off(D,R),t.removeClass(c),t.removeClass(u),O&&a.cancel(O),$(t,n);var e=h(t);for(var i in p)e.style.removeProperty(p[i])}function R(e){e.stopPropagation();var t=e.originalEvent||e,n=t.$manualTimeStamp||t.timeStamp||Date.now(),r=parseFloat(t.elapsedTime.toFixed(3));Math.max(n-I,0)>=k&&r>=S&&i()}i()}(0,t,n,i,r);$(t,n),i()}function D(e,t,n,i,o){var a=O(0,t,n,o.from);if(!a)return _(),void i();var s=a;return x(0,(function(){s=I(0,t,n,i,o.to)})),function(e){(s||r)(e)}}function $(e,t){e.removeClass(t);var n=e.data("$$ngAnimateCSS3Data");n&&(n.running&&n.running--,n.running&&0!==n.running||e.removeData("$$ngAnimateCSS3Data"))}return{animate:function(e,t,n,i,r,o){return(o=o||{}).from=n,o.to=i,D(0,e,t,r,o)},enter:function(e,t,n){return D(0,e,"ng-enter",t,n=n||{})},leave:function(e,t,n){return D(0,e,"ng-leave",t,n=n||{})},move:function(e,t,n){return D(0,e,"ng-move",t,n=n||{})},beforeSetClass:function(e,t,n,i,r){r=r||{};var o=O(0,e,N(n,"-remove")+" "+N(t,"-add"),r.from);if(o)return x(0,i),o;_(),i()},beforeAddClass:function(e,t,n,i){i=i||{};var r=O(0,e,N(t,"-add"),i.from);if(r)return x(0,n),r;_(),n()},beforeRemoveClass:function(e,t,n,i){i=i||{};var r=O(0,e,N(t,"-remove"),i.from);if(r)return x(0,n),r;_(),n()},setClass:function(e,t,n,i,r){return r=r||{},I(0,e,(n=N(n,"-remove"))+" "+(t=N(t,"-add")),i,r.to)},addClass:function(e,t,n,i){return i=i||{},I(0,e,N(t,"-add"),n,i.to)},removeClass:function(e,t,n,i){return i=i||{},I(0,e,N(t,"-remove"),n,i.to)}};function N(e,t){var n="";return e=s(e)?e:e.split(/\s+/),o(e,(function(e,i){e&&e.length>0&&(n+=(i>0?" ":"")+e+t)})),n}}])}])}(window,window.angular)},function(e,t){
/**
 * @license AngularJS v1.3.0
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e,t,n){"use strict";t.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function(e,n){var i,r={},o={},a=!1,s=t.copy,l=t.isUndefined;return n.addPollFn((function(){var t=n.cookies();i!=t&&(i=t,s(t,o),s(t,r),a&&e.$apply())}))(),a=!0,e.$watch((function(){var e,i,a,s;for(e in o)l(r[e])&&n.cookies(e,void 0);for(e in r)i=r[e],t.isString(i)||(i=""+i,r[e]=i),i!==o[e]&&(n.cookies(e,i),s=!0);if(s)for(e in s=!1,a=n.cookies(),r)r[e]!==a[e]&&(l(a[e])?delete r[e]:r[e]=a[e],s=!0)})),r}]).factory("$cookieStore",["$cookies",function(e){return{get:function(n){var i=e[n];return i?t.fromJson(i):i},put:function(n,i){e[n]=t.toJson(i)},remove:function(t){delete e[t]}}}])}(window,window.angular)},function(e,t){
/**
 * @license AngularJS v1.3.0
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e,t,n){"use strict";t.module("ngMessages",[]).directive("ngMessages",["$compile","$animate","$templateRequest",function(e,n,i){return{restrict:"AE",controller:function(){this.$renderNgMessageClasses=t.noop;var e=[];this.registerMessage=function(t,n){for(var i=0;i<e.length;i++)if(e[i].type==n.type){if(t!=i){var r=e[t];e[t]=e[i],t<e.length?e[i]=r:e.splice(0,i)}return}e.splice(t,0,n)},this.renderMessages=function(n,i){var r;n=n||{},t.forEach(e,(function(e){var t;r&&!i||(null===(t=n[e.type])||!1===t||!t)?e.detach():(e.attach(),r=!0)})),this.renderElementClasses(r)}},require:"ngMessages",link:function(r,o,a,s){s.renderElementClasses=function(e){e?n.setClass(o,"ng-active","ng-inactive"):n.setClass(o,"ng-inactive","ng-active")};var l,c=t.isString(a.ngMessagesMultiple)||t.isString(a.multiple),u=a.ngMessages||a.for;r.$watchCollection(u,(function(e){l=e,s.renderMessages(e,c)}));var d=a.ngMessagesInclude||a.include;d&&i(d).then((function(n){var i,a=t.element("<div/>").html(n);t.forEach(a.children(),(function(n){n=t.element(n),i?i.after(n):o.prepend(n),i=n,e(n)(r)})),s.renderMessages(l,c)}))}}}]).directive("ngMessage",["$animate",function(e){return{require:"^ngMessages",transclude:"element",terminal:!0,restrict:"AE",link:function(t,n,i,r,o){for(var a,s,l=n[0],c=l.parentNode,u=0,d=0;u<c.childNodes.length;u++){var h=c.childNodes[u];if(8==h.nodeType&&h.nodeValue.indexOf("ngMessage")>=0){if(h===l){a=d;break}d++}}r.registerMessage(a,{type:i.ngMessage||i.when,attach:function(){s||o(t,(function(t){e.enter(t,null,n),s=t}))},detach:function(t){s&&(e.leave(s),s=null)}})}}}])}(window,window.angular)},function(e,t){
/**
 * @license AngularJS v1.3.0
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e,t,n){"use strict";var i=t.$$minErr("$resource"),r=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;function o(e,t){if(!function(e){return null!=e&&""!==e&&"hasOwnProperty"!==e&&r.test("."+e)}(t))throw i("badmember",'Dotted member path "@{0}" is invalid.',t);for(var n=t.split("."),o=0,a=n.length;o<a&&void 0!==e;o++){var s=n[o];e=null!==e?e[s]:void 0}return e}function a(e,n){for(var i in n=n||{},t.forEach(n,(function(e,t){delete n[t]})),e)!e.hasOwnProperty(i)||"$"===i.charAt(0)&&"$"===i.charAt(1)||(n[i]=e[i]);return n}t.module("ngResource",["ng"]).provider("$resource",(function(){var e=this;this.defaults={stripTrailingSlashes:!0,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},delete:{method:"DELETE"}}},this.$get=["$http","$q",function(n,r){var s=t.noop,l=t.forEach,c=t.extend,u=t.copy,d=t.isFunction;function h(e){return function(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function p(t,n){this.template=t,this.defaults=c({},e.defaults,n),this.urlParams={}}return p.prototype={setUrlParams:function(e,n,r){var o,a,s=this,c=r||s.template,u=s.urlParams={};l(c.split(/\W/),(function(e){if("hasOwnProperty"===e)throw i("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(e)&&e&&new RegExp("(^|[^\\\\]):"+e+"(\\W|$)").test(c)&&(u[e]=!0)})),c=c.replace(/\\:/g,":"),n=n||{},l(s.urlParams,(function(e,i){o=n.hasOwnProperty(i)?n[i]:s.defaults[i],t.isDefined(o)&&null!==o?(a=h(o),c=c.replace(new RegExp(":"+i+"(\\W|$)","g"),(function(e,t){return a+t}))):c=c.replace(new RegExp("(/?):"+i+"(\\W|$)","g"),(function(e,t,n){return"/"==n.charAt(0)?n:t+n}))})),s.defaults.stripTrailingSlashes&&(c=c.replace(/\/+$/,"")||"/"),c=c.replace(/\/\.(?=\w+($|\?))/,"."),e.url=c.replace(/\/\\\./,"/."),l(n,(function(t,n){s.urlParams[n]||(e.params=e.params||{},e.params[n]=t)}))}},function h(f,g,m,v){var y=new p(f,v);function b(e,t){var n={};return t=c({},g,t),l(t,(function(t,i){d(t)&&(t=t()),n[i]=t&&t.charAt&&"@"==t.charAt(0)?o(e,t.substr(1)):t})),n}function _(e){return e.resource}function x(e){a(e||{},this)}return m=c({},e.defaults.actions,m),x.prototype.toJSON=function(){var e=c({},this);return delete e.$promise,delete e.$resolved,e},l(m,(function(e,o){var h=/^(POST|PUT|PATCH)$/i.test(e.method);x[o]=function(p,f,g,m){var v,w,S,T={};switch(arguments.length){case 4:S=m,w=g;case 3:case 2:if(!d(f)){T=p,v=f,w=g;break}if(d(p)){w=p,S=f;break}w=f,S=g;case 1:d(p)?w=p:h?v=p:T=p;break;case 0:break;default:throw i("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var E=this instanceof x,C=E?v:e.isArray?[]:new x(v),k={},L=e.interceptor&&e.interceptor.response||_,P=e.interceptor&&e.interceptor.responseError||void 0;l(e,(function(e,t){"params"!=t&&"isArray"!=t&&"interceptor"!=t&&(k[t]=u(e))})),h&&(k.data=v),y.setUrlParams(k,c({},b(v,e.params||{}),T),e.url);var A=n(k).then((function(n){var r=n.data,s=C.$promise;if(r){if(t.isArray(r)!==!!e.isArray)throw i("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2}",o,e.isArray?"array":"object",t.isArray(r)?"array":"object");e.isArray?(C.length=0,l(r,(function(e){"object"==typeof e?C.push(new x(e)):C.push(e)}))):(a(r,C),C.$promise=s)}return C.$resolved=!0,n.resource=C,n}),(function(e){return C.$resolved=!0,(S||s)(e),r.reject(e)}));return A=A.then((function(e){var t=L(e);return(w||s)(t,e.headers),t}),P),E?A:(C.$promise=A,C.$resolved=!1,C)},x.prototype["$"+o]=function(e,t,n){d(e)&&(n=t,t=e,e={});var i=x[o].call(this,e,this,t,n);return i.$promise||i}})),x.bind=function(e){return h(f,c({},g,e),m)},x}}]}))}(window,window.angular)},function(e,t){
/**
 * @license AngularJS v1.3.0
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e,t,n){"use strict";var i=t.module("ngRoute",["ng"]).provider("$route",(function(){function e(e,n){return t.extend(new(t.extend((function(){}),{prototype:e})),n)}var n={};function i(e,t){var n=t.caseInsensitiveMatch,i={originalPath:e,regexp:e},r=i.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,(function(e,t,n,i){var o="?"===i?i:null,a="*"===i?i:null;return r.push({name:n,optional:!!o}),t=t||"",(o?"":t)+"(?:"+(o?t:"")+(a?"(.+?)":"([^/]+)")+(o||"")+")"+(o||"")})).replace(/([\/$\*])/g,"\\$1"),i.regexp=new RegExp("^"+e+"$",n?"i":""),i}this.when=function(e,r){if(n[e]=t.extend({reloadOnSearch:!0},r,e&&i(e,r)),e){var o="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";n[o]=t.extend({redirectTo:e},i(o,r))}return this},this.otherwise=function(e){return"string"==typeof e&&(e={redirectTo:e}),this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function(i,o,a,s,l,c,u){var d,h,p=!1,f={routes:n,reload:function(){p=!0,i.$evalAsync((function(){g(),m()}))},updateParams:function(e){if(!this.current||!this.current.$$route)throw r("norout","Tried updating route when with no current route");var n={},i=this;t.forEach(Object.keys(e),(function(t){i.current.pathParams[t]||(n[t]=e[t])})),e=t.extend({},this.current.params,e),o.path(v(this.current.$$route.originalPath,e)),o.search(t.extend({},o.search(),n))}};return i.$on("$locationChangeStart",g),i.$on("$locationChangeSuccess",m),f;function g(r){var a,s,l=f.current;t.forEach(n,(function(n,i){!s&&(a=function(e,t){var n=t.keys,i={};if(!t.regexp)return null;var r=t.regexp.exec(e);if(!r)return null;for(var o=1,a=r.length;o<a;++o){var s=n[o-1],l=r[o];s&&l&&(i[s.name]=l)}return i}(o.path(),n))&&((s=e(n,{params:t.extend({},o.search(),a),pathParams:a})).$$route=n)})),d=s||n.null&&e(n.null,{params:{},pathParams:{}}),(h=d&&l&&d.$$route===l.$$route&&t.equals(d.pathParams,l.pathParams)&&!d.reloadOnSearch&&!p)||!l&&!d||i.$broadcast("$routeChangeStart",d,l).defaultPrevented&&r&&r.preventDefault()}function m(){var e=f.current,n=d;h?(e.params=n.params,t.copy(e.params,a),i.$broadcast("$routeUpdate",e)):(n||e)&&(p=!1,f.current=n,n&&n.redirectTo&&(t.isString(n.redirectTo)?o.path(v(n.redirectTo,n.params)).search(n.params).replace():o.url(n.redirectTo(n.pathParams,o.path(),o.search())).replace()),s.when(n).then((function(){if(n){var e,i,r=t.extend({},n.resolve);return t.forEach(r,(function(e,n){r[n]=t.isString(e)?l.get(e):l.invoke(e,null,null,n)})),t.isDefined(e=n.template)?t.isFunction(e)&&(e=e(n.params)):t.isDefined(i=n.templateUrl)&&(t.isFunction(i)&&(i=i(n.params)),i=u.getTrustedResourceUrl(i),t.isDefined(i)&&(n.loadedTemplateUrl=i,e=c(i))),t.isDefined(e)&&(r.$template=e),s.all(r)}})).then((function(r){n==f.current&&(n&&(n.locals=r,t.copy(n.params,a)),i.$broadcast("$routeChangeSuccess",n,e))}),(function(t){n==f.current&&i.$broadcast("$routeChangeError",n,e,t)})))}function v(e,n){var i=[];return t.forEach((e||"").split(":"),(function(e,t){if(0===t)i.push(e);else{var r=e.match(/(\w+)(.*)/),o=r[1];i.push(n[o]),i.push(r[2]||""),delete n[o]}})),i.join("")}}]})),r=t.$$minErr("ngRoute");function o(e,n,i){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(r,o,a,s,l){var c,u,d,h=a.autoscroll,p=a.onload||"";function f(){d&&(i.cancel(d),d=null),c&&(c.$destroy(),c=null),u&&((d=i.leave(u)).then((function(){d=null})),u=null)}function g(){var a=e.current&&e.current.locals,s=a&&a.$template;if(t.isDefined(s)){var d=r.$new(),g=e.current,m=l(d,(function(e){i.enter(e,null,u||o).then((function(){!t.isDefined(h)||h&&!r.$eval(h)||n()})),f()}));u=m,(c=g.scope=d).$emit("$viewContentLoaded"),c.$eval(p)}else f()}r.$on("$routeChangeSuccess",g),g()}}}function a(e,t,n){return{restrict:"ECA",priority:-400,link:function(i,r){var o=n.current,a=o.locals;r.html(a.$template);var s=e(r.contents());if(o.controller){a.$scope=i;var l=t(o.controller,a);o.controllerAs&&(i[o.controllerAs]=l),r.data("$ngControllerController",l),r.children().data("$ngControllerController",l)}s(i)}}}i.provider("$routeParams",(function(){this.$get=function(){return{}}})),i.directive("ngView",o),i.directive("ngView",a),o.$inject=["$route","$anchorScroll","$animate"],a.$inject=["$compile","$controller","$route"]}(window,window.angular)},function(e,t){
/**
 * @license AngularJS v1.3.0
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e,t,n){"use strict";var i=t.$$minErr("$sanitize");var r=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,o=/^<\/\s*([\w:-]+)[^>]*>/,a=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,s=/^</,l=/^<\//,c=/<!--(.*?)-->/g,u=/<!DOCTYPE([^>]*?)>/i,d=/<!\[CDATA\[(.*?)]]>/g,h=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,p=/([^\#-~| |!])/g,f=T("area,br,col,hr,img,wbr"),g=T("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),m=T("rp,rt"),v=t.extend({},m,g),y=t.extend({},g,T("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),b=t.extend({},m,T("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),_=T("script,style"),x=t.extend({},f,y,b,v),w=T("background,cite,href,longdesc,src,usemap"),S=t.extend({},w,T("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"));function T(e){var t,n={},i=e.split(",");for(t=0;t<i.length;t++)n[i[t]]=!0;return n}var E=document.createElement("pre"),C=/^(\s*)([\s\S]*?)(\s*)$/;function k(e){if(!e)return"";var t=C.exec(e),n=t[1],i=t[3],r=t[2];return r&&(E.innerHTML=r.replace(/</g,"&lt;"),r="textContent"in E?E.textContent:E.innerText),n+r+i}function L(e){return e.replace(/&/g,"&amp;").replace(h,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(p,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function P(e,n){var i=!1,r=t.bind(e,e.push);return{start:function(e,o,a){e=t.lowercase(e),!i&&_[e]&&(i=e),i||!0!==x[e]||(r("<"),r(e),t.forEach(o,(function(i,o){var a=t.lowercase(o),s="img"===e&&"src"===a||"background"===a;!0!==S[a]||!0===w[a]&&!n(i,s)||(r(" "),r(o),r('="'),r(L(i)),r('"'))})),r(a?"/>":">"))},end:function(e){e=t.lowercase(e),i||!0!==x[e]||(r("</"),r(e),r(">")),e==i&&(i=!1)},chars:function(e){i||r(L(e))}}}t.module("ngSanitize",[]).provider("$sanitize",(function(){this.$get=["$$sanitizeUri",function(e){return function(n){var h=[];return function(e,n){"string"!=typeof e&&(e=null==e?"":""+e);var h,p,g,m,x=[],w=e;x.last=function(){return x[x.length-1]};for(;e;){if(m="",p=!0,x.last()&&_[x.last()]?(e=e.replace(new RegExp("(.*)<\\s*\\/\\s*"+x.last()+"[^>]*>","i"),(function(e,t){return t=t.replace(c,"$1").replace(d,"$1"),n.chars&&n.chars(k(t)),""})),T("",x.last())):(0===e.indexOf("\x3c!--")?(h=e.indexOf("--",4))>=0&&e.lastIndexOf("--\x3e",h)===h&&(n.comment&&n.comment(e.substring(4,h)),e=e.substring(h+3),p=!1):u.test(e)?(g=e.match(u))&&(e=e.replace(g[0],""),p=!1):l.test(e)?(g=e.match(o))&&(e=e.substring(g[0].length),g[0].replace(o,T),p=!1):s.test(e)&&((g=e.match(r))?(g[4]&&(e=e.substring(g[0].length),g[0].replace(r,S)),p=!1):(m+="<",e=e.substring(1))),p&&(h=e.indexOf("<"),m+=h<0?e:e.substring(0,h),e=h<0?"":e.substring(h),n.chars&&n.chars(k(m)))),e==w)throw i("badparse","The sanitizer was unable to parse the following block of html: {0}",e);w=e}function S(e,i,r,o){if(i=t.lowercase(i),y[i])for(;x.last()&&b[x.last()];)T("",x.last());v[i]&&x.last()==i&&T("",i),(o=f[i]||!!o)||x.push(i);var s={};r.replace(a,(function(e,t,n,i,r){var o=n||i||r||"";s[t]=k(o)})),n.start&&n.start(i,s,o)}function T(e,i){var r,o=0;if(i=t.lowercase(i))for(o=x.length-1;o>=0&&x[o]!=i;o--);if(o>=0){for(r=x.length-1;r>=o;r--)n.end&&n.end(x[r]);x.length=o}}T()}(n,P(h,(function(t,n){return!/^unsafe/.test(e(t,n))}))),h.join("")}}]})),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,i=/^mailto:/;return function(r,o){if(!r)return r;for(var a,s,l,c=r,u=[];a=c.match(n);)s=a[0],a[2]==a[3]&&(s="mailto:"+s),l=a.index,d(c.substr(0,l)),h(s,a[0].replace(i,"")),c=c.substring(l+a[0].length);return d(c),e(u.join(""));function d(e){var n,i;e&&u.push((n=e,P(i=[],t.noop).chars(n),i.join("")))}function h(e,n){u.push("<a "),t.isDefined(o)&&(u.push('target="'),u.push(o),u.push('" ')),u.push('href="'),u.push(e),u.push('">'),d(n),u.push("</a>")}}}])}(window,window.angular)},function(e,t){!function(e){function t(e){this.parser=new e.ActiveXObject("Microsoft.XMLDOM")}function n(e){this.parser=new e.DOMParser}function i(e,t){return{response:function(n){return n&&function(e){var t=e.headers("content-type"),n="text/xml".indexOf("/xml");return t.indexOf("/xml")>=n}(n)?(n.xml=t(n.data),n):e.when(n)}}}t.prototype.parse=function(e){var t,n=this.parser;if(n.async=!1,n.loadXML(e),0===(t=n.parseError).errorCode)return n;throw new Error("Cannot parse XML: "+t.reason)},n.prototype.parse=function(e){return this.parser.parseFromString(e,"text/xml")},e&&e.module("xml",[]).config(["$provide",function(e){e.factory("xmlHttpInterceptor",["$q","xmlFilter",i])}]).factory("xmlParser",["$window",function(e){if(e.DOMParser)return new n(e);if(e.ActiveXObject)return new t(e);throw new Error("Cannot parser XML in this environment.")}]).filter("xml",["xmlParser",function(t){return function(n){var i=t.parse(n);return e.element(i)}}])}(angular)},function(e,t){
/**
 * @license AngularJS v1.3.15
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e,t,n){"use strict";var i=t.module("ngTouch",[]);function r(e,n,r){i.directive(e,["$parse","$swipe",function(i,o){return function(a,s,l){var c,u,d=i(l[e]);var h=["touch"];t.isDefined(l.ngSwipeDisableMouse)||h.push("mouse"),o.bind(s,{start:function(e,t){c=e,u=!0},cancel:function(e){u=!1},end:function(e,t){(function(e){if(!c)return!1;var t=Math.abs(e.y-c.y),i=(e.x-c.x)*n;return u&&t<75&&i>0&&i>30&&t/i<.3})(e)&&a.$apply((function(){s.triggerHandler(r),d(a,{$event:t})}))}},h)}}])}i.factory("$swipe",[function(){var e={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}};function n(e){var t=e.touches&&e.touches.length?e.touches:[e],n=e.changedTouches&&e.changedTouches[0]||e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]||t[0].originalEvent||t[0];return{x:n.clientX,y:n.clientY}}function i(n,i){var r=[];return t.forEach(n,(function(t){var n=e[t][i];n&&r.push(n)})),r.join(" ")}return{bind:function(e,t,r){var o,a,s,l,c=!1;r=r||["mouse","touch"],e.on(i(r,"start"),(function(e){s=n(e),c=!0,o=0,a=0,l=s,t.start&&t.start(s,e)}));var u=i(r,"cancel");u&&e.on(u,(function(e){c=!1,t.cancel&&t.cancel(e)})),e.on(i(r,"move"),(function(e){if(c&&s){var i=n(e);if(o+=Math.abs(i.x-l.x),a+=Math.abs(i.y-l.y),l=i,!(o<10&&a<10))return a>o?(c=!1,void(t.cancel&&t.cancel(e))):(e.preventDefault(),void(t.move&&t.move(i,e)))}})),e.on(i(r,"end"),(function(e){c&&(c=!1,t.end&&t.end(n(e),e))}))}}}]),i.config(["$provide",function(e){e.decorator("ngClickDirective",["$delegate",function(e){return e.shift(),e}])}]),i.directive("ngClick",["$parse","$timeout","$rootElement",function(e,n,i){var r,o,a;function s(e,t,n){for(var i=0;i<e.length;i+=2)if(r=e[i],o=e[i+1],a=t,s=n,Math.abs(r-a)<25&&Math.abs(o-s)<25)return e.splice(i,i+2),!0;var r,o,a,s;return!1}function l(e){if(!(Date.now()-r>2500)){var t=e.touches&&e.touches.length?e.touches:[e],n=t[0].clientX,i=t[0].clientY;n<1&&i<1||a&&a[0]===n&&a[1]===i||(a&&(a=null),"label"===e.target.tagName.toLowerCase()&&(a=[n,i]),s(o,n,i)||(e.stopPropagation(),e.preventDefault(),e.target&&e.target.blur()))}}function c(e){var t=e.touches&&e.touches.length?e.touches:[e],i=t[0].clientX,r=t[0].clientY;o.push(i,r),n((function(){for(var e=0;e<o.length;e+=2)if(o[e]==i&&o[e+1]==r)return void o.splice(e,e+2)}),2500,!1)}return function(n,a,u){var d,h,p,f,g=e(u.ngClick),m=!1;function v(){m=!1,a.removeClass("ng-click-active")}a.on("touchstart",(function(e){m=!0,3==(d=e.target?e.target:e.srcElement).nodeType&&(d=d.parentNode),a.addClass("ng-click-active"),h=Date.now();var t=e.touches&&e.touches.length?e.touches:[e],n=t[0].originalEvent||t[0];p=n.clientX,f=n.clientY})),a.on("touchmove",(function(e){v()})),a.on("touchcancel",(function(e){v()})),a.on("touchend",(function(e){var n=Date.now()-h,g=e.changedTouches&&e.changedTouches.length?e.changedTouches:e.touches&&e.touches.length?e.touches:[e],y=g[0].originalEvent||g[0],b=y.clientX,_=y.clientY,x=Math.sqrt(Math.pow(b-p,2)+Math.pow(_-f,2));m&&n<750&&x<12&&(!function(e,t){o||(i[0].addEventListener("click",l,!0),i[0].addEventListener("touchstart",c,!0),o=[]),r=Date.now(),s(o,e,t)}(b,_),d&&d.blur(),t.isDefined(u.disabled)&&!1!==u.disabled||a.triggerHandler("click",[e])),v()})),a.onclick=function(e){},a.on("click",(function(e,t){n.$apply((function(){g(n,{$event:t||e})}))})),a.on("mousedown",(function(e){a.addClass("ng-click-active")})),a.on("mousemove mouseup",(function(e){a.removeClass("ng-click-active")}))}}]),r("ngSwipeLeft",-1,"swipeleft"),r("ngSwipeRight",1,"swiperight")}(window,window.angular)},function(e,t,n){var i,r,o;
/*! angularjs-slider - v6.7.0 - 
 (c) Rafal Zajac <rzajac@gmail.com>, Valentin Hervieu <valentin@hervi.eu>, Jussi Saarivirta <jusasi@gmail.com>, Angelin Sirbu <angelin.sirbu@gmail.com> - 
 https://github.com/angular-slider/angularjs-slider - 
 2019-02-23 */!function(a,s){"use strict";r=[n(8)],void 0===(o="function"==typeof(i=function(e){var t=e.module("rzModule",[]).factory("RzSliderOptions",(function(){var t={floor:0,ceil:null,step:1,precision:0,minRange:null,maxRange:null,restrictedRange:null,pushRange:!1,minLimit:null,maxLimit:null,id:null,translate:null,getLegend:null,stepsArray:null,bindIndexForStepsArray:!1,draggableRange:!1,draggableRangeOnly:!1,showSelectionBar:!1,showSelectionBarEnd:!1,showSelectionBarFromValue:null,showOuterSelectionBars:!1,hidePointerLabels:!1,hideLimitLabels:!1,autoHideLimitLabels:!0,readOnly:!1,disabled:!1,interval:350,showTicks:!1,showTicksValues:!1,ticksArray:null,ticksTooltip:null,ticksValuesTooltip:null,vertical:!1,getSelectionBarColor:null,getTickColor:null,getPointerColor:null,keyboardSupport:!0,scale:1,enforceStep:!0,enforceRange:!1,noSwitching:!1,onlyBindHandles:!1,onStart:null,onChange:null,onEnd:null,rightToLeft:!1,reversedControls:!1,boundPointerLabels:!0,mergeRangeLabelsIfSame:!1,labelOverlapSeparator:" - ",customTemplateScope:null,logScale:!1,customValueToPosition:null,customPositionToValue:null,selectionBarGradient:null,ariaLabel:null,ariaLabelledBy:null,ariaLabelHigh:null,ariaLabelledByHigh:null},n={},i={options:function(t){e.extend(n,t)},getOptions:function(i){return e.extend({},t,n,i)}};return i})).factory("rzThrottle",["$timeout",function(e){return function(t,n,i){var r,o,a,s=Date.now||function(){return(new Date).getTime()},l=null,c=0;i=i||{};var u=function(){c=s(),l=null,a=t.apply(r,o),r=o=null};return function(){var d=s(),h=n-(d-c);return r=this,o=arguments,h<=0?(e.cancel(l),l=null,c=d,a=t.apply(r,o),r=o=null):l||!1===i.trailing||(l=e(u,h)),a}}}]).factory("RzSlider",["$timeout","$document","$window","$compile","RzSliderOptions","rzThrottle",function(t,n,i,r,o,a){var s=function(e,t){this.scope=e,this.lowValue=0,this.highValue=0,this.sliderElem=t,this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.dragging={active:!1,value:0,difference:0,position:0,lowLimit:0,highLimit:0},this.positionProperty="left",this.dimensionProperty="width",this.handleHalfDim=0,this.maxPos=0,this.precision=0,this.step=1,this.tracking="",this.minValue=0,this.maxValue=0,this.valueRange=0,this.intermediateTicks=!1,this.initHasRun=!1,this.firstKeyDown=!1,this.internalChange=!1,this.cmbLabelShown=!1,this.currentFocusElement=null,this.fullBar=null,this.selBar=null,this.minH=null,this.maxH=null,this.flrLab=null,this.ceilLab=null,this.minLab=null,this.maxLab=null,this.cmbLab=null,this.ticks=null,this.init()};return s.prototype={init:function(){var t,n,r=this,o=function(){r.calcViewDimensions()};this.applyOptions(),this.syncLowValue(),this.range&&this.syncHighValue(),this.initElemHandles(),this.manageElementsStyle(),this.setDisabledState(),this.calcViewDimensions(),this.setMinAndMax(),this.updateRestrictionBar(),this.addAccessibility(),this.updateCeilLab(),this.updateFloorLab(),this.initHandles(),this.manageEventsBindings(),this.scope.$on("reCalcViewDimensions",o),e.element(i).on("resize",o),this.initHasRun=!0,t=a((function(){r.onLowHandleChange()}),r.options.interval),n=a((function(){r.onHighHandleChange()}),r.options.interval),this.scope.$on("rzSliderForceRender",(function(){r.resetLabelsValue(),t(),r.range&&n(),r.resetSlider()})),this.scope.$watchCollection("rzSliderOptions()",(function(e,t){e!==t&&(r.applyOptions(),r.syncLowValue(),r.range&&r.syncHighValue(),r.resetSlider())})),this.scope.$watch("rzSliderModel",(function(e,n){r.internalChange||e!==n&&t()})),this.scope.$watch("rzSliderHigh",(function(e,t){r.internalChange||e!==t&&(null!=e&&n(),(r.range&&null==e||!r.range&&null!=e)&&(r.applyOptions(),r.resetSlider()))})),this.scope.$on("$destroy",(function(){r.unbindEvents(),e.element(i).off("resize",o),r.currentFocusElement=null}))},findStepIndex:function(t){for(var n=0,i=0;i<this.options.stepsArray.length;i++){var r=this.options.stepsArray[i];if(r===t){n=i;break}if(e.isDate(r)){if(r.getTime()===t.getTime()){n=i;break}}else if(e.isObject(r)&&(e.isDate(r.value)&&r.value.getTime()===t.getTime()||r.value===t)){n=i;break}}return n},syncLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.lowValue=this.scope.rzSliderModel:this.lowValue=this.findStepIndex(this.scope.rzSliderModel):this.lowValue=this.scope.rzSliderModel},syncHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.highValue=this.scope.rzSliderHigh:this.highValue=this.findStepIndex(this.scope.rzSliderHigh):this.highValue=this.scope.rzSliderHigh},getStepValue:function(t){var n=this.options.stepsArray[t];return e.isDate(n)?n:e.isObject(n)?n.value:n},applyLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderModel=this.lowValue:this.scope.rzSliderModel=this.getStepValue(this.lowValue):this.scope.rzSliderModel=this.lowValue},applyHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderHigh=this.highValue:this.scope.rzSliderHigh=this.getStepValue(this.highValue):this.scope.rzSliderHigh=this.highValue},onLowHandleChange:function(){this.syncLowValue(),this.range&&this.syncHighValue(),this.setMinAndMax(),this.updateLowHandle(this.valueToPosition(this.lowValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateAriaAttributes(),this.range&&this.updateCmbLabel()},onHighHandleChange:function(){this.syncLowValue(),this.syncHighValue(),this.setMinAndMax(),this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateCmbLabel(),this.updateAriaAttributes()},applyOptions:function(){var t;t=this.scope.rzSliderOptions?this.scope.rzSliderOptions():{},this.options=o.getOptions(t),this.options.step<=0&&(this.options.step=1),this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.options.draggableRange=this.range&&this.options.draggableRange,this.options.draggableRangeOnly=this.range&&this.options.draggableRangeOnly,this.options.draggableRangeOnly&&(this.options.draggableRange=!0),this.options.showTicks=this.options.showTicks||this.options.showTicksValues||!!this.options.ticksArray,this.scope.showTicks=this.options.showTicks,(e.isNumber(this.options.showTicks)||this.options.ticksArray)&&(this.intermediateTicks=!0),this.options.showSelectionBar=this.options.showSelectionBar||this.options.showSelectionBarEnd||null!==this.options.showSelectionBarFromValue,this.options.stepsArray?this.parseStepsArray():(this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(e){return String(e)},this.getLegend=this.options.getLegend),this.options.vertical&&(this.positionProperty="bottom",this.dimensionProperty="height"),this.options.customTemplateScope&&(this.scope.custom=this.options.customTemplateScope)},parseStepsArray:function(){this.options.floor=0,this.options.ceil=this.options.stepsArray.length-1,this.options.step=1,this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(e){return this.options.bindIndexForStepsArray?this.getStepValue(e):e},this.getLegend=function(t){var n=this.options.stepsArray[t];return e.isObject(n)?n.legend:null}},resetSlider:function(){this.manageElementsStyle(),this.addAccessibility(),this.setMinAndMax(),this.updateCeilLab(),this.updateFloorLab(),this.unbindEvents(),this.manageEventsBindings(),this.setDisabledState(),this.calcViewDimensions(),this.updateRestrictionBar(),this.refocusPointerIfNeeded()},refocusPointerIfNeeded:function(){this.currentFocusElement&&(this.onPointerFocus(this.currentFocusElement.pointer,this.currentFocusElement.ref),this.focusElement(this.currentFocusElement.pointer))},initElemHandles:function(){e.forEach(this.sliderElem.children(),(function(t,n){var i=e.element(t);switch(n){case 0:this.leftOutSelBar=i;break;case 1:this.rightOutSelBar=i;break;case 2:this.fullBar=i;break;case 3:this.selBar=i;break;case 4:this.restrictedBar=i;break;case 5:this.minH=i;break;case 6:this.maxH=i;break;case 7:this.flrLab=i;break;case 8:this.ceilLab=i;break;case 9:this.minLab=i;break;case 10:this.maxLab=i;break;case 11:this.cmbLab=i;break;case 12:this.ticks=i}}),this),this.selBar.rzsp=0,this.minH.rzsp=0,this.maxH.rzsp=0,this.flrLab.rzsp=0,this.ceilLab.rzsp=0,this.minLab.rzsp=0,this.maxLab.rzsp=0,this.cmbLab.rzsp=0},manageElementsStyle:function(){this.range?this.maxH.css("display",""):this.maxH.css("display","none"),this.alwaysHide(this.flrLab,this.options.showTicksValues||this.options.hideLimitLabels),this.alwaysHide(this.ceilLab,this.options.showTicksValues||this.options.hideLimitLabels);var e=this.options.showTicksValues&&!this.intermediateTicks;this.alwaysHide(this.minLab,e||this.options.hidePointerLabels),this.alwaysHide(this.maxLab,e||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.cmbLab,e||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.selBar,!this.range&&!this.options.showSelectionBar),this.alwaysHide(this.leftOutSelBar,!this.range||!this.options.showOuterSelectionBars),this.alwaysHide(this.restrictedBar,!this.options.restrictedRange),this.alwaysHide(this.rightOutSelBar,!this.range||!this.options.showOuterSelectionBars),this.range&&this.options.showOuterSelectionBars&&this.fullBar.addClass("rz-transparent"),this.options.vertical&&this.sliderElem.addClass("rz-vertical"),this.options.draggableRange?this.selBar.addClass("rz-draggable"):this.selBar.removeClass("rz-draggable"),this.intermediateTicks&&this.options.showTicksValues&&this.ticks.addClass("rz-ticks-values-under")},alwaysHide:function(e,t){e.rzAlwaysHide=t,t?this.hideEl(e):this.showEl(e)},manageEventsBindings:function(){this.options.disabled||this.options.readOnly?this.unbindEvents():this.bindEvents()},setDisabledState:function(){this.options.disabled?this.sliderElem.attr("disabled","disabled"):this.sliderElem.attr("disabled",null)},resetLabelsValue:function(){this.minLab.rzsv=void 0,this.maxLab.rzsv=void 0},initHandles:function(){this.updateLowHandle(this.valueToPosition(this.lowValue)),this.range&&this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.range&&this.updateCmbLabel(),this.updateTicksScale()},translateFn:function(e,t,n,i){i=void 0===i||i;var r="",o=!1,a=t.hasClass("no-label-injection");i?(this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(e=this.getStepValue(e)),r=String(this.customTrFn(e,this.options.id,n))):r=String(e),(void 0===t.rzsv||t.rzsv.length!==r.length||t.rzsv.length>0&&0===t.rzsd)&&(o=!0,t.rzsv=r),a||t.html(r),this.scope[n+"Label"]=r,o&&this.getDimension(t)},setMinAndMax:function(){if(this.step=+this.options.step,this.precision=+this.options.precision,this.minValue=this.options.floor,this.options.logScale&&0===this.minValue)throw Error("Can't use floor=0 with logarithmic scale");this.options.enforceStep&&(this.lowValue=this.roundStep(this.lowValue),this.range&&(this.highValue=this.roundStep(this.highValue))),null!=this.options.ceil?this.maxValue=this.options.ceil:this.maxValue=this.options.ceil=this.range?this.highValue:this.lowValue,this.options.enforceRange&&(this.lowValue=this.sanitizeValue(this.lowValue),this.range&&(this.highValue=this.sanitizeValue(this.highValue))),this.applyLowValue(),this.range&&this.applyHighValue(),this.valueRange=this.maxValue-this.minValue},addAccessibility:function(){this.minH.attr("role","slider"),this.updateAriaAttributes(),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.minH.attr("tabindex",""):this.minH.attr("tabindex","0"),this.options.vertical&&this.minH.attr("aria-orientation","vertical"),this.options.ariaLabel?this.minH.attr("aria-label",this.options.ariaLabel):this.options.ariaLabelledBy&&this.minH.attr("aria-labelledby",this.options.ariaLabelledBy),this.range&&(this.maxH.attr("role","slider"),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.maxH.attr("tabindex",""):this.maxH.attr("tabindex","0"),this.options.vertical&&this.maxH.attr("aria-orientation","vertical"),this.options.ariaLabelHigh?this.maxH.attr("aria-label",this.options.ariaLabelHigh):this.options.ariaLabelledByHigh&&this.maxH.attr("aria-labelledby",this.options.ariaLabelledByHigh))},updateAriaAttributes:function(){this.minH.attr({"aria-valuenow":this.scope.rzSliderModel,"aria-valuetext":this.customTrFn(this.scope.rzSliderModel,this.options.id,"model"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue}),this.range&&this.maxH.attr({"aria-valuenow":this.scope.rzSliderHigh,"aria-valuetext":this.customTrFn(this.scope.rzSliderHigh,this.options.id,"high"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue})},calcViewDimensions:function(){var e=this.getDimension(this.minH);if(this.handleHalfDim=e/2,this.barDimension=this.getDimension(this.fullBar),this.maxPos=this.barDimension-e,this.getDimension(this.sliderElem),this.sliderElem.rzsp=this.sliderElem[0].getBoundingClientRect()[this.positionProperty],this.initHasRun){this.updateFloorLab(),this.updateCeilLab(),this.initHandles();var n=this;t((function(){n.updateTicksScale()}))}},updateTicksScale:function(){if(this.options.showTicks){var t=this.options.ticksArray||this.getTicksArray(),n=this.options.vertical?"translateY":"translateX",i=this;this.options.rightToLeft&&t.reverse(),this.scope.ticks=t.map((function(t){var r=null;e.isObject(t)&&(r=t.legend,t=t.value);var o=i.valueToPosition(t);i.options.vertical&&(o=i.maxPos-o);var a=n+"("+Math.round(o)+"px)",s={legend:r,selected:i.isTickSelected(t),style:{"-webkit-transform":a,"-moz-transform":a,"-o-transform":a,"-ms-transform":a,transform:a}};return s.selected&&i.options.getSelectionBarColor&&(s.style["background-color"]=i.getSelectionBarColor()),!s.selected&&i.options.getTickColor&&(s.style["background-color"]=i.getTickColor(t)),i.options.ticksTooltip&&(s.tooltip=i.options.ticksTooltip(t),s.tooltipPlacement=i.options.vertical?"right":"top"),!0!==i.options.showTicksValues&&t%i.options.showTicksValues!=0||(s.value=i.getDisplayValue(t,"tick-value"),i.options.ticksValuesTooltip&&(s.valueTooltip=i.options.ticksValuesTooltip(t),s.valueTooltipPlacement=i.options.vertical?"right":"top")),i.getLegend&&(r=i.getLegend(t,i.options.id))&&(s.legend=r),s}))}},getTicksArray:function(){var e=this.step,t=[];this.intermediateTicks&&(e=this.options.showTicks);for(var n=this.minValue;n<=this.maxValue;n+=e)t.push(n);return t},isTickSelected:function(e){if(!this.range)if(null!==this.options.showSelectionBarFromValue){var t=this.options.showSelectionBarFromValue;if(this.lowValue>t&&e>=t&&e<=this.lowValue)return!0;if(this.lowValue<t&&e<=t&&e>=this.lowValue)return!0}else if(this.options.showSelectionBarEnd){if(e>=this.lowValue)return!0}else if(this.options.showSelectionBar&&e<=this.lowValue)return!0;return!!(this.range&&e>=this.lowValue&&e<=this.highValue)},updateFloorLab:function(){this.translateFn(this.minValue,this.flrLab,"floor"),this.getDimension(this.flrLab);var e=this.options.rightToLeft?this.barDimension-this.flrLab.rzsd:0;this.setPosition(this.flrLab,e)},updateCeilLab:function(){this.translateFn(this.maxValue,this.ceilLab,"ceil"),this.getDimension(this.ceilLab);var e=this.options.rightToLeft?0:this.barDimension-this.ceilLab.rzsd;this.setPosition(this.ceilLab,e)},updateHandles:function(e,t){"lowValue"===e?this.updateLowHandle(t):this.updateHighHandle(t),this.updateSelectionBar(),this.updateTicksScale(),this.range&&this.updateCmbLabel()},getHandleLabelPos:function(e,t){var n=this[e].rzsd,i=t-n/2+this.handleHalfDim,r=this.barDimension-n;return this.options.boundPointerLabels?this.options.rightToLeft&&"minLab"===e||!this.options.rightToLeft&&"maxLab"===e?Math.min(i,r):Math.min(Math.max(i,0),r):i},updateLowHandle:function(e){if(this.setPosition(this.minH,e),this.translateFn(this.lowValue,this.minLab,"model"),this.setPosition(this.minLab,this.getHandleLabelPos("minLab",e)),this.options.getPointerColor){var t=this.getPointerColor("min");this.scope.minPointerStyle={backgroundColor:t}}this.options.autoHideLimitLabels&&this.shFloorCeil()},updateHighHandle:function(e){if(this.setPosition(this.maxH,e),this.translateFn(this.highValue,this.maxLab,"high"),this.setPosition(this.maxLab,this.getHandleLabelPos("maxLab",e)),this.options.getPointerColor){var t=this.getPointerColor("max");this.scope.maxPointerStyle={backgroundColor:t}}this.options.autoHideLimitLabels&&this.shFloorCeil()},shFloorCeil:function(){if(!this.options.hidePointerLabels){var e=!1,t=!1,n=this.isLabelBelowFloorLab(this.minLab),i=this.isLabelAboveCeilLab(this.minLab),r=this.isLabelAboveCeilLab(this.maxLab),o=this.isLabelBelowFloorLab(this.cmbLab),a=this.isLabelAboveCeilLab(this.cmbLab);if(n?(e=!0,this.hideEl(this.flrLab)):(e=!1,this.showEl(this.flrLab)),i?(t=!0,this.hideEl(this.ceilLab)):(t=!1,this.showEl(this.ceilLab)),this.range){var s=this.cmbLabelShown?a:r,l=this.cmbLabelShown?o:n;s?this.hideEl(this.ceilLab):t||this.showEl(this.ceilLab),l?this.hideEl(this.flrLab):e||this.showEl(this.flrLab)}}},isLabelBelowFloorLab:function(e){var t=this.options.rightToLeft,n=e.rzsp,i=e.rzsd,r=this.flrLab.rzsp,o=this.flrLab.rzsd;return t?n+i>=r-2:n<=r+o+2},isLabelAboveCeilLab:function(e){var t=this.options.rightToLeft,n=e.rzsp,i=e.rzsd,r=this.ceilLab.rzsp,o=this.ceilLab.rzsd;return t?n<=r+o+2:n+i>=r-2},updateRestrictionBar:function(){var e=0,t=0;if(this.options.restrictedRange){var n=this.valueToPosition(this.options.restrictedRange.from),i=this.valueToPosition(this.options.restrictedRange.to);t=Math.abs(i-n),e=this.options.rightToLeft?i+this.handleHalfDim:n+this.handleHalfDim,this.setDimension(this.restrictedBar,t),this.setPosition(this.restrictedBar,e)}},updateSelectionBar:function(){var e=0,t=0,n=this.options.rightToLeft?!this.options.showSelectionBarEnd:this.options.showSelectionBarEnd,i=this.options.rightToLeft?this.maxH.rzsp+this.handleHalfDim:this.minH.rzsp+this.handleHalfDim;if(this.range)t=Math.abs(this.maxH.rzsp-this.minH.rzsp),e=i;else if(null!==this.options.showSelectionBarFromValue){var r=this.options.showSelectionBarFromValue,o=this.valueToPosition(r);(this.options.rightToLeft?this.lowValue<=r:this.lowValue>r)?(t=this.minH.rzsp-o,e=o+this.handleHalfDim):(t=o-this.minH.rzsp,e=this.minH.rzsp+this.handleHalfDim)}else n?(t=Math.abs(this.maxPos-this.minH.rzsp)+this.handleHalfDim,e=this.minH.rzsp+this.handleHalfDim):(t=this.minH.rzsp+this.handleHalfDim,e=0);if(this.setDimension(this.selBar,t),this.setPosition(this.selBar,e),this.range&&this.options.showOuterSelectionBars&&(this.options.rightToLeft?(this.setDimension(this.rightOutSelBar,e),this.setPosition(this.rightOutSelBar,0),this.setDimension(this.leftOutSelBar,this.getDimension(this.fullBar)-(e+t)),this.setPosition(this.leftOutSelBar,e+t)):(this.setDimension(this.leftOutSelBar,e),this.setPosition(this.leftOutSelBar,0),this.setDimension(this.rightOutSelBar,this.getDimension(this.fullBar)-(e+t)),this.setPosition(this.rightOutSelBar,e+t))),this.options.getSelectionBarColor){var a=this.getSelectionBarColor();this.scope.barStyle={backgroundColor:a}}else if(this.options.selectionBarGradient){var s=null!==this.options.showSelectionBarFromValue?this.valueToPosition(this.options.showSelectionBarFromValue):0,l=s-e>0^n,c=this.options.vertical?l?"bottom":"top":l?"left":"right";this.scope.barStyle={backgroundImage:"linear-gradient(to "+c+", "+this.options.selectionBarGradient.from+" 0%,"+this.options.selectionBarGradient.to+" 100%)"},this.options.vertical?(this.scope.barStyle.backgroundPosition="center "+(s+t+e+(l?-this.handleHalfDim:0))+"px",this.scope.barStyle.backgroundSize="100% "+(this.barDimension-this.handleHalfDim)+"px"):(this.scope.barStyle.backgroundPosition=s-e+(l?this.handleHalfDim:0)+"px center",this.scope.barStyle.backgroundSize=this.barDimension-this.handleHalfDim+"px 100%")}},getSelectionBarColor:function(){return this.range?this.options.getSelectionBarColor(this.scope.rzSliderModel,this.scope.rzSliderHigh):this.options.getSelectionBarColor(this.scope.rzSliderModel)},getPointerColor:function(e){return"max"===e?this.options.getPointerColor(this.scope.rzSliderHigh,e):this.options.getPointerColor(this.scope.rzSliderModel,e)},getTickColor:function(e){return this.options.getTickColor(e)},updateCmbLabel:function(){if(this.options.rightToLeft?this.minLab.rzsp-this.minLab.rzsd-10<=this.maxLab.rzsp:this.minLab.rzsp+this.minLab.rzsd+10>=this.maxLab.rzsp){var e=this.getDisplayValue(this.lowValue,"model"),t=this.getDisplayValue(this.highValue,"high"),n="";n=this.options.mergeRangeLabelsIfSame&&e===t?e:this.options.rightToLeft?t+this.options.labelOverlapSeparator+e:e+this.options.labelOverlapSeparator+t,this.translateFn(n,this.cmbLab,"cmb",!1);var i=this.options.boundPointerLabels?Math.min(Math.max(this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2,0),this.barDimension-this.cmbLab.rzsd):this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2;this.setPosition(this.cmbLab,i),this.cmbLabelShown=!0,this.hideEl(this.minLab),this.hideEl(this.maxLab),this.showEl(this.cmbLab)}else this.cmbLabelShown=!1,this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateLowHandle(this.valueToPosition(this.lowValue)),this.showEl(this.maxLab),this.showEl(this.minLab),this.hideEl(this.cmbLab);this.options.autoHideLimitLabels&&this.shFloorCeil()},getDisplayValue:function(e,t){return this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(e=this.getStepValue(e)),this.customTrFn(e,this.options.id,t)},roundStep:function(e,t){var n=t||this.step,i=parseFloat((e-this.minValue)/n).toPrecision(12);return i=Math.round(+i)*n,+(this.minValue+i).toFixed(this.precision)},hideEl:function(e){return e.css({visibility:"hidden"})},showEl:function(e){return e.rzAlwaysHide?e:e.css({visibility:"visible"})},setPosition:function(e,t){e.rzsp=t;var n={};return n[this.positionProperty]=Math.round(t)+"px",e.css(n),t},getDimension:function(e){var t=e[0].getBoundingClientRect();return this.options.vertical?e.rzsd=(t.bottom-t.top)*this.options.scale:e.rzsd=(t.right-t.left)*this.options.scale,e.rzsd},setDimension:function(e,t){e.rzsd=t;var n={};return n[this.dimensionProperty]=Math.round(t)+"px",e.css(n),t},sanitizeValue:function(e){return Math.min(Math.max(e,this.minValue),this.maxValue)},valueToPosition:function(e){var t=this.linearValueToPosition;this.options.customValueToPosition?t=this.options.customValueToPosition:this.options.logScale&&(t=this.logValueToPosition);var n=t(e=this.sanitizeValue(e),this.minValue,this.maxValue)||0;return this.options.rightToLeft&&(n=1-n),n*this.maxPos},linearValueToPosition:function(e,t,n){return(e-t)/(n-t)},logValueToPosition:function(e,t,n){return((e=Math.log(e))-(t=Math.log(t)))/((n=Math.log(n))-t)},positionToValue:function(e){var t=e/this.maxPos;this.options.rightToLeft&&(t=1-t);var n=this.linearPositionToValue;return this.options.customPositionToValue?n=this.options.customPositionToValue:this.options.logScale&&(n=this.logPositionToValue),n(t,this.minValue,this.maxValue)||0},linearPositionToValue:function(e,t,n){return e*(n-t)+t},logPositionToValue:function(e,t,n){t=Math.log(t);var i=e*((n=Math.log(n))-t)+t;return Math.exp(i)},getEventAttr:function(e,t){return void 0===e.originalEvent?e[t]:e.originalEvent[t]},getEventXY:function(e,t){var n=this.options.vertical?"clientY":"clientX";if(void 0!==e[n])return e[n];var i=this.getEventAttr(e,"touches");if(void 0!==t)for(var r=0;r<i.length;r++)if(i[r].identifier===t)return i[r][n];return i[0][n]},getEventPosition:function(e,t){var n=this.sliderElem.rzsp;return(this.options.vertical?-this.getEventXY(e,t)+n:this.getEventXY(e,t)-n)*this.options.scale-this.handleHalfDim},getEventNames:function(e){var t={moveEvent:"",endEvent:""};return this.getEventAttr(e,"touches")?(t.moveEvent="touchmove",t.endEvent="touchend"):(t.moveEvent="mousemove",t.endEvent="mouseup"),t},getNearestHandle:function(e){if(!this.range)return this.minH;var t=this.getEventPosition(e),n=Math.abs(t-this.minH.rzsp),i=Math.abs(t-this.maxH.rzsp);return n<i?this.minH:n>i?this.maxH:this.options.rightToLeft?t>this.minH.rzsp?this.minH:this.maxH:t<this.minH.rzsp?this.minH:this.maxH},focusElement:function(e){e[0].focus()},bindEvents:function(){var t,n,i;this.options.draggableRange?(t="rzSliderDrag",n=this.onDragStart,i=this.onDragMove):(t="lowValue",n=this.onStart,i=this.onMove),this.options.onlyBindHandles||(this.selBar.on("mousedown",e.bind(this,n,null,t)),this.selBar.on("mousedown",e.bind(this,i,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("mousedown",e.bind(this,n,null,t)),this.maxH.on("mousedown",e.bind(this,n,null,t))):(this.minH.on("mousedown",e.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("mousedown",e.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("mousedown",e.bind(this,this.onStart,null,null)),this.fullBar.on("mousedown",e.bind(this,this.onMove,this.fullBar)),this.ticks.on("mousedown",e.bind(this,this.onStart,null,null)),this.ticks.on("mousedown",e.bind(this,this.onTickClick,this.ticks)))),this.options.onlyBindHandles||(this.selBar.on("touchstart",e.bind(this,n,null,t)),this.selBar.on("touchstart",e.bind(this,i,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("touchstart",e.bind(this,n,null,t)),this.maxH.on("touchstart",e.bind(this,n,null,t))):(this.minH.on("touchstart",e.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("touchstart",e.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("touchstart",e.bind(this,this.onStart,null,null)),this.fullBar.on("touchstart",e.bind(this,this.onMove,this.fullBar)),this.ticks.on("touchstart",e.bind(this,this.onStart,null,null)),this.ticks.on("touchstart",e.bind(this,this.onTickClick,this.ticks)))),this.options.keyboardSupport&&(this.minH.on("focus",e.bind(this,this.onPointerFocus,this.minH,"lowValue")),this.range&&this.maxH.on("focus",e.bind(this,this.onPointerFocus,this.maxH,"highValue")))},unbindEvents:function(){this.minH.off(),this.maxH.off(),this.fullBar.off(),this.selBar.off(),this.ticks.off()},onStart:function(t,i,r){var o,a,s=this.getEventNames(r);r.stopPropagation(),r.preventDefault(),this.calcViewDimensions(),t?this.tracking=i:(t=this.getNearestHandle(r),this.tracking=t===this.minH?"lowValue":"highValue"),t.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(t),o=e.bind(this,this.dragging.active?this.onDragMove:this.onMove,t),a=e.bind(this,this.onEnd,o),n.on(s.moveEvent,o),n.on(s.endEvent,a),this.endHandlerToBeRemovedOnEnd=a,this.callOnStart();var l=this.getEventAttr(r,"changedTouches");l&&(this.touchId||(this.isDragging=!0,this.touchId=l[0].identifier))},onMove:function(t,n,i){var r,o=this.getEventAttr(n,"changedTouches");if(o)for(var a=0;a<o.length;a++)if(o[a].identifier===this.touchId){r=o[a];break}if(!o||r){var s,l=this.getEventPosition(n,r?r.identifier:void 0),c=this.options.rightToLeft?this.minValue:this.maxValue,u=this.options.rightToLeft?this.maxValue:this.minValue;l<=0?s=u:l>=this.maxPos?s=c:(s=this.positionToValue(l),s=i&&e.isNumber(this.options.showTicks)?this.roundStep(s,this.options.showTicks):this.roundStep(s)),this.positionTrackingHandle(s)}},onEnd:function(e,t){var i=this.getEventAttr(t,"changedTouches");if(!i||i[0].identifier===this.touchId){this.isDragging=!1,this.touchId=null,this.options.keyboardSupport||(this.minH.removeClass("rz-active"),this.maxH.removeClass("rz-active"),this.tracking=""),this.dragging.active=!1;var r=this.getEventNames(t);n.off(r.moveEvent,e),n.off(r.endEvent,this.endHandlerToBeRemovedOnEnd),this.endHandlerToBeRemovedOnEnd=null,this.callOnEnd()}},onTickClick:function(e,t){this.onMove(e,t,!0)},onPointerFocus:function(t,n){this.tracking=n,t.one("blur",e.bind(this,this.onPointerBlur,t)),t.on("keydown",e.bind(this,this.onKeyboardEvent)),t.on("keyup",e.bind(this,this.onKeyUp)),this.firstKeyDown=!0,t.addClass("rz-active"),this.currentFocusElement={pointer:t,ref:n}},onKeyUp:function(){this.firstKeyDown=!0,this.callOnEnd()},onPointerBlur:function(e){e.off("keydown"),e.off("keyup"),e.removeClass("rz-active"),this.isDragging||(this.tracking="",this.currentFocusElement=null)},getKeyActions:function(e){var t=e+this.step,n=e-this.step,i=e+this.valueRange/10,r=e-this.valueRange/10;this.options.reversedControls&&(t=e-this.step,n=e+this.step,i=e-this.valueRange/10,r=e+this.valueRange/10);var o={UP:t,DOWN:n,LEFT:n,RIGHT:t,PAGEUP:i,PAGEDOWN:r,HOME:this.options.reversedControls?this.maxValue:this.minValue,END:this.options.reversedControls?this.minValue:this.maxValue};return this.options.rightToLeft&&(o.LEFT=t,o.RIGHT=n,this.options.vertical&&(o.UP=n,o.DOWN=t)),o},onKeyboardEvent:function(e){var n=this[this.tracking],i=e.keyCode||e.which,r=this.getKeyActions(n)[{38:"UP",40:"DOWN",37:"LEFT",39:"RIGHT",33:"PAGEUP",34:"PAGEDOWN",36:"HOME",35:"END"}[i]];if(null!=r&&""!==this.tracking){e.preventDefault(),this.firstKeyDown&&(this.firstKeyDown=!1,this.callOnStart());var o=this;t((function(){var e=o.roundStep(o.sanitizeValue(r));if(o.options.draggableRangeOnly){var t,n,i=o.highValue-o.lowValue;"lowValue"===o.tracking?(t=e,(n=e+i)>o.maxValue&&(t=(n=o.maxValue)-i)):(n=e,(t=e-i)<o.minValue&&(n=(t=o.minValue)+i)),o.positionTrackingBar(t,n)}else o.positionTrackingHandle(e)}))}},onDragStart:function(e,t,n){var i=this.getEventPosition(n);this.dragging={active:!0,value:this.positionToValue(i),difference:this.highValue-this.lowValue,lowLimit:this.options.rightToLeft?this.minH.rzsp-i:i-this.minH.rzsp,highLimit:this.options.rightToLeft?i-this.maxH.rzsp:this.maxH.rzsp-i},this.onStart(e,t,n)},getValue:function(e,t,n,i){var r=this.options.rightToLeft,o=null;return o="min"===e?n?i?r?this.minValue:this.maxValue-this.dragging.difference:r?this.maxValue-this.dragging.difference:this.minValue:r?this.positionToValue(t+this.dragging.lowLimit):this.positionToValue(t-this.dragging.lowLimit):n?i?r?this.minValue+this.dragging.difference:this.maxValue:r?this.maxValue:this.minValue+this.dragging.difference:r?this.positionToValue(t+this.dragging.lowLimit)+this.dragging.difference:this.positionToValue(t-this.dragging.lowLimit)+this.dragging.difference,this.roundStep(o)},onDragMove:function(e,t){var n,i,r,o,a,s,l,c,u=this.getEventPosition(t);if(this.options.rightToLeft?(r=this.dragging.lowLimit,o=this.dragging.highLimit,l=this.maxH,c=this.minH):(r=this.dragging.highLimit,o=this.dragging.lowLimit,l=this.minH,c=this.maxH),a=u<=o,s=u>=this.maxPos-r,a){if(0===l.rzsp)return;n=this.getValue("min",u,!0,!1),i=this.getValue("max",u,!0,!1)}else if(s){if(c.rzsp===this.maxPos)return;i=this.getValue("max",u,!0,!0),n=this.getValue("min",u,!0,!0)}else n=this.getValue("min",u,!1),i=this.getValue("max",u,!1);this.positionTrackingBar(n,i)},positionTrackingBar:function(e,t){null!=this.options.minLimit&&e<this.options.minLimit&&(t=(e=this.options.minLimit)+this.dragging.difference),null!=this.options.maxLimit&&t>this.options.maxLimit&&(e=(t=this.options.maxLimit)-this.dragging.difference),this.lowValue=e,this.highValue=t,this.applyLowValue(),this.range&&this.applyHighValue(),this.applyModel(!0),this.updateHandles("lowValue",this.valueToPosition(e)),this.updateHandles("highValue",this.valueToPosition(t))},positionTrackingHandle:function(e){var t=!1;e=this.applyMinMaxLimit(e),e=this.applyRestrictedRange(e),this.range&&(this.options.pushRange?(e=this.applyPushRange(e),t=!0):(this.options.noSwitching&&("lowValue"===this.tracking&&e>this.highValue?e=this.applyMinMaxRange(this.highValue):"highValue"===this.tracking&&e<this.lowValue&&(e=this.applyMinMaxRange(this.lowValue))),e=this.applyMinMaxRange(e),"lowValue"===this.tracking&&e>this.highValue?(this.lowValue=this.highValue,this.applyLowValue(),this.applyModel(),this.updateHandles(this.tracking,this.maxH.rzsp),this.updateAriaAttributes(),this.tracking="highValue",this.minH.removeClass("rz-active"),this.maxH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.maxH),t=!0):"highValue"===this.tracking&&e<this.lowValue&&(this.highValue=this.lowValue,this.applyHighValue(),this.applyModel(),this.updateHandles(this.tracking,this.minH.rzsp),this.updateAriaAttributes(),this.tracking="lowValue",this.maxH.removeClass("rz-active"),this.minH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.minH),t=!0))),this[this.tracking]!==e&&(this[this.tracking]=e,"lowValue"===this.tracking?this.applyLowValue():this.applyHighValue(),this.applyModel(),this.updateHandles(this.tracking,this.valueToPosition(e)),this.updateAriaAttributes(),t=!0),t&&this.applyModel(!0)},applyMinMaxLimit:function(e){return null!=this.options.minLimit&&e<this.options.minLimit?this.options.minLimit:null!=this.options.maxLimit&&e>this.options.maxLimit?this.options.maxLimit:e},applyMinMaxRange:function(e){var t="lowValue"===this.tracking?this.highValue:this.lowValue,n=Math.abs(e-t);return null!=this.options.minRange&&n<this.options.minRange?"lowValue"===this.tracking?this.highValue-this.options.minRange:this.lowValue+this.options.minRange:null!=this.options.maxRange&&n>this.options.maxRange?"lowValue"===this.tracking?this.highValue-this.options.maxRange:this.lowValue+this.options.maxRange:e},applyRestrictedRange:function(e){if(null!=this.options.restrictedRange&&e>this.options.restrictedRange.from&&e<this.options.restrictedRange.to){var t=(this.options.restrictedRange.to-this.options.restrictedRange.from)/2;if("lowValue"===this.tracking)return e>this.options.restrictedRange.from+t?this.options.restrictedRange.to:this.options.restrictedRange.from;if("highValue"===this.tracking)return e<this.options.restrictedRange.to-t?this.options.restrictedRange.from:this.options.restrictedRange.to}return e},applyPushRange:function(e){var t="lowValue"===this.tracking?this.highValue-e:e-this.lowValue,n=null!==this.options.minRange?this.options.minRange:this.options.step,i=this.options.maxRange;return t<n?("lowValue"===this.tracking?(this.highValue=Math.min(e+n,this.maxValue),e=this.highValue-n,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=Math.max(e-n,this.minValue),e=this.lowValue+n,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()):null!==i&&t>i&&("lowValue"===this.tracking?(this.highValue=e+i,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=e-i,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()),e},applyModel:function(e){this.internalChange=!0,this.scope.$apply(),e&&this.callOnChange(),this.internalChange=!1},callOnStart:function(){if(this.options.onStart){var e=this,t="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync((function(){e.options.onStart(e.options.id,e.scope.rzSliderModel,e.scope.rzSliderHigh,t)}))}},callOnChange:function(){if(this.options.onChange){var e=this,t="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync((function(){e.options.onChange(e.options.id,e.scope.rzSliderModel,e.scope.rzSliderHigh,t)}))}},callOnEnd:function(){if(this.options.onEnd){var e=this,t="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync((function(){e.options.onEnd(e.options.id,e.scope.rzSliderModel,e.scope.rzSliderHigh,t)}))}this.scope.$emit("slideEnded")}},s}]).directive("rzslider",["RzSlider",function(e){return{restrict:"AE",replace:!0,scope:{rzSliderModel:"=?",rzSliderHigh:"=?",rzSliderOptions:"&?",rzSliderTplUrl:"@"},templateUrl:function(e,t){return t.rzSliderTplUrl||"rzSliderTpl.html"},link:function(t,n){t.slider=new e(t,n)}}}]);return t.run(["$templateCache",function(e){e.put("rzSliderTpl.html",'<div class=rzslider><span class="rz-bar-wrapper rz-left-out-selection"><span class=rz-bar></span></span> <span class="rz-bar-wrapper rz-right-out-selection"><span class=rz-bar></span></span> <span class=rz-bar-wrapper><span class=rz-bar></span></span> <span class=rz-bar-wrapper><span class="rz-bar rz-selection" ng-style=barStyle></span></span> <span class=rz-bar-wrapper><span class="rz-bar rz-restricted" ng-style=restrictionStyle></span></span> <span class="rz-pointer rz-pointer-min" ng-style=minPointerStyle></span> <span class="rz-pointer rz-pointer-max" ng-style=maxPointerStyle></span> <span class="rz-bubble rz-limit rz-floor"></span> <span class="rz-bubble rz-limit rz-ceil"></span> <span class="rz-bubble rz-model-value"></span> <span class="rz-bubble rz-model-high"></span> <span class=rz-bubble></span><ul ng-show=showTicks class=rz-ticks><li ng-repeat="t in ticks track by $index" class=rz-tick ng-class="{\'rz-selected\': t.selected}" ng-style=t.style ng-attr-uib-tooltip="{{ t.tooltip }}" ng-attr-tooltip-placement={{t.tooltipPlacement}} ng-attr-tooltip-append-to-body="{{ t.tooltip ? true : undefined}}"><span ng-if="t.value != null" class=rz-tick-value ng-attr-uib-tooltip="{{ t.valueTooltip }}" ng-attr-tooltip-placement={{t.valueTooltipPlacement}}>{{ t.value }}</span> <span ng-if="t.legend != null" class=rz-tick-legend>{{ t.legend }}</span></li></ul></div>')}]),t.name})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){},function(e,t,n){var i,r;i=[n(8)],void 0!==(r=function(e){return function(e){function t(t){return"ActiveXObject"in t||e.isDefined(XSLTProcessor)&&e.isDefined(XMLSerializer)}function n(e){var t;return(t=e.getElementsByTagName("parsererror")[0])?t.textContent?t.textContent.split("\n",1)[0]:"unknown parser error":null}function i(e,i,r,o){if(!r||!o)return"No"+(r?"":" XML")+(r||o?"":" &")+(o?"":" XSLT");if(!t(e))return"XSL transformation is not supported by your browser";var a,s,l,c;if("ActiveXObject"in e){if((l=new ActiveXObject("Msxml2.DOMDocument")).loadXML(r),0!==l.parseError.errorCode)return("XML parse error ("+l.parseError.errorCode+"): "+l.parseError.reason).trim();if((c=new ActiveXObject("Msxml2.FreeThreadedDOMDocument")).loadXML(o),0!==c.parseError.errorCode)return("XSLT parse error ("+c.parseError.errorCode+"): "+c.parseError.reason).trim();var u=new ActiveXObject("Msxml2.XSLTemplate");try{u.stylesheet=c}catch(d){return"XSLT error: "+d.message}(a=u.createProcessor()).input=l,a.transform(),s=a.output}else{var d;if(d=n(l=(new DOMParser).parseFromString(r,"text/xml")))return"XML parse error: "+d;if(d=n(c=(new DOMParser).parseFromString(o,"text/xml")))return"XSLT parse error: "+d;(a=new XSLTProcessor).importStylesheet(c),s=(new XMLSerializer).serializeToString(a.transformToFragment(l,i))}return s||"(empty)"}return e.module("ngXslt",[]).filter("xslt",["$window","$document",function(e,t){return i.bind(this,e,t[0])}])}(e)}.apply(t,i))&&(e.exports=r)},function(e,t,n){angular.module("infinite-scroll",[]).value("THROTTLE_MILLISECONDS",null).directive("infiniteScroll",["$rootScope","$window","$interval","THROTTLE_MILLISECONDS",function(e,t,n,i){return{scope:{infiniteScroll:"&",infiniteScrollContainer:"=",infiniteScrollDistance:"=",infiniteScrollDisabled:"=",infiniteScrollUseDocumentBottom:"=",infiniteScrollListenForEvent:"@"},link:function(r,o,a){var s,l,c,u,d,h,p,f,g,m,v,y,b,_,x,w,S,T;return T=angular.element(t),_=null,x=null,c=null,u=null,v=!0,S=!1,w=null,l=!1,m=function(e){return e=e[0]||e,isNaN(e.offsetHeight)?e.document.documentElement.clientHeight:e.offsetHeight},y=function(e){if(e[0].getBoundingClientRect&&!e.css("none"))return e[0].getBoundingClientRect().top+b(e)},b=function(e){return e=e[0]||e,isNaN(window.pageYOffset)?e.document.documentElement.scrollTop:e.ownerDocument.defaultView.pageYOffset},g=function(){var t,i,a;return u===T?(t=m(u)+b(u[0].document.documentElement),a=y(o)+m(o)):(t=m(u),i=0,void 0!==y(u)&&(i=y(u)),a=y(o)-i+m(o)),S&&(a=m((o[0].ownerDocument||o[0].document).documentElement)),a-t<=m(u)*_+1?(c=!0,x?r.$$phase||e.$$phase?r.infiniteScroll():r.$apply(r.infiniteScroll):void 0):(l&&n.cancel(l),c=!1)},null!=i&&(g=function(e,t){var i,r,o;return o=null,r=0,i=function(){return r=(new Date).getTime(),n.cancel(o),o=null,e.call()},function(){var a,s;return a=(new Date).getTime(),(s=t-(a-r))<=0?(n.cancel(o),o=null,r=a,e.call()):o?void 0:o=n(i,s,1)}}(g,i)),r.$on("$destroy",(function(){if(u.unbind("scroll",g),null!=w&&(w(),w=null),l)return n.cancel(l)})),p=function(e){return _=parseFloat(e)||0},r.$watch("infiniteScrollDistance",p),p(r.infiniteScrollDistance),h=function(e){if((x=!e)&&c)return c=!1,g()},r.$watch("infiniteScrollDisabled",h),h(r.infiniteScrollDisabled),f=function(e){return S=e},r.$watch("infiniteScrollUseDocumentBottom",f),f(r.infiniteScrollUseDocumentBottom),(s=function(e){if(null!=u&&u.unbind("scroll",g),u=e,null!=e)return u.bind("scroll",g)})(T),r.infiniteScrollListenForEvent&&(w=e.$on(r.infiniteScrollListenForEvent,g)),d=function(e){if(null!=e&&0!==e.length){if(e.nodeType&&1===e.nodeType?e=angular.element(e):"function"==typeof e.append?e=angular.element(e[e.length-1]):"string"==typeof e&&(e=angular.element(document.querySelector(e))),null!=e)return s(e);throw new Error("invalid infinite-scroll-container attribute.")}},r.$watch("infiniteScrollContainer",d),d(r.infiniteScrollContainer||[]),null!=a.infiniteScrollParent&&s(angular.element(o.parent())),null!=a.infiniteScrollImmediateCheck&&(v=r.$eval(a.infiniteScrollImmediateCheck)),l=n((function(){return v&&g(),n.cancel(l)}))}}}]),e.exports===t&&(e.exports="infinite-scroll")},function(e,t,n){var i;
/*!
 * angular-translate - v2.19.1 - 2024-01-21
 * 
 * Copyright (c) 2024 The angular-translate team, Pascal Precht; Licensed MIT
 */void 0===(i=function(){return function(){function e(e){"use strict";var t=e.storageKey(),n=e.storage(),i=function(){var i=e.preferredLanguage();angular.isString(i)?e.use(i):n.put(t,e.use())};i.displayName="fallbackFromIncorrectStorageValue",n?n.get(t)?e.use(n.get(t)).catch(i):i():angular.isString(e.preferredLanguage())&&e.use(e.preferredLanguage())}function t(e,t,n,i){"use strict";var r,o,a,s,l,c,u,d,h,p,f,g,m,v,y,b,_={},x=[],w=e,S=[],T="translate-cloak",E=!1,C=!1,k=!0,L=".",P=!1,A=!1,O=0,I=!0,D="default",$={default:function(e){return(e||"").split("-").join("_")},java:function(e){var t=(e||"").split("-").join("_"),n=t.split("_");return n.length>1?n[0].toLowerCase()+"_"+n[1].toUpperCase():t},bcp47:function(e){var t=(e||"").split("_").join("-"),n=t.split("-");switch(n.length){case 1:n[0]=n[0].toLowerCase();break;case 2:n[0]=n[0].toLowerCase(),4===n[1].length?n[1]=n[1].charAt(0).toUpperCase()+n[1].slice(1).toLowerCase():n[1]=n[1].toUpperCase();break;case 3:n[0]=n[0].toLowerCase(),n[1]=n[1].charAt(0).toUpperCase()+n[1].slice(1).toLowerCase(),n[2]=n[2].toUpperCase();break;default:return t}return n.join("-")},"iso639-1":function(e){return(e||"").split("_").join("-").split("-")[0].toLowerCase()}},N=function(){if(angular.isFunction(i.getLocale))return i.getLocale();var e,n,r=t.$get().navigator,o=["language","browserLanguage","systemLanguage","userLanguage"];if(angular.isArray(r.languages))for(e=0;e<r.languages.length;e++)if((n=r.languages[e])&&n.length)return n;for(e=0;e<o.length;e++)if((n=r[o[e]])&&n.length)return n;return null};N.displayName="angular-translate/service: getFirstBrowserLanguage";var M=function(){var e=N()||"";return $[D]&&(e=$[D](e)),e};M.displayName="angular-translate/service: getLocale";var R=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},B=function(){return this.toString().replace(/^\s+|\s+$/g,"")},H=function(e){return angular.isString(e)?e.toLowerCase():e},z=function(e){if(e){for(var t,n=[],i=H(e),r=0,a=x.length;r<a;r++)n.push(H(x[r]));if((r=R(n,i))>-1)return x[r];if(o)for(var s in o)if(o.hasOwnProperty(s)){var l=!1,c=Object.prototype.hasOwnProperty.call(o,s)&&H(s)===H(e);if("*"===s.slice(-1)&&(l=H(s.slice(0,-1))===H(e.slice(0,s.length-1))),(c||l)&&(t=o[s],R(n,H(t))>-1))return t}var u=e.split("_");return u.length>1&&R(n,H(u[0]))>-1?u[0]:void 0}},F=function(e,t){if(!e&&!t)return _;if(e&&!t){if(angular.isString(e))return _[e]}else angular.isObject(_[e])||(_[e]={}),angular.extend(_[e],V(t));return this};this.translations=F,this.cloakClassName=function(e){return e?(T=e,this):T},this.allowNamespaces=function(e){return void 0===e?k:(k=e,this)},this.nestedObjectDelimeter=function(e){return e?(L=e,this):L};var V=function(e,t,n,i){var r,o,a;if(t||(t=[]),n||(n={}),!k)return e;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a=e[r],angular.isObject(a)?V(a,t.concat(r),n,r):(o=t.length?""+t.join(L)+L+r:r,t.length&&r===i&&(n[""+t.join(L)]="@:"+o),n[o]=a));return n};V.displayName="flatObject",this.addInterpolation=function(e){return S.push(e),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(e){return p=e,this},this.useSanitizeValueStrategy=function(e){return n.useStrategy(e),this},this.preferredLanguage=function(e){return e?(j(e),this):r};var j=function(e){return e&&(r=e),r};this.translationNotFoundIndicator=function(e){return this.translationNotFoundIndicatorLeft(e),this.translationNotFoundIndicatorRight(e),this},this.translationNotFoundIndicatorLeft=function(e){return e?(m=e,this):m},this.translationNotFoundIndicatorRight=function(e){return e?(v=e,this):v},this.fallbackLanguage=function(e){return U(e),this};var U=function(e){return e?(angular.isString(e)?(s=!0,a=[e]):angular.isArray(e)&&(s=!1,a=e),angular.isString(r)&&R(a,r)<0&&a.push(r),this):s?a[0]:a};this.use=function(e){if(e){if(!_[e]&&!f)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+e+"'");return l=e,this}return l},this.resolveClientLocale=function(){return M()};var W=function(e){return e?(w=e,this):d?d+w:w};this.storageKey=W,this.useUrlLoader=function(e,t){return this.useLoader("$translateUrlLoader",angular.extend({url:e},t))},this.useStaticFilesLoader=function(e){return this.useLoader("$translateStaticFilesLoader",e)},this.useLoader=function(e,t){return f=e,g=t||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(e){return u=e,this},this.storagePrefix=function(e){return e?(d=e,this):e},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(e){return h=e,this},this.usePostCompiling=function(e){return E=!!e,this},this.forceAsyncReload=function(e){return C=!!e,this},this.uniformLanguageTag=function(e){return e?angular.isString(e)&&(e={standard:e}):e={},D=e.standard,this},this.determinePreferredLanguage=function(e){var t=e&&angular.isFunction(e)?e():M();return r=x.length&&z(t)||t,this},this.registerAvailableLanguageKeys=function(e,t){return e?(x=e,t&&(o=t),this):x},this.useLoaderCache=function(e){return!1===e?y=void 0:!0===e?y=!0:void 0===e?y="$translationCache":e&&(y=e),this},this.directivePriority=function(e){return void 0===e?O:(O=e,this)},this.statefulFilter=function(e){return void 0===e?I:(I=e,this)},this.postProcess=function(e){return b=e||void 0,this},this.keepContent=function(e){return A=!!e,this},this.$get=["$log","$injector","$rootScope","$q",function(e,t,n,i){var o,d,D,$=t.get(p||"$translateDefaultInterpolation"),N=!1,H={},q={},G=function(e,t,n,s,c,h){!l&&r&&(l=r);var p=c&&c!==l?z(c)||c:l;if(c&&ae(c),angular.isArray(e))return function(e){for(var r={},o=[],a=function(e){var o=i.defer(),a=function(t){r[e]=t,o.resolve([e,t])};return G(e,t,n,s,c,h).then(a,a),o.promise},l=0,u=e.length;l<u;l++)o.push(a(e[l]));return i.all(o).then((function(){return r}))}(e);var f=i.defer();if(!e)throw new TypeError("translationId must be a not empty string");e=B.apply(e);var g=function(){var e=q[p]||q[r];if(d=0,u&&!e){var t=o.get(w);if(e=q[t],a&&a.length){var n=R(a,t);d=0===n?1:0,R(a,r)<0&&a.push(r)}}return e}();if(g){var m=function(){c||(p=l),ie(e,t,n,s,p,h).then(f.resolve,f.reject)};m.displayName="promiseResolved",g.finally(m).catch(angular.noop)}else ie(e,t,n,s,p,h).then(f.resolve,f.reject);return f.promise},Z=function(e){return m&&(e=[m,e].join(" ")),v&&(e=[e,v].join(" ")),e},X=function(e){l=e,u&&o.put(G.storageKey(),l),n.$emit("$translateChangeSuccess",{language:e}),$.setLocale(l);var t=function(e,t){H[t].setLocale(l)};t.displayName="eachInterpolatorLocaleSetter",angular.forEach(H,t),n.$emit("$translateChangeEnd",{language:e})},Q=function(e){if(!e)throw"No language key specified for loading.";var r=i.defer();n.$emit("$translateLoadingStart",{language:e}),N=!0;var o=y;"string"==typeof o&&(o=t.get(o));var a=angular.extend({},g,{key:e,$http:angular.extend({},{cache:o},g.$http)}),s=function(t){var i={};n.$emit("$translateLoadingSuccess",{language:e}),angular.isArray(t)?angular.forEach(t,(function(e){angular.extend(i,V(e))})):angular.extend(i,V(t)),N=!1,r.resolve({key:e,table:i}),n.$emit("$translateLoadingEnd",{language:e})};s.displayName="onLoaderSuccess";var l=function(e){n.$emit("$translateLoadingError",{language:e}),r.reject(e),n.$emit("$translateLoadingEnd",{language:e})};return l.displayName="onLoaderError",t.get(f)(a).then(s,l),r.promise};if(u&&(!(o=t.get(u)).get||!o.put))throw new Error("Couldn't use storage '"+u+"', missing get() or put() method!");if(S.length){var Y=function(e){var n=t.get(e);n.setLocale(r||l),H[n.getInterpolationIdentifier()]=n};Y.displayName="interpolationFactoryAdder",angular.forEach(S,Y)}var K=function(e,t,n,r,o){var a=i.defer(),s=function(i){if(Object.prototype.hasOwnProperty.call(i,t)&&null!==i[t]){r.setLocale(e);var s=i[t];if("@:"===s.substr(0,2))K(e,s.substr(2),n,r,o).then(a.resolve,a.reject);else{var c=r.interpolate(i[t],n,"service",o,t);c=oe(t,i[t],c,n,e),a.resolve(c)}r.setLocale(l)}else a.reject()};return s.displayName="fallbackTranslationResolver",function(e){var t=i.defer();if(Object.prototype.hasOwnProperty.call(_,e))t.resolve(_[e]);else if(q[e]){var n=function(e){F(e.key,e.table),t.resolve(e.table)};n.displayName="translationTableResolver",q[e].then(n,t.reject)}else t.reject();return t.promise}(e).then(s,a.reject),a.promise},J=function(e,t,n,i,r){var o,a=_[e];if(a&&Object.prototype.hasOwnProperty.call(a,t)&&null!==a[t]){if(i.setLocale(e),o=i.interpolate(a[t],n,"filter",r,t),o=oe(t,a[t],o,n,e,r),!angular.isString(o)&&angular.isFunction(o.$$unwrapTrustedValue)){var s=o.$$unwrapTrustedValue();if("@:"===s.substr(0,2))return J(e,s.substr(2),n,i,r)}else if("@:"===o.substr(0,2))return J(e,o.substr(2),n,i,r);i.setLocale(l)}return o},ee=function(e,n,i,r){return h?t.get(h)(e,l,n,i,r):e},te=function(e,t,n,r,o,s){var l=i.defer();if(e<a.length){var c=a[e];K(c,t,n,r,s).then((function(e){l.resolve(e)}),(function(){return te(e+1,t,n,r,o,s).then(l.resolve,l.reject)}))}else if(o)l.resolve(o);else{var u=ee(t,n,o);h&&u?l.resolve(u):l.reject(Z(t))}return l.promise},ne=function(e,t,n,i,r){var o;if(e<a.length){var s=a[e];(o=J(s,t,n,i,r))||""===o||(o=ne(e+1,t,n,i))}return o},ie=function(e,t,n,r,o,s){var l=i.defer(),c=o?_[o]:_,u=n?H[n]:$;if(c&&Object.prototype.hasOwnProperty.call(c,e)&&null!==c[e]){var p=c[e];if("@:"===p.substr(0,2))G(p.substr(2),t,n,r,o,s).then(l.resolve,l.reject);else{var f=u.interpolate(p,t,"service",s,e);f=oe(e,p,f,t,o),l.resolve(f)}}else{var g;h&&!N&&(g=ee(e,t,r)),o&&a&&a.length?function(e,t,n,i,r){return te(D>0?D:d,e,t,n,i,r)}(e,t,u,r,s).then((function(e){l.resolve(e)}),(function(e){l.reject(Z(e))})):h&&!N&&g?r?l.resolve(r):l.resolve(g):r?l.resolve(r):l.reject(Z(e))}return l.promise},re=function(e,t,n,i,r){var o,s=i?_[i]:_,l=$;if(H&&Object.prototype.hasOwnProperty.call(H,n)&&(l=H[n]),s&&Object.prototype.hasOwnProperty.call(s,e)&&null!==s[e]){var c=s[e];"@:"===c.substr(0,2)?o=re(c.substr(2),t,n,i,r):(o=l.interpolate(c,t,"filter",r,e),o=oe(e,c,o,t,i,r))}else{var u;h&&!N&&(u=ee(e,t,r)),i&&a&&a.length?(d=0,o=function(e,t,n,i){return ne(D>0?D:d,e,t,n,i)}(e,t,l,r)):o=h&&!N&&u?u:Z(e)}return o},oe=function(e,n,i,r,o,a){var s=b;return s&&("string"==typeof s&&(s=t.get(s)),s)?s(e,n,i,r,o,a):i},ae=function(e){_[e]||!f||q[e]||(q[e]=Q(e).then((function(e){return F(e.key,e.table),e})))};G.preferredLanguage=function(e){return e&&j(e),r},G.cloakClassName=function(){return T},G.allowNamespaces=function(){return k},G.nestedObjectDelimeter=function(){return L},G.fallbackLanguage=function(e){if(null!=e){if(U(e),f&&a&&a.length)for(var t=0,n=a.length;t<n;t++)q[a[t]]||(q[a[t]]=Q(a[t]));G.use(G.use())}return s?a[0]:a},G.useFallbackLanguage=function(e){if(null!=e)if(e){var t=R(a,e);t>-1&&(D=t)}else D=0},G.proposedLanguage=function(){return c},G.storage=function(){return o},G.negotiateLocale=z,G.use=function(e){if(!e)return l;var t=i.defer();t.promise.then(null,angular.noop),n.$emit("$translateChangeStart",{language:e});var r=z(e);return x.length>0&&!r?i.reject(e):(r&&(e=r),c=e,!C&&_[e]||!f||q[e]?q[e]?q[e].then((function(e){return c===e.key&&X(e.key),t.resolve(e.key),e}),(function(e){return!l&&a&&a.length>0&&a[0]!==e?G.use(a[0]).then(t.resolve,t.reject):t.reject(e)})):(t.resolve(e),X(e)):(q[e]=Q(e).then((function(n){return F(n.key,n.table),t.resolve(n.key),c===e&&X(n.key),n}),(function(e){return n.$emit("$translateChangeError",{language:e}),t.reject(e),n.$emit("$translateChangeEnd",{language:e}),i.reject(e)})),q[e].finally((function(){!function(e){c===e&&(c=void 0),q[e]=void 0}(e)})).catch(angular.noop)),t.promise)},G.resolveClientLocale=function(){return M()},G.storageKey=function(){return W()},G.isPostCompilingEnabled=function(){return E},G.isForceAsyncReloadEnabled=function(){return C},G.isKeepContent=function(){return A},G.refresh=function(e){if(!f)throw new Error("Couldn't refresh translation table, no loader registered!");n.$emit("$translateRefreshStart",{language:e});var t=i.defer(),r={};function o(e){var t=Q(e);return q[e]=t,t.then((function(t){_[e]={},F(e,t.table),r[e]=!0}),angular.noop),t}if(t.promise.then((function(){for(var e in _)_.hasOwnProperty(e)&&(e in r||delete _[e]);l&&X(l)}),angular.noop).finally((function(){n.$emit("$translateRefreshEnd",{language:e})})),e)_[e]?o(e).then(t.resolve,t.reject):t.reject();else{var s=a&&a.slice()||[];l&&-1===s.indexOf(l)&&s.push(l),i.all(s.map(o)).then(t.resolve,t.reject)}return t.promise},G.instant=function(e,t,n,i,o){var s=i&&i!==l?z(i)||i:l;if(null===e||angular.isUndefined(e))return e;if(i&&ae(i),angular.isArray(e)){for(var c={},u=0,d=e.length;u<d;u++)c[e[u]]=G.instant(e[u],t,n,i,o);return c}if(angular.isString(e)&&e.length<1)return e;e&&(e=B.apply(e));var p,f,g=[];r&&g.push(r),s&&g.push(s),a&&a.length&&(g=g.concat(a));for(var y=0,b=g.length;y<b;y++){var x=g[y];if(_[x]&&void 0!==_[x][e]&&(p=re(e,t,n,s,o)),void 0!==p)break}return p||""===p||(m||v?p=Z(e):(p=$.interpolate(e,t,"filter",o),h&&!N&&(f=ee(e,t,o)),h&&!N&&f&&(p=f))),p},G.versionInfo=function(){return"2.19.1"},G.loaderCache=function(){return y},G.directivePriority=function(){return O},G.statefulFilter=function(){return I},G.isReady=function(){return P};var se=i.defer();se.promise.then((function(){P=!0})),G.onReady=function(e){var t=i.defer();return angular.isFunction(e)&&t.promise.then(e),P?t.resolve():se.promise.then(t.resolve),t.promise},G.getAvailableLanguageKeys=function(){return x.length>0?x:null},G.getTranslationTable=function(e){return(e=e||G.use())&&_[e]?angular.copy(_[e]):null};var le=n.$on("$translateReady",(function(){se.resolve(),le(),le=null})),ce=n.$on("$translateChangeEnd",(function(){se.resolve(),ce(),ce=null}));if(f){if(angular.equals(_,{})&&G.use()&&G.use(G.use()),a&&a.length)for(var ue=function(e){return F(e.key,e.table),n.$emit("$translateChangeEnd",{language:e.key}),e},de=0,he=a.length;de<he;de++){var pe=a[de];!C&&_[pe]||(q[pe]=Q(pe).then(ue))}}else n.$emit("$translateReady",{language:G.use()});return G}]}function n(e,t){"use strict";var n={setLocale:function(e){},getInterpolationIdentifier:function(){return"default"},useSanitizeValueStrategy:function(e){return t.useStrategy(e),this},interpolate:function(n,i,r,o,a){var s;return i=i||{},i=t.sanitize(i,"params",o,r),angular.isNumber(n)?s=""+n:angular.isString(n)?(s=e(n)(i),s=t.sanitize(s,"text",o,r)):s="",s}};return n}function i(e,t,n,i,r){"use strict";var o=function(){return this.toString().replace(/^\s+|\s+$/g,"")},a=function(e){return angular.isString(e)?e.toLowerCase():e};return{restrict:"AE",scope:!0,priority:e.directivePriority(),compile:function(s,l){var c=l.translateValues?l.translateValues:void 0,u=l.translateInterpolation?l.translateInterpolation:void 0,d=l.translateSanitizeStrategy?l.translateSanitizeStrategy:void 0,h=s[0].outerHTML.match(/translate-value-+/i),p="^(.*)("+t.startSymbol()+".*"+t.endSymbol()+")(.*)",f="^(.*)"+t.startSymbol()+"(.*)"+t.endSymbol()+"(.*)";return function(s,g,m){s.interpolateParams={},s.preText="",s.postText="",s.translateNamespace=function e(t){return t.translateNamespace?t.translateNamespace:t.$parent?e(t.$parent):void 0}(s);var v={},y=function(e){if(angular.isFunction(y._unwatchOld)&&(y._unwatchOld(),y._unwatchOld=void 0),angular.equals(e,"")||!angular.isDefined(e)){var n=o.apply(g.text()).replace(/\n/g," "),i=n.match(p);if(angular.isArray(i)){s.preText=i[1],s.postText=i[3],v.translate=t(i[2])(s.$parent);var r=n.match(f);angular.isArray(r)&&r[2]&&r[2].length&&(y._unwatchOld=s.$watch(r[2],(function(e){v.translate=e,T()})))}else v.translate=n||void 0}else v.translate=e;T()},b=function(e){m.$observe(e,(function(t){v[e]=t,T()}))};!function(e,t,n){if(t.translateValues&&angular.extend(e,i(t.translateValues)(s.$parent)),h)for(var r in n)Object.prototype.hasOwnProperty.call(t,r)&&"translateValue"===r.substr(0,14)&&"translateValues"!==r&&(e[a(r.substr(14,1))+r.substr(15)]=n[r])}(s.interpolateParams,m,l);var _=!0;for(var x in m.$observe("translate",(function(e){void 0===e?y(""):""===e&&_||(v.translate=e,T()),_=!1})),m)m.hasOwnProperty(x)&&"translateAttr"===x.substr(0,13)&&x.length>13&&b(x);if(m.$observe("translateDefault",(function(e){s.defaultText=e,T()})),d&&m.$observe("translateSanitizeStrategy",(function(e){s.sanitizeStrategy=i(e)(s.$parent),T()})),c&&m.$observe("translateValues",(function(e){e&&s.$parent.$watch((function(){angular.extend(s.interpolateParams,i(e)(s.$parent))}))})),h){var w=function(e){m.$observe(e,(function(t){var n=a(e.substr(14,1))+e.substr(15);s.interpolateParams[n]=t}))};for(var S in m)Object.prototype.hasOwnProperty.call(m,S)&&"translateValue"===S.substr(0,14)&&"translateValues"!==S&&w(S)}var T=function(){for(var e in v)v.hasOwnProperty(e)&&void 0!==v[e]&&E(e,v[e],s,s.interpolateParams,s.defaultText,s.translateNamespace)},E=function(t,n,i,r,o,a){n?(a&&"."===n.charAt(0)&&(n=a+n),e(n,r,u,o,i.translateLanguage,i.sanitizeStrategy).then((function(e){C(e,i,!0,t)}),(function(e){C(e,i,!1,t)}))):C(n,i,!1,t)},C=function(t,i,r,o){if(r||void 0!==i.defaultText&&(t=i.defaultText),"translate"===o){(r||!r&&!e.isKeepContent()&&void 0===m.translateKeepContent)&&g.empty().append(i.preText+t+i.postText);var a=e.isPostCompilingEnabled(),s=void 0!==l.translateCompile,c=s&&"false"!==l.translateCompile;(a&&!s||c)&&n(g.contents())(i)}else{var u=m.$attr[o];"data-"===u.substr(0,5)&&(u=u.substr(5)),u=u.substr(15),g.attr(u,t)}};(c||h||m.translateDefault)&&s.$watch("interpolateParams",T,!0),s.$on("translateLanguageChanged",T);var k=r.$on("$translateChangeSuccess",T);g.text().length?m.translate?y(m.translate):y(""):m.translate&&y(m.translate),T(),s.$on("$destroy",k)}}}}function r(e,t){"use strict";return{restrict:"A",priority:e.directivePriority(),link:function(n,i,r){var a,s,l,c={},u=function(){angular.forEach(a,(function(t,o){t&&(c[o]=!0,n.translateNamespace&&"."===t.charAt(0)&&(t=n.translateNamespace+t),e(t,s,r.translateInterpolation,void 0,n.translateLanguage,l).then((function(e){i.attr(o,e)}),(function(e){i.attr(o,e)})))})),angular.forEach(c,(function(e,t){a[t]||(i.removeAttr(t),delete c[t])}))};o(n,r.translateAttr,(function(e){a=e}),u),o(n,r.translateValues,(function(e){s=e}),u),o(n,r.translateSanitizeStrategy,(function(e){l=e}),u),r.translateValues&&n.$watch(r.translateValues,u,!0),n.$on("translateLanguageChanged",u);var d=t.$on("$translateChangeSuccess",u);u(),n.$on("$destroy",d)}}}function o(e,t,n,i){"use strict";t&&("::"===t.substr(0,2)?t=t.substr(2):e.$watch(t,(function(e){n(e),i()}),!0),n(e.$eval(t)))}function a(e,t){"use strict";return{compile:function(n){var i=function(t){t.addClass(e.cloakClassName())},r=function(t){t.removeClass(e.cloakClassName())};return i(n),function(n,o,a){var s=r.bind(this,o),l=i.bind(this,o);a.translateCloak&&a.translateCloak.length?(a.$observe("translateCloak",(function(t){e(t).then(s,l)})),t.$on("$translateChangeSuccess",(function(){e(a.translateCloak).then(s,l)}))):e.onReady(s)}}}}function s(){"use strict";return{restrict:"A",scope:!0,compile:function(){return{pre:function(e,t,n){e.translateNamespace=function e(t){return t.translateNamespace?t.translateNamespace:t.$parent?e(t.$parent):void 0}(e),e.translateNamespace&&"."===n.translateNamespace.charAt(0)?e.translateNamespace+=n.translateNamespace:e.translateNamespace=n.translateNamespace}}}}}function l(){"use strict";return{restrict:"A",scope:!0,compile:function(){return function(e,t,n){n.$observe("translateLanguage",(function(t){e.translateLanguage=t})),e.$watch("translateLanguage",(function(){e.$broadcast("translateLanguageChanged")}))}}}}function c(e,t){"use strict";var n=function(n,i,r,o){if(!angular.isObject(i)){var a=this||{__SCOPE_IS_NOT_AVAILABLE:"More info at https://github.com/angular/angular.js/commit/8863b9d04c722b278fa93c5d66ad1e578ad6eb1f"};i=e(i)(a)}return t.instant(n,i,r,o)};return t.statefulFilter()&&(n.$stateful=!0),n}function u(e){"use strict";return e("translations")}return e.$inject=["$translate"],t.$inject=["$STORAGE_KEY","$windowProvider","$translateSanitizationProvider","pascalprechtTranslateOverrider"],n.$inject=["$interpolate","$translateSanitization"],i.$inject=["$translate","$interpolate","$compile","$parse","$rootScope"],r.$inject=["$translate","$rootScope"],a.$inject=["$translate","$rootScope"],c.$inject=["$parse","$translate"],u.$inject=["$cacheFactory"],angular.module("pascalprecht.translate",["ng"]).run(e),e.displayName="runTranslate",angular.module("pascalprecht.translate").provider("$translateSanitization",(function(){"use strict";var e,t,n,i=null,r=!1,o=!1;(n={sanitize:function(e,t){return"text"===t&&(e=s(e)),e},escape:function(e,t){return"text"===t&&(e=a(e)),e},sanitizeParameters:function(e,t){return"params"===t&&(e=c(e,s)),e},escapeParameters:function(e,t){return"params"===t&&(e=c(e,a)),e},sce:function(e,t,n){return"text"===t?e=l(e):"params"===t&&"filter"!==n&&(e=c(e,a)),e},sceParameters:function(e,t){return"params"===t&&(e=c(e,l)),e}}).escaped=n.escapeParameters,this.addStrategy=function(e,t){return n[e]=t,this},this.removeStrategy=function(e){return delete n[e],this},this.useStrategy=function(e){return r=!0,i=e,this},this.$get=["$injector","$log",function(a,s){var l,c={};return a.has("$sanitize")&&(e=a.get("$sanitize")),a.has("$sce")&&(t=a.get("$sce")),{useStrategy:(l=this,function(e){l.useStrategy(e)}),sanitize:function(e,t,l,u){return i||r||o||(s.warn("pascalprecht.translate.$translateSanitization: No sanitization strategy has been configured. This can have serious security implications. See http://angular-translate.github.io/docs/#/guide/19_security for details."),o=!0),l||null===l||(l=i),l?(u||(u="service"),function(e,t,i,r){return angular.forEach(r,(function(r){if(angular.isFunction(r))e=r(e,t,i);else if(angular.isFunction(n[r]))e=n[r](e,t,i);else{if(!angular.isString(n[r]))throw new Error("pascalprecht.translate.$translateSanitization: Unknown sanitization strategy: '"+r+"'");if(!c[n[r]])try{c[n[r]]=a.get(n[r])}catch(e){throw c[n[r]]=function(){},new Error("pascalprecht.translate.$translateSanitization: Unknown sanitization strategy: '"+r+"'")}e=c[n[r]](e,t,i)}})),e}(e,t,u,angular.isArray(l)?l:[l])):e}}}];var a=function(e){var t=angular.element("<div></div>");return t.text(e),t.html()},s=function(t){if(!e)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot find $sanitize service. Either include the ngSanitize module (https://docs.angularjs.org/api/ngSanitize) or use a sanitization strategy which does not depend on $sanitize, such as 'escape'.");return e(t)},l=function(e){if(!t)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot find $sce service.");return t.trustAsHtml(e)},c=function(e,t,n){if(angular.isDate(e))return e;if(angular.isObject(e)){var i=angular.isArray(e)?[]:{};if(n){if(n.indexOf(e)>-1)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot interpolate parameter due recursive object")}else n=[];return n.push(e),angular.forEach(e,(function(e,r){angular.isFunction(e)||(i[r]=c(e,t,n))})),n.splice(-1,1),i}return angular.isNumber(e)||!0===e||!1===e||angular.isUndefined(e)||null===e?e:t(e)}})),angular.module("pascalprecht.translate").constant("pascalprechtTranslateOverrider",{}).provider("$translate",t),t.displayName="displayName",angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",n),n.displayName="$translateDefaultInterpolation",angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",i),i.displayName="translateDirective",angular.module("pascalprecht.translate").directive("translateAttr",r),r.displayName="translateAttrDirective",angular.module("pascalprecht.translate").directive("translateCloak",a),a.displayName="translateCloakDirective",angular.module("pascalprecht.translate").directive("translateNamespace",s),s.displayName="translateNamespaceDirective",angular.module("pascalprecht.translate").directive("translateLanguage",l),l.displayName="translateLanguageDirective",angular.module("pascalprecht.translate").filter("translate",c),c.displayName="translateFilterFactory",angular.module("pascalprecht.translate").factory("$translationCache",u),u.displayName="$translationCache","pascalprecht.translate"}()}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i;
/*!
 * angular-translate - v2.19.1 - 2024-01-21
 * 
 * Copyright (c) 2024 The angular-translate team, Pascal Precht; Licensed MIT
 */void 0===(i=function(){return function(){function e(e,t){"use strict";return function(n){if(!n||!(angular.isArray(n.files)||angular.isString(n.prefix)&&angular.isString(n.suffix)))throw new Error("Couldn't load static files, no files and prefix or suffix specified!");n.files||(n.files=[{prefix:n.prefix,suffix:n.suffix}]);for(var i=function(i){if(!i||!angular.isString(i.prefix)||!angular.isString(i.suffix))throw new Error("Couldn't load static file, no prefix or suffix specified!");var r=[i.prefix,n.key,i.suffix].join("");return angular.isObject(n.fileMap)&&n.fileMap[r]&&(r=n.fileMap[r]),t(angular.extend({url:r,method:"GET"},n.$http)).then((function(e){return e.data}),(function(){return e.reject(n.key)}))},r=[],o=n.files.length,a=0;a<o;a++)r.push(i({prefix:n.files[a].prefix,key:n.key,suffix:n.files[a].suffix}));return e.all(r).then((function(e){for(var t=e.length,n={},i=0;i<t;i++)for(var r in e[i])n[r]=e[i][r];return n}))}}return e.$inject=["$q","$http"],angular.module("pascalprecht.translate").factory("$translateStaticFilesLoader",e),e.displayName="$translateStaticFilesLoader","pascalprecht.translate"}()}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i,r;i=[n(8)],void 0!==(r=function(e){return function(e){function t(t,n){isFinite(n)?0!==n&&(n=n||2):e.isString(n)||(n=2);for(var i=t.replace(/>\s*</gm,"><").replace(/</g,"~::~<").replace(/\s*xmlns([=:])/g,"~::~xmlns$1").split("~::~"),r=i.length,o=!1,a=0,s="",l=function(e){var t="";if(isNaN(parseInt(e)))t=e;else for(var n=0;e>n;n++)t+=" ";for(var i=["\n"],r=0;100>r;r++)i.push(i[r]+t);return i}(n),c=0;r>c;c++)-1!==i[c].indexOf("<!")?(s+=l[a]+i[c],o=!0,(-1!==i[c].indexOf("--\x3e")||-1!==i[c].indexOf("]>")||-1!==i[c].indexOf("!DOCTYPE"))&&(o=!1)):-1!==i[c].indexOf("--\x3e")||-1!==i[c].indexOf("]>")?(s+=i[c],o=!1):/^<\w/.test(i[c-1])&&/^<\/\w/.test(i[c])&&/^<[\w:\-\.,]+/.exec(i[c-1])==/^<\/[\w:\-\.,]+/.exec(i[c])[0].replace("/","")?(s+=i[c],o||a--):s+=-1!==i[c].search(/<\w/)&&-1===i[c].indexOf("</")&&-1===i[c].indexOf("/>")?o?i[c]:l[a++]+i[c]:-1!==i[c].search(/<\w/)&&-1!==i[c].indexOf("</")?o?i[c]:l[a]+i[c]:i[c].search(/<\//)>-1?o?i[c]:l[--a]+i[c]:-1!==i[c].indexOf("/>")?o?i[c]:l[a]+i[c]:-1!==i[c].indexOf("<?")||-1!==i[c].indexOf("xmlns:")||-1!==i[c].indexOf("xmlns=")?l[a]+i[c]:i[c];return s.trim()}return e.module("prettyXml",[]).filter("prettyXml",(function(){return t}))}(e)}.apply(t,i))&&(e.exports=r)},function(e,t,n){
/**
 *  angular-simple-logger
 *
 * @version: 0.1.7
 * @author: Nicholas McCready
 * @date: Tue Jan 26 2016 10:15:01 GMT-0500 (EST)
 * @license: MIT
 */
var i=n(8);i.module("nemLogging",[]),i.module("nemLogging").provider("nemDebug",(function(){var e;return e=n(47),this.$get=function(){return e},this.debug=e,this}));var r=[].slice;i.module("nemLogging").provider("nemSimpleLogger",["nemDebugProvider",function(e){var t,n,i,o,a,s,l,c,u,d,h,p;for(h=e.debug,i={},t={},u=c=0,d=(o=["debug","info","warn","error","log"]).length;c<d;u=++c)t[p=o[u]]=u;return s=function(e,t,n){if(e>=t)return n()},a=function(e){var t,n,i;if(t=!1,!e)return t;for(n=0,i=o.length;n<i&&(t=null!=e[p=o[n]]&&"function"==typeof e[p]);n++);return t},l=function(e,t){var n,r,a,s;for(null==i[e]&&(i[e]=h(e)),n=i[e],s={},r=0,a=o.length;r<a;r++)s[p=o[r]]="debug"===p?n:t[p];return s},n=function(){function e(e){var n,i,l,c,u,d,h;if(this.$log=e,this.spawn=(u=this.spawn,d=this,function(){return u.apply(d,arguments)}),!this.$log)throw"internalLogger undefined";if(!a(this.$log))throw"@$log is invalid";for(this.doLog=!0,c={},h=this,n=function(e){return c[e]=function(){var n;if(n=1<=arguments.length?r.call(arguments,0):[],h.doLog)return s(t[e],h.currentLevel,(function(){var t;return(t=h.$log)[e].apply(t,n)}))},h[e]=c[e]},i=0,l=o.length;i<l;i++)n(o[i]);this.LEVELS=t,this.currentLevel=t.error}return e.prototype.spawn=function(t){if("string"==typeof t){if(!a(this.$log))throw"@$log is invalid";if(!h)throw"nemDebug is undefined this is probably the light version of this library sep debug logggers is not supported!";return l(t,this.$log)}return new e(t||this.$log)},e}(),this.decorator=["$log",function(e){var i;return(i=new n(e)).currentLevel=t.debug,i}],this.$get=["$log",function(e){return new n(e)}],this}])},function(e,t,n){(function(i){function r(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e}(t=e.exports=n(49)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(o=r))})),e.splice(o,0,i)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=r,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(r())}).call(this,n(48))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,c=[],u=!1,d=-1;function h(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&p())}function p(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){var i;function r(e){function n(){if(n.enabled){var e=n,r=+new Date,o=r-(i||r);e.diff=o,e.prev=i,e.curr=r,i=r;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,i){if("%%"===n)return n;l++;var r=t.formatters[i];if("function"==typeof r){var o=a[l];n=r.call(e,o),a.splice(l,1),l--}return n})),t.formatArgs.call(e,a);var c=n.log||t.log||console.log.bind(console);c.apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,i=0;for(n in e)i=(i<<5)-i+e.charCodeAt(n),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length,r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(50),t.names=[],t.skips=[],t.formatters={}},function(e,t){var n=1e3,i=6e4,r=60*i,o=24*r;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var s,l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*i;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===l&&!1===isNaN(e))return t.long?a(s=e,o,"day")||a(s,r,"hour")||a(s,i,"minute")||a(s,n,"second")||s+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var i,r;!function(o,a,s){var l,c,u=o.L,d={};d.version="0.7.7","object"==typeof e.exports?e.exports=d:void 0===(r="function"==typeof(i=d)?i.call(t,n,t,e):i)||(e.exports=r),d.noConflict=function(){return o.L=u,this},o.L=d,d.Util={extend:function(e){var t,n,i,r,o=Array.prototype.slice.call(arguments,1);for(n=0,i=o.length;n<i;n++)for(t in r=o[n]||{})r.hasOwnProperty(t)&&(e[t]=r[t]);return e},bind:function(e,t){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return e.apply(t,n||arguments)}},stamp:(l=0,c="_leaflet_id",function(e){return e[c]=e[c]||++l,e[c]}),invokeEach:function(e,t,n){var i,r;if("object"==typeof e){for(i in r=Array.prototype.slice.call(arguments,3),e)t.apply(n,[i,e[i]].concat(r));return!0}return!1},limitExecByInterval:function(e,t,n){var i,r;return function o(){var a=arguments;i?r=!0:(i=!0,setTimeout((function(){i=!1,r&&(o.apply(n,a),r=!1)}),t),e.apply(n,a))}},falseFn:function(){return!1},formatNum:function(e,t){var n=Math.pow(10,t||5);return Math.round(e*n)/n},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},splitWords:function(e){return d.Util.trim(e).split(/\s+/)},setOptions:function(e,t){return e.options=d.extend({},e.options,t),e.options},getParamString:function(e,t,n){var i=[];for(var r in e)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(e[r]));return(t&&-1!==t.indexOf("?")?"&":"?")+i.join("&")},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,(function(e,n){var i=t[n];if(void 0===i)throw new Error("No value provided for variable "+e);return"function"==typeof i&&(i=i(t)),i}))},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var t,n,i=["webkit","moz","o","ms"];for(t=0;t<i.length&&!n;t++)n=o[i[t]+e];return n}var t=0;function n(e){var n=+new Date,i=Math.max(0,16-(n-t));return t=n+i,o.setTimeout(e,i)}var i=o.requestAnimationFrame||e("RequestAnimationFrame")||n,r=o.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){o.clearTimeout(e)};d.Util.requestAnimFrame=function(e,t,r,a){if(e=d.bind(e,t),!r||i!==n)return i.call(o,e,a);e()},d.Util.cancelAnimFrame=function(e){e&&r.call(o,e)}}(),d.extend=d.Util.extend,d.bind=d.Util.bind,d.stamp=d.Util.stamp,d.setOptions=d.Util.setOptions,d.Class=function(){},d.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;for(var r in i.constructor=t,t.prototype=i,this)this.hasOwnProperty(r)&&"prototype"!==r&&(t[r]=this[r]);e.statics&&(d.extend(t,e.statics),delete e.statics),e.includes&&(d.Util.extend.apply(null,[i].concat(e.includes)),delete e.includes),e.options&&i.options&&(e.options=d.extend({},i.options,e.options)),d.extend(i,e),i._initHooks=[];var o=this;return t.__super__=o.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){o.prototype.callInitHooks&&o.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=i._initHooks.length;e<t;e++)i._initHooks[e].call(this)}},t},d.Class.include=function(e){d.extend(this.prototype,e)},d.Class.mergeOptions=function(e){d.extend(this.prototype.options,e)},d.Class.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"==typeof e?e:function(){this[e].apply(this,t)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var h,p,f,g="_leaflet_events";d.Mixin={},d.Mixin.Events={addEventListener:function(e,t,n){if(d.Util.invokeEach(e,this.addEventListener,this,t,n))return this;var i,r,o,a,s,l,c,u=this[g]=this[g]||{},h=n&&n!==this&&d.stamp(n);for(i=0,r=(e=d.Util.splitWords(e)).length;i<r;i++)o={action:t,context:n||this},a=e[i],h?(l=(s=a+"_idx")+"_len",(c=u[s]=u[s]||{})[h]||(c[h]=[],u[l]=(u[l]||0)+1),c[h].push(o)):(u[a]=u[a]||[],u[a].push(o));return this},hasEventListeners:function(e){var t=this[g];return!!t&&(e in t&&t[e].length>0||e+"_idx"in t&&t[e+"_idx_len"]>0)},removeEventListener:function(e,t,n){if(!this[g])return this;if(!e)return this.clearAllEventListeners();if(d.Util.invokeEach(e,this.removeEventListener,this,t,n))return this;var i,r,o,a,s,l,c,u,h=this[g],p=n&&n!==this&&d.stamp(n);for(i=0,r=(e=d.Util.splitWords(e)).length;i<r;i++)if(c=(l=(o=e[i])+"_idx")+"_len",u=h[l],t){if(a=p&&u?u[p]:h[o]){for(s=a.length-1;s>=0;s--)a[s].action!==t||n&&a[s].context!==n||(a.splice(s,1)[0].action=d.Util.falseFn);n&&u&&0===a.length&&(delete u[p],h[c]--)}}else delete h[o],delete h[l],delete h[c];return this},clearAllEventListeners:function(){return delete this[g],this},fireEvent:function(e,t){if(!this.hasEventListeners(e))return this;var n,i,r,o,a,s=d.Util.extend({},t,{type:e,target:this}),l=this[g];if(l[e])for(i=0,r=(n=l[e].slice()).length;i<r;i++)n[i].action.call(n[i].context,s);for(a in o=l[e+"_idx"])if(n=o[a].slice())for(i=0,r=n.length;i<r;i++)n[i].action.call(n[i].context,s);return this},addOneTimeEventListener:function(e,t,n){if(d.Util.invokeEach(e,this.addOneTimeEventListener,this,t,n))return this;var i=d.bind((function(){this.removeEventListener(e,t,n).removeEventListener(e,i,n)}),this);return this.addEventListener(e,t,n).addEventListener(e,i,n)}},d.Mixin.Events.on=d.Mixin.Events.addEventListener,d.Mixin.Events.off=d.Mixin.Events.removeEventListener,d.Mixin.Events.once=d.Mixin.Events.addOneTimeEventListener,d.Mixin.Events.fire=d.Mixin.Events.fireEvent,function(){var e="ActiveXObject"in o,t=e&&!a.addEventListener,n=navigator.userAgent.toLowerCase(),i=-1!==n.indexOf("webkit"),r=-1!==n.indexOf("chrome"),s=-1!==n.indexOf("phantom"),l=-1!==n.indexOf("android"),c=-1!==n.search("android [23]"),u=-1!==n.indexOf("gecko"),h=typeof orientation!=void 0+"",p=!o.PointerEvent&&o.MSPointerEvent,f=o.PointerEvent&&o.navigator.pointerEnabled||p,g="devicePixelRatio"in o&&o.devicePixelRatio>1||"matchMedia"in o&&o.matchMedia("(min-resolution:144dpi)")&&o.matchMedia("(min-resolution:144dpi)").matches,m=a.documentElement,v=e&&"transition"in m.style,y="WebKitCSSMatrix"in o&&"m11"in new o.WebKitCSSMatrix&&!c,b="MozPerspective"in m.style,_="OTransition"in m.style,x=!o.L_DISABLE_3D&&(v||y||b||_)&&!s,w=!o.L_NO_TOUCH&&!s&&(f||"ontouchstart"in o||o.DocumentTouch&&a instanceof o.DocumentTouch);d.Browser={ie:e,ielt9:t,webkit:i,gecko:u&&!i&&!o.opera&&!e,android:l,android23:c,chrome:r,ie3d:v,webkit3d:y,gecko3d:b,opera3d:_,any3d:x,mobile:h,mobileWebkit:h&&i,mobileWebkit3d:h&&y,mobileOpera:h&&o.opera,touch:w,msPointer:p,pointer:f,retina:g}}(),d.Point=function(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t},d.Point.prototype={clone:function(){return new d.Point(this.x,this.y)},add:function(e){return this.clone()._add(d.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(d.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(e){var t=(e=d.point(e)).x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return(e=d.point(e)).x===this.x&&e.y===this.y},contains:function(e){return e=d.point(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+d.Util.formatNum(this.x)+", "+d.Util.formatNum(this.y)+")"}},d.point=function(e,t,n){return e instanceof d.Point?e:d.Util.isArray(e)?new d.Point(e[0],e[1]):null==e?e:new d.Point(e,t,n)},d.Bounds=function(e,t){if(e)for(var n=t?[e,t]:e,i=0,r=n.length;i<r;i++)this.extend(n[i])},d.Bounds.prototype={extend:function(e){return e=d.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new d.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new d.Point(this.min.x,this.max.y)},getTopRight:function(){return new d.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return(e="number"==typeof e[0]||e instanceof d.Point?d.point(e):d.bounds(e))instanceof d.Bounds?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=d.bounds(e);var t=this.min,n=this.max,i=e.min,r=e.max,o=r.x>=t.x&&i.x<=n.x,a=r.y>=t.y&&i.y<=n.y;return o&&a},isValid:function(){return!(!this.min||!this.max)}},d.bounds=function(e,t){return!e||e instanceof d.Bounds?e:new d.Bounds(e,t)},d.Transformation=function(e,t,n,i){this._a=e,this._b=t,this._c=n,this._d=i},d.Transformation.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new d.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}},d.DomUtil={get:function(e){return"string"==typeof e?a.getElementById(e):e},getStyle:function(e,t){var n=e.style[t];if(!n&&e.currentStyle&&(n=e.currentStyle[t]),(!n||"auto"===n)&&a.defaultView){var i=a.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"auto"===n?null:n},getViewportOffset:function(e){var t,n=0,i=0,r=e,o=a.body,s=a.documentElement;do{if(n+=r.offsetTop||0,i+=r.offsetLeft||0,n+=parseInt(d.DomUtil.getStyle(r,"borderTopWidth"),10)||0,i+=parseInt(d.DomUtil.getStyle(r,"borderLeftWidth"),10)||0,t=d.DomUtil.getStyle(r,"position"),r.offsetParent===o&&"absolute"===t)break;if("fixed"===t){n+=o.scrollTop||s.scrollTop||0,i+=o.scrollLeft||s.scrollLeft||0;break}if("relative"===t&&!r.offsetLeft){var l=d.DomUtil.getStyle(r,"width"),c=d.DomUtil.getStyle(r,"max-width"),u=r.getBoundingClientRect();"none"===l&&"none"===c||(i+=u.left+r.clientLeft),n+=u.top+(o.scrollTop||s.scrollTop||0);break}r=r.offsetParent}while(r);r=e;do{if(r===o)break;n-=r.scrollTop||0,i-=r.scrollLeft||0,r=r.parentNode}while(r);return new d.Point(i,n)},documentIsLtr:function(){return d.DomUtil._docIsLtrCached||(d.DomUtil._docIsLtrCached=!0,d.DomUtil._docIsLtr="ltr"===d.DomUtil.getStyle(a.body,"direction")),d.DomUtil._docIsLtr},create:function(e,t,n){var i=a.createElement(e);return i.className=t,n&&n.appendChild(i),i},hasClass:function(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=d.DomUtil._getClass(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)},addClass:function(e,t){if(void 0!==e.classList)for(var n=d.Util.splitWords(t),i=0,r=n.length;i<r;i++)e.classList.add(n[i]);else if(!d.DomUtil.hasClass(e,t)){var o=d.DomUtil._getClass(e);d.DomUtil._setClass(e,(o?o+" ":"")+t)}},removeClass:function(e,t){void 0!==e.classList?e.classList.remove(t):d.DomUtil._setClass(e,d.Util.trim((" "+d.DomUtil._getClass(e)+" ").replace(" "+t+" "," ")))},_setClass:function(e,t){void 0===e.className.baseVal?e.className=t:e.className.baseVal=t},_getClass:function(e){return void 0===e.className.baseVal?e.className:e.className.baseVal},setOpacity:function(e,t){if("opacity"in e.style)e.style.opacity=t;else if("filter"in e.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(i)}catch(e){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+i+"(opacity="+t+")"}},testProp:function(e){for(var t=a.documentElement.style,n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1},getTranslateString:function(e){var t=d.Browser.webkit3d,n=(t?",0":"")+")";return"translate"+(t?"3d":"")+"("+e.x+"px,"+e.y+"px"+n},getScaleString:function(e,t){return d.DomUtil.getTranslateString(t.add(t.multiplyBy(-1*e)))+(" scale("+e+") ")},setPosition:function(e,t,n){e._leaflet_pos=t,!n&&d.Browser.any3d?e.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(t):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos}},d.DomUtil.TRANSFORM=d.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),d.DomUtil.TRANSITION=d.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),d.DomUtil.TRANSITION_END="webkitTransition"===d.DomUtil.TRANSITION||"OTransition"===d.DomUtil.TRANSITION?d.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in a)d.extend(d.DomUtil,{disableTextSelection:function(){d.DomEvent.on(o,"selectstart",d.DomEvent.preventDefault)},enableTextSelection:function(){d.DomEvent.off(o,"selectstart",d.DomEvent.preventDefault)}});else{var e=d.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);d.extend(d.DomUtil,{disableTextSelection:function(){if(e){var t=a.documentElement.style;this._userSelect=t[e],t[e]="none"}},enableTextSelection:function(){e&&(a.documentElement.style[e]=this._userSelect,delete this._userSelect)}})}d.extend(d.DomUtil,{disableImageDrag:function(){d.DomEvent.on(o,"dragstart",d.DomEvent.preventDefault)},enableImageDrag:function(){d.DomEvent.off(o,"dragstart",d.DomEvent.preventDefault)}})}(),d.LatLng=function(e,t,n){if(e=parseFloat(e),t=parseFloat(t),isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=e,this.lng=t,void 0!==n&&(this.alt=parseFloat(n))},d.extend(d.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),d.LatLng.prototype={equals:function(e){return!!e&&(e=d.latLng(e),Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng))<=d.LatLng.MAX_MARGIN)},toString:function(e){return"LatLng("+d.Util.formatNum(this.lat,e)+", "+d.Util.formatNum(this.lng,e)+")"},distanceTo:function(e){e=d.latLng(e);var t=d.LatLng.DEG_TO_RAD,n=(e.lat-this.lat)*t,i=(e.lng-this.lng)*t,r=this.lat*t,o=e.lat*t,a=Math.sin(n/2),s=Math.sin(i/2),l=a*a+s*s*Math.cos(r)*Math.cos(o);return 12756274*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))},wrap:function(e,t){var n=this.lng;return n=(n+(t=t||180))%(t-(e=e||-180))+(n<e||n===t?t:e),new d.LatLng(this.lat,n)}},d.latLng=function(e,t){return e instanceof d.LatLng?e:d.Util.isArray(e)?"number"==typeof e[0]||"string"==typeof e[0]?new d.LatLng(e[0],e[1],e[2]):null:null==e?e:"object"==typeof e&&"lat"in e?new d.LatLng(e.lat,"lng"in e?e.lng:e.lon):void 0===t?null:new d.LatLng(e,t)},d.LatLngBounds=function(e,t){if(e)for(var n=t?[e,t]:e,i=0,r=n.length;i<r;i++)this.extend(n[i])},d.LatLngBounds.prototype={extend:function(e){if(!e)return this;var t=d.latLng(e);return(e=null!==t?t:d.latLngBounds(e))instanceof d.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(e.lat,this._southWest.lat),this._southWest.lng=Math.min(e.lng,this._southWest.lng),this._northEast.lat=Math.max(e.lat,this._northEast.lat),this._northEast.lng=Math.max(e.lng,this._northEast.lng)):(this._southWest=new d.LatLng(e.lat,e.lng),this._northEast=new d.LatLng(e.lat,e.lng)):e instanceof d.LatLngBounds&&(this.extend(e._southWest),this.extend(e._northEast)),this},pad:function(e){var t=this._southWest,n=this._northEast,i=Math.abs(t.lat-n.lat)*e,r=Math.abs(t.lng-n.lng)*e;return new d.LatLngBounds(new d.LatLng(t.lat-i,t.lng-r),new d.LatLng(n.lat+i,n.lng+r))},getCenter:function(){return new d.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new d.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new d.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"==typeof e[0]||e instanceof d.LatLng?d.latLng(e):d.latLngBounds(e);var t,n,i=this._southWest,r=this._northEast;return e instanceof d.LatLngBounds?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=i.lat&&n.lat<=r.lat&&t.lng>=i.lng&&n.lng<=r.lng},intersects:function(e){e=d.latLngBounds(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),r=e.getNorthEast(),o=r.lat>=t.lat&&i.lat<=n.lat,a=r.lng>=t.lng&&i.lng<=n.lng;return o&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e){return!!e&&(e=d.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},d.latLngBounds=function(e,t){return!e||e instanceof d.LatLngBounds?e:new d.LatLngBounds(e,t)},d.Projection={},d.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var t=d.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,e.lat),-n),r=e.lng*t,o=i*t;return o=Math.log(Math.tan(Math.PI/4+o/2)),new d.Point(r,o)},unproject:function(e){var t=d.LatLng.RAD_TO_DEG,n=e.x*t,i=(2*Math.atan(Math.exp(e.y))-Math.PI/2)*t;return new d.LatLng(i,n)}},d.Projection.LonLat={project:function(e){return new d.Point(e.lng,e.lat)},unproject:function(e){return new d.LatLng(e.y,e.x)}},d.CRS={latLngToPoint:function(e,t){var n=this.projection.project(e),i=this.scale(t);return this.transformation._transform(n,i)},pointToLatLng:function(e,t){var n=this.scale(t),i=this.transformation.untransform(e,n);return this.projection.unproject(i)},project:function(e){return this.projection.project(e)},scale:function(e){return 256*Math.pow(2,e)},getSize:function(e){var t=this.scale(e);return d.point(t,t)}},d.CRS.Simple=d.extend({},d.CRS,{projection:d.Projection.LonLat,transformation:new d.Transformation(1,0,-1,0),scale:function(e){return Math.pow(2,e)}}),d.CRS.EPSG3857=d.extend({},d.CRS,{code:"EPSG:3857",projection:d.Projection.SphericalMercator,transformation:new d.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(e){return this.projection.project(e).multiplyBy(6378137)}}),d.CRS.EPSG900913=d.extend({},d.CRS.EPSG3857,{code:"EPSG:900913"}),d.CRS.EPSG4326=d.extend({},d.CRS,{code:"EPSG:4326",projection:d.Projection.LonLat,transformation:new d.Transformation(1/360,.5,-1/360,.5)}),d.Map=d.Class.extend({includes:d.Mixin.Events,options:{crs:d.CRS.EPSG3857,fadeAnimation:d.DomUtil.TRANSITION&&!d.Browser.android23,trackResize:!0,markerZoomAnimation:d.DomUtil.TRANSITION&&d.Browser.any3d},initialize:function(e,t){t=d.setOptions(this,t),this._initContainer(e),this._initLayout(),this._onResize=d.bind(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),t.center&&void 0!==t.zoom&&this.setView(d.latLng(t.center),t.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(t.layers)},setView:function(e,t){return t=void 0===t?this.getZoom():t,this._resetView(d.latLng(e),this._limitZoom(t)),this},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=this._limitZoom(e),this)},zoomIn:function(e,t){return this.setZoom(this._zoom+(e||1),t)},zoomOut:function(e,t){return this.setZoom(this._zoom-(e||1),t)},setZoomAround:function(e,t,n){var i=this.getZoomScale(t),r=this.getSize().divideBy(2),o=(e instanceof d.Point?e:this.latLngToContainerPoint(e)).subtract(r).multiplyBy(1-1/i),a=this.containerPointToLatLng(r.add(o));return this.setView(a,t,{zoom:n})},fitBounds:function(e,t){t=t||{},e=e.getBounds?e.getBounds():d.latLngBounds(e);var n=d.point(t.paddingTopLeft||t.padding||[0,0]),i=d.point(t.paddingBottomRight||t.padding||[0,0]),r=this.getBoundsZoom(e,!1,n.add(i));r=t.maxZoom?Math.min(t.maxZoom,r):r;var o=i.subtract(n).divideBy(2),a=this.project(e.getSouthWest(),r),s=this.project(e.getNorthEast(),r),l=this.unproject(a.add(s).divideBy(2).add(o),r);return this.setView(l,r,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e){return this.fire("movestart"),this._rawPanBy(d.point(e)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(e){return e=d.latLngBounds(e),this.options.maxBounds=e,e?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(e,t){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,e);return n.equals(i)?this:this.panTo(i,t)},addLayer:function(e){var t=d.stamp(e);return this._layers[t]||(this._layers[t]=e,!e.options||isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[t]=e,this._updateZoomLevels()),this.options.zoomAnimation&&d.TileLayer&&e instanceof d.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,e.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(e)),this},removeLayer:function(e){var t=d.stamp(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&this.fire("layerremove",{layer:e}),this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels()),this.options.zoomAnimation&&d.TileLayer&&e instanceof d.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,e.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(e){return!!e&&d.stamp(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},invalidateSize:function(e){if(!this._loaded)return this;e=d.extend({animate:!1,pan:!0},!0===e?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=t.divideBy(2).round(),r=n.divideBy(2).round(),o=i.subtract(r);return o.x||o.y?(e.animate&&e.pan?this.panBy(o):(e.pan&&this._rawPanBy(o),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:n})):this},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(e){this._container._leaflet=void 0}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),n=this.unproject(e.getTopRight());return new d.LatLngBounds(t,n)},getMinZoom:function(){return void 0===this.options.minZoom?void 0===this._layersMinZoom?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=d.latLngBounds(e);var i,r=this.getMinZoom()-(t?1:0),o=this.getMaxZoom(),a=this.getSize(),s=e.getNorthWest(),l=e.getSouthEast(),c=!0;n=d.point(n||[0,0]);do{r++,i=this.project(l,r).subtract(this.project(s,r)).add(n),c=t?i.x<a.x||i.y<a.y:a.contains(i)}while(c&&r<=o);return c&&t?null:t?r:r-1},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new d.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var e=this._getTopLeftPoint();return new d.Bounds(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e){var t=this.options.crs;return t.scale(e)/t.scale(this._zoom)},getScaleZoom:function(e){return this._zoom+Math.log(e)/Math.LN2},project:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.latLngToPoint(d.latLng(e),t)},unproject:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.pointToLatLng(d.point(e),t)},layerPointToLatLng:function(e){var t=d.point(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){return this.project(d.latLng(e))._round()._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(e){return d.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return d.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(d.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(d.latLng(e)))},mouseEventToContainerPoint:function(e){return d.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=d.DomUtil.get(e);if(!t)throw new Error("Map container not found.");if(t._leaflet)throw new Error("Map container is already initialized.");t._leaflet=!0},_initLayout:function(){var e=this._container;d.DomUtil.addClass(e,"leaflet-container"+(d.Browser.touch?" leaflet-touch":"")+(d.Browser.retina?" leaflet-retina":"")+(d.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var t=d.DomUtil.getStyle(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._mapPane=e.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=e.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),e.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),e.shadowPane=this._createPane("leaflet-shadow-pane"),e.overlayPane=this._createPane("leaflet-overlay-pane"),e.markerPane=this._createPane("leaflet-marker-pane"),e.popupPane=this._createPane("leaflet-popup-pane");var t=" leaflet-zoom-hide";this.options.markerZoomAnimation||(d.DomUtil.addClass(e.markerPane,t),d.DomUtil.addClass(e.shadowPane,t),d.DomUtil.addClass(e.popupPane,t))},_createPane:function(e,t){return d.DomUtil.create("div",e,t||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(e){for(var t=0,n=(e=e?d.Util.isArray(e)?e:[e]:[]).length;t<n;t++)this.addLayer(e[t])},_resetView:function(e,t,n,i){var r=this._zoom!==t;i||(this.fire("movestart"),r&&this.fire("zoomstart")),this._zoom=t,this._initialCenter=e,this._initialTopLeftPoint=this._getNewTopLeftPoint(e),n?this._initialTopLeftPoint._add(this._getMapPanePos()):d.DomUtil.setPosition(this._mapPane,new d.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var o=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),o&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(r||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(e){d.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var e,t=1/0,n=-1/0,i=this._getZoomSpan();for(e in this._zoomBoundLayers){var r=this._zoomBoundLayers[e];isNaN(r.options.minZoom)||(t=Math.min(t,r.options.minZoom)),isNaN(r.options.maxZoom)||(n=Math.max(n,r.options.maxZoom))}void 0===e?this._layersMaxZoom=this._layersMinZoom=void 0:(this._layersMaxZoom=n,this._layersMinZoom=t),i!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(d.DomEvent){e=e||"on",d.DomEvent[e](this._container,"click",this._onMouseClick,this);var t,n,i=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(t=0,n=i.length;t<n;t++)d.DomEvent[e](this._container,i[t],this._fireMouseEvent,this);this.options.trackResize&&d.DomEvent[e](o,"resize",this._onResize,this)}},_onResize:function(){d.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=d.Util.requestAnimFrame((function(){this.invalidateSize({debounceMoveend:!0})}),this,!1,this._container)},_onMouseClick:function(e){!this._loaded||!e._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||d.DomEvent._skipped(e)||(this.fire("preclick"),this._fireMouseEvent(e))},_fireMouseEvent:function(e){if(this._loaded&&!d.DomEvent._skipped(e)){var t=e.type;if(t="mouseenter"===t?"mouseover":"mouseleave"===t?"mouseout":t,this.hasEventListeners(t)){"contextmenu"===t&&d.DomEvent.preventDefault(e);var n=this.mouseEventToContainerPoint(e),i=this.containerPointToLayerPoint(n),r=this.layerPointToLatLng(i);this.fire(t,{latlng:r,layerPoint:i,containerPoint:n,originalEvent:e})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,this):this.on("load",e,t),this},_layerAdd:function(e){e.onAdd(this),this.fire("layeradd",{layer:e})},_getMapPanePos:function(){return d.DomUtil.getPosition(this._mapPane)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._round()},_latLngToNewLayerPoint:function(e,t,n){var i=this._getNewTopLeftPoint(n,t).add(this._getMapPanePos());return this.project(e,t)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var i=this.project(e,t),r=this.getSize().divideBy(2),o=new d.Bounds(i.subtract(r),i.add(r)),a=this._getBoundsOffset(o,n,t);return this.unproject(i.add(a),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),i=new d.Bounds(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(i,t))},_getBoundsOffset:function(e,t,n){var i=this.project(t.getNorthWest(),n).subtract(e.min),r=this.project(t.getSouthEast(),n).subtract(e.max),o=this._rebound(i.x,-r.x),a=this._rebound(i.y,-r.y);return new d.Point(o,a)},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom();return Math.max(t,Math.min(n,e))}}),d.map=function(e,t){return new d.Map(e,t)},d.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(e){var t=d.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,e.lat),-n),r=this.R_MAJOR,o=this.R_MINOR,a=e.lng*t*r,s=i*t,l=o/r,c=Math.sqrt(1-l*l),u=c*Math.sin(s);u=Math.pow((1-u)/(1+u),.5*c);var h=Math.tan(.5*(.5*Math.PI-s))/u;return s=-r*Math.log(h),new d.Point(a,s)},unproject:function(e){for(var t,n=d.LatLng.RAD_TO_DEG,i=this.R_MAJOR,r=this.R_MINOR,o=e.x*n/i,a=r/i,s=Math.sqrt(1-a*a),l=Math.exp(-e.y/i),c=Math.PI/2-2*Math.atan(l),u=15,h=.1;Math.abs(h)>1e-7&&--u>0;)t=s*Math.sin(c),c+=h=Math.PI/2-2*Math.atan(l*Math.pow((1-t)/(1+t),.5*s))-c;return new d.LatLng(c*n,o)}},d.CRS.EPSG3395=d.extend({},d.CRS,{code:"EPSG:3395",projection:d.Projection.Mercator,transformation:(h=d.Projection.Mercator.R_MAJOR,p=.5/(Math.PI*h),new d.Transformation(p,.5,-p,.5))}),d.TileLayer=d.Class.extend({includes:d.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:d.Browser.mobile,updateWhenIdle:d.Browser.mobile},initialize:function(e,t){(t=d.setOptions(this,t)).detectRetina&&d.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom>0&&t.minZoom--,this.options.maxZoom--),t.bounds&&(t.bounds=d.latLngBounds(t.bounds)),this._url=e;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(e){this._map=e,this._animated=e._zoomAnimated,this._initContainer(),e.on({viewreset:this._reset,moveend:this._update},this),this._animated&&e.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=d.Util.limitExecByInterval(this._update,150,this),e.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this._container.parentNode.removeChild(this._container),e.off({viewreset:this._reset,moveend:this._update},this),this._animated&&e.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||e.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var e=this._map._panes.tilePane;return this._container&&(e.appendChild(this._container),this._setAutoZIndex(e,Math.max)),this},bringToBack:function(){var e=this._map._panes.tilePane;return this._container&&(e.insertBefore(this._container,e.firstChild),this._setAutoZIndex(e,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},setUrl:function(e,t){return this._url=e,t||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e,t){var n,i,r,o=e.children,a=-t(1/0,-1/0);for(i=0,r=o.length;i<r;i++)o[i]!==this._container&&(n=parseInt(o[i].style.zIndex,10),isNaN(n)||(a=t(a,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(a)?a:0)+t(1,-1)},_updateOpacity:function(){var e,t=this._tiles;if(d.Browser.ielt9)for(e in t)d.DomUtil.setOpacity(t[e],this.options.opacity);else d.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var e=this._map._panes.tilePane;if(!this._container){if(this._container=d.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){this._bgBuffer=d.DomUtil.create("div","leaflet-tile-container",this._container),this._tileContainer=d.DomUtil.create("div","leaflet-tile-container",this._container)}else this._tileContainer=this._container;e.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(e){for(var t in this._tiles)this.fire("tileunload",{tile:this._tiles[t]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&e&&e.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var e=this._map,t=e.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&t>n&&(i=Math.round(e.getZoomScale(t)/e.getZoomScale(n)*i)),i},_update:function(){if(this._map){var e=this._map,t=e.getPixelBounds(),n=e.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var r=d.bounds(t.min.divideBy(i)._floor(),t.max.divideBy(i)._floor());this._addTilesFromCenterOut(r),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(r)}}},_addTilesFromCenterOut:function(e){var t,n,i,r=[],o=e.getCenter();for(t=e.min.y;t<=e.max.y;t++)for(n=e.min.x;n<=e.max.x;n++)i=new d.Point(n,t),this._tileShouldBeLoaded(i)&&r.push(i);var s=r.length;if(0!==s){r.sort((function(e,t){return e.distanceTo(o)-t.distanceTo(o)}));var l=a.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=s,n=0;n<s;n++)this._addTile(r[n],l);this._tileContainer.appendChild(l)}},_tileShouldBeLoaded:function(e){if(e.x+":"+e.y in this._tiles)return!1;var t=this.options;if(!t.continuousWorld){var n=this._getWrapTileNum();if(t.noWrap&&(e.x<0||e.x>=n.x)||e.y<0||e.y>=n.y)return!1}if(t.bounds){var i=this._getTileSize(),r=e.multiplyBy(i),o=r.add([i,i]),a=this._map.unproject(r),s=this._map.unproject(o);if(t.continuousWorld||t.noWrap||(a=a.wrap(),s=s.wrap()),!t.bounds.intersects([a,s]))return!1}return!0},_removeOtherTiles:function(e){var t,n,i,r;for(r in this._tiles)t=r.split(":"),n=parseInt(t[0],10),i=parseInt(t[1],10),(n<e.min.x||n>e.max.x||i<e.min.y||i>e.max.y)&&this._removeTile(r)},_removeTile:function(e){var t=this._tiles[e];this.fire("tileunload",{tile:t,url:t.src}),this.options.reuseTiles?(d.DomUtil.removeClass(t,"leaflet-tile-loaded"),this._unusedTiles.push(t)):t.parentNode===this._tileContainer&&this._tileContainer.removeChild(t),d.Browser.android||(t.onload=null,t.src=d.Util.emptyImageUrl),delete this._tiles[e]},_addTile:function(e,t){var n=this._getTilePos(e),i=this._getTile();d.DomUtil.setPosition(i,n,d.Browser.chrome),this._tiles[e.x+":"+e.y]=i,this._loadTile(i,e),i.parentNode!==this._tileContainer&&t.appendChild(i)},_getZoomForUrl:function(){var e=this.options,t=this._map.getZoom();return e.zoomReverse&&(t=e.maxZoom-t),t+=e.zoomOffset,e.maxNativeZoom?Math.min(t,e.maxNativeZoom):t},_getTilePos:function(e){var t=this._map.getPixelOrigin(),n=this._getTileSize();return e.multiplyBy(n).subtract(t)},getTileUrl:function(e){return d.Util.template(this._url,d.extend({s:this._getSubdomain(e),z:e.z,x:e.x,y:e.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(e){var t=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(e.x=(e.x%t.x+t.x)%t.x),this.options.tms&&(e.y=t.y-e.y-1),e.z=this._getZoomForUrl()},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var e=this._unusedTiles.pop();return this._resetTile(e),e}return this._createTile()},_resetTile:function(){},_createTile:function(){var e=d.DomUtil.create("img","leaflet-tile");return e.style.width=e.style.height=this._getTileSize()+"px",e.galleryimg="no",e.onselectstart=e.onmousemove=d.Util.falseFn,d.Browser.ielt9&&void 0!==this.options.opacity&&d.DomUtil.setOpacity(e,this.options.opacity),d.Browser.mobileWebkit3d&&(e.style.WebkitBackfaceVisibility="hidden"),e},_loadTile:function(e,t){e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError,this._adjustTilePoint(t),e.src=this.getTileUrl(t),this.fire("tileloadstart",{tile:e,url:e.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&d.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(d.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var e=this._layer;this.src!==d.Util.emptyImageUrl&&(d.DomUtil.addClass(this,"leaflet-tile-loaded"),e.fire("tileload",{tile:this,url:this.src})),e._tileLoaded()},_tileOnError:function(){var e=this._layer;e.fire("tileerror",{tile:this,url:this.src});var t=e.options.errorTileUrl;t&&(this.src=t),e._tileLoaded()}}),d.tileLayer=function(e,t){return new d.TileLayer(e,t)},d.TileLayer.WMS=d.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(e,t){this._url=e;var n=d.extend({},this.defaultWmsParams),i=t.tileSize||this.options.tileSize;for(var r in t.detectRetina&&d.Browser.retina?n.width=n.height=2*i:n.width=n.height=i,t)this.options.hasOwnProperty(r)||"crs"===r||(n[r]=t[r]);this.wmsParams=n,d.setOptions(this,t)},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,d.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._map,n=this.options.tileSize,i=e.multiplyBy(n),r=i.add([n,n]),o=this._crs.project(t.unproject(i,e.z)),a=this._crs.project(t.unproject(r,e.z)),s=this._wmsVersion>=1.3&&this._crs===d.CRS.EPSG4326?[a.y,o.x,o.y,a.x].join(","):[o.x,a.y,a.x,o.y].join(","),l=d.Util.template(this._url,{s:this._getSubdomain(e)});return l+d.Util.getParamString(this.wmsParams,l,!0)+"&BBOX="+s},setParams:function(e,t){return d.extend(this.wmsParams,e),t||this.redraw(),this}}),d.tileLayer.wms=function(e,t){return new d.TileLayer.WMS(e,t)},d.TileLayer.Canvas=d.TileLayer.extend({options:{async:!1},initialize:function(e){d.setOptions(this,e)},redraw:function(){for(var e in this._map&&(this._reset({hard:!0}),this._update()),this._tiles)this._redrawTile(this._tiles[e]);return this},_redrawTile:function(e){this.drawTile(e,e._tilePoint,this._map._zoom)},_createTile:function(){var e=d.DomUtil.create("canvas","leaflet-tile");return e.width=e.height=this.options.tileSize,e.onselectstart=e.onmousemove=d.Util.falseFn,e},_loadTile:function(e,t){e._layer=this,e._tilePoint=t,this._redrawTile(e),this.options.async||this.tileDrawn(e)},drawTile:function(){},tileDrawn:function(e){this._tileOnLoad.call(e)}}),d.tileLayer.canvas=function(e){return new d.TileLayer.Canvas(e)},d.ImageOverlay=d.Class.extend({includes:d.Mixin.Events,options:{opacity:1},initialize:function(e,t,n){this._url=e,this._bounds=d.latLngBounds(t),d.setOptions(this,n)},onAdd:function(e){this._map=e,this._image||this._initImage(),e._panes.overlayPane.appendChild(this._image),e.on("viewreset",this._reset,this),e.options.zoomAnimation&&d.Browser.any3d&&e.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._image),e.off("viewreset",this._reset,this),e.options.zoomAnimation&&e.off("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var e=this._map._panes.overlayPane;return this._image&&e.insertBefore(this._image,e.firstChild),this},setUrl:function(e){this._url=e,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=d.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&d.Browser.any3d?d.DomUtil.addClass(this._image,"leaflet-zoom-animated"):d.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),d.extend(this._image,{galleryimg:"no",onselectstart:d.Util.falseFn,onmousemove:d.Util.falseFn,onload:d.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(e){var t=this._map,n=this._image,i=t.getZoomScale(e.zoom),r=this._bounds.getNorthWest(),o=this._bounds.getSouthEast(),a=t._latLngToNewLayerPoint(r,e.zoom,e.center),s=t._latLngToNewLayerPoint(o,e.zoom,e.center)._subtract(a),l=a._add(s._multiplyBy(.5*(1-1/i)));n.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(l)+" scale("+i+") "},_reset:function(){var e=this._image,t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(t);d.DomUtil.setPosition(e,t),e.style.width=n.x+"px",e.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){d.DomUtil.setOpacity(this._image,this.options.opacity)}}),d.imageOverlay=function(e,t,n){return new d.ImageOverlay(e,t,n)},d.Icon=d.Class.extend({options:{className:""},initialize:function(e){d.setOptions(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n,i=this._getIconUrl(e);if(!i){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}return n=t&&"IMG"===t.tagName?this._createImg(i,t):this._createImg(i),this._setIconStyles(n,e),n},_setIconStyles:function(e,t){var n,i=this.options,r=d.point(i[t+"Size"]);!(n="shadow"===t?d.point(i.shadowAnchor||i.iconAnchor):d.point(i.iconAnchor))&&r&&(n=r.divideBy(2,!0)),e.className="leaflet-marker-"+t+" "+i.className,n&&(e.style.marginLeft=-n.x+"px",e.style.marginTop=-n.y+"px"),r&&(e.style.width=r.x+"px",e.style.height=r.y+"px")},_createImg:function(e,t){return(t=t||a.createElement("img")).src=e,t},_getIconUrl:function(e){return d.Browser.retina&&this.options[e+"RetinaUrl"]?this.options[e+"RetinaUrl"]:this.options[e+"Url"]}}),d.icon=function(e){return new d.Icon(e)},d.Icon.Default=d.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(e){var t=e+"Url";if(this.options[t])return this.options[t];d.Browser.retina&&"icon"===e&&(e+="-2x");var n=d.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+e+".png"}}),d.Icon.Default.imagePath=function(){var e,t,n,i,r=a.getElementsByTagName("script"),o=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(e=0,t=r.length;e<t;e++)if((n=r[e].src).match(o))return((i=n.split(o)[0])?i+"/":"")+"images"}(),d.Marker=d.Class.extend({includes:d.Mixin.Events,options:{icon:new d.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(e,t){d.setOptions(this,t),this._latlng=d.latLng(e)},onAdd:function(e){this._map=e,e.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),e.options.zoomAnimation&&e.options.markerZoomAnimation&&e.on("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),e.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=d.latLng(e),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update(),this},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var e=this.options,t=this._map,n=t.options.zoomAnimation&&t.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",i=e.icon.createIcon(this._icon),r=!1;i!==this._icon&&(this._icon&&this._removeIcon(),r=!0,e.title&&(i.title=e.title),e.alt&&(i.alt=e.alt)),d.DomUtil.addClass(i,n),e.keyboard&&(i.tabIndex="0"),this._icon=i,this._initInteraction(),e.riseOnHover&&d.DomEvent.on(i,"mouseover",this._bringToFront,this).on(i,"mouseout",this._resetZIndex,this);var o=e.icon.createShadow(this._shadow),a=!1;o!==this._shadow&&(this._removeShadow(),a=!0),o&&d.DomUtil.addClass(o,n),this._shadow=o,e.opacity<1&&this._updateOpacity();var s=this._map._panes;r&&s.markerPane.appendChild(this._icon),o&&a&&s.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&d.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(e){d.DomUtil.setPosition(this._icon,e),this._shadow&&d.DomUtil.setPosition(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon.style.zIndex=this._zIndex+e},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(this.options.clickable){var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout","contextmenu"];d.DomUtil.addClass(e,"leaflet-clickable"),d.DomEvent.on(e,"click",this._onMouseClick,this),d.DomEvent.on(e,"keypress",this._onKeyPress,this);for(var n=0;n<t.length;n++)d.DomEvent.on(e,t[n],this._fireMouseEvent,this);d.Handler.MarkerDrag&&(this.dragging=new d.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(e){var t=this.dragging&&this.dragging.moved();(this.hasEventListeners(e.type)||t)&&d.DomEvent.stopPropagation(e),t||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(e.type,{originalEvent:e,latlng:this._latlng})},_onKeyPress:function(e){13===e.keyCode&&this.fire("click",{originalEvent:e,latlng:this._latlng})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e,latlng:this._latlng}),"contextmenu"===e.type&&this.hasEventListeners(e.type)&&d.DomEvent.preventDefault(e),"mousedown"!==e.type?d.DomEvent.stopPropagation(e):d.DomEvent.preventDefault(e)},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){d.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&d.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),d.marker=function(e,t){return new d.Marker(e,t)},d.DivIcon=d.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(e){var t=e&&"DIV"===e.tagName?e:a.createElement("div"),n=this.options;return!1!==n.html?t.innerHTML=n.html:t.innerHTML="",n.bgPos&&(t.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(t,"icon"),t},createShadow:function(){return null}}),d.divIcon=function(e){return new d.DivIcon(e)},d.Map.mergeOptions({closePopupOnClick:!0}),d.Popup=d.Class.extend({includes:d.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(e,t){d.setOptions(this,e),this._source=t,this._animated=d.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(e){this._map=e,this._container||this._initLayout();var t=e.options.fadeAnimation;t&&d.DomUtil.setOpacity(this._container,0),e._panes.popupPane.appendChild(this._container),e.on(this._getEvents(),this),this.update(),t&&d.DomUtil.setOpacity(this._container,1),this.fire("open"),e.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(e){return e.addLayer(this),this},openOn:function(e){return e.openPopup(this),this},onRemove:function(e){e._panes.popupPane.removeChild(this._container),d.Util.falseFn(this._container.offsetWidth),e.off(this._getEvents(),this),e.options.fadeAnimation&&d.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),e.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=d.latLng(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var e={viewreset:this._updatePosition};return this._animated&&(e.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this._close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var e,t="leaflet-popup",n=t+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=d.DomUtil.create("div",n);this.options.closeButton&&((e=this._closeButton=d.DomUtil.create("a",t+"-close-button",i)).href="#close",e.innerHTML="&#215;",d.DomEvent.disableClickPropagation(e),d.DomEvent.on(e,"click",this._onCloseButtonClick,this));var r=this._wrapper=d.DomUtil.create("div",t+"-content-wrapper",i);d.DomEvent.disableClickPropagation(r),this._contentNode=d.DomUtil.create("div",t+"-content",r),d.DomEvent.disableScrollPropagation(this._contentNode),d.DomEvent.on(r,"contextmenu",d.DomEvent.stopPropagation),this._tipContainer=d.DomUtil.create("div",t+"-tip-container",i),this._tip=d.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var i=e.offsetHeight,r=this.options.maxHeight;r&&i>r?(t.height=r+"px",d.DomUtil.addClass(e,"leaflet-popup-scrolled")):d.DomUtil.removeClass(e,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=this._animated,n=d.point(this.options.offset);t&&d.DomUtil.setPosition(this._container,e),this._containerBottom=-n.y-(t?0:e.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);d.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(this.options.autoPan){var e=this._map,t=this._container.offsetHeight,n=this._containerWidth,i=new d.Point(this._containerLeft,-t-this._containerBottom);this._animated&&i._add(d.DomUtil.getPosition(this._container));var r=e.layerPointToContainerPoint(i),o=d.point(this.options.autoPanPadding),a=d.point(this.options.autoPanPaddingTopLeft||o),s=d.point(this.options.autoPanPaddingBottomRight||o),l=e.getSize(),c=0,u=0;r.x+n+s.x>l.x&&(c=r.x+n-l.x+s.x),r.x-c-a.x<0&&(c=r.x-a.x),r.y+t+s.y>l.y&&(u=r.y+t-l.y+s.y),r.y-u-a.y<0&&(u=r.y-a.y),(c||u)&&e.fire("autopanstart").panBy([c,u])}},_onCloseButtonClick:function(e){this._close(),d.DomEvent.stop(e)}}),d.popup=function(e,t){return new d.Popup(e,t)},d.Map.include({openPopup:function(e,t,n){if(this.closePopup(),!(e instanceof d.Popup)){var i=e;e=new d.Popup(n).setLatLng(t).setContent(i)}return e._isOpen=!0,this._popup=e,this.addLayer(e)},closePopup:function(e){return e&&e!==this._popup||(e=this._popup,this._popup=null),e&&(this.removeLayer(e),e._isOpen=!1),this}}),d.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(e,t){var n=d.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(d.Popup.prototype.options.offset),t&&t.offset&&(n=n.add(t.offset)),t=d.extend({offset:n},t),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),e instanceof d.Popup?(d.setOptions(e,t),this._popup=e,e._source=this):this._popup=new d.Popup(t,this).setContent(e),this},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(e){this._popup.setLatLng(e.latlng)}}),d.LayerGroup=d.Class.extend({initialize:function(e){var t,n;if(this._layers={},e)for(t=0,n=e.length;t<n;t++)this.addLayer(e[t])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return!!e&&(e in this._layers||this.getLayerId(e)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(e){var t,n,i=Array.prototype.slice.call(arguments,1);for(t in this._layers)(n=this._layers[t])[e]&&n[e].apply(n,i);return this},onAdd:function(e){this._map=e,this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e),this._map=null},addTo:function(e){return e.addLayer(this),this},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];for(var t in this._layers)e.push(this._layers[t]);return e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return d.stamp(e)}}),d.layerGroup=function(e){return new d.LayerGroup(e)},d.FeatureGroup=d.LayerGroup.extend({includes:d.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(e){return this.hasLayer(e)?this:("on"in e&&e.on(d.FeatureGroup.EVENTS,this._propagateEvent,this),d.LayerGroup.prototype.addLayer.call(this,e),this._popupContent&&e.bindPopup&&e.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),"off"in e&&e.off(d.FeatureGroup.EVENTS,this._propagateEvent,this),d.LayerGroup.prototype.removeLayer.call(this,e),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:e})):this},bindPopup:function(e,t){return this._popupContent=e,this._popupOptions=t,this.invoke("bindPopup",e,t)},openPopup:function(e){for(var t in this._layers){this._layers[t].openPopup(e);break}return this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new d.LatLngBounds;return this.eachLayer((function(t){e.extend(t instanceof d.Marker?t.getLatLng():t.getBounds())})),e},_propagateEvent:function(e){e=d.extend({layer:e.target,target:this},e),this.fire(e.type,e)}}),d.featureGroup=function(e){return new d.FeatureGroup(e)},d.Path=d.Class.extend({includes:[d.Mixin.Events],statics:{CLIP_PADDING:(f=((d.Browser.mobile?1280:2e3)/Math.max(o.outerWidth,o.outerHeight)-1)/2,Math.max(0,Math.min(.5,f)))},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(e){d.setOptions(this,e)},onAdd:function(e){this._map=e,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),e.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,d.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),e.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(e){return d.setOptions(this,e),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),d.Map.include({_updatePathViewport:function(){var e=d.Path.CLIP_PADDING,t=this.getSize(),n=d.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(t.multiplyBy(e)._round()),i=n.add(t.multiplyBy(1+2*e)._round());this._pathViewport=new d.Bounds(n,i)}}),d.Path.SVG_NS="http://www.w3.org/2000/svg",d.Browser.svg=!(!a.createElementNS||!a.createElementNS(d.Path.SVG_NS,"svg").createSVGRect),d.Path=d.Path.extend({statics:{SVG:d.Browser.svg},bringToFront:function(){var e=this._map._pathRoot,t=this._container;return t&&e.lastChild!==t&&e.appendChild(t),this},bringToBack:function(){var e=this._map._pathRoot,t=this._container,n=e.firstChild;return t&&n!==t&&e.insertBefore(t,n),this},getPathString:function(){},_createElement:function(e){return a.createElementNS(d.Path.SVG_NS,e)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&d.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var e=this.getPathString();e||(e="M0 0"),this._path.setAttribute("d",e)},_initEvents:function(){if(this.options.clickable){!d.Browser.svg&&d.Browser.vml||d.DomUtil.addClass(this._path,"leaflet-clickable"),d.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var e=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],t=0;t<e.length;t++)d.DomEvent.on(this._container,e[t],this._fireMouseEvent,this)}},_onMouseClick:function(e){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(e)},_fireMouseEvent:function(e){if(this._map&&this.hasEventListeners(e.type)){var t=this._map,n=t.mouseEventToContainerPoint(e),i=t.containerPointToLayerPoint(n),r=t.layerPointToLatLng(i);this.fire(e.type,{latlng:r,layerPoint:i,containerPoint:n,originalEvent:e}),"contextmenu"===e.type&&d.DomEvent.preventDefault(e),"mousemove"!==e.type&&d.DomEvent.stopPropagation(e)}}}),d.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=d.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&d.Browser.any3d?(d.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):d.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(e){var t=this.getZoomScale(e.zoom),n=this._getCenterOffset(e.center)._multiplyBy(-t)._add(this._pathViewport.min);this._pathRoot.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(n)+" scale("+t+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max,i=n.x-t.x,r=n.y-t.y,o=this._pathRoot,a=this._panes.overlayPane;d.Browser.mobileWebkit&&a.removeChild(o),d.DomUtil.setPosition(o,t),o.setAttribute("width",i),o.setAttribute("height",r),o.setAttribute("viewBox",[t.x,t.y,i,r].join(" ")),d.Browser.mobileWebkit&&a.appendChild(o)}}}),d.Path.include({bindPopup:function(e,t){return e instanceof d.Popup?this._popup=e:(this._popup&&!t||(this._popup=new d.Popup(t,this)),this._popup.setContent(e)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(e){return this._popup&&(e=e||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:e})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(e){this._popup.setLatLng(e.latlng),this._map.openPopup(this._popup)}}),d.Browser.vml=!d.Browser.svg&&function(){try{var e=a.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(e){return!1}}(),d.Path=d.Browser.svg||!d.Browser.vml?d.Path:d.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return a.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return a.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return a.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var e=this._container=this._createElement("shape");d.DomUtil.addClass(e,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&d.DomUtil.addClass(e,"leaflet-clickable"),e.coordsize="1 1",this._path=this._createElement("path"),e.appendChild(this._path),this._map._pathRoot.appendChild(e)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var e=this._stroke,t=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(e||((e=this._stroke=this._createElement("stroke")).endcap="round",i.appendChild(e)),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=d.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",n.lineCap&&(e.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(e.joinstyle=n.lineJoin)):e&&(i.removeChild(e),this._stroke=null),n.fill?(t||(t=this._fill=this._createElement("fill"),i.appendChild(t)),t.color=n.fillColor||n.color,t.opacity=n.fillOpacity):t&&(i.removeChild(t),this._fill=null)},_updatePath:function(){var e=this._container.style;e.display="none",this._path.v=this.getPathString()+" ",e.display=""}}),d.Map.include(d.Browser.svg||!d.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var e=this._pathRoot=a.createElement("div");e.className="leaflet-vml-container",this._panes.overlayPane.appendChild(e),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),d.Browser.canvas=!!a.createElement("canvas").getContext,d.Path=d.Path.SVG&&!o.L_PREFER_CANVAS||!d.Browser.canvas?d.Path:d.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(e){return d.setOptions(this,e),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(e){e.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!d.Path._updateRequest&&(d.Path._updateRequest=d.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){d.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var e=this.options;e.stroke&&(this._ctx.lineWidth=e.weight,this._ctx.strokeStyle=e.color),e.fill&&(this._ctx.fillStyle=e.fillColor||e.color),e.lineCap&&(this._ctx.lineCap=e.lineCap),e.lineJoin&&(this._ctx.lineJoin=e.lineJoin)},_drawPath:function(){var e,t,n,i,r,o;for(this._ctx.beginPath(),e=0,n=this._parts.length;e<n;e++){for(t=0,i=this._parts[e].length;t<i;t++)r=this._parts[e][t],o=(0===t?"move":"line")+"To",this._ctx[o](r.x,r.y);this instanceof d.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var e=this._ctx,t=this.options;this._drawPath(),e.save(),this._updateStyle(),t.fill&&(e.globalAlpha=t.fillOpacity,e.fill(t.fillRule||"evenodd")),t.stroke&&(e.globalAlpha=t.opacity,e.stroke()),e.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(e){this._containsPoint(e.layerPoint)&&this.fire(e.type,e)},_onMouseMove:function(e){this._map&&!this._map._animatingZoom&&(this._containsPoint(e.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",e)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",e)))}}),d.Map.include(d.Path.SVG&&!o.L_PREFER_CANVAS||!d.Browser.canvas?{}:{_initPathRoot:function(){var e,t=this._pathRoot;t||((t=this._pathRoot=a.createElement("canvas")).style.position="absolute",(e=this._canvasCtx=t.getContext("2d")).lineCap="round",e.lineJoin="round",this._panes.overlayPane.appendChild(t),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max.subtract(t),i=this._pathRoot;d.DomUtil.setPosition(i,t),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-t.x,-t.y)}}}),d.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=this._reducePoints(e,n),e=this._simplifyDP(e,n)},pointToSegmentDistance:function(e,t,n){return Math.sqrt(this._sqClosestPointOnSegment(e,t,n,!0))},closestPointOnSegment:function(e,t,n){return this._sqClosestPointOnSegment(e,t,n)},_simplifyDP:function(e,t){var n=e.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,this._simplifyDPStep(e,i,t,0,n-1);var r,o=[];for(r=0;r<n;r++)i[r]&&o.push(e[r]);return o},_simplifyDPStep:function(e,t,n,i,r){var o,a,s,l=0;for(a=i+1;a<=r-1;a++)(s=this._sqClosestPointOnSegment(e[a],e[i],e[r],!0))>l&&(o=a,l=s);l>n&&(t[o]=1,this._simplifyDPStep(e,t,n,i,o),this._simplifyDPStep(e,t,n,o,r))},_reducePoints:function(e,t){for(var n=[e[0]],i=1,r=0,o=e.length;i<o;i++)this._sqDist(e[i],e[r])>t&&(n.push(e[i]),r=i);return r<o-1&&n.push(e[o-1]),n},clipSegment:function(e,t,n,i){var r,o,a,s=i?this._lastCode:this._getBitCode(e,n),l=this._getBitCode(t,n);for(this._lastCode=l;;){if(!(s|l))return[e,t];if(s&l)return!1;r=s||l,o=this._getEdgeIntersection(e,t,r,n),a=this._getBitCode(o,n),r===s?(e=o,s=a):(t=o,l=a)}},_getEdgeIntersection:function(e,t,n,i){var r=t.x-e.x,o=t.y-e.y,a=i.min,s=i.max;return 8&n?new d.Point(e.x+r*(s.y-e.y)/o,s.y):4&n?new d.Point(e.x+r*(a.y-e.y)/o,a.y):2&n?new d.Point(s.x,e.y+o*(s.x-e.x)/r):1&n?new d.Point(a.x,e.y+o*(a.x-e.x)/r):void 0},_getBitCode:function(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n},_sqDist:function(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i},_sqClosestPointOnSegment:function(e,t,n,i){var r,o=t.x,a=t.y,s=n.x-o,l=n.y-a,c=s*s+l*l;return c>0&&((r=((e.x-o)*s+(e.y-a)*l)/c)>1?(o=n.x,a=n.y):r>0&&(o+=s*r,a+=l*r)),s=e.x-o,l=e.y-a,i?s*s+l*l:new d.Point(o,a)}},d.Polyline=d.Path.extend({initialize:function(e,t){d.Path.prototype.initialize.call(this,t),this._latlngs=this._convertLatLngs(e)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var e=0,t=this._latlngs.length;e<t;e++)this._originalPoints[e]=this._map.latLngToLayerPoint(this._latlngs[e])},getPathString:function(){for(var e=0,t=this._parts.length,n="";e<t;e++)n+=this._getPathPartStr(this._parts[e]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._latlngs=this._convertLatLngs(e),this.redraw()},addLatLng:function(e){return this._latlngs.push(d.latLng(e)),this.redraw()},spliceLatLngs:function(){var e=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),e},closestLayerPoint:function(e){for(var t,n,i=1/0,r=this._parts,o=null,a=0,s=r.length;a<s;a++)for(var l=r[a],c=1,u=l.length;c<u;c++){t=l[c-1],n=l[c];var h=d.LineUtil._sqClosestPointOnSegment(e,t,n,!0);h<i&&(i=h,o=d.LineUtil._sqClosestPointOnSegment(e,t,n))}return o&&(o.distance=Math.sqrt(i)),o},getBounds:function(){return new d.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(e,t){var n,i,r=t?e:[];for(n=0,i=e.length;n<i;n++){if(d.Util.isArray(e[n])&&"number"!=typeof e[n][0])return;r[n]=d.latLng(e[n])}return r},_initEvents:function(){d.Path.prototype._initEvents.call(this)},_getPathPartStr:function(e){for(var t,n=d.Path.VML,i=0,r=e.length,o="";i<r;i++)t=e[i],n&&t._round(),o+=(i?"L":"M")+t.x+" "+t.y;return o},_clipPoints:function(){var e,t,n,i=this._originalPoints,r=i.length;if(this.options.noClip)this._parts=[i];else{this._parts=[];var o=this._parts,a=this._map._pathViewport,s=d.LineUtil;for(e=0,t=0;e<r-1;e++)(n=s.clipSegment(i[e],i[e+1],a,e))&&(o[t]=o[t]||[],o[t].push(n[0]),n[1]===i[e+1]&&e!==r-2||(o[t].push(n[1]),t++))}},_simplifyPoints:function(){for(var e=this._parts,t=d.LineUtil,n=0,i=e.length;n<i;n++)e[n]=t.simplify(e[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),d.Path.prototype._updatePath.call(this))}}),d.polyline=function(e,t){return new d.Polyline(e,t)},d.PolyUtil={},d.PolyUtil.clipPolygon=function(e,t){var n,i,r,o,a,s,l,c,u,h=[1,4,2,8],p=d.LineUtil;for(i=0,l=e.length;i<l;i++)e[i]._code=p._getBitCode(e[i],t);for(o=0;o<4;o++){for(c=h[o],n=[],i=0,r=(l=e.length)-1;i<l;r=i++)a=e[i],s=e[r],a._code&c?s._code&c||((u=p._getEdgeIntersection(s,a,c,t))._code=p._getBitCode(u,t),n.push(u)):(s._code&c&&((u=p._getEdgeIntersection(s,a,c,t))._code=p._getBitCode(u,t),n.push(u)),n.push(a));e=n}return e},d.Polygon=d.Polyline.extend({options:{fill:!0},initialize:function(e,t){d.Polyline.prototype.initialize.call(this,e,t),this._initWithHoles(e)},_initWithHoles:function(e){var t,n,i;if(e&&d.Util.isArray(e[0])&&"number"!=typeof e[0][0])for(this._latlngs=this._convertLatLngs(e[0]),this._holes=e.slice(1),t=0,n=this._holes.length;t<n;t++)(i=this._holes[t]=this._convertLatLngs(this._holes[t]))[0].equals(i[i.length-1])&&i.pop();(e=this._latlngs).length>=2&&e[0].equals(e[e.length-1])&&e.pop()},projectLatlngs:function(){var e,t,n,i;if(d.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(e=0,n=this._holes.length;e<n;e++)for(this._holePoints[e]=[],t=0,i=this._holes[e].length;t<i;t++)this._holePoints[e][t]=this._map.latLngToLayerPoint(this._holes[e][t])},setLatLngs:function(e){return e&&d.Util.isArray(e[0])&&"number"!=typeof e[0][0]?(this._initWithHoles(e),this.redraw()):d.Polyline.prototype.setLatLngs.call(this,e)},_clipPoints:function(){var e=this._originalPoints,t=[];if(this._parts=[e].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;n<i;n++){var r=d.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);r.length&&t.push(r)}this._parts=t}},_getPathPartStr:function(e){return d.Polyline.prototype._getPathPartStr.call(this,e)+(d.Browser.svg?"z":"x")}}),d.polygon=function(e,t){return new d.Polygon(e,t)},function(){function e(e){return d.FeatureGroup.extend({initialize:function(e,t){this._layers={},this._options=t,this.setLatLngs(e)},setLatLngs:function(t){var n=0,i=t.length;for(this.eachLayer((function(e){n<i?e.setLatLngs(t[n++]):this.removeLayer(e)}),this);n<i;)this.addLayer(new e(t[n++],this._options));return this},getLatLngs:function(){var e=[];return this.eachLayer((function(t){e.push(t.getLatLngs())})),e}})}d.MultiPolyline=e(d.Polyline),d.MultiPolygon=e(d.Polygon),d.multiPolyline=function(e,t){return new d.MultiPolyline(e,t)},d.multiPolygon=function(e,t){return new d.MultiPolygon(e,t)}}(),d.Rectangle=d.Polygon.extend({initialize:function(e,t){d.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return[(e=d.latLngBounds(e)).getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}}),d.rectangle=function(e,t){return new d.Rectangle(e,t)},d.Circle=d.Path.extend({initialize:function(e,t,n){d.Path.prototype.initialize.call(this,n),this._latlng=d.latLng(e),this._mRadius=t},options:{fill:!0},setLatLng:function(e){return this._latlng=d.latLng(e),this.redraw()},setRadius:function(e){return this._mRadius=e,this.redraw()},projectLatlngs:function(){var e=this._getLngRadius(),t=this._latlng,n=this._map.latLngToLayerPoint([t.lat,t.lng-e]);this._point=this._map.latLngToLayerPoint(t),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var e=this._getLngRadius(),t=this._mRadius/40075017*360,n=this._latlng;return new d.LatLngBounds([n.lat-t,n.lng-e],[n.lat+t,n.lng+e])},getLatLng:function(){return this._latlng},getPathString:function(){var e=this._point,t=this._radius;return this._checkIfEmpty()?"":d.Browser.svg?"M"+e.x+","+(e.y-t)+"A"+t+","+t+",0,1,1,"+(e.x-.1)+","+(e.y-t)+" z":(e._round(),t=Math.round(t),"AL "+e.x+","+e.y+" "+t+","+t+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(d.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var e=this._map._pathViewport,t=this._radius,n=this._point;return n.x-t>e.max.x||n.y-t>e.max.y||n.x+t<e.min.x||n.y+t<e.min.y}}),d.circle=function(e,t,n){return new d.Circle(e,t,n)},d.CircleMarker=d.Circle.extend({options:{radius:10,weight:2},initialize:function(e,t){d.Circle.prototype.initialize.call(this,e,null,t),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){d.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(e){return d.Circle.prototype.setLatLng.call(this,e),this._popup&&this._popup._isOpen&&this._popup.setLatLng(e),this},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius}}),d.circleMarker=function(e,t){return new d.CircleMarker(e,t)},d.Polyline.include(d.Path.CANVAS?{_containsPoint:function(e,t){var n,i,r,o,a,s,l=this.options.weight/2;for(d.Browser.touch&&(l+=10),n=0,o=this._parts.length;n<o;n++)for(i=0,r=(a=(s=this._parts[n]).length)-1;i<a;r=i++)if((t||0!==i)&&d.LineUtil.pointToSegmentDistance(e,s[r],s[i])<=l)return!0;return!1}}:{}),d.Polygon.include(d.Path.CANVAS?{_containsPoint:function(e){var t,n,i,r,o,a,s,l,c=!1;if(d.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(r=0,s=this._parts.length;r<s;r++)for(o=0,a=(l=(t=this._parts[r]).length)-1;o<l;a=o++)n=t[o],i=t[a],n.y>e.y!=i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c}}:{}),d.Circle.include(d.Path.CANVAS?{_drawPath:function(){var e=this._point;this._ctx.beginPath(),this._ctx.arc(e.x,e.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(e){var t=this._point,n=this.options.stroke?this.options.weight/2:0;return e.distanceTo(t)<=this._radius+n}}:{}),d.CircleMarker.include(d.Path.CANVAS?{_updateStyle:function(){d.Path.prototype._updateStyle.call(this)}}:{}),d.GeoJSON=d.FeatureGroup.extend({initialize:function(e,t){d.setOptions(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,i,r=d.Util.isArray(e)?e:e.features;if(r){for(t=0,n=r.length;t<n;t++)((i=r[t]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(r[t]);return this}var o=this.options;if(!o.filter||o.filter(e)){var a=d.GeoJSON.geometryToLayer(e,o.pointToLayer,o.coordsToLatLng,o);return a.feature=d.GeoJSON.asFeature(e),a.defaultOptions=a.options,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(e,a),this.addLayer(a)}},resetStyle:function(e){var t=this.options.style;t&&(d.Util.extend(e.options,e.defaultOptions),this._setLayerStyle(e,t))},setStyle:function(e){this.eachLayer((function(t){this._setLayerStyle(t,e)}),this)},_setLayerStyle:function(e,t){"function"==typeof t&&(t=t(e.feature)),e.setStyle&&e.setStyle(t)}}),d.extend(d.GeoJSON,{geometryToLayer:function(e,t,n,i){var r,o,a,s,l="Feature"===e.type?e.geometry:e,c=l.coordinates,u=[];switch(n=n||this.coordsToLatLng,l.type){case"Point":return r=n(c),t?t(e,r):new d.Marker(r);case"MultiPoint":for(a=0,s=c.length;a<s;a++)r=n(c[a]),u.push(t?t(e,r):new d.Marker(r));return new d.FeatureGroup(u);case"LineString":return o=this.coordsToLatLngs(c,0,n),new d.Polyline(o,i);case"Polygon":if(2===c.length&&!c[1].length)throw new Error("Invalid GeoJSON object.");return o=this.coordsToLatLngs(c,1,n),new d.Polygon(o,i);case"MultiLineString":return o=this.coordsToLatLngs(c,1,n),new d.MultiPolyline(o,i);case"MultiPolygon":return o=this.coordsToLatLngs(c,2,n),new d.MultiPolygon(o,i);case"GeometryCollection":for(a=0,s=l.geometries.length;a<s;a++)u.push(this.geometryToLayer({geometry:l.geometries[a],type:"Feature",properties:e.properties},t,n,i));return new d.FeatureGroup(u);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e){return new d.LatLng(e[1],e[0],e[2])},coordsToLatLngs:function(e,t,n){var i,r,o,a=[];for(r=0,o=e.length;r<o;r++)i=t?this.coordsToLatLngs(e[r],t-1,n):(n||this.coordsToLatLng)(e[r]),a.push(i);return a},latLngToCoords:function(e){var t=[e.lng,e.lat];return void 0!==e.alt&&t.push(e.alt),t},latLngsToCoords:function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(d.GeoJSON.latLngToCoords(e[n]));return t},getFeature:function(e,t){return e.feature?d.extend({},e.feature,{geometry:t}):d.GeoJSON.asFeature(t)},asFeature:function(e){return"Feature"===e.type?e:{type:"Feature",properties:{},geometry:e}}});var m={toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"Point",coordinates:d.GeoJSON.latLngToCoords(this.getLatLng())})}};d.Marker.include(m),d.Circle.include(m),d.CircleMarker.include(m),d.Polyline.include({toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"LineString",coordinates:d.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),d.Polygon.include({toGeoJSON:function(){var e,t,n,i=[d.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(e=0,t=this._holes.length;e<t;e++)(n=d.GeoJSON.latLngsToCoords(this._holes[e])).push(n[0]),i.push(n);return d.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function e(e){return function(){var t=[];return this.eachLayer((function(e){t.push(e.toGeoJSON().geometry.coordinates)})),d.GeoJSON.getFeature(this,{type:e,coordinates:t})}}d.MultiPolyline.include({toGeoJSON:e("MultiLineString")}),d.MultiPolygon.include({toGeoJSON:e("MultiPolygon")}),d.LayerGroup.include({toGeoJSON:function(){var t,n=this.feature&&this.feature.geometry,i=[];if(n&&"MultiPoint"===n.type)return e("MultiPoint").call(this);var r=n&&"GeometryCollection"===n.type;return this.eachLayer((function(e){e.toGeoJSON&&(t=e.toGeoJSON(),i.push(r?t.geometry:d.GeoJSON.asFeature(t)))})),r?d.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),d.geoJson=function(e,t){return new d.GeoJSON(e,t)},d.DomEvent={addListener:function(e,t,n,i){var r,o,a,s=d.stamp(n),l="_leaflet_"+t+s;return e[l]?this:(r=function(t){return n.call(i||e,t||d.DomEvent._getEvent())},d.Browser.pointer&&0===t.indexOf("touch")?this.addPointerListener(e,t,r,s):(d.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener&&this.addDoubleTapListener(e,r,s),"addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",r,!1),e.addEventListener(t,r,!1)):"mouseenter"===t||"mouseleave"===t?(o=r,a="mouseenter"===t?"mouseover":"mouseout",r=function(t){if(d.DomEvent._checkMouse(e,t))return o(t)},e.addEventListener(a,r,!1)):"click"===t&&d.Browser.android?(o=r,r=function(e){return d.DomEvent._filterClick(e,o)},e.addEventListener(t,r,!1)):e.addEventListener(t,r,!1):"attachEvent"in e&&e.attachEvent("on"+t,r),e[l]=r,this))},removeListener:function(e,t,n){var i=d.stamp(n),r="_leaflet_"+t+i,o=e[r];return o?(d.Browser.pointer&&0===t.indexOf("touch")?this.removePointerListener(e,t,i):d.Browser.touch&&"dblclick"===t&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,i):"removeEventListener"in e?"mousewheel"===t?(e.removeEventListener("DOMMouseScroll",o,!1),e.removeEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?e.removeEventListener("mouseenter"===t?"mouseover":"mouseout",o,!1):e.removeEventListener(t,o,!1):"detachEvent"in e&&e.detachEvent("on"+t,o),e[r]=null,this):this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,d.DomEvent._skipped(e),this},disableScrollPropagation:function(e){var t=d.DomEvent.stopPropagation;return d.DomEvent.on(e,"mousewheel",t).on(e,"MozMousePixelScroll",t)},disableClickPropagation:function(e){for(var t=d.DomEvent.stopPropagation,n=d.Draggable.START.length-1;n>=0;n--)d.DomEvent.on(e,d.Draggable.START[n],t);return d.DomEvent.on(e,"click",d.DomEvent._fakeStop).on(e,"dblclick",t)},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return d.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,t){if(!t)return new d.Point(e.clientX,e.clientY);var n=t.getBoundingClientRect();return new d.Point(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop)},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_skipEvents:{},_fakeStop:function(e){d.DomEvent._skipEvents[e.type]=!0},_skipped:function(e){var t=this._skipEvents[e.type];return this._skipEvents[e.type]=!1,t},_checkMouse:function(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(e){return!1}return n!==e},_getEvent:function(){var e=o.event;if(!e)for(var t=arguments.callee.caller;t&&(!(e=t.arguments[0])||o.Event!==e.constructor);)t=t.caller;return e},_filterClick:function(e,t){var n=e.timeStamp||e.originalEvent.timeStamp,i=d.DomEvent._lastClick&&n-d.DomEvent._lastClick;if(!(i&&i>100&&i<500||e.target._simulatedClick&&!e._simulated))return d.DomEvent._lastClick=n,t(e);d.DomEvent.stop(e)}},d.DomEvent.on=d.DomEvent.addListener,d.DomEvent.off=d.DomEvent.removeListener,d.Draggable=d.Class.extend({includes:d.Mixin.Events,statics:{START:d.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(e,t){this._element=e,this._dragStartTarget=t||e},enable:function(){if(!this._enabled){for(var e=d.Draggable.START.length-1;e>=0;e--)d.DomEvent.on(this._dragStartTarget,d.Draggable.START[e],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var e=d.Draggable.START.length-1;e>=0;e--)d.DomEvent.off(this._dragStartTarget,d.Draggable.START[e],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(e){if(this._moved=!1,!e.shiftKey&&(1===e.which||1===e.button||e.touches)&&(d.DomEvent.stopPropagation(e),!d.Draggable._disabled&&(d.DomUtil.disableImageDrag(),d.DomUtil.disableTextSelection(),!this._moving))){var t=e.touches?e.touches[0]:e;this._startPoint=new d.Point(t.clientX,t.clientY),this._startPos=this._newPos=d.DomUtil.getPosition(this._element),d.DomEvent.on(a,d.Draggable.MOVE[e.type],this._onMove,this).on(a,d.Draggable.END[e.type],this._onUp,this)}},_onMove:function(e){if(e.touches&&e.touches.length>1)this._moved=!0;else{var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new d.Point(t.clientX,t.clientY).subtract(this._startPoint);(n.x||n.y)&&(d.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3||(d.DomEvent.preventDefault(e),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=d.DomUtil.getPosition(this._element).subtract(n),d.DomUtil.addClass(a.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,d.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,d.Util.cancelAnimFrame(this._animRequest),this._animRequest=d.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))}},_updatePosition:function(){this.fire("predrag"),d.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){for(var e in d.DomUtil.removeClass(a.body,"leaflet-dragging"),this._lastTarget&&(d.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),d.Draggable.MOVE)d.DomEvent.off(a,d.Draggable.MOVE[e],this._onMove).off(a,d.Draggable.END[e],this._onUp);d.DomUtil.enableImageDrag(),d.DomUtil.enableTextSelection(),this._moved&&this._moving&&(d.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),d.Handler=d.Class.extend({initialize:function(e){this._map=e},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),d.Map.mergeOptions({dragging:!0,inertia:!d.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:d.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),d.Map.Drag=d.Handler.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new d.Draggable(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),e.on("viewreset",this._onViewReset,this),e.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var e=this._map;e._panAnim&&e._panAnim.stop(),e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var e=this._lastTime=+new Date,t=this._lastPos=this._draggable._newPos;this._positions.push(t),this._times.push(e),e-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize()._divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,r=(i-t+n)%e+t-n,o=(i+t+n)%e-t-n,a=Math.abs(r+n)<Math.abs(o+n)?r:o;this._draggable._newPos.x=a},_onDragEnd:function(e){var t=this._map,n=t.options,i=+new Date-this._lastTime,r=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(t.fire("dragend",e),r)t.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+i-this._times[0])/1e3,s=n.easeLinearity,l=o.multiplyBy(s/a),c=l.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,c),h=l.multiplyBy(u/c),p=u/(n.inertiaDeceleration*s),f=h.multiplyBy(-p/2).round();f.x&&f.y?(f=t._limitOffset(f,t.options.maxBounds),d.Util.requestAnimFrame((function(){t.panBy(f,{duration:p,easeLinearity:s,noMoveStart:!0})}))):t.fire("moveend")}}}),d.Map.addInitHook("addHandler","dragging",d.Map.Drag),d.Map.mergeOptions({doubleClickZoom:!0}),d.Map.DoubleClickZoom=d.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom()+(e.originalEvent.shiftKey?-1:1);"center"===t.options.doubleClickZoom?t.setZoom(n):t.setZoomAround(e.containerPoint,n)}}),d.Map.addInitHook("addHandler","doubleClickZoom",d.Map.DoubleClickZoom),d.Map.mergeOptions({scrollWheelZoom:!0}),d.Map.ScrollWheelZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),d.DomEvent.on(this._map._container,"MozMousePixelScroll",d.DomEvent.preventDefault),this._delta=0},removeHooks:function(){d.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),d.DomEvent.off(this._map._container,"MozMousePixelScroll",d.DomEvent.preventDefault)},_onWheelScroll:function(e){var t=d.DomEvent.getWheelDelta(e);this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(d.bind(this._performZoom,this),n),d.DomEvent.preventDefault(e),d.DomEvent.stopPropagation(e)},_performZoom:function(){var e=this._map,t=this._delta,n=e.getZoom();t=t>0?Math.ceil(t):Math.floor(t),t=Math.max(Math.min(t,4),-4),t=e._limitZoom(n+t)-n,this._delta=0,this._startTime=null,t&&("center"===e.options.scrollWheelZoom?e.setZoom(n+t):e.setZoomAround(this._lastMousePos,n+t))}}),d.Map.addInitHook("addHandler","scrollWheelZoom",d.Map.ScrollWheelZoom),d.extend(d.DomEvent,{_touchstart:d.Browser.msPointer?"MSPointerDown":d.Browser.pointer?"pointerdown":"touchstart",_touchend:d.Browser.msPointer?"MSPointerUp":d.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(e,t,n){var i,r,o=!1,s=this._touchstart,l=this._touchend,c=[];function u(e){var t;if(d.Browser.pointer?(c.push(e.pointerId),t=c.length):t=e.touches.length,!(t>1)){var n=Date.now(),a=n-(i||n);r=e.touches?e.touches[0]:e,o=a>0&&a<=250,i=n}}function h(e){if(d.Browser.pointer){var n=c.indexOf(e.pointerId);if(-1===n)return;c.splice(n,1)}if(o){if(d.Browser.pointer){var a,s={};for(var l in r)a=r[l],s[l]="function"==typeof a?a.bind(r):a;r=s}r.type="dblclick",t(r),i=null}}e["_leaflet_"+s+n]=u,e["_leaflet_"+l+n]=h;var p=d.Browser.pointer?a.documentElement:e;return e.addEventListener(s,u,!1),p.addEventListener(l,h,!1),d.Browser.pointer&&p.addEventListener(d.DomEvent.POINTER_CANCEL,h,!1),this},removeDoubleTapListener:function(e,t){var n="_leaflet_";return e.removeEventListener(this._touchstart,e[n+this._touchstart+t],!1),(d.Browser.pointer?a.documentElement:e).removeEventListener(this._touchend,e[n+this._touchend+t],!1),d.Browser.pointer&&a.documentElement.removeEventListener(d.DomEvent.POINTER_CANCEL,e[n+this._touchend+t],!1),this}}),d.extend(d.DomEvent,{POINTER_DOWN:d.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:d.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:d.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:d.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(e,t,n,i){switch(t){case"touchstart":return this.addPointerListenerStart(e,t,n,i);case"touchend":return this.addPointerListenerEnd(e,t,n,i);case"touchmove":return this.addPointerListenerMove(e,t,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(e,t,n,i){var r=this._pointers,o=function(e){"mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE&&d.DomEvent.preventDefault(e);for(var t=!1,i=0;i<r.length;i++)if(r[i].pointerId===e.pointerId){t=!0;break}t||r.push(e),e.touches=r.slice(),e.changedTouches=[e],n(e)};if(e["_leaflet_touchstart"+i]=o,e.addEventListener(this.POINTER_DOWN,o,!1),!this._pointerDocumentListener){var s=function(e){for(var t=0;t<r.length;t++)if(r[t].pointerId===e.pointerId){r.splice(t,1);break}};a.documentElement.addEventListener(this.POINTER_UP,s,!1),a.documentElement.addEventListener(this.POINTER_CANCEL,s,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(e,t,n,i){var r=this._pointers;function o(e){if(e.pointerType!==e.MSPOINTER_TYPE_MOUSE&&"mouse"!==e.pointerType||0!==e.buttons){for(var t=0;t<r.length;t++)if(r[t].pointerId===e.pointerId){r[t]=e;break}e.touches=r.slice(),e.changedTouches=[e],n(e)}}return e["_leaflet_touchmove"+i]=o,e.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(e,t,n,i){var r=this._pointers,o=function(e){for(var t=0;t<r.length;t++)if(r[t].pointerId===e.pointerId){r.splice(t,1);break}e.touches=r.slice(),e.changedTouches=[e],n(e)};return e["_leaflet_touchend"+i]=o,e.addEventListener(this.POINTER_UP,o,!1),e.addEventListener(this.POINTER_CANCEL,o,!1),this},removePointerListener:function(e,t,n){var i=e["_leaflet_"+t+n];switch(t){case"touchstart":e.removeEventListener(this.POINTER_DOWN,i,!1);break;case"touchmove":e.removeEventListener(this.POINTER_MOVE,i,!1);break;case"touchend":e.removeEventListener(this.POINTER_UP,i,!1),e.removeEventListener(this.POINTER_CANCEL,i,!1)}return this}}),d.Map.mergeOptions({touchZoom:d.Browser.touch&&!d.Browser.android23,bounceAtZoomLimits:!0}),d.Map.TouchZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToLayerPoint(e.touches[0]),i=t.mouseEventToLayerPoint(e.touches[1]),r=t._getCenterLayerPoint();this._startCenter=n.add(i)._divideBy(2),this._startDist=n.distanceTo(i),this._moved=!1,this._zooming=!0,this._centerOffset=r.subtract(this._startCenter),t._panAnim&&t._panAnim.stop(),d.DomEvent.on(a,"touchmove",this._onTouchMove,this).on(a,"touchend",this._onTouchEnd,this),d.DomEvent.preventDefault(e)}},_onTouchMove:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&this._zooming){var n=t.mouseEventToLayerPoint(e.touches[0]),i=t.mouseEventToLayerPoint(e.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(!t.options.bounceAtZoomLimits&&(t.getZoom()===t.getMinZoom()&&this._scale<1||t.getZoom()===t.getMaxZoom()&&this._scale>1)||(this._moved||(d.DomUtil.addClass(t._mapPane,"leaflet-touching"),t.fire("movestart").fire("zoomstart"),this._moved=!0),d.Util.cancelAnimFrame(this._animRequest),this._animRequest=d.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),d.DomEvent.preventDefault(e)))}},_updateOnMove:function(){var e=this._map,t=this._getScaleOrigin(),n=e.layerPointToLatLng(t),i=e.getScaleZoom(this._scale);e._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(this._moved&&this._zooming){var e=this._map;this._zooming=!1,d.DomUtil.removeClass(e._mapPane,"leaflet-touching"),d.Util.cancelAnimFrame(this._animRequest),d.DomEvent.off(a,"touchmove",this._onTouchMove).off(a,"touchend",this._onTouchEnd);var t=this._getScaleOrigin(),n=e.layerPointToLatLng(t),i=e.getZoom(),r=e.getScaleZoom(this._scale)-i,o=r>0?Math.ceil(r):Math.floor(r),s=e._limitZoom(i+o),l=e.getZoomScale(s)/this._scale;e._animateZoom(n,s,t,l)}else this._zooming=!1},_getScaleOrigin:function(){var e=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(e)}}),d.Map.addInitHook("addHandler","touchZoom",d.Map.TouchZoom),d.Map.mergeOptions({tap:!0,tapTolerance:15}),d.Map.Tap=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(e.touches){if(d.DomEvent.preventDefault(e),this._fireClick=!0,e.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var t=e.touches[0],n=t.target;this._startPos=this._newPos=new d.Point(t.clientX,t.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&d.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(d.bind((function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",t))}),this),1e3),d.DomEvent.on(a,"touchmove",this._onMove,this).on(a,"touchend",this._onUp,this)}},_onUp:function(e){if(clearTimeout(this._holdTimeout),d.DomEvent.off(a,"touchmove",this._onMove,this).off(a,"touchend",this._onUp,this),this._fireClick&&e&&e.changedTouches){var t=e.changedTouches[0],n=t.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&d.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",t)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var t=e.touches[0];this._newPos=new d.Point(t.clientX,t.clientY)},_simulateEvent:function(e,t){var n=a.createEvent("MouseEvents");n._simulated=!0,t.target._simulatedClick=!0,n.initMouseEvent(e,!0,!0,o,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)}}),d.Browser.touch&&!d.Browser.pointer&&d.Map.addInitHook("addHandler","tap",d.Map.Tap),d.Map.mergeOptions({boxZoom:!0}),d.Map.BoxZoom=d.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._moved=!1},addHooks:function(){d.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){d.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(e){if(this._moved=!1,!e.shiftKey||1!==e.which&&1!==e.button)return!1;d.DomUtil.disableTextSelection(),d.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),d.DomEvent.on(a,"mousemove",this._onMouseMove,this).on(a,"mouseup",this._onMouseUp,this).on(a,"keydown",this._onKeyDown,this)},_onMouseMove:function(e){this._moved||(this._box=d.DomUtil.create("div","leaflet-zoom-box",this._pane),d.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var t=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(e),r=i.subtract(t),o=new d.Point(Math.min(i.x,t.x),Math.min(i.y,t.y));d.DomUtil.setPosition(n,o),this._moved=!0,n.style.width=Math.max(0,Math.abs(r.x)-4)+"px",n.style.height=Math.max(0,Math.abs(r.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),d.DomUtil.enableTextSelection(),d.DomUtil.enableImageDrag(),d.DomEvent.off(a,"mousemove",this._onMouseMove).off(a,"mouseup",this._onMouseUp).off(a,"keydown",this._onKeyDown)},_onMouseUp:function(e){this._finish();var t=this._map,n=t.mouseEventToLayerPoint(e);if(!this._startLayerPoint.equals(n)){var i=new d.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint),t.layerPointToLatLng(n));t.fitBounds(i),t.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(e){27===e.keyCode&&this._finish()}}),d.Map.addInitHook("addHandler","boxZoom",d.Map.BoxZoom),d.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),d.Map.Keyboard=d.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(e){this._map=e,this._setPanOffset(e.options.keyboardPanOffset),this._setZoomOffset(e.options.keyboardZoomOffset)},addHooks:function(){var e=this._map._container;-1===e.tabIndex&&(e.tabIndex="0"),d.DomEvent.on(e,"focus",this._onFocus,this).on(e,"blur",this._onBlur,this).on(e,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var e=this._map._container;d.DomEvent.off(e,"focus",this._onFocus,this).off(e,"blur",this._onBlur,this).off(e,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var e=a.body,t=a.documentElement,n=e.scrollTop||t.scrollTop,i=e.scrollLeft||t.scrollLeft;this._map._container.focus(),o.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(e){var t,n,i=this._panKeys={},r=this.keyCodes;for(t=0,n=r.left.length;t<n;t++)i[r.left[t]]=[-1*e,0];for(t=0,n=r.right.length;t<n;t++)i[r.right[t]]=[e,0];for(t=0,n=r.down.length;t<n;t++)i[r.down[t]]=[0,e];for(t=0,n=r.up.length;t<n;t++)i[r.up[t]]=[0,-1*e]},_setZoomOffset:function(e){var t,n,i=this._zoomKeys={},r=this.keyCodes;for(t=0,n=r.zoomIn.length;t<n;t++)i[r.zoomIn[t]]=e;for(t=0,n=r.zoomOut.length;t<n;t++)i[r.zoomOut[t]]=-e},_addHooks:function(){d.DomEvent.on(a,"keydown",this._onKeyDown,this)},_removeHooks:function(){d.DomEvent.off(a,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){var t=e.keyCode,n=this._map;if(t in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[t]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(t in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[t])}d.DomEvent.stop(e)}}),d.Map.addInitHook("addHandler","keyboard",d.Map.Keyboard),d.Handler.MarkerDrag=d.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new d.Draggable(e,e)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),d.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),d.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var e=this._marker,t=e._shadow,n=d.DomUtil.getPosition(e._icon),i=e._map.layerPointToLatLng(n);t&&d.DomUtil.setPosition(t,n),e._latlng=i,e.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(e){this._marker.fire("moveend").fire("dragend",e)}}),d.Control=d.Class.extend({options:{position:"topright"},initialize:function(e){d.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),i=e._controlCorners[n];return d.DomUtil.addClass(t,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(t,i.firstChild):i.appendChild(t),this},removeFrom:function(e){var t=this.getPosition();return e._controlCorners[t].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(e),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),d.control=function(e){return new d.Control(e)},d.Map.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.removeFrom(this),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=d.DomUtil.create("div",t+"control-container",this._container);function i(i,r){var o=t+i+" "+t+r;e[i+r]=d.DomUtil.create("div",o,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),d.Control.Zoom=d.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=d.DomUtil.create("div",t+" leaflet-bar");return this._map=e,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,t+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,t+"-out",n,this._zoomOut,this),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(e){this._map.zoomIn(e.shiftKey?3:1)},_zoomOut:function(e){this._map.zoomOut(e.shiftKey?3:1)},_createButton:function(e,t,n,i,r,o){var a=d.DomUtil.create("a",n,i);a.innerHTML=e,a.href="#",a.title=t;var s=d.DomEvent.stopPropagation;return d.DomEvent.on(a,"click",s).on(a,"mousedown",s).on(a,"dblclick",s).on(a,"click",d.DomEvent.preventDefault).on(a,"click",r,o).on(a,"click",this._refocusOnMap,o),a},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";d.DomUtil.removeClass(this._zoomInButton,t),d.DomUtil.removeClass(this._zoomOutButton,t),e._zoom===e.getMinZoom()&&d.DomUtil.addClass(this._zoomOutButton,t),e._zoom===e.getMaxZoom()&&d.DomUtil.addClass(this._zoomInButton,t)}}),d.Map.mergeOptions({zoomControl:!0}),d.Map.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new d.Control.Zoom,this.addControl(this.zoomControl))})),d.control.zoom=function(e){return new d.Control.Zoom(e)},d.Control.Attribution=d.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(e){d.setOptions(this,e),this._attributions={}},onAdd:function(e){for(var t in this._container=d.DomUtil.create("div","leaflet-control-attribution"),d.DomEvent.disableClickPropagation(this._container),e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return e.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(e){e.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){if(e)return this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this},removeAttribution:function(e){if(e)return this._attributions[e]&&(this._attributions[e]--,this._update()),this},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(e){e.layer.getAttribution&&this.addAttribution(e.layer.getAttribution())},_onLayerRemove:function(e){e.layer.getAttribution&&this.removeAttribution(e.layer.getAttribution())}}),d.Map.mergeOptions({attributionControl:!0}),d.Map.addInitHook((function(){this.options.attributionControl&&(this.attributionControl=(new d.Control.Attribution).addTo(this))})),d.control.attribution=function(e){return new d.Control.Attribution(e)},d.Control.Scale=d.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(e){this._map=e;var t=d.DomUtil.create("div","leaflet-control-scale"),n=this.options;return this._addScales(n,"leaflet-control-scale",t),e.on(n.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),t},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=d.DomUtil.create("div",t+"-line",n)),e.imperial&&(this._iScale=d.DomUtil.create("div",t+"-line",n))},_update:function(){var e=this._map.getBounds(),t=e.getCenter().lat,n=6378137*Math.PI*Math.cos(t*Math.PI/180)*(e.getNorthEast().lng-e.getSouthWest().lng)/180,i=this._map.getSize(),r=this.options,o=0;i.x>0&&(o=n*(r.maxWidth/i.x)),this._updateScales(r,o)},_updateScales:function(e,t){e.metric&&t&&this._updateMetric(t),e.imperial&&t&&this._updateImperial(t)},_updateMetric:function(e){var t=this._getRoundNum(e);this._mScale.style.width=this._getScaleWidth(t/e)+"px",this._mScale.innerHTML=t<1e3?t+" m":t/1e3+" km"},_updateImperial:function(e){var t,n,i,r=3.2808399*e,o=this._iScale;r>5280?(t=r/5280,n=this._getRoundNum(t),o.style.width=this._getScaleWidth(n/t)+"px",o.innerHTML=n+" mi"):(i=this._getRoundNum(r),o.style.width=this._getScaleWidth(i/r)+"px",o.innerHTML=i+" ft")},_getScaleWidth:function(e){return Math.round(this.options.maxWidth*e)-10},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),d.control.scale=function(e){return new d.Control.Scale(e)},d.Control.Layers=d.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(e,t,n){for(var i in d.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1,e)this._addLayer(e[i],i);for(i in t)this._addLayer(t[i],i,!0)},onAdd:function(e){return this._initLayout(),this._update(),e.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(e){e.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update(),this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update(),this},removeLayer:function(e){var t=d.stamp(e);return delete this._layers[t],this._update(),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=d.DomUtil.create("div",e);t.setAttribute("aria-haspopup",!0),d.Browser.touch?d.DomEvent.on(t,"click",d.DomEvent.stopPropagation):d.DomEvent.disableClickPropagation(t).disableScrollPropagation(t);var n=this._form=d.DomUtil.create("form",e+"-list");if(this.options.collapsed){d.Browser.android||d.DomEvent.on(t,"mouseover",this._expand,this).on(t,"mouseout",this._collapse,this);var i=this._layersLink=d.DomUtil.create("a",e+"-toggle",t);i.href="#",i.title="Layers",d.Browser.touch?d.DomEvent.on(i,"click",d.DomEvent.stop).on(i,"click",this._expand,this):d.DomEvent.on(i,"focus",this._expand,this),d.DomEvent.on(n,"click",(function(){setTimeout(d.bind(this._onInputClick,this),0)}),this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=d.DomUtil.create("div",e+"-base",n),this._separator=d.DomUtil.create("div",e+"-separator",n),this._overlaysList=d.DomUtil.create("div",e+"-overlays",n),t.appendChild(n)},_addLayer:function(e,t,n){var i=d.stamp(e);this._layers[i]={layer:e,name:t,overlay:n},this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e,t,n=!1,i=!1;for(e in this._layers)t=this._layers[e],this._addItem(t),i=i||t.overlay,n=n||!t.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(e){var t=this._layers[d.stamp(e.layer)];if(t){this._handlingClick||this._update();var n=t.overlay?"layeradd"===e.type?"overlayadd":"overlayremove":"layeradd"===e.type?"baselayerchange":null;n&&this._map.fire(n,t)}},_createRadioElement:function(e,t){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"';t&&(n+=' checked="checked"'),n+="/>";var i=a.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(e){var t,n=a.createElement("label"),i=this._map.hasLayer(e.layer);e.overlay?((t=a.createElement("input")).type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=i):t=this._createRadioElement("leaflet-base-layers",i),t.layerId=d.stamp(e.layer),d.DomEvent.on(t,"click",this._onInputClick,this);var r=a.createElement("span");return r.innerHTML=" "+e.name,n.appendChild(t),n.appendChild(r),(e.overlay?this._overlaysList:this._baseLayersList).appendChild(n),n},_onInputClick:function(){var e,t,n,i=this._form.getElementsByTagName("input"),r=i.length;for(this._handlingClick=!0,e=0;e<r;e++)t=i[e],n=this._layers[t.layerId],t.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!t.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){d.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),d.control.layers=function(e,t,n){return new d.Control.Layers(e,t,n)},d.PosAnimation=d.Class.extend({includes:d.Mixin.Events,run:function(e,t,n,i){this.stop(),this._el=e,this._inProgress=!0,this._newPos=t,this.fire("start"),e.style[d.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",d.DomEvent.on(e,d.DomUtil.TRANSITION_END,this._onTransitionEnd,this),d.DomUtil.setPosition(e,t),d.Util.falseFn(e.offsetWidth),this._stepTimer=setInterval(d.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(d.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),d.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var e=this._getPos();e?(this._el._leaflet_pos=e,this.fire("step")):this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,t,n,i=this._el,r=o.getComputedStyle(i);if(d.Browser.any3d){if(!(n=r[d.DomUtil.TRANSFORM].match(this._transformRe)))return;e=parseFloat(n[1]),t=parseFloat(n[2])}else e=parseFloat(r.left),t=parseFloat(r.top);return new d.Point(e,t,!0)},_onTransitionEnd:function(){d.DomEvent.off(this._el,d.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[d.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),d.Map.include({setView:function(e,t,n){if((t=void 0===t?this._zoom:this._limitZoom(t),e=this._limitCenter(d.latLng(e),t,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&!0!==n)&&(void 0!==n.animate&&(n.zoom=d.extend({animate:n.animate},n.zoom),n.pan=d.extend({animate:n.animate},n.pan)),this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,n.zoom):this._tryAnimatedPan(e,n.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(e,t),this},panBy:function(e,t){if(t=t||{},!(e=d.point(e).round()).x&&!e.y)return this;if(this._panAnim||(this._panAnim=new d.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),!1!==t.animate){d.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e);this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){d.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._floor();return!(!0!==(t&&t.animate)&&!this.getSize().contains(n))&&(this.panBy(n,t),!0)}}),d.PosAnimation=d.DomUtil.TRANSITION?d.PosAnimation:d.PosAnimation.extend({run:function(e,t,n,i){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=d.DomUtil.getPosition(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=d.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var e=+new Date-this._startTime,t=1e3*this._duration;e<t?this._runFrame(this._easeOut(e/t)):(this._runFrame(1),this._complete())},_runFrame:function(e){var t=this._startPos.add(this._offset.multiplyBy(e));d.DomUtil.setPosition(this._el,t),this.fire("step")},_complete:function(){d.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),d.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),d.DomUtil.TRANSITION&&d.Map.addInitHook((function(){this._zoomAnimated=this.options.zoomAnimation&&d.DomUtil.TRANSITION&&d.Browser.any3d&&!d.Browser.android23&&!d.Browser.mobileOpera,this._zoomAnimated&&d.DomEvent.on(this._mapPane,d.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)})),d.Map.include(d.DomUtil.TRANSITION?{_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(t),r=this._getCenterOffset(e)._divideBy(1-1/i),o=this._getCenterLayerPoint()._add(r);return!(!0!==n.animate&&!this.getSize().contains(r))&&(this.fire("movestart").fire("zoomstart"),this._animateZoom(e,t,o,i,null,!0),!0)},_animateZoom:function(e,t,n,i,r,o,a){a||(this._animatingZoom=!0),d.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=e,this._animateToZoom=t,d.Draggable&&(d.Draggable._disabled=!0),d.Util.requestAnimFrame((function(){this.fire("zoomanim",{center:e,zoom:t,origin:n,scale:i,delta:r,backwards:o}),setTimeout(d.bind(this._onZoomTransitionEnd,this),250)}),this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,d.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),d.Util.requestAnimFrame((function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),d.Draggable&&(d.Draggable._disabled=!1)}),this))}}:{}),d.TileLayer.include({_animateZoom:function(e){this._animating||(this._animating=!0,this._prepareBgBuffer());var t=this._bgBuffer,n=d.DomUtil.TRANSFORM,i=e.delta?d.DomUtil.getTranslateString(e.delta):t.style[n],r=d.DomUtil.getScaleString(e.scale,e.origin);t.style[n]=e.backwards?r+" "+i:i+" "+r},_endZoomAnim:function(){var e=this._tileContainer,t=this._bgBuffer;e.style.visibility="",e.parentNode.appendChild(e),d.Util.falseFn(t.offsetWidth);var n=this._map.getZoom();(n>this.options.maxZoom||n<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var e=this._map;!e||e._animatingZoom||e.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[d.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var e=this._tileContainer,t=this._bgBuffer,n=this._getLoadedTilesPercentage(t),i=this._getLoadedTilesPercentage(e);if(t&&n>.5&&i<.5)return e.style.visibility="hidden",void this._stopLoadingImages(e);t.style.visibility="hidden",t.style[d.DomUtil.TRANSFORM]="",this._tileContainer=t,t=this._bgBuffer=e,this._stopLoadingImages(t),clearTimeout(this._clearBgBufferTimer)},_getLoadedTilesPercentage:function(e){var t,n,i=e.getElementsByTagName("img"),r=0;for(t=0,n=i.length;t<n;t++)i[t].complete&&r++;return r/n},_stopLoadingImages:function(e){var t,n,i,r=Array.prototype.slice.call(e.getElementsByTagName("img"));for(t=0,n=r.length;t<n;t++)(i=r[t]).complete||(i.onload=d.Util.falseFn,i.onerror=d.Util.falseFn,i.src=d.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),d.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(e){if(e=this._locateOptions=d.extend(this._defaultLocateOptions,e),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=d.bind(this._handleGeolocationResponse,this),n=d.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,n,e):navigator.geolocation.getCurrentPosition(t,n,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){var t=e.code,n=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(e){var t=e.coords.latitude,n=e.coords.longitude,i=new d.LatLng(t,n),r=180*e.coords.accuracy/40075017,o=r/Math.cos(d.LatLng.DEG_TO_RAD*t),a=d.latLngBounds([t-r,n-o],[t+r,n+o]),s=this._locateOptions;if(s.setView){var l=Math.min(this.getBoundsZoom(a),s.maxZoom);this.setView(i,l)}var c={latlng:i,bounds:a,timestamp:e.timestamp};for(var u in e.coords)"number"==typeof e.coords[u]&&(c[u]=e.coords[u]);this.fire("locationfound",c)}})}(window,document)},function(e,t,n){},function(module,exports){
/*!
*  ui-leaflet 1.0.3 2017-01-26
*  ui-leaflet - An AngularJS directive to easily interact with Leaflet maps
*  git: https://github.com/angular-ui/ui-leaflet
*/
!function(angular){"use strict";angular.module("ui-leaflet",["nemLogging"]).directive("leaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletMapEvents",function(e,t,n,i,r){return{restrict:"EA",replace:!0,scope:{center:"=",lfCenter:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"=",markersWatchOptions:"=",geojsonWatchOptions:"="},transclude:!0,template:'<div class="angular-leaflet-map"><div ng-transclude></div></div>',controller:["$scope",function(t){this._leafletMap=e.defer(),this.getMap=function(){return this._leafletMap.promise},this.getLeafletScope=function(){return t}}],link:function(e,o,a,s){var l=i.isDefined,c=n.setDefaults(e.defaults,a.id),u=r.getAvailableMapEvents(),d=r.addEvents;function h(){isNaN(a.width)?o.css("width",a.width):o.css("width",a.width+"px")}function p(){isNaN(a.height)?o.css("height",a.height):o.css("height",a.height+"px")}e.mapId=a.id,t.setDirectiveControls({},a.id),l(a.width)&&(h(),e.$watch((function(){return o[0].getAttribute("width")}),(function(){h(),f.invalidateSize()}))),l(a.height)&&(p(),e.$watch((function(){return o[0].getAttribute("height")}),(function(){p(),f.invalidateSize()})));var f=new L.Map(o[0],n.getMapCreationDefaults(a.id));if(s._leafletMap.resolve(f),l(a.center)||l(a.lfCenter)||f.setView([c.center.lat,c.center.lng],c.center.zoom),!l(a.tiles)&&!l(a.layers)){var g=L.tileLayer(c.tileLayer,c.tileLayerOptions);g.addTo(f),t.setTiles(g,a.id)}if(l(f.zoomControl)&&l(c.zoomControlPosition)&&f.zoomControl.setPosition(c.zoomControlPosition),l(f.zoomControl)&&!1===c.zoomControl&&f.zoomControl.removeFrom(f),l(f.zoomsliderControl)&&l(c.zoomsliderControl)&&!1===c.zoomsliderControl&&f.zoomsliderControl.removeFrom(f),!l(a.eventBroadcast)){d(f,u,"eventName",e,"broadcast")}f.whenReady((function(){t.setMap(f,a.id)})),e.$on("$destroy",(function(){n.reset(),f.remove(),t.unresolveMap(a.id)})),e.$on("invalidateSize",(function(){f.invalidateSize()}))}}}]),angular.module("ui-leaflet").factory("leafletBoundsHelpers",["leafletLogger","leafletHelpers",function(e,t){var n=t.isArray,i=t.isNumber,r=t.isFunction,o=t.isDefined,a=e;function s(e){return angular.isDefined(e)&&angular.isDefined(e.southWest)&&angular.isDefined(e.northEast)&&angular.isNumber(e.southWest.lat)&&angular.isNumber(e.southWest.lng)&&angular.isNumber(e.northEast.lat)&&angular.isNumber(e.northEast.lng)}return{createLeafletBounds:function(e){if(s(e))return L.latLngBounds([e.southWest.lat,e.southWest.lng],[e.northEast.lat,e.northEast.lng])},isValidBounds:s,createBoundsFromArray:function(e){if(n(e)&&2===e.length&&n(e[0])&&n(e[1])&&2===e[0].length&&2===e[1].length&&i(e[0][0])&&i(e[0][1])&&i(e[1][0])&&i(e[1][1]))return{northEast:{lat:e[0][0],lng:e[0][1]},southWest:{lat:e[1][0],lng:e[1][1]}};a.error("[AngularJS - Leaflet] The bounds array is not valid.")},createBoundsFromLeaflet:function(e){if(o(e)&&r(e.getNorthEast)&&r(e.getSouthWest)){var t=e.getNorthEast(),n=e.getSouthWest();return{northEast:{lat:t.lat,lng:t.lng},southWest:{lat:n.lat,lng:n.lng}}}a.error("[AngularJS - Leaflet] The leaflet bounds is not valid object.")}}}]),angular.module("ui-leaflet").factory("leafletControlHelpers",["$rootScope","leafletLogger","leafletHelpers","leafletLayerHelpers","leafletMapDefaults",function(e,t,n,i,r){var o=n.isDefined,a=n.isObject,s=n.get,l=i.createLayer,c={},u=n.errorHeader+" [Controls] ",d=t,h=function(e,t,n){var i=r.getDefaults(n);if(!s(i,"controls.layers.visible"))return!1;var l=!1;return a(e)&&Object.keys(e).forEach((function(t){var n=e[t];o(n.layerOptions)&&!1===n.layerOptions.showOnSelector||(l=!0)})),a(t)&&Object.keys(t).forEach((function(e){var n=t[e];o(n.layerParams)&&!1===n.layerParams.showOnSelector||(l=!0)})),l},p={draw:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Draw)||(d.error(u+" Draw plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Draw(e)}},scale:{isPluginLoaded:function(){return!0},checkValidParams:function(){return!0},createControl:function(e){return new L.control.scale(e)}},fullscreen:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Fullscreen)||(d.error(u+" Fullscreen plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Fullscreen(e)}},search:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Search)||(d.error(u+" Search plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Search(e)}},custom:{},minimap:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.MiniMap)||(d.error(u+" Minimap plugin is not loaded."),!1)},checkValidParams:function(e){return!!o(e.layer)||(d.warn(u+' minimap "layer" option should be defined.'),!1)},createControl:function(e){var t=l(e.layer);if(o(t))return new L.Control.MiniMap(t,e);d.warn(u+' minimap control "layer" could not be created.')}}};return{layersControlMustBeVisible:h,isValidControlType:function(e){return-1!==Object.keys(p).indexOf(e)},createControl:function(e,t){if(p[e].checkValidParams(t))return p[e].createControl(t)},updateLayersControl:function(e,t,n,i,a,l){var u,d=c[t],p=h(i,a,t);if(o(d)&&n){for(u in l.baselayers)d.removeLayer(l.baselayers[u]);for(u in l.overlays)d.removeLayer(l.overlays[u]);e.removeControl(d),delete c[t]}if(p){for(u in d=function(e){var t=r.getDefaults(e),n={collapsed:t.controls.layers.collapsed,position:t.controls.layers.position,autoZIndex:!1};return angular.extend(n,t.controls.layers.options),s(t,"controls.layers.control")?t.controls.layers.control.apply(this,[[],[],n]):new L.control.layers([],[],n)}(t),c[t]=d,i){!(o(i[u].layerOptions)&&!1===i[u].layerOptions.showOnSelector)&&o(l.baselayers[u])&&d.addBaseLayer(l.baselayers[u],i[u].name)}for(u in a){!(o(a[u].layerParams)&&!1===a[u].layerParams.showOnSelector)&&o(l.overlays[u])&&d.addOverlay(l.overlays[u],a[u].name)}e.addControl(d)}return p}}}]),angular.module("ui-leaflet").service("leafletData",["leafletLogger","$q","leafletHelpers",function(e,t,n){var i=n.getDefer,r=n.getUnresolvedDefer,o=n.setResolvedDefer,a={},s=this,l=["map","tiles","layers","paths","markers","geoJSON","UTFGrid","decorations","directiveControls"];l.forEach((function(e){a[e]={}})),this.unresolveMap=function(e){var t=n.obtainEffectiveMapId(a.map,e);l.forEach((function(e){a[e][t]=void 0}))},l.forEach((function(e){var t,n=(t=e).charAt(0).toUpperCase()+t.slice(1);s["set"+n]=function(t,n){r(a[e],n).resolve(t),o(a[e],n)},s["get"+n]=function(t){return i(a[e],t).promise}}))}]),angular.module("ui-leaflet").service("leafletDirectiveControlsHelpers",["leafletLogger","leafletData","leafletHelpers",function(e,t,n){var i=n.isDefined,r=n.isString,o=n.isObject,a=n.errorHeader,s=e,l=a+"[leafletDirectiveControlsHelpers";return{extend:function(e,n,a,c){var u=l+".extend] ",d={};if(i(n)){if(r(n)&&i(a)&&i(c))d[n]={create:a,clean:c};else{if(!o(n)||i(a)||i(c))return void s.error(u+"incorrect arguments");d=n}t.getDirectiveControls(e).then((function(n){angular.extend(n,d),t.setDirectiveControls(n,e)}))}else s.error(u+"thingToAddName cannot be undefined")}}}]),angular.module("ui-leaflet").service("leafletGeoJsonHelpers",["leafletHelpers","leafletIterators",function(e,t){var n=e,i=t,r=function(e,t){return this.lat=e,this.lng=t,this},o=function(e){if(n.isUndefined(e))return!1;if(n.isArray(e)){if(2===e.length&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0}else if(n.isDefined(e.type)&&"Point"===e.type&&n.isArray(e.coordinates)&&2===e.coordinates.length&&n.isNumber(e.coordinates[0])&&n.isNumber(e.coordinates[1]))return!0;return i.all(["lat","lng"],(function(t){return n.isDefined(e[t])&&n.isNumber(e[t])}))};return{getLat:function(e){return Array.isArray(e)&&2===e.length?e[1]:n.isDefined(e.type)&&"Point"===e.type?+e.coordinates[1]:+e.lat},getLng:function(e){return Array.isArray(e)&&2===e.length?e[0]:n.isDefined(e.type)&&"Point"===e.type?+e.coordinates[0]:+e.lng},validateCoords:o,getCoords:function(e){if(e&&o(e)){var t=null;if(Array.isArray(e)&&2===e.length)t=new r(e[1],e[0]);else{if(!n.isDefined(e.type)||"Point"!==e.type)return e;t=new r(e.coordinates[1],e.coordinates[0])}return angular.extend(e,t)}}}}]),angular.module("ui-leaflet").service("leafletHelpers",["$q","$log",function(e,t){var n=angular.copy,i=function(e,t){if(e){for(var n=e[(t=t.split(".")).shift()];n&&t.length;)n=n[t.shift()];return n}};function r(e,t){var n,i=Object.keys(e);if(angular.isDefined(t))n=t;else{if(0!==i.length&&(1!==i.length||"main"!==i[0]))throw new Error("[AngularJS - Leaflet] - You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call. Where one of the following mapIds "+Object.keys(e).join(",")+" are available.");n="main"}return n}function o(t,n){var i,o=r(t,n);return angular.isDefined(t[o])&&!0!==t[o].resolvedDefer?i=t[o].defer:(i=e.defer(),t[o]={defer:i,resolvedDefer:!1}),i}var a=function(e){return angular.isDefined(e)&&null!==e},s=/([\:\-\_]+(.))/g,l=/^moz([A-Z])/,c=/^((?:x|data)[\:\-_])/i,u=function(e){return e.replace(s,(function(e,t,n,i){return i?n.toUpperCase():n})).replace(l,"Moz$1")};return{camelCase:u,directiveNormalize:function(e){return u(e.replace(c,""))},copy:n,clone:n,errorHeader:"[AngularJS - Leaflet] ",getObjectValue:i,get:i,getObjectArrayPath:function(e){return e.split(".").reduce((function(e,t){return e+'["'+t+'"]'}))},getObjectDotPath:function(e){return e.reduce((function(e,t){return e+"."+t}))},defaultTo:function(e,t){return a(e)?e:t},isTruthy:function(e){return"true"===e||!0===e},isEmpty:function(e){return 0===Object.keys(e).length},isUndefinedOrEmpty:function(e){return angular.isUndefined(e)||null===e||0===Object.keys(e).length},isDefined:a,isUndefined:function(e){return!a(e)},isNumber:angular.isNumber,isString:angular.isString,isArray:angular.isArray,isObject:angular.isObject,isFunction:angular.isFunction,equals:angular.equals,isValidCenter:function(e){return angular.isDefined(e)&&angular.isNumber(e.lat)&&angular.isNumber(e.lng)&&angular.isNumber(e.zoom)},isValidPoint:function(e){return!!angular.isDefined(e)&&(angular.isArray(e)?2===e.length&&angular.isNumber(e[0])&&angular.isNumber(e[1]):angular.isNumber(e.lat)&&angular.isNumber(e.lng))},isSameCenterOnMap:function(e,t){var n=t.getCenter(),i=t.getZoom();return!(!e.lat||!e.lng||n.lat.toFixed(4)!==e.lat.toFixed(4)||n.lng.toFixed(4)!==e.lng.toFixed(4)||i!==e.zoom)},safeApply:function(e,t){var n=e.$root.$$phase;"$apply"===n||"$digest"===n?e.$eval(t):e.$evalAsync(t)},obtainEffectiveMapId:r,getDefer:function(e,t){var n=r(e,t);return angular.isDefined(e[n])&&!1!==e[n].resolvedDefer?e[n].defer:o(e,t)},getUnresolvedDefer:o,setResolvedDefer:function(e,t){e[r(e,t)].resolvedDefer=!0},rangeIsSupported:function(){var e=document.createElement("input");return e.setAttribute("type","range"),"range"===e.type},FullScreenControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.Fullscreen)}},MiniMapControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.MiniMap)}},AwesomeMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.AwesomeMarkers)&&angular.isDefined(L.AwesomeMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.AwesomeMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},VectorMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.VectorMarkers)&&angular.isDefined(L.VectorMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.VectorMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},DomMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.DomMarkers)||!angular.isDefined(L.DomMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.DomMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},PolylineDecoratorPlugin:{isLoaded:function(){return!!angular.isDefined(L.PolylineDecorator)},is:function(e){return!!this.isLoaded()&&e instanceof L.PolylineDecorator},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},MakiMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.MakiMarkers)||!angular.isDefined(L.MakiMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.MakiMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},ExtraMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.ExtraMarkers)||!angular.isDefined(L.ExtraMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.ExtraMarkers.Icon},equal:function(e,t){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,t))}},LabelPlugin:{isLoaded:function(){return angular.isDefined(L.Label)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},MarkerClusterPlugin:{isLoaded:function(){return angular.isDefined(L.MarkerClusterGroup)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},GoogleLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Google)},is:function(e){return!!this.isLoaded()&&e instanceof L.Google}},LeafletProviderPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.Provider)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.Provider}},ChinaLayerPlugin:{isLoaded:function(){return angular.isDefined(L.tileLayer.chinaProvider)}},HeatLayerPlugin:{isLoaded:function(){return angular.isDefined(L.heatLayer)}},WebGLHeatMapLayerPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.WebGLHeatMap)}},BingLayerPlugin:{isLoaded:function(){return angular.isDefined(L.BingLayer)},is:function(e){return!!this.isLoaded()&&e instanceof L.BingLayer}},WFSLayerPlugin:{isLoaded:function(){return void 0!==L.GeoJSON.WFS},is:function(e){return!!this.isLoaded()&&e instanceof L.GeoJSON.WFS}},AGSBaseLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.basemapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.basemapLayer}},AGSLayerPlugin:{isLoaded:function(){return void 0!==lvector&&void 0!==lvector.AGS},is:function(e){return!!this.isLoaded()&&e instanceof lvector.AGS}},AGSFeatureLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.featureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.featureLayer}},AGSTiledMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.tiledMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.tiledMapLayer}},AGSDynamicMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.dynamicMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.dynamicMapLayer}},AGSImageMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.imageMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.imageMapLayer}},AGSClusteredLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.clusteredFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.clusteredFeatureLayer}},AGSHeatmapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.heatmapFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.heatmapFeatureLayer}},YandexLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Yandex)},is:function(e){return!!this.isLoaded()&&e instanceof L.Yandex}},GeoJSONPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.GeoJSON)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.GeoJSON}},UTFGridPlugin:{isLoaded:function(){return angular.isDefined(L.UtfGrid)},is:function(e){return this.isLoaded()?e instanceof L.UtfGrid:(t.error("[AngularJS - Leaflet] No UtfGrid plugin found."),!1)}},CartoDB:{isLoaded:function(){return cartodb},is:function(){return!0}},Leaflet:{DivIcon:{is:function(e){return e instanceof L.DivIcon},equal:function(e,t){return!!this.is(e)&&angular.equals(e,t)}},Icon:{is:function(e){return e instanceof L.Icon},equal:function(e,t){return!!this.is(e)&&angular.equals(e,t)}}},watchOptions:{doWatch:!0,isDeep:!0,individual:{doWatch:!0,isDeep:!0}}}}]),angular.module("ui-leaflet").service("leafletIterators",["leafletLogger","leafletHelpers",function(e,t){var n,i,r,o=t,a=t.errorHeader+"leafletIterators: ",s=Object.keys,l=o.isFunction,c=o.isObject,u=e,d=Math.pow(2,53)-1,h=function(e){return e};i=s,n=function(e){var t=arguments.length;if(t<2||null===e)return e;for(var n=1;n<t;n++)for(var o=arguments[n],a=i(o),s=a.length,l=0;l<s;l++){var c=a[l];r&&void 0!==e[c]||(e[c]=o[c])}return e};var p;p=function(e){return e=n({},e),function(t){return function(e,t){var n=s(t),i=n.length;if(null===e)return!i;for(var r=Object(e),o=0;o<i;o++){var a=n[o];if(t[a]!==r[a]||!(a in r))return!1}return!0}(t,e)}};var f,g;f=g=function(e,t,n){t=function(e,t,n){return null===e?h:l(e)?function(e,t,n){if(void 0===t)return e;switch(null===n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return function(){return e.apply(t,arguments)}}(e,t,n):c(e)?p(e):(i=e,function(e){return null===e?void 0:e[i]});var i}(t,n);for(var i=!function(e){var t=null!==e&&e.length;return o.isNumber(t)&&t>=0&&t<=d}(e)&&s(e),r=(i||e).length,a=0;a<r;a++){var u=i?i[a]:a;if(!t(e[u],u,e))return!1}return!0};var m=function(e,t,n,i){return!(n||o.isDefined(e)&&o.isDefined(t))||!o.isFunction(t)&&(i=o.defaultTo(t,"cb"),u.error(a+i+" is not a function"),!0)},v=function(e,t){!function(e,t,n){if(!m(void 0,n,!0,"internalCb")&&!m(e,t))for(var i in e)e.hasOwnProperty(i)&&n(e[i],i)}(e,t,(function(e,n){t(e,n)}))};return{each:v,forEach:v,every:f,all:g}}]),angular.module("ui-leaflet").factory("leafletLayerHelpers",["$rootScope","$q","leafletLogger","leafletHelpers","leafletIterators",function($rootScope,$q,leafletLogger,leafletHelpers,leafletIterators){var Helpers=leafletHelpers,isString=leafletHelpers.isString,isObject=leafletHelpers.isObject,isArray=leafletHelpers.isArray,isDefined=leafletHelpers.isDefined,errorHeader=leafletHelpers.errorHeader,$it=leafletIterators,$log=leafletLogger,utfGridCreateLayer=function(e){if(Helpers.UTFGridPlugin.isLoaded()){var t=new L.UtfGrid(e.url,e.pluginOptions);return t.on("mouseover",(function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)})),t.on("mouseout",(function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)})),t.on("click",(function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)})),t.on("mousemove",(function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMousemove",e)})),t}$log.error("[AngularJS - Leaflet] The UTFGrid plugin is not loaded.")},layerTypes={xyz:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer(e.url,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){var t=3;isDefined(e.options.version)&&4===e.options.version&&(t=e.options.version);var n=3===t?"//{s}.tiles.mapbox.com/v3/"+e.key+"/{z}/{x}/{y}.png":"//api.tiles.mapbox.com/v4/"+e.key+"/{z}/{x}/{y}.png?access_token="+e.apiKey;return L.tileLayer(n,e.options)}},geoJSON:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.GeoJSONPlugin.isLoaded())return new L.TileLayer.GeoJSON(e.url,e.pluginOptions,e.options)}},geoJSONShape:{mustHaveUrl:!1,createLayer:function(e){return new L.GeoJSON(e.data,e.options)}},geoJSONAwesomeMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(t,n){return L.marker(n,{icon:L.AwesomeMarkers.icon(e.icon)})}})}},geoJSONVectorMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(t,n){return L.marker(n,{icon:L.VectorMarkers.icon(e.icon)})}})}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},cartodbTiles:{mustHaveKey:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(t,e.options)}},cartodbUTFGrid:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){return e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json",utfGridCreateLayer(e)}},cartodbInteractive:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png",n=L.tileLayer(t,e.options);e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json";var i=utfGridCreateLayer(e);return L.layerGroup([n,i])}},wms:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wms(e.url,e.options)}},wmts:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wmts(e.url,e.options)}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function(params){if(Helpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}}},group:{mustHaveUrl:!1,createLayer:function(e){var t=[];return $it.each(e.options.layers,(function(e){t.push(createLayer(e))})),e.options.loadedDefer=function(){var t=[];if(isDefined(e.options.layers))for(var n=0;n<e.options.layers.length;n++){var i=e.options.layers[n].layerOptions.loadedDefer;isDefined(i)&&t.push(i)}return t},L.layerGroup(t)}},featureGroup:{mustHaveUrl:!1,createLayer:function(){return L.featureGroup()}},google:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"SATELLITE";if(Helpers.GoogleLayerPlugin.isLoaded())return new L.Google(t,e.options)}},here:{mustHaveUrl:!1,createLayer:function(e){var t=e.provider||"HERE.terrainDay";if(Helpers.LeafletProviderPlugin.isLoaded())return new L.TileLayer.Provider(t,e.options)}},china:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"";if(Helpers.ChinaLayerPlugin.isLoaded())return L.tileLayer.chinaProvider(t,e.options)}},agsBase:{mustHaveLayer:!0,createLayer:function(e){if(Helpers.AGSBaseLayerPlugin.isLoaded())return L.esri.basemapLayer(e.layer,e.options)}},ags:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSLayerPlugin.isLoaded()){var t=angular.copy(e.options);angular.extend(t,{url:e.url});var n=new lvector.AGS(t);return n.onAdd=function(e){this.setMap(e)},n.onRemove=function(){this.setMap(null)},n}}},agsFeature:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSFeatureLayerPlugin.isLoaded()){e.options.url=e.url;var t=L.esri.featureLayer(e.options),n=function(){isDefined(e.options.loadedDefer)&&e.options.loadedDefer.resolve()};return t.on("loading",(function(){e.options.loadedDefer=$q.defer(),t.off("load",n),t.on("load",n)})),t}$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsTiled:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSTiledMapLayerPlugin.isLoaded())return e.options.url=e.url,L.esri.tiledMapLayer(e.options);$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsDynamic:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSDynamicMapLayerPlugin.isLoaded())return e.options.url=e.url,L.esri.dynamicMapLayer(e.options);$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsImage:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSImageMapLayerPlugin.isLoaded())return e.options.url=e.url,L.esri.imageMapLayer(e.options);$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsClustered:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSClusteredLayerPlugin.isLoaded()){if(Helpers.MarkerClusterPlugin.isLoaded())return L.esri.clusteredFeatureLayer(e.url,e.options);$log.warn(errorHeader+" The markercluster plugin is not loaded.")}else $log.warn(errorHeader+" The esri clustered layer plugin is not loaded.")}},agsHeatmap:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSHeatmapLayerPlugin.isLoaded()){if(Helpers.HeatLayerPlugin.isLoaded())return L.esri.heatmapFeatureLayer(e.url,e.options);$log.warn(errorHeader+" The heatlayer plugin is not loaded.")}else $log.warn(errorHeader+" The esri heatmap layer plugin is not loaded.")}},markercluster:{mustHaveUrl:!1,createLayer:function(e){if(Helpers.MarkerClusterPlugin.isLoaded())return new L.MarkerClusterGroup(e.options);$log.warn(errorHeader+" The markercluster plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){if(Helpers.BingLayerPlugin.isLoaded())return new L.BingLayer(e.key,e.options)}},webGLHeatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.WebGLHeatMapLayerPlugin.isLoaded()){var t=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&t.setData(e.data),t}}},heat:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.HeatLayerPlugin.isLoaded()){var t=new L.heatLayer;return isArray(e.data)&&t.setLatLngs(e.data),isObject(e.options)&&t.setOptions(e.options),t}}},yandex:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"map";if(Helpers.YandexLayerPlugin.isLoaded())return new L.Yandex(t,e.options)}},imageOverlay:{mustHaveUrl:!0,mustHaveBounds:!0,createLayer:function(e){return L.imageOverlay(e.url,e.bounds,e.options)}},iip:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.iip(e.url,e.options)}},custom:{createLayer:function(e){if(e.layer instanceof L.Class)return angular.copy(e.layer);$log.error("[AngularJS - Leaflet] A custom layer must be a leaflet Class")}},cartodb:{mustHaveUrl:!0,createLayer:function(e){return cartodb.createLayer(e.map,e.url)}}};function isValidLayerType(e){return isString(e.type)?-1===Object.keys(layerTypes).indexOf(e.type)?($log.error("[AngularJS - Leaflet] A layer must have a valid type: "+Object.keys(layerTypes)),!1):layerTypes[e.type].mustHaveUrl&&!isString(e.url)?($log.error("[AngularJS - Leaflet] A base layer must have an url"),!1):layerTypes[e.type].mustHaveData&&!isDefined(e.data)?($log.error('[AngularJS - Leaflet] The base layer must have a "data" array attribute'),!1):layerTypes[e.type].mustHaveLayer&&!isDefined(e.layer)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have an layer defined"),!1):layerTypes[e.type].mustHaveBounds&&!isDefined(e.bounds)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have bounds defined"),!1):!(layerTypes[e.type].mustHaveKey&&!isDefined(e.key))||($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have key defined"),!1):($log.error("[AngularJS - Leaflet] A layer must have a valid type defined."),!1)}function createLayer(e){if(isValidLayerType(e)){if(isString(e.name)){for(var t in isObject(e.layerParams)||(e.layerParams={}),isObject(e.layerOptions)||(e.layerOptions={}),e.layerParams)e.layerOptions[t]=e.layerParams[t];var n={url:e.url,data:e.data,options:e.layerOptions,layer:e.layer,icon:e.icon,type:e.layerType,bounds:e.bounds,key:e.key,apiKey:e.apiKey,pluginOptions:e.pluginOptions,user:e.user};return layerTypes[e.type].createLayer(n)}$log.error("[AngularJS - Leaflet] A base layer must have a name")}}function safeAddLayer(e,t){t&&"function"==typeof t.addTo?t.addTo(e):e.addLayer(t)}function safeRemoveLayer(e,t,n){if(isDefined(n)&&isDefined(n.loadedDefer))if(angular.isFunction(n.loadedDefer)){var i=n.loadedDefer();$log.debug("Loaded Deferred",i);var r=i.length;if(r>0)for(var o=function(){0===--r&&e.removeLayer(t)},a=0;a<i.length;a++)i[a].promise.then(o);else e.removeLayer(t)}else n.loadedDefer.promise.then((function(){e.removeLayer(t)}));else e.removeLayer(t)}return{createLayer:createLayer,safeAddLayer:safeAddLayer,safeRemoveLayer:safeRemoveLayer}}]),angular.module("ui-leaflet").factory("leafletLegendHelpers",["$http","$q","$log","leafletHelpers",function(e,t,n,i){var r={},o=i.isDefined,a=function(t){var n=r[t],i=n[0];e(i.c).then((function(e){n.shift(),i.d.resolve(e),n.length>0&&a(t)}),(function(e){n.shift(),i.d.reject(e),n.length>0&&a(t)}))},s=function(e,t,n,i){if(e.innerHTML="",t.error)e.innerHTML+='<div class="info-title alert alert-danger">'+t.error.message+"</div>";else if("arcgis"===n)for(var r=0;r<t.layers.length;r++){var o=t.layers[r];e.innerHTML+='<div class="info-title" data-layerid="'+o.layerId+'">'+o.layerName+"</div>";for(var a=0;a<o.legend.length;a++){var s=o.legend[a];e.innerHTML+='<div class="inline" data-layerid="'+o.layerId+'"><img src="data:'+s.contentType+";base64,"+s.imageData+'" /></div><div class="info-label" data-layerid="'+o.layerId+'">'+s.label+"</div>"}}else"image"===n&&(e.innerHTML='<img src="'+i+'"/>')};return{getOnAddLegend:function(e,t,n,i){return function(){var r=L.DomUtil.create("div",t);return L.Browser.touch?L.DomEvent.on(r,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(r),L.DomEvent.on(r,"mousewheel",L.DomEvent.stopPropagation)),s(r,e,n,i),r}},getOnAddArrayLegend:function(e,t){return function(){for(var n=L.DomUtil.create("div",t),i=0;i<e.colors.length;i++)n.innerHTML+='<div class="outline"><i style="background:'+e.colors[i]+'"></i></div><div class="info-label">'+e.labels[i]+"</div>";return L.Browser.touch?L.DomEvent.on(n,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(n),L.DomEvent.on(n,"mousewheel",L.DomEvent.stopPropagation)),n}},updateLegend:s,addLegendURL:function(e,n){var i=t.defer();return o(r[e])||(r[e]=[]),r[e].push({c:n,d:i}),1===r[e].length&&a(e),i.promise}}}]),angular.module("ui-leaflet").factory("leafletMapDefaults",["$q","leafletHelpers",function(e,t){var n=t.isDefined,i=t.isObject,r=t.obtainEffectiveMapId,o={};return{reset:function(){o={}},getDefaults:function(e){var t=r(o,e);return o[t]},getMapCreationDefaults:function(e){var t=r(o,e),i=o[t],a={maxZoom:i.maxZoom,keyboard:i.keyboard,dragging:i.dragging,zoomControl:i.zoomControl,doubleClickZoom:i.doubleClickZoom,scrollWheelZoom:i.scrollWheelZoom,tap:i.tap,touchZoom:i.touchZoom,attributionControl:i.attributionControl,worldCopyJump:i.worldCopyJump,crs:i.crs};if(n(i.minZoom)&&(a.minZoom=i.minZoom),n(i.zoomAnimation)&&(a.zoomAnimation=i.zoomAnimation),n(i.fadeAnimation)&&(a.fadeAnimation=i.fadeAnimation),n(i.markerZoomAnimation)&&(a.markerZoomAnimation=i.markerZoomAnimation),i.map)for(var s in i.map)a[s]=i.map[s];return a},setDefaults:function(e,t){var a={keyboard:!0,dragging:!0,worldCopyJump:!1,doubleClickZoom:!0,scrollWheelZoom:!0,tap:!0,touchZoom:!0,zoomControl:!0,zoomsliderControl:!1,zoomControlPosition:"topleft",attributionControl:!0,controls:{layers:{visible:!0,position:"topright",collapsed:!0}},nominatim:{server:" http://nominatim.openstreetmap.org/search"},crs:L.CRS.EPSG3857,tileLayer:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}};n(e)&&(a.doubleClickZoom=n(e.doubleClickZoom)?e.doubleClickZoom:a.doubleClickZoom,a.scrollWheelZoom=n(e.scrollWheelZoom)?e.scrollWheelZoom:a.doubleClickZoom,a.tap=n(e.tap)?e.tap:a.tap,a.touchZoom=n(e.touchZoom)?e.touchZoom:a.doubleClickZoom,a.zoomControl=n(e.zoomControl)?e.zoomControl:a.zoomControl,a.zoomsliderControl=n(e.zoomsliderControl)?e.zoomsliderControl:a.zoomsliderControl,a.attributionControl=n(e.attributionControl)?e.attributionControl:a.attributionControl,a.tileLayer=n(e.tileLayer)?e.tileLayer:a.tileLayer,a.zoomControlPosition=n(e.zoomControlPosition)?e.zoomControlPosition:a.zoomControlPosition,a.keyboard=n(e.keyboard)?e.keyboard:a.keyboard,a.dragging=n(e.dragging)?e.dragging:a.dragging,n(e.controls)&&angular.extend(a.controls,e.controls),i(e.crs)?a.crs=e.crs:n(L.CRS[e.crs])&&(a.crs=L.CRS[e.crs]),n(e.center)&&angular.copy(e.center,a.center),n(e.tileLayerOptions)&&angular.copy(e.tileLayerOptions,a.tileLayerOptions),n(e.maxZoom)&&(a.maxZoom=e.maxZoom),n(e.minZoom)&&(a.minZoom=e.minZoom),n(e.zoomAnimation)&&(a.zoomAnimation=e.zoomAnimation),n(e.fadeAnimation)&&(a.fadeAnimation=e.fadeAnimation),n(e.markerZoomAnimation)&&(a.markerZoomAnimation=e.markerZoomAnimation),n(e.worldCopyJump)&&(a.worldCopyJump=e.worldCopyJump),n(e.map)&&(a.map=e.map),n(e.path)&&(a.path=e.path));var s=r(o,t);return o[s]=a,a}}}]),angular.module("ui-leaflet").service("leafletMarkersHelpers",["$rootScope","$timeout","leafletHelpers","leafletLogger","$compile","leafletGeoJsonHelpers",function(e,t,n,i,r,o){var a=n.isDefined,s=n.defaultTo,l=n.MarkerClusterPlugin,c=n.AwesomeMarkersPlugin,u=n.VectorMarkersPlugin,d=n.MakiMarkersPlugin,h=n.ExtraMarkersPlugin,p=n.DomMarkersPlugin,f=n.safeApply,g=n,m=n.isString,v=n.isNumber,y=n.isObject,b={},_=o,x=n.errorHeader,w=i,S=function(e){var t="";return["_icon","_latlng","_leaflet_id","_map","_shadow"].forEach((function(n){t+=n+": "+s(e[n],"undefined")+" \n"})),"[leafletMarker] : \n"+t},T=function(t){if(a(t)&&a(t.type)&&"awesomeMarker"===t.type)return c.isLoaded()||w.error(x+" The AwesomeMarkers Plugin is not loaded."),new L.AwesomeMarkers.icon(t);if(a(t)&&a(t.type)&&"vectorMarker"===t.type)return u.isLoaded()||w.error(x+" The VectorMarkers Plugin is not loaded."),new L.VectorMarkers.icon(t);if(a(t)&&a(t.type)&&"makiMarker"===t.type)return d.isLoaded()||w.error(x+"The MakiMarkers Plugin is not loaded."),new L.MakiMarkers.icon(t);if(a(t)&&a(t.type)&&"extraMarker"===t.type)return h.isLoaded()||w.error(x+"The ExtraMarkers Plugin is not loaded."),new L.ExtraMarkers.icon(t);if(a(t)&&a(t.type)&&"div"===t.type)return new L.divIcon(t);if(a(t)&&a(t.type)&&"dom"===t.type){p.isLoaded()||w.error(x+"The DomMarkers Plugin is not loaded.");var n=angular.isFunction(t.getMarkerScope)?t.getMarkerScope():e,i=r(t.template)(n),o=angular.copy(t);return o.element=i[0],new L.DomMarkers.icon(o)}if(a(t)&&a(t.type)&&"icon"===t.type)return t.icon;return a(t)&&a(t.iconUrl)?new L.Icon(t):new L.Icon.Default({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",shadowUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},E=function(e,t,n){if(e.closePopup(),a(n)&&a(n.overlays))for(var i in n.overlays)if((n.overlays[i]instanceof L.LayerGroup||n.overlays[i]instanceof L.FeatureGroup)&&n.overlays[i].hasLayer(e))return void n.overlays[i].removeLayer(e);if(a(b))for(var r in b)b[r].hasLayer(e)&&b[r].removeLayer(e);t.hasLayer(e)&&t.removeLayer(e)},C=function(e,n,i){(e._popup._contentNode.innerText||e._popup._contentNode.textContent).length<1&&t((function(){C(e,n,i)}));var r=e._popup._contentNode.offsetWidth;return e._popup._updateLayout(),e._popup._updatePosition(),e._popup.options.autoPan&&function(e,t){var n=e._popup._container.offsetHeight,i=new L.Point(e._popup._containerLeft,-n-e._popup._containerBottom);null!==t.layerPointToContainerPoint(i)&&e._popup._adjustPan()}(e,i),r},k=function(t,n,i){var o=angular.isFunction(n.getMessageScope)?n.getMessageScope():e;if(!a(n.compileMessage)||n.compileMessage){if(!a(t._popup)||!a(t._popup._contentNode))return w.error(x+"Popup is invalid or does not have any content."),!1;!function(e,t){r(e._popup._contentNode)(t)}(t,o),C(t,n,i)}},P=function(t,n){var i=angular.isFunction(n.getMessageScope)?n.getMessageScope():e,o=angular.isFunction(n.getLabelScope)?n.getLabelScope():i,s=!a(n.compileMessage)||n.compileMessage;g.LabelPlugin.isLoaded()&&a(n.label)&&(a(n.label.options)&&!0===n.label.options.noHide&&t.showLabel(),s&&a(t.label)&&r(t.label._container)(o))},A=function(e,t,n,i,r,o,s){if(a(t)){if(!_.validateCoords(e))return w.warn("There are problems with lat-lng data, please verify your marker model"),void E(n,s,o);var l=e===t;if(a(e.iconAngle)&&t.iconAngle!==e.iconAngle&&n.setIconAngle(e.iconAngle),m(e.layer)||m(t.layer)&&(a(o.overlays[t.layer])&&o.overlays[t.layer].hasLayer(n)&&(o.overlays[t.layer].removeLayer(n),n.closePopup()),s.hasLayer(n)||s.addLayer(n)),(v(e.opacity)||v(parseFloat(e.opacity)))&&e.opacity!==t.opacity&&n.setOpacity(e.opacity),m(e.layer)&&t.layer!==e.layer){if(m(t.layer)&&a(o.overlays[t.layer])&&o.overlays[t.layer].hasLayer(n)&&o.overlays[t.layer].removeLayer(n),n.closePopup(),s.hasLayer(n)&&s.removeLayer(n),!a(o.overlays[e.layer]))return void w.error(x+"You must use a name of an existing layer");var c=o.overlays[e.layer];if(!(c instanceof L.LayerGroup||c instanceof L.FeatureGroup))return void w.error(x+'A marker can only be added to a layer of type "group" or "featureGroup"');c.addLayer(n),s.hasLayer(n)&&!0===e.focus&&n.openPopup()}if(!0!==e.draggable&&!0===t.draggable&&a(n.dragging)&&n.dragging.disable(),!0===e.draggable&&!0!==t.draggable&&(n.dragging?n.dragging.enable():L.Handler.MarkerDrag&&(n.dragging=new L.Handler.MarkerDrag(n),n.options.draggable=!0,n.dragging.enable())),y(e.icon)||y(t.icon)&&(n.setIcon(T()),n.closePopup(),n.unbindPopup(),m(e.message)&&n.bindPopup(e.message,e.popupOptions)),y(e.icon)&&y(t.icon)&&!angular.equals(e.icon,t.icon)){var u=!1;n.dragging&&(u=n.dragging.enabled()),n.setIcon(T(e.icon)),u&&n.dragging.enable(),n.closePopup(),n.unbindPopup(),m(e.message)&&(n.bindPopup(e.message,e.popupOptions),s.hasLayer(n)&&!0===e.focus&&n.openPopup())}!m(e.message)&&m(t.message)&&(n.closePopup(),n.unbindPopup()),g.LabelPlugin.isLoaded()&&(a(e.label)&&a(e.label.message)?"label"in t&&"message"in t.label&&!angular.equals(e.label.message,t.label.message)?n.updateLabelContent(e.label.message):!angular.isFunction(n.getLabel)||angular.isFunction(n.getLabel)&&!a(n.getLabel())?(n.bindLabel(e.label.message,e.label.options),P(n,e)):P(n,e):"label"in e&&!("message"in e.label)||angular.isFunction(n.unbindLabel)&&n.unbindLabel()),m(e.message)&&!m(t.message)&&n.bindPopup(e.message,e.popupOptions),m(e.message)&&m(t.message)&&e.message!==t.message&&n.setPopupContent(e.message);var d=!1;!0!==e.focus&&!0===t.focus&&(n.closePopup(),d=!0),(!0===e.focus&&(!a(t.focus)||!1===t.focus)||l&&!0===e.focus)&&(n.openPopup(),d=!0),t.zIndexOffset!==e.zIndexOffset&&n.setZIndexOffset(e.zIndexOffset);var h=n.getLatLng();m(e.layer)&&g.MarkerClusterPlugin.is(o.overlays[e.layer])?d?e.lat===t.lat&&e.lng===t.lng||(o.overlays[e.layer].removeLayer(n),n.setLatLng([e.lat,e.lng]),o.overlays[e.layer].addLayer(n)):h.lat!==e.lat||h.lng!==e.lng||e.lat!==t.lat||e.lng!==t.lng?(o.overlays[e.layer].removeLayer(n),n.setLatLng([e.lat,e.lng]),o.overlays[e.layer].addLayer(n)):y(e.icon)&&y(t.icon)&&!angular.equals(e.icon,t.icon)&&(o.overlays[e.layer].removeLayer(n),o.overlays[e.layer].addLayer(n)):h.lat===e.lat&&h.lng===e.lng||n.setLatLng([e.lat,e.lng])}};return{resetMarkerGroup:function(e){a(b[e])&&b.splice(e,1)},resetMarkerGroups:function(){b={}},deleteMarker:E,manageOpenPopup:k,manageOpenLabel:P,createMarker:function(e){if(a(e)&&_.validateCoords(e)){var t=_.getCoords(e);if(a(t)){var n={icon:T(e.icon),title:a(e.title)?e.title:"",draggable:!!a(e.draggable)&&e.draggable,clickable:!a(e.clickable)||e.clickable,riseOnHover:!!a(e.riseOnHover)&&e.riseOnHover,zIndexOffset:a(e.zIndexOffset)?e.zIndexOffset:0,iconAngle:a(e.iconAngle)?e.iconAngle:0};for(var i in e)e.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(n[i]=e[i]);var r=new L.marker(t,n);return m(e.message)||r.unbindPopup(),r}w.error(x+"Unable to get coordinates from markerData.")}else w.error(x+"The marker definition is not valid.")},addMarkerToGroup:function(e,t,n,i){m(t)?l.isLoaded()?(a(b[t])||(b[t]=new L.MarkerClusterGroup(n),i.addLayer(b[t])),b[t].addLayer(e)):w.error(x+"The MarkerCluster plugin is not loaded."):w.error(x+"The marker group you have specified is invalid.")},listenMarkerEvents:function(e,t,n,i,r){e.on("popupopen",(function(){f(n,(function(){(a(e._popup)||a(e._popup._contentNode))&&(t.focus=!0,k(e,t,r))}))})),e.on("popupclose",(function(){f(n,(function(){t.focus=!1}))})),e.on("add",(function(){f(n,(function(){"label"in t&&P(e,t)}))}))},updateMarker:A,addMarkerWatcher:function(e,t,n,i,r,o){var l=g.getObjectArrayPath("markers."+t);o=s(o,!0);var c=n.$watch(l,(function(t,n){if(!a(t))return E(e,r,i),void c();A(t,n,e,0,0,i,r)}),o)},string:S,log:function(e,t){(t?console:w).debug(S(e))},getModelFromModels:function(e,t,n){if(a(e)){if(t)return n?e[n][t]:e[t];w.error(x+"marker id missing in getMarker")}},getLayerModels:function(e,t){if(a(e))return t?e[t]:e}}}]),angular.module("ui-leaflet").factory("leafletPathsHelpers",["$rootScope","leafletLogger","leafletHelpers",function(e,t,n){var i=n.isDefined,r=n.isArray,o=n.isNumber,a=n.isValidPoint,s=t,l=["stroke","weight","color","opacity","fill","fillColor","fillOpacity","dashArray","lineCap","lineJoin","clickable","pointerEvents","className","smoothFactor","noClip"];function c(e){return e.filter((function(e){return a(e)})).map((function(e){return u(e)}))}function u(e){return r(e)?new L.LatLng(e[0],e[1]):new L.LatLng(e.lat,e.lng)}function d(e){return e.map((function(e){return c(e)}))}var h=function(e,t){for(var n={},r=0;r<l.length;r++){var o=l[r];i(t[o])&&(n[o]=t[o])}e.setStyle(t)},p=function(e){if(!r(e))return!1;for(var t=0;t<e.length;t++){var n=e[t];if(!a(n))return!1}return!0},f={polyline:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polyline([],e)},setPath:function(e,t){e.setLatLngs(c(t.latlngs)),h(e,t)}},multiPolyline:{isValid:function(e){var t=e.latlngs;if(!r(t))return!1;for(var n in t){var i=t[n];if(!p(i))return!1}return!0},createPath:function(e){return new L.multiPolyline([[[0,0],[1,1]]],e)},setPath:function(e,t){e.setLatLngs(d(t.latlngs)),h(e,t)}},polygon:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polygon([],e)},setPath:function(e,t){e.setLatLngs(c(t.latlngs)),h(e,t)}},multiPolygon:{isValid:function(e){var t=e.latlngs;if(!r(t))return!1;for(var n in t){var i=t[n];if(!p(i))return!1}return!0},createPath:function(e){return new L.MultiPolygon([[[0,0],[1,1],[0,1]]],e)},setPath:function(e,t){e.setLatLngs(d(t.latlngs)),h(e,t)}},rectangle:{isValid:function(e){var t=e.latlngs;if(!r(t)||2!==t.length)return!1;for(var n in t){var i=t[n];if(!a(i))return!1}return!0},createPath:function(e){return new L.Rectangle([[0,0],[1,1]],e)},setPath:function(e,t){e.setBounds(new L.LatLngBounds(c(t.latlngs))),h(e,t)}},circle:{isValid:function(e){var t=e.latlngs;return a(t)&&o(e.radius)},createPath:function(e){return new L.Circle([0,0],1,e)},setPath:function(e,t){e.setLatLng(u(t.latlngs)),i(t.radius)&&e.setRadius(t.radius),h(e,t)}},circleMarker:{isValid:function(e){var t=e.latlngs;return a(t)&&o(e.radius)},createPath:function(e){return new L.CircleMarker([0,0],e)},setPath:function(e,t){e.setLatLng(u(t.latlngs)),i(t.radius)&&e.setRadius(t.radius),h(e,t)}}};return{setPathOptions:function(e,t,n){i(t)||(t="polyline"),f[t].setPath(e,n)},createPath:function(e,t,n){i(t.type)||(t.type="polyline");var r=function(e,t){for(var n={},r=0;r<l.length;r++){var o=l[r];i(e[o])?n[o]=e[o]:i(t.path[o])&&(n[o]=t.path[o])}return n}(t,n),o=function(e){var t={};return e.latlngs&&(t.latlngs=e.latlngs),e.radius&&(t.radius=e.radius),t}(t);if(f[t.type].isValid(o))return f[t.type].createPath(r);s.error("[AngularJS - Leaflet] Invalid data passed to the "+t.type+" path")}}}]),angular.module("ui-leaflet").service("leafletWatchHelpers",(function(){var e=function(e,t,n,i,r){var o=e[t](n,(function(e,t){r(e,t),i.doWatch||o()}),i.isDeep);return o};return{maybeWatch:function(t,n,i,r){return e(t,"$watch",n,i,r)},maybeWatchCollection:function(t,n,i,r){return e(t,"$watchCollection",n,i,r)}}})),angular.module("ui-leaflet").service("leafletLogger",["nemSimpleLogger",function(e){return e.spawn()}]),angular.module("ui-leaflet").factory("nominatimService",["$q","$http","leafletHelpers","leafletMapDefaults",function(e,t,n,i){var r=n.isDefined;return{query:function(n,o){var a=i.getDefaults(o).nominatim.server,s=e.defer();return t.get(a,{params:{format:"json",limit:1,q:n}}).success((function(e){e.length>0&&r(e[0].boundingbox)?s.resolve(e[0]):s.reject("[Nominatim] Invalid address")})),s.promise}}}]),angular.module("ui-leaflet").directive("bounds",["leafletLogger","$timeout","$http","leafletHelpers","nominatimService","leafletBoundsHelpers",function(e,t,n,i,r,o){var a=e;return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(e,n,s,l){var c=i.isDefined,u=o.createLeafletBounds,d=l[0].getLeafletScope(),h=l[0],p=i.errorHeader+" [Bounds] ";h.getMap().then((function(n){var i;d.$on("boundsChanged",(function(e){var i=e.currentScope,r=n.getBounds();if(!function(e){return 0===e._southWest.lat&&0===e._southWest.lng&&0===e._northEast.lat&&0===e._northEast.lng}(r)&&!i.settingBoundsFromScope){i.settingBoundsFromLeaflet=!0;var o={northEast:{lat:r._northEast.lat,lng:r._northEast.lng},southWest:{lat:r._southWest.lat,lng:r._southWest.lng},options:r.options};angular.equals(i.bounds,o)||(i.bounds=o),t((function(){i.settingBoundsFromLeaflet=!1}))}})),d.$watch("bounds",(function(o){if(!e.settingBoundsFromLeaflet){if(c(o.address)&&o.address!==i)return e.settingBoundsFromScope=!0,r.query(o.address,s.id).then((function(e){var t=e.boundingbox,i=[[t[0],t[2]],[t[1],t[3]]];n.fitBounds(i)}),(function(e){a.error(p+" "+e+".")})),i=o.address,void t((function(){e.settingBoundsFromScope=!1}));var l=u(o);l&&!n.getBounds().equals(l)&&(e.settingBoundsFromScope=!0,n.fitBounds(l,o.options),t((function(){e.settingBoundsFromScope=!1})))}}),!0)}))}}}]);var centerDirectiveTypes=["center","lfCenter"],centerDirectives={};centerDirectiveTypes.forEach((function(e){centerDirectives[e]=["leafletLogger","$q","$location","$timeout","leafletMapDefaults","leafletHelpers","leafletBoundsHelpers","leafletMapEvents",function(t,n,i,r,o,a,s,l){var c,u=a.isDefined,d=a.isNumber,h=a.isSameCenterOnMap,p=a.safeApply,f=a.isValidCenter,g=s.isValidBounds,m=a.isUndefinedOrEmpty,v=a.errorHeader,y=t;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:function(){c=n.defer(),this.getCenter=function(){return c.promise}},link:function(t,n,a,b){var _=b.getLeafletScope(),x=_[e];b.getMap().then((function(t){var n,b,w,S,T=o.getDefaults(a.id);if(-1!==a[e].search("-"))return y.error(v+' The "center" variable can\'t use a "-" on its key name: "'+a[e]+'".'),void t.setView([T.center.lat,T.center.lng],T.center.zoom);if(n=_.bounds,b=x,u(n)&&g(n)&&m(b))t.fitBounds(s.createLeafletBounds(_.bounds),_.bounds.options),x=t.getCenter(),p(_,(function(n){angular.extend(n[e],{lat:t.getCenter().lat,lng:t.getCenter().lng,zoom:t.getZoom(),autoDiscover:!1})})),p(_,(function(e){var n=t.getBounds();e.bounds={northEast:{lat:n._northEast.lat,lng:n._northEast.lng},southWest:{lat:n._southWest.lat,lng:n._southWest.lng}}}));else{if(!u(x))return y.error(v+' The "center" property is not defined in the main scope'),void t.setView([T.center.lat,T.center.lng],T.center.zoom);u(x.lat)&&u(x.lng)||u(x.autoDiscover)||angular.copy(T.center,x)}if("yes"===a.urlHashCenter){var E=function(){var e,t=i.search();if(u(t.c)){var n=t.c.split(":");3===n.length&&(e={lat:parseFloat(n[0]),lng:parseFloat(n[1]),zoom:parseInt(n[2],10)})}return e};w=E(),_.$on("$locationChangeSuccess",(function(n){var i=n.currentScope,r=E();u(r)&&!h(r,t)&&angular.extend(i[e],{lat:r.lat,lng:r.lng,zoom:r.zoom})}))}_.$watch(e,(function(e){if(!_.settingCenterFromLeaflet){if(u(w)&&(angular.copy(w,e),w=void 0),f(e)||!0===e.autoDiscover)return!0===e.autoDiscover?(d(e.zoom)||t.setView([T.center.lat,T.center.lng],T.center.zoom),void(d(e.zoom)&&e.zoom>T.center.zoom?t.locate({setView:!0,maxZoom:e.zoom}):u(T.maxZoom)?t.locate({setView:!0,maxZoom:T.maxZoom}):t.locate({setView:!0}))):void(S&&h(e,t)||(_.settingCenterFromScope=!0,t.setView([e.lat,e.lng],e.zoom),l.notifyCenterChangedToBounds(_,t),r((function(){_.settingCenterFromScope=!1}))));y.warn(v+" invalid 'center'")}}),!0),t.whenReady((function(){S=!0})),t.on("moveend",(function(){c.resolve(),l.notifyCenterUrlHashChanged(_,t,a,i.search()),h(x,t)||_.settingCenterFromScope||(_.settingCenterFromLeaflet=!0,p(_,(function(n){_.settingCenterFromScope||angular.extend(n[e],{lat:t.getCenter().lat,lng:t.getCenter().lng,zoom:t.getZoom(),autoDiscover:!1}),l.notifyCenterChangedToBounds(_,t),r((function(){_.settingCenterFromLeaflet=!1}))})))})),!0===x.autoDiscover&&t.on("locationerror",(function(){y.warn(v+" The Geolocation API is unauthorized on this page."),f(x)?(t.setView([x.lat,x.lng],x.zoom),l.notifyCenterChangedToBounds(_,t)):(t.setView([T.center.lat,T.center.lng],T.center.zoom),l.notifyCenterChangedToBounds(_,t))}))}))}}}]})),centerDirectiveTypes.forEach((function(e){angular.module("ui-leaflet").directive(e,centerDirectives[e])})),angular.module("ui-leaflet").directive("controls",["leafletLogger","leafletHelpers","leafletControlHelpers",function(e,t,n){var i=e;return{restrict:"A",scope:!1,replace:!1,require:"?^leaflet",link:function(e,r,o,a){if(a){var s=n.createControl,l=n.isValidControlType,c=a.getLeafletScope(),u=t.isDefined,d=t.isArray,h={},p=t.errorHeader+" [Controls] ";a.getMap().then((function(e){c.$watchCollection("controls",(function(t){for(var n in h)u(t[n])||(e.hasControl(h[n])&&e.removeControl(h[n]),delete h[n]);for(var r in t){var o,a=u(t[r].type)?t[r].type:r;if(!l(a))return void i.error(p+" Invalid control type: "+a+".");if("custom"!==a)o=s(a,t[r]),e.addControl(o),h[r]=o;else{var c=t[r];if(d(c))for(var f in c){var g=c[f];e.addControl(g),h[r]=u(h[r])?h[r].concat([g]):[g]}else e.addControl(c),h[r]=c}}}))}))}}}}]),angular.module("ui-leaflet").directive("decorations",["leafletLogger","leafletHelpers",function(e,t){var n=e;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,i,r,o){var a=o.getLeafletScope(),s=t.PolylineDecoratorPlugin,l=t.isDefined,c={};function u(e,t){if(l(e)&&l(t)&&l(t.coordinates)&&l(t.patterns))return e.setPaths(t.coordinates),e.setPatterns(t.patterns),e}o.getMap().then((function(e){a.$watch("decorations",(function(t){for(var i in c)l(t[i])&&angular.equals(t[i],c)||(e.removeLayer(c[i]),delete c[i]);for(var r in t){var o=t[r],a=(l(d=o)&&l(d.coordinates)&&(s.isLoaded()||n.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(d.coordinates));l(a)&&(c[r]=a,e.addLayer(a),u(a,o))}var d}),!0)}))}}}]),angular.module("ui-leaflet").directive("eventBroadcast",["leafletLogger","$rootScope","leafletHelpers","leafletMapEvents","leafletIterators",function(e,t,n,i,r){var o=e;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,a,s){var l=n.isObject,c=n.isDefined,u=s.getLeafletScope(),d=u.eventBroadcast,h=i.getAvailableMapEvents(),p=i.addEvents;s.getMap().then((function(e){var t=[],n="broadcast";c(d.map)?l(d.map)?("emit"!==d.map.logic&&"broadcast"!==d.map.logic?o.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):n=d.map.logic,l(d.map.enable)&&d.map.enable.length>=0?r.each(d.map.enable,(function(e){-1===t.indexOf(e)&&-1!==h.indexOf(e)&&t.push(e)})):o.warn("[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.")):o.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model."):t=h,p(e,t,"eventName",u,n)}))}}}]),angular.module("ui-leaflet").directive("geojson",["leafletLogger","$rootScope","leafletData","leafletHelpers","leafletWatchHelpers","leafletDirectiveControlsHelpers","leafletIterators","leafletGeoJsonEvents",function(e,t,n,i,r,o,a,s){var l=r.maybeWatch,c=i.watchOptions,u=o.extend,d=i,h=a;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,r,o){var a=i.isDefined,p=o.getLeafletScope(),f={},g=!1;o.getMap().then((function(e){var t=p.geojsonWatchOptions||c,o=d.isDefined(r.geojsonNested)&&d.isTruthy(r.geojsonNested),m=function(){if(f){var t=function(t){a(t)&&e.hasLayer(t)&&e.removeLayer(t)};o?h.each(f,(function(e){t(e)})):t(f)}},v=function(t,o){var l=angular.copy(t);if(a(l)&&a(l.data)){var c=function(e,t){return angular.isFunction(e.onEachFeature)?e.onEachFeature:function(n,o){i.LabelPlugin.isLoaded()&&a(n.properties.description)&&o.bindLabel(n.properties.description),s.bindEvents(r.id,o,null,n,p,t,{resetStyleOnMouseout:e.resetStyleOnMouseout,mapId:r.id})}}(l,o);a(l.options)||(l.options={style:l.style,filter:l.filter,onEachFeature:c,pointToLayer:l.pointToLayer});var u=L.geoJson(l.data,l.options);o&&d.isString(o)?f[o]=u:f=u,u.addTo(e),g||(g=!0,n.setGeoJSON(f,r.id))}},y=function(e){if(m(),o){if(!e||!Object.keys(e).length)return;h.each(e,(function(e,t){v(e,t)}))}else v(e)};u(r.id,"geojson",y,m),l(p,"geojson",t,(function(e){y(e)}))}))}}}]),angular.module("ui-leaflet").directive("layercontrol",["$filter","leafletLogger","leafletData","leafletHelpers",function(e,t,n,i){var r=t;return{restrict:"E",scope:{icons:"=?",autoHideOpacity:"=?",showGroups:"=?",title:"@",baseTitle:"@",overlaysTitle:"@"},replace:!0,transclude:!1,require:"^leaflet",controller:["$scope","$element","$sce",function(e,t,o){r.debug("[Angular Directive - Layers] layers",e,t);var a=i.safeApply,s=i.isDefined;angular.extend(e,{baselayer:"",oldGroup:"",layerProperties:{},groupProperties:{},rangeIsSupported:i.rangeIsSupported(),changeBaseLayer:function(t,r){i.safeApply(e,(function(i){i.baselayer=t,n.getMap().then((function(r){n.getLayers().then((function(n){if(!r.hasLayer(n.baselayers[t])){for(var o in i.layers.baselayers)i.layers.baselayers[o].icon=i.icons.unradio,r.hasLayer(n.baselayers[o])&&r.removeLayer(n.baselayers[o]);r.addLayer(n.baselayers[t]),i.layers.baselayers[t].icon=e.icons.radio}}))}))})),r.preventDefault()},moveLayer:function(t,n,i){var r=Object.keys(e.layers.baselayers).length;if(n>=1+r&&n<=e.overlaysArray.length+r){var o;for(var s in e.layers.overlays)if(e.layers.overlays[s].index===n){o=e.layers.overlays[s];break}o&&a(e,(function(){o.index=t.index,t.index=n}))}i.stopPropagation(),i.preventDefault()},initIndex:function(t,n){var i=Object.keys(e.layers.baselayers).length;t.index=s(t.index)?t.index:n+i+1},initGroup:function(t){e.groupProperties[t]=e.groupProperties[t]?e.groupProperties[t]:{}},toggleOpacity:function(t,n){if(n.visible){if(e.autoHideOpacity&&!e.layerProperties[n.name].opacityControl)for(var i in e.layerProperties)e.layerProperties[i].opacityControl=!1;e.layerProperties[n.name].opacityControl=!e.layerProperties[n.name].opacityControl}t.stopPropagation(),t.preventDefault()},toggleLegend:function(t){e.layerProperties[t.name].showLegend=!e.layerProperties[t.name].showLegend},showLegend:function(t){return t.legend&&e.layerProperties[t.name].showLegend},unsafeHTML:function(e){return o.trustAsHtml(e)},getOpacityIcon:function(t){return t.visible&&e.layerProperties[t.name].opacityControl?e.icons.close:e.icons.open},getGroupIcon:function(t){return t.visible?e.icons.check:e.icons.uncheck},changeOpacity:function(t){var i=e.layerProperties[t.name].opacity;n.getMap().then((function(r){n.getLayers().then((function(n){var o;for(var a in e.layers.overlays)if(e.layers.overlays[a]===t){o=n.overlays[a];break}r.hasLayer(o)&&(o.setOpacity&&o.setOpacity(i/100),o.getLayers&&o.eachLayer&&o.eachLayer((function(e){e.setOpacity&&e.setOpacity(i/100)})))}))}))},changeGroupVisibility:function(t){if(s(e.groupProperties[t])){var n=e.groupProperties[t].visible;for(var i in e.layers.overlays){var r=e.layers.overlays[i];r.group===t&&(r.visible=n)}}}});var l=t.get(0);L.Browser.touch?L.DomEvent.on(l,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(l),L.DomEvent.on(l,"mousewheel",L.DomEvent.stopPropagation))}],template:'<div class="angular-leaflet-control-layers" ng-show="overlaysArray.length"><h4 ng-if="title">{{ title }}</h4><div class="lf-baselayers"><h5 class="lf-title" ng-if="baseTitle">{{ baseTitle }}</h5><div class="lf-row" ng-repeat="(key, layer) in baselayersArray"><label class="lf-icon-bl" ng-click="changeBaseLayer(key, $event)"><input class="leaflet-control-layers-selector" type="radio" name="lf-radio" ng-show="false" ng-checked="baselayer === key" ng-value="key" /> <i class="lf-icon lf-icon-radio" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label></div></div><div class="lf-overlays"><h5 class="lf-title" ng-if="overlaysTitle">{{ overlaysTitle }}</h5><div class="lf-container"><div class="lf-row" ng-repeat="layer in (o = (overlaysArray | orderBy:\'index\':order))" ng-init="initIndex(layer, $index)"><label class="lf-icon-ol-group" ng-if="showGroups &amp;&amp; layer.group &amp;&amp; layer.group != o[$index-1].group"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-change="changeGroupVisibility(layer.group)" ng-model="groupProperties[layer.group].visible"/> <i class="lf-icon lf-icon-check" ng-class="getGroupIcon(groupProperties[layer.group])"></i><div class="lf-text">{{ layer.group }}</div></label><label class="lf-icon-ol"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-model="layer.visible"/> <i class="lf-icon lf-icon-check" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label><div class="lf-icons"><i class="lf-icon lf-up" ng-class="icons.up" ng-click="moveLayer(layer, layer.index - orderNumber, $event)"></i> <i class="lf-icon lf-down" ng-class="icons.down" ng-click="moveLayer(layer, layer.index + orderNumber, $event)"></i> <i class="lf-icon lf-toggle-legend" ng-class="icons.toggleLegend" ng-if="layer.legend" ng-click="toggleLegend(layer)"></i> <i class="lf-icon lf-open" ng-class="getOpacityIcon(layer)" ng-click="toggleOpacity($event, layer)"></i></div><div class="lf-legend" ng-if="showLegend(layer)" ng-bind-html="unsafeHTML(layer.legend)"></div><div class="lf-opacity clearfix" ng-if="layer.visible &amp;&amp; layerProperties[layer.name].opacityControl"><label ng-if="rangeIsSupported" class="pull-left" style="width: 50%">0</label><label ng-if="rangeIsSupported" class="pull-left text-right" style="width: 50%">100</label><input ng-if="rangeIsSupported" class="clearfix" type="range" min="0" max="100" class="lf-opacity-control" ng-model="layerProperties[layer.name].opacity" ng-change="changeOpacity(layer)"/><h6 ng-if="!rangeIsSupported">Range is not supported in this browser</h6></div></div></div></div></div>',link:function(e,t,r,o){var a=i.isDefined,s=o.getLeafletScope(),l=s.layers;e.$watch("icons",(function(){var t={uncheck:"fa fa-square-o",check:"fa fa-check-square-o",radio:"fa fa-dot-circle-o",unradio:"fa fa-circle-o",up:"fa fa-angle-up",down:"fa fa-angle-down",open:"fa fa-angle-double-down",close:"fa fa-angle-double-up",toggleLegend:"fa fa-pencil-square-o"};a(e.icons)?(angular.extend(t,e.icons),angular.extend(e.icons,t)):e.icons=t})),r.order=!a(r.order)||"normal"!==r.order&&"reverse"!==r.order?"normal":r.order,e.order="normal"===r.order,e.orderNumber="normal"===r.order?-1:1,e.layers=l,o.getMap().then((function(t){s.$watch("layers.baselayers",(function(i){var r={};n.getLayers().then((function(n){var o;for(o in i){var a=i[o];a.icon=e.icons[t.hasLayer(n.baselayers[o])?"radio":"unradio"],r[o]=a}e.baselayersArray=r}))})),s.$watch("layers.overlays",(function(t){var i=[],r={};n.getLayers().then((function(n){var o;for(o in t){var s=t[o];s.icon=e.icons[s.visible?"check":"uncheck"],i.push(s),a(e.layerProperties[s.name])||(e.layerProperties[s.name]={opacity:a(s.layerOptions.opacity)?100*s.layerOptions.opacity:100,opacityControl:!1,showLegend:!0}),a(s.group)&&(a(e.groupProperties[s.group])||(e.groupProperties[s.group]={visible:!1}),r[s.group]=a(r[s.group])?r[s.group]:{count:0,visibles:0},r[s.group].count++,s.visible&&r[s.group].visibles++),a(s.index)&&n.overlays[o].setZIndex&&n.overlays[o].setZIndex(t[o].index)}for(o in r)e.groupProperties[o].visible=r[o].visibles===r[o].count;e.overlaysArray=i}))}),!0)}))}}}]),angular.module("ui-leaflet").directive("layers",["leafletLogger","$q","leafletData","leafletHelpers","leafletLayerHelpers","leafletControlHelpers",function(e,t,n,i,r,o){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:["$scope",function(e){e._leafletLayers=t.defer(),this.getLayers=function(){return e._leafletLayers.promise}}],link:function(e,t,a,s){var l=i.isDefined,c={},u=s.getLeafletScope(),d=u.layers,h=r.createLayer,p=r.safeAddLayer,f=r.safeRemoveLayer,g=o.updateLayersControl,m=!1;s.getMap().then((function(t){e._leafletLayers.resolve(c),n.setLayers(c,a.id),c.baselayers={},c.overlays={};var i=a.id,r=!1;for(var o in d.baselayers){var s=h(d.baselayers[o]);l(s)?(c.baselayers[o]=s,!0===d.baselayers[o].top&&(p(t,c.baselayers[o]),r=!0)):delete d.baselayers[o]}for(o in!r&&Object.keys(c.baselayers).length>0&&p(t,c.baselayers[Object.keys(d.baselayers)[0]]),d.overlays){d.overlays[o].type;var v=h(d.overlays[o]);l(v)?(c.overlays[o]=v,!0===d.overlays[o].visible&&p(t,c.overlays[o])):delete d.overlays[o]}u.$watch("layers.baselayers",(function(e,n){if(angular.equals(e,n))return m=g(t,i,m,e,d.overlays,c),!0;for(var r in c.baselayers)l(e[r])&&!e[r].doRefresh||(t.hasLayer(c.baselayers[r])&&t.removeLayer(c.baselayers[r]),delete c.baselayers[r],e[r]&&e[r].doRefresh&&(e[r].doRefresh=!1));for(var o in e)if(l(c.baselayers[o]))!0!==e[o].top||t.hasLayer(c.baselayers[o])?!1===e[o].top&&t.hasLayer(c.baselayers[o])&&t.removeLayer(c.baselayers[o]):p(t,c.baselayers[o]);else{var a=h(e[o]);l(a)&&(c.baselayers[o]=a,!0===e[o].top&&p(t,c.baselayers[o]))}var s=!1;for(var u in c.baselayers)if(t.hasLayer(c.baselayers[u])){s=!0;break}!s&&Object.keys(c.baselayers).length>0&&p(t,c.baselayers[Object.keys(c.baselayers)[0]]),m=g(t,i,m,e,d.overlays,c)}),!0),u.$watch("layers.overlays",(function(e,n){if(angular.equals(e,n))return m=g(t,i,m,d.baselayers,e,c),!0;for(var r in c.overlays)if(!l(e[r])||e[r].doRefresh){if(t.hasLayer(c.overlays[r])){var o=l(e[r])?e[r].layerOptions:null;f(t,c.overlays[r],o)}delete c.overlays[r],e[r]&&e[r].doRefresh&&(e[r].doRefresh=!1)}for(var a in e){if(l(c.overlays[a]))e[a].visible&&!t.hasLayer(c.overlays[a])?p(t,c.overlays[a]):!1===e[a].visible&&t.hasLayer(c.overlays[a])&&f(t,c.overlays[a],e[a].layerOptions);else{var s=h(e[a]);if(!l(s))continue;c.overlays[a]=s,!0===e[a].visible&&p(t,c.overlays[a])}e[a].visible&&t._loaded&&e[a].data&&"heatmap"===e[a].type&&(c.overlays[a].setData(e[a].data),c.overlays[a].update())}m=g(t,i,m,d.baselayers,e,c)}),!0)}))}}}]),angular.module("ui-leaflet").directive("legend",["leafletLogger","$http","$timeout","leafletHelpers","leafletLegendHelpers",function(e,t,n,i,r){var o=e,a=i.errorHeader+" [Legend] ";return{restrict:"A",scope:!1,replace:!1,require:"leaflet",transclude:!1,link:function(e,t,n,s){var l,c,u,d,h=i.isArray,p=i.isString,f=i.isDefined,g=i.isFunction,m=s.getLeafletScope(),v=m.legend;m.$watch("legend",(function(e){f(e)&&(l=e.legendClass?e.legendClass:"legend",c=e.position||"bottomright",d=e.type||"arcgis")}),!0);var y=function(e,t,n){t&&t.layers&&t.layers.length>0&&(f(u)?r.updateLegend(u.getContainer(),t,d,n):((u=L.control({position:c})).onAdd=r.getOnAddLegend(t,l,d,n),u.addTo(e)),f(v.loadedData)&&g(v.loadedData)&&v.loadedData())};s.getMap().then((function(e){m.$watch("legend",(function(t){f(t)?f(t.url)||"arcgis"!==d||h(t.colors)&&h(t.labels)&&t.colors.length===t.labels.length?f(t.url)?o.info(a+" loading legend service."):(f(u)&&(u.removeFrom(e),u=null),u=L.control({position:c}),"arcgis"===d&&(u.onAdd=r.getOnAddArrayLegend(t,l)),u.addTo(e)):o.warn(a+" legend.colors and legend.labels must be set."):f(u)&&(u.removeFrom(e),u=null)})),m.$watch("legend.url",(function(t){if(f(t))if(h(t)||p(t))for(var i,s=p(t)?[t]:t,l=function(n,r){return function(l){f(l.data.error)?o.warn(a+"Error loadin legend from: "+r,l.data.error.message):i&&i.layers&&i.layers.length>0?i.layers=i.layers.concat(l.data.layers):i=l.data,n===s.length-1&&y(e,i,t)}},c=function(e){o.warn(a+" legend.url not loaded.",e)},u=0;u<s.length;u++)r.addLegendURL(n.id,{url:s[u],method:"GET"}).then(l(u)).catch(c);else o.warn(a+" legend.url must be an array or string.")})),m.$watch("legend.legendData",(function(t){o.debug("legendData",t),!f(m.legend.url)&&f(t)&&y(e,t)}),!0)}))}}}]),angular.module("ui-leaflet").directive("markers",["leafletLogger","$rootScope","$q","leafletData","leafletHelpers","leafletMapDefaults","leafletMarkersHelpers","leafletMarkerEvents","leafletIterators","leafletWatchHelpers","leafletDirectiveControlsHelpers",function(e,t,n,i,r,o,a,s,l,c,u){var d=r.isDefined,h=r.errorHeader,p=r,f=r.isString,g=a.addMarkerWatcher,m=a.updateMarker,v=a.listenMarkerEvents,y=a.addMarkerToGroup,b=a.createMarker,_=a.deleteMarker,x=a.getModelFromModels,w=a.getLayerModels,S=l,T=r.watchOptions,E=c.maybeWatch,C=u.extend,k=e,P=function(e,t,n){if(Object.keys(e).length){if(n&&f(n)){if(!e[n]||!Object.keys(e[n]).length)return;return e[n][t]}return e[t]}},A=function(e,t,n,i){return i&&f(i)?(d(t[i])||(t[i]={}),t[i][n]=e):t[n]=e,e},O=function(e,t,n,i,r,o){if(!f(e))return k.error(h+" A layername must be a string"),!1;if(!d(t))return k.error(h+" You must add layers to the directive if the markers are going to use this functionality."),!1;if(!d(t.overlays)||!d(t.overlays[e]))return k.error(h+' A marker can only be added to a layer of type "group"'),!1;var a=t.overlays[e];return a instanceof L.LayerGroup||a instanceof L.FeatureGroup?(a.addLayer(i),!r&&o.hasLayer(i)&&!0===n.focus&&i.openPopup(),!0):(k.error(h+' Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"'),!1)},I=function(e,t,n,i,r,o,a,l,c,u){for(var f in t)if(!u[f])if(-1===f.search("-")){var _=p.copy(t[f]),w=p.getObjectDotPath(c?[c,f]:[f]),S=P(o,f,c);if(d(S)){var T=x(n,f,c);m(_,T,S,w,a,r,i)}else{var E=b(_),C=(_?_.layer:void 0)||c;if(!d(E)){k.error(h+" Received invalid data on the marker "+f+".");continue}if(A(E,o,f,c),d(_.message)&&E.bindPopup(_.message,_.popupOptions),d(_.group)){var L=d(_.groupOption)?_.groupOption:null;y(E,_.group,L,i)}if(p.LabelPlugin.isLoaded()&&d(_.label)&&d(_.label.message)&&E.bindLabel(_.label.message,_.label.options),d(_)&&(d(_.layer)||d(c))){if(!O(C,r,_,E,l.individual.doWatch,i))continue}else d(_.group)||(i.addLayer(E),l.individual.doWatch||!0!==_.focus||E.openPopup());l.individual.doWatch&&g(E,w,a,r,i,l.individual.isDeep),v(E,_,a,l.individual.doWatch,i),s.bindEvents(e,E,w,_,a,C)}}else k.error('The marker can\'t use a "-" on his key name: "'+f+'".')},D=function(e,t,n,i,r){var o,a,s=!1,l=!1,c=d(t);for(var u in n)s||(k.debug(h+"[markers] destroy: "),s=!0),c&&(a=e[u],o=t[u],l=angular.equals(a,o)&&i),d(e)&&Object.keys(e).length&&d(e[u])&&Object.keys(e[u]).length&&!l||r&&p.isFunction(r)&&r(a,o,u)},$=function(e,t,n,i,r){D(e,t,n,!1,(function(e,t,o){k.debug(h+"[marker] is deleting marker: "+o),_(n[o],i,r),delete n[o]}))},N=function(e,t,n){var i={};return D(e,t,n,!0,(function(e,t,n){k.debug(h+"[marker] is already rendered, marker: "+n),i[n]=e})),i};return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(e,t,r,o){var a=o[0],s=a.getLeafletScope();a.getMap().then((function(e){var t,a={};t=d(o[1])?o[1].getLayers:function(){var e=n.defer();return e.resolve(),e.promise};var l=s.markersWatchOptions||T;d(r.watchMarkers)&&(l.doWatch=l.individual.doWatch=!d(r.watchMarkers)||p.isTruthy(r.watchMarkers));var c=d(r.markersNested)&&p.isTruthy(r.markersNested);t().then((function(t){var n=function(n,i){c?S.each(n,(function(n,r){var o=w(i,r);$(n,o,a[r],e,t)})):$(n,i,a,e,t)},o=function(i,o){n(i,o);var u=null;c?S.each(i,(function(n,c){var d=w(o,c),h=w(i,c);u=N(h,d,a[c]),I(r.id,n,o,e,t,a,s,l,c,u)})):(u=N(i,o,a),I(r.id,i,o,e,t,a,s,l,void 0,u))};C(r.id,"markers",o,n),i.setMarkers(a,r.id),E(s,"markers",l,(function(e,t){o(e,t)}))}))}))}}}]),angular.module("ui-leaflet").directive("maxbounds",["leafletLogger","leafletMapDefaults","leafletBoundsHelpers","leafletHelpers",function(e,t,n,i){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,r,o){var a=o.getLeafletScope(),s=n.isValidBounds,l=i.isNumber;o.getMap().then((function(e){a.$watch("maxbounds",(function(t){if(s(t)){var i=n.createLeafletBounds(t);l(t.pad)&&(i=i.pad(t.pad)),e.setMaxBounds(i),r.center||r.lfCenter||e.fitBounds(i)}else e.setMaxBounds()}))}))}}}]),angular.module("ui-leaflet").directive("paths",["leafletLogger","$q","leafletData","leafletMapDefaults","leafletHelpers","leafletPathsHelpers","leafletPathEvents",function(e,t,n,i,r,o,a){var s=e;return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(e,l,c,u){var d=u[0],h=r.isDefined,p=r.isString,f=d.getLeafletScope(),g=f.paths,m=o.createPath,v=a.bindPathEvents,y=o.setPathOptions;d.getMap().then((function(e){var o,a=i.getDefaults(c.id);o=h(u[1])?u[1].getLayers:function(){var e=t.defer();return e.resolve(),e.promise},h(g)&&o().then((function(t){var i={};n.setPaths(i,c.id);var o=!h(c.watchPaths)||"true"===c.watchPaths,l=function(n,i){var r=f.$watch('paths["'+i+'"]',(function(i,o){if(!h(i)){if(h(o.layer))for(var a in t.overlays){t.overlays[a].removeLayer(n)}return e.removeLayer(n),void r()}y(n,i.type,i)}),!0)};f.$watchCollection("paths",(function(n){for(var u in i)h(n[u])||(e.removeLayer(i[u]),delete i[u]);for(var d in n)if(0!==d.search("\\$"))if(-1===d.search("-")){if(!h(i[d])){var g=n[d],b=m(d,n[d],a);if(h(b)&&h(g.message)&&b.bindPopup(g.message,g.popupOptions),r.LabelPlugin.isLoaded()&&h(g.label)&&h(g.label.message)&&b.bindLabel(g.label.message,g.label.options),h(g)&&h(g.layer)){if(!p(g.layer)){s.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!h(t)){s.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!h(t.overlays)||!h(t.overlays[g.layer])){s.error('[AngularJS - Leaflet] A path can only be added to a layer of type "group"');continue}var _=t.overlays[g.layer];if(!(_ instanceof L.LayerGroup||_ instanceof L.FeatureGroup)){s.error('[AngularJS - Leaflet] Adding a path to an overlay needs a overlay of the type "group" or "featureGroup"');continue}i[d]=b,_.addLayer(b),o?l(b,d):y(b,g.type,g)}else h(b)&&(i[d]=b,e.addLayer(b),o?l(b,d):y(b,g.type,g));v(c.id,b,d,g,f)}}else s.error('[AngularJS - Leaflet] The path name "'+d+'" is not valid. It must not include "-" and a number.')}))}))}))}}}]),angular.module("ui-leaflet").directive("tiles",["leafletLogger","leafletData","leafletMapDefaults","leafletHelpers",function(e,t,n,i){var r=e;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,o,a,s){var l=i.isDefined,c=s.getLeafletScope(),u=c.tiles;l(u)&&l(u.url)?s.getMap().then((function(e){var i,r=n.getDefaults(a.id);c.$watch("tiles",(function(n){var o=r.tileLayerOptions,s=r.tileLayer;if(l(n.url)||!l(i))return l(i)?l(n.url)&&l(n.options)&&!angular.equals(n.options,o)?(e.removeLayer(i),o=r.tileLayerOptions,angular.copy(n.options,o),s=n.url,(i=L.tileLayer(s,o)).addTo(e),void t.setTiles(i,a.id)):void(l(n.url)&&i.setUrl(n.url)):(l(n.options)&&angular.copy(n.options,o),l(n.url)&&(s=n.url),(i=L.tileLayer(s,o)).addTo(e),void t.setTiles(i,a.id));e.removeLayer(i)}),!0)})):r.warn("[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.")}}}]),["markers","geojson"].forEach((function(e){angular.module("ui-leaflet").directive(e+"WatchOptions",["$log","$rootScope","$q","leafletData","leafletHelpers",function(t,n,i,r,o){var a=o.isDefined,s=o.errorHeader,l=o.isObject,c=o.watchOptions,u=t;return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(t,n,i,r){var o=r[0],d=o.getLeafletScope();o.getMap().then((function(){a(t[e+"WatchOptions"])&&(l(t[e+"WatchOptions"])?angular.extend(c,t[e+"WatchOptions"]):u.error(s+"["+e+"WatchOptions] is not an object"),d[e+"WatchOptions"]=c)}))}}}])})),angular.module("ui-leaflet").factory("leafletEventsHelpersFactory",["$rootScope","$q","leafletLogger","leafletHelpers",function(e,t,n,i){var r=i.safeApply,o=i.isDefined,a=i.isObject,s=i.isArray,l=i.errorHeader,c=n,u=function(e,t){this.rootBroadcastName=e,c.debug("leafletEventsHelpersFactory: lObjectType: "+t+"rootBroadcastName: "+e),this.lObjectType=t};return u.prototype.getAvailableEvents=function(){return[]},u.prototype.genDispatchEvent=function(e,t,n,i,r,o,a,s,l){var u=this;return(e=e||"")&&(e="."+e),function(d){var h=u.rootBroadcastName+e+"."+t;c.debug(h),u.fire(i,h,n,d,d.target||r,a,o,s,l)}},u.prototype.fire=function(t,n,i,a,s,l,c,u,d){r(t,(function(){var r={leafletEvent:a,leafletObject:s,modelName:c,model:l};o(u)&&angular.extend(r,{layerName:u}),"emit"===i?t.$emit(n,r):e.$broadcast(n,r)}))},u.prototype.bindEvents=function(e,t,n,i,r,u,d){var h=[],p=this;if(o(r.eventBroadcast))if(a(r.eventBroadcast))if(o(r.eventBroadcast[p.lObjectType]))if(a(r.eventBroadcast[p.lObjectType])){o(r.eventBroadcast[this.lObjectType].logic)&&"emit"!==r.eventBroadcast[p.lObjectType].logic&&"broadcast"!==r.eventBroadcast[p.lObjectType].logic&&c.warn(l+"Available event propagation logic are: 'emit' or 'broadcast'.");var f=!1,g=!1;o(r.eventBroadcast[p.lObjectType].enable)&&s(r.eventBroadcast[p.lObjectType].enable)&&(f=!0),o(r.eventBroadcast[p.lObjectType].disable)&&s(r.eventBroadcast[p.lObjectType].disable)&&(g=!0),f&&g?c.warn(l+"can not enable and disable events at the same time"):f||g?f?r.eventBroadcast[this.lObjectType].enable.forEach((function(e){-1!==h.indexOf(e)?c.warn(l+"This event "+e+" is already enabled"):-1===p.getAvailableEvents().indexOf(e)?c.warn(l+"This event "+e+" does not exist"):h.push(e)})):(h=this.getAvailableEvents(),r.eventBroadcast[p.lObjectType].disable.forEach((function(e){var t=h.indexOf(e);-1===t?c.warn(l+"This event "+e+" does not exist or has been already disabled"):h.splice(t,1)}))):c.warn(l+"must enable or disable events")}else c.warn(l+"event-broadcast."+[p.lObjectType]+" must be an object check your model.");else h=this.getAvailableEvents();else c.error(l+"event-broadcast must be an object check your model.");else h=this.getAvailableEvents();return h.forEach((function(o){t.on(o,p.genDispatchEvent(e,o,"emit",r,t,n,i,u,d))})),"emit"},u}]).service("leafletEventsHelpers",["leafletEventsHelpersFactory",function(e){return new e}]),angular.module("ui-leaflet").factory("leafletGeoJsonEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpersFactory","leafletData",function(e,t,n,i,r,o){var a=i.safeApply,s=r,l=function(){s.call(this,"leafletDirectiveGeoJson","geojson")};return(l.prototype=new s).genDispatchEvent=function(t,n,i,r,l,c,u,d,h){var p=s.prototype.genDispatchEvent.call(this,t,n,i,r,l,c,u,d),f=this;return function(t){"mouseout"===n&&(h.resetStyleOnMouseout&&o.getGeoJSON(h.mapId).then((function(e){(d?e[d]:e).resetStyle(t.target)})),a(r,(function(){e.$broadcast(f.rootBroadcastName+".mouseout",t)}))),p(t)}},l.prototype.getAvailableEvents=function(){return["click","dblclick","mouseover","mouseout"]},new l}]),angular.module("ui-leaflet").factory("leafletLabelEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpersFactory",function(e,t,n,i,r){var o=i,a=r,s=function(){a.call(this,"leafletDirectiveLabel","markers")};return(s.prototype=new a).genDispatchEvent=function(e,t,n,i,r,o,s,l){var c=o.replace("markers.","");return a.prototype.genDispatchEvent.call(this,e,t,n,i,r,c,s,l)},s.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu"]},s.prototype.genEvents=function(e,t,n,i,r,a,s,l){var c=this,u=this.getAvailableEvents(),d=o.getObjectArrayPath("markers."+a);u.forEach((function(t){r.label.on(t,c.genDispatchEvent(e,t,n,i,r.label,d,s,l))}))},s.prototype.bindEvents=function(e,t,n,i,r,o){},new s}]),angular.module("ui-leaflet").factory("leafletMapEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpers","leafletIterators",function(e,t,n,i,r,o){var a=i.isDefined,s=r.fire,l=function(e,t,i,r){return r&&(r+="."),function(o){var a="leafletDirectiveMap."+r+t;n.debug(a),s(e,a,i,o,o.target,e)}};return{getAvailableMapEvents:function(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomanim","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose","draw:created","draw:edited","draw:deleted","draw:drawstart","draw:drawstop","draw:editstart","draw:editstop","draw:deletestart","draw:deletestop"]},genDispatchMapEvent:l,notifyCenterChangedToBounds:function(e){e.$broadcast("boundsChanged")},notifyCenterUrlHashChanged:function(e,t,n,i){if(a(n.urlHashCenter)){var r=t.getCenter(),o=r.lat.toFixed(4)+":"+r.lng.toFixed(4)+":"+t.getZoom();a(i.c)&&i.c===o||e.$emit("centerUrlHash",o)}},addEvents:function(e,t,n,i,r){o.each(t,(function(t){var o={};o[n]=t,e.on(t,l(i,t,r,e._container.id||""),o)}))}}}]),angular.module("ui-leaflet").factory("leafletMarkerEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpersFactory","leafletLabelEvents",function(e,t,n,i,r,o){var a=i.safeApply,s=i.isDefined,l=i,c=o,u=r,d=function(){u.call(this,"leafletDirectiveMarker","markers")};return(d.prototype=new u).genDispatchEvent=function(t,n,i,r,o,s,l,c){var d=u.prototype.genDispatchEvent.call(this,t,n,i,r,o,s,l,c);return function(t){"click"===n?a(r,(function(){e.$broadcast("leafletDirectiveMarkersClick",s)})):"dragend"===n&&(a(r,(function(){l.lat=o.getLatLng().lat,l.lng=o.getLatLng().lng})),l.message&&!0===l.focus&&o.openPopup()),d(t)}},d.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose","touchend","touchstart","touchmove","touchcancel","touchleave"]},d.prototype.bindEvents=function(e,t,n,i,r,o){var a=u.prototype.bindEvents.call(this,e,t,n,i,r,o);l.LabelPlugin.isLoaded()&&s(t.label)&&c.genEvents(e,n,a,r,t,i,o)},new d}]),angular.module("ui-leaflet").factory("leafletPathEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletLabelEvents","leafletEventsHelpers",function(e,t,n,i,r,o){var a=i.isDefined,s=i.isObject,l=i,c=i.errorHeader,u=r,d=o.fire,h=n,p=function(e,t,n,i,r,o,a,s){return(e=e||"")&&(e="."+e),function(l){var c="leafletDirectivePath"+e+"."+t;h.debug(c),d(i,c,n,l,l.target||r,a,o,s)}},f=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","add","remove","popupopen","popupclose"]};return{getAvailablePathEvents:f,bindPathEvents:function(e,t,n,i,r){var o,d,g=[],m="broadcast";if(a(r.eventBroadcast))if(s(r.eventBroadcast))if(a(r.eventBroadcast.path))if(s(r.eventBroadcast.paths))h.warn(c+"event-broadcast.path must be an object check your model.");else{void 0!==r.eventBroadcast.path.logic&&null!==r.eventBroadcast.path.logic&&("emit"!==r.eventBroadcast.path.logic&&"broadcast"!==r.eventBroadcast.path.logic?h.warn(c+"Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===r.eventBroadcast.path.logic&&(m="emit"));var v=!1,y=!1;if(void 0!==r.eventBroadcast.path.enable&&null!==r.eventBroadcast.path.enable&&"object"==typeof r.eventBroadcast.path.enable&&(v=!0),void 0!==r.eventBroadcast.path.disable&&null!==r.eventBroadcast.path.disable&&"object"==typeof r.eventBroadcast.path.disable&&(y=!0),v&&y)h.warn(c+"can not enable and disable events at the same time");else if(v||y)if(v)for(o=0;o<r.eventBroadcast.path.enable.length;o++)d=r.eventBroadcast.path.enable[o],-1!==g.indexOf(d)?h.warn(c+"This event "+d+" is already enabled"):-1===f().indexOf(d)?h.warn(c+"This event "+d+" does not exist"):g.push(d);else for(g=f(),o=0;o<r.eventBroadcast.path.disable.length;o++){d=r.eventBroadcast.path.disable[o];var b=g.indexOf(d);-1===b?h.warn(c+"This event "+d+" does not exist or has been already disabled"):g.splice(b,1)}else h.warn(c+"must enable or disable events")}else g=f();else h.error(c+"event-broadcast must be an object check your model.");else g=f();for(o=0;o<g.length;o++)d=g[o],t.on(d,p(e,d,m,r,g,n));l.LabelPlugin.isLoaded()&&a(t.label)&&u.genEvents(e,n,m,r,t,i)}}}])}(angular)},function(e,t,n){(function(n){
/**
 * oclazyload - Load modules on demand (lazy load) with angularJS
 * @version v1.0.10
 * @link https://github.com/ocombe/ocLazyLoad
 * @license MIT
 * @author Olivier Combe <olivier.combe@gmail.com>
 */
!function(n,i){"use strict";var r=["ng","oc.lazyLoad"],o={},a=[],s=[],l=[],c=[],u=n.noop,d={},h=[];n.module("oc.lazyLoad",["ng"]).provider("$ocLazyLoad",["$controllerProvider","$provide","$compileProvider","$filterProvider","$injector","$animateProvider",function(e,t,p,m,v,y){var b={},_={$controllerProvider:e,$compileProvider:p,$filterProvider:m,$provide:t,$injector:v,$animateProvider:y},x=!1,w=!1,S=[],T={};S.push=function(e){-1===this.indexOf(e)&&Array.prototype.push.apply(this,arguments)},this.config=function(e){n.isDefined(e.modules)&&(n.isArray(e.modules)?n.forEach(e.modules,(function(e){b[e.name]=e})):b[e.modules.name]=e.modules),n.isDefined(e.debug)&&(x=e.debug),n.isDefined(e.events)&&(w=e.events)},this._init=function(e){if(0===s.length){var t=[e],o=["ng:app","ng-app","x-ng-app","data-ng-app"],a=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/,l=function(e){return e&&t.push(e)};n.forEach(o,(function(t){o[t]=!0,l(document.getElementById(t)),t=t.replace(":","\\:"),void 0!==e[0]&&e[0].querySelectorAll&&(n.forEach(e[0].querySelectorAll("."+t),l),n.forEach(e[0].querySelectorAll("."+t+"\\:"),l),n.forEach(e[0].querySelectorAll("["+t+"]"),l))})),n.forEach(t,(function(t){if(0===s.length){var i=" "+e.className+" ",r=a.exec(i);r?s.push((r[2]||"").replace(/\s+/g,",")):n.forEach(t.attributes,(function(e){0===s.length&&o[e.name]&&s.push(e.value)}))}}))}0!==s.length||(i.jasmine||i.mocha)&&n.isDefined(n.mock)||console.error("No module found during bootstrap, unable to init ocLazyLoad. You should always use the ng-app directive or angular.boostrap when you use ocLazyLoad.");n.forEach(s,(function(e){!function e(t){if(-1===r.indexOf(t)){r.push(t);var i=n.module(t);P(null,i._invokeQueue,t),P(null,i._configBlocks,t),n.forEach(i.requires,e)}}(e)})),s=[],c.pop()};var E=function(e){try{return JSON.stringify(e)}catch(i){var t=[];return JSON.stringify(e,(function(e,i){if(n.isObject(i)&&null!==i){if(-1!==t.indexOf(i))return;t.push(i)}return i}))}},C=function(e){var t,n,i=0;if(0==e.length)return i;for(t=0,n=e.length;t<n;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i};function k(e,t,i){if(t){var o,a,s,c=[];for(o=t.length-1;o>=0;o--)if(a=t[o],n.isString(a)||(a=A(a)),a&&-1===h.indexOf(a)&&(!b[a]||-1!==l.indexOf(a))){var p=-1===r.indexOf(a);if(s=g(a),p&&(r.push(a),k(e,s.requires,i)),s._runBlocks.length>0)for(d[a]=[];s._runBlocks.length>0;)d[a].push(s._runBlocks.shift());n.isDefined(d[a])&&(p||i.rerun)&&(c=c.concat(d[a])),P(e,s._invokeQueue,a,i.reconfig),P(e,s._configBlocks,a,i.reconfig),u(p?"ocLazyLoad.moduleLoaded":"ocLazyLoad.moduleReloaded",a),t.pop(),h.push(a)}var f=e.getInstanceInjector();n.forEach(c,(function(e){f.invoke(e)}))}}function L(e,t){var i=e[2][0],r=e[1],a=!1;n.isUndefined(o[t])&&(o[t]={}),n.isUndefined(o[t][r])&&(o[t][r]={});var s=function(e,i){o[t][r].hasOwnProperty(e)||(o[t][r][e]=[]),function(e,t){var i,r=!0;t.length&&(i=l(e),n.forEach(t,(function(e){r=r&&l(e)!==i})));return r}(i,o[t][r][e])&&(a=!0,o[t][r][e].push(i),u("ocLazyLoad.componentLoaded",[t,r,e]))};function l(e){return n.isArray(e)?C(e.toString()):n.isObject(e)?C(E(e)):n.isDefined(e)&&null!==e?C(e.toString()):e}if(n.isString(i))s(i,e[2][1]);else{if(!n.isObject(i))return!1;n.forEach(i,(function(e,t){n.isString(e)?s(e,i[1]):s(t,e)}))}return a}function P(e,t,i,r){var o,s,l,c;if(t)for(o=0,s=t.length;o<s;o++)if(l=t[o],n.isArray(l)){if(null!==e){if(!e.hasOwnProperty(l[0]))throw new Error("unsupported provider "+l[0]);c=e[l[0]]}var u=L(l,i);if("invoke"!==l[1])u&&n.isDefined(c)&&c[l[1]].apply(c,l[2]);else{var d=function(e){var t=a.indexOf(i+"-"+e);(-1===t||r)&&(-1===t&&a.push(i+"-"+e),n.isDefined(c)&&c[l[1]].apply(c,l[2]))};if(n.isFunction(l[2][0]))d(l[2][0]);else if(n.isArray(l[2][0]))for(var h=0,p=l[2][0].length;h<p;h++)n.isFunction(l[2][0][h])&&d(l[2][0][h])}}}function A(e){var t=null;return n.isString(e)?t=e:n.isObject(e)&&e.hasOwnProperty("name")&&n.isString(e.name)&&(t=e.name),t}function O(e){if(!n.isString(e))return!1;try{return g(e)}catch(e){if(/No module/.test(e)||e.message.indexOf("$injector:nomod")>-1)return!1}}this.$get=["$log","$rootElement","$rootScope","$cacheFactory","$q",function(e,t,i,a,l){var d,p=a("ocLazyLoad");function m(t){var n=l.defer();return e.error(t.message),n.reject(t),n.promise}return x||((e={}).error=n.noop,e.warn=n.noop,e.info=n.noop),_.getInstanceInjector=function(){return d||(d=t.data("$injector")||n.injector())},{_broadcast:u=function(t,n){w&&i.$broadcast(t,n),x&&e.info(t,n)},_$log:e,_getFilesCache:function(){return p},toggleWatch:function(e){e?c.push(!0):c.pop()},getModuleConfig:function(e){if(!n.isString(e))throw new Error("You need to give the name of the module to get");return b[e]?n.copy(b[e]):null},setModuleConfig:function(e){if(!n.isObject(e))throw new Error("You need to give the module config object to set");return b[e.name]=e,e},getModules:function(){return r},isLoaded:function(e){var t=function(e){var t=r.indexOf(e)>-1;return t||(t=!!O(e)),t};if(n.isString(e)&&(e=[e]),n.isArray(e)){var i,o;for(i=0,o=e.length;i<o;i++)if(!t(e[i]))return!1;return!0}throw new Error("You need to define the module(s) name(s)")},_getModuleName:A,_getModule:function(e){try{return g(e)}catch(t){throw(/No module/.test(t)||t.message.indexOf("$injector:nomod")>-1)&&(t.message='The module "'+E(e)+'" that you are trying to load does not exist. '+t.message),t}},moduleExists:O,_loadDependencies:function(e,t){var i,r,o,a=[],s=this;if(null===(e=s._getModuleName(e)))return l.when();try{i=s._getModule(e)}catch(e){return m(e)}return r=s.getRequires(i),n.forEach(r,(function(i){if(n.isString(i)){var r=s.getModuleConfig(i);if(null===r)return void S.push(i);i=r,r.name=void 0}if(s.moduleExists(i.name))return 0!==(o=i.files.filter((function(e){return s.getModuleConfig(i.name).files.indexOf(e)<0}))).length&&s._$log.warn('Module "',e,'" attempted to redefine configuration for dependency. "',i.name,'"\n Additional Files Loaded:',o),n.isDefined(s.filesLoader)?void a.push(s.filesLoader(i,t).then((function(){return s._loadDependencies(i)}))):m(new Error("Error: New dependencies need to be loaded from external files ("+i.files+"), but no loader has been defined."));if(n.isArray(i)){var l=[];n.forEach(i,(function(e){var t=s.getModuleConfig(e);null===t?l.push(e):t.files&&(l=l.concat(t.files))})),l.length>0&&(i={files:l})}else n.isObject(i)&&i.hasOwnProperty("name")&&i.name&&(s.setModuleConfig(i),S.push(i.name));if(n.isDefined(i.files)&&0!==i.files.length){if(!n.isDefined(s.filesLoader))return m(new Error('Error: the module "'+i.name+'" is defined in external files ('+i.files+"), but no loader has been defined."));a.push(s.filesLoader(i,t).then((function(){return s._loadDependencies(i)})))}})),l.all(a)},inject:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],r=this,o=l.defer();if(n.isDefined(e)&&null!==e){if(n.isArray(e)){var a=[];return n.forEach(e,(function(e){a.push(r.inject(e,t,i))})),l.all(a)}r._addToLoadList(r._getModuleName(e),!0,i)}if(s.length>0){var c=s.slice(),u=function e(n){S.push(n),T[n]=o.promise,r._loadDependencies(n,t).then((function(){try{h=[],k(_,S,t)}catch(e){return r._$log.error(e.message),void o.reject(e)}s.length>0?e(s.shift()):o.resolve(c)}),(function(e){o.reject(e)}))};u(s.shift())}else{if(t&&t.name&&T[t.name])return T[t.name];o.resolve()}return o.promise},getRequires:function(e){var t=[];return n.forEach(e.requires,(function(e){-1===r.indexOf(e)&&t.push(e)})),t},_invokeQueue:P,_registerInvokeList:L,_register:k,_addToLoadList:f,_unregister:function(e){n.isDefined(e)&&n.isArray(e)&&n.forEach(e,(function(e){o[e]=void 0}))}}}],this._init(n.element(i.document))}]);var p=n.bootstrap;n.bootstrap=function(e,t,i){return r=["ng","oc.lazyLoad"],o={},a=[],s=[],l=[],c=[],u=n.noop,d={},h=[],n.forEach(t.slice(),(function(e){f(e,!0,!0)})),p(e,t,i)};var f=function(e,t,i){(c.length>0||t)&&n.isString(e)&&-1===s.indexOf(e)&&(s.push(e),i&&l.push(e))},g=n.module;n.module=function(e,t,n){return f(e,!1,!0),g(e,t,n)},e.exports===t&&(e.exports="oc.lazyLoad")}(angular,window),function(e){"use strict";e.module("oc.lazyLoad").directive("ocLazyLoad",["$ocLazyLoad","$compile","$animate","$parse","$timeout",function(t,n,i,r,o){return{restrict:"A",terminal:!0,priority:1e3,compile:function(o,a){var s=o[0].innerHTML;return o.html(""),function(o,a,l){var c=r(l.ocLazyLoad);o.$watch((function(){return c(o)||l.ocLazyLoad}),(function(r){e.isDefined(r)&&t.load(r).then((function(){i.enter(s,a),n(a.contents())(o)}))}),!0)}}}}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(t){t.decorator("$ocLazyLoad",["$delegate","$q","$window","$interval",function(t,i,r,o){var a=!1,s=r.document.getElementsByTagName("head")[0]||r.document.getElementsByTagName("body")[0];return t.buildElement=function(l,c,u){var d,h,p=i.defer(),f=t._getFilesCache(),g=function(e){var t=(new Date).getTime();return e.indexOf("?")>=0?"&"===e.substring(0,e.length-1)?e+"_dc="+t:e+"&_dc="+t:e+"?_dc="+t};switch(e.isUndefined(f.get(c))&&f.put(c,p.promise),l){case"css":(d=r.document.createElement("link")).type="text/css",d.rel="stylesheet",d.href=!1===u.cache?g(c):c;break;case"js":(d=r.document.createElement("script")).src=!1===u.cache?g(c):c;break;default:f.remove(c),p.reject(new Error('Requested type "'+l+'" is not known. Could not inject "'+c+'"'))}d.onload=d.onreadystatechange=function(e){d.readyState&&!/^c|loade/.test(d.readyState)||h||(d.onload=d.onreadystatechange=null,h=1,t._broadcast("ocLazyLoad.fileLoaded",c),p.resolve(d))},d.onerror=function(){f.remove(c),p.reject(new Error("Unable to load "+c))},d.async=u.serie?0:1;var m=s.lastChild;if(u.insertBefore){var v=e.element(e.isDefined(n)?u.insertBefore:document.querySelector(u.insertBefore));v&&v.length>0&&(m=v[0])}if(m.parentNode.insertBefore(d,m),"css"==l){var y=r.navigator.userAgent.toLowerCase();if(y.indexOf("phantomjs/1.9")>-1)a=!0;else if(/iP(hone|od|ad)/.test(r.navigator.platform)){var b=r.navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),_=parseFloat([parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3]||0,10)].join("."));a=_<6}else if(y.indexOf("android")>-1){var x=parseFloat(y.slice(y.indexOf("android")+8));a=x<4.4}else if(y.indexOf("safari")>-1){var w=y.match(/version\/([\.\d]+)/i);a=w&&w[1]&&parseFloat(w[1])<6}if(a)var S=1e3,T=o((function(){try{d.sheet.cssRules,o.cancel(T),d.onload()}catch(e){--S<=0&&d.onerror()}}),20)}return p.promise},t}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(t){t.decorator("$ocLazyLoad",["$delegate","$q",function(t,n){return t.filesLoader=function(i){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=[],a=[],s=[],l=[],c=null,u=t._getFilesCache();t.toggleWatch(!0),e.extend(r,i);var d=function(n){var i,d=null;if(e.isObject(n)&&(d=n.type,n=n.path),c=u.get(n),e.isUndefined(c)||!1===r.cache){if(null!==(i=/^(css|less|html|htm|js)?(?=!)/.exec(n))&&(d=i[1],n=n.substr(i[1].length+1,n.length)),!d)if(null!==(i=/[.](css|less|html|htm|js)?((\?|#).*)?$/.exec(n)))d=i[1];else{if(t.jsLoader.hasOwnProperty("ocLazyLoadLoader")||!t.jsLoader.hasOwnProperty("requirejs"))return void t._$log.error("File type could not be determined. "+n);d="js"}"css"!==d&&"less"!==d||-1!==o.indexOf(n)?"html"!==d&&"htm"!==d||-1!==a.indexOf(n)?"js"===d||-1===s.indexOf(n)?s.push(n):t._$log.error("File type is not valid. "+n):a.push(n):o.push(n)}else c&&l.push(c)};if(r.serie?d(r.files.shift()):e.forEach(r.files,(function(e){d(e)})),o.length>0){var h=n.defer();t.cssLoader(o,(function(n){e.isDefined(n)&&t.cssLoader.hasOwnProperty("ocLazyLoadLoader")?(t._$log.error(n),h.reject(n)):h.resolve()}),r),l.push(h.promise)}if(a.length>0){var p=n.defer();t.templatesLoader(a,(function(n){e.isDefined(n)&&t.templatesLoader.hasOwnProperty("ocLazyLoadLoader")?(t._$log.error(n),p.reject(n)):p.resolve()}),r),l.push(p.promise)}if(s.length>0){var f=n.defer();t.jsLoader(s,(function(n){e.isDefined(n)&&(t.jsLoader.hasOwnProperty("ocLazyLoadLoader")||t.jsLoader.hasOwnProperty("requirejs"))?(t._$log.error(n),f.reject(n)):f.resolve()}),r),l.push(f.promise)}if(0===l.length){var g=n.defer(),m="Error: no file to load has been found, if you're trying to load an existing module you should use the 'inject' method instead of 'load'.";return t._$log.error(m),g.reject(m),g.promise}return r.serie&&r.files.length>0?n.all(l).then((function(){return t.filesLoader(i,r)})):n.all(l).finally((function(e){return t.toggleWatch(!1),e}))},t.load=function(i){var r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=this,s=null,l=[],c=n.defer(),u=e.copy(i),d=e.copy(o);if(e.isArray(u))return e.forEach(u,(function(e){l.push(a.load(e,d))})),n.all(l).then((function(e){c.resolve(e)}),(function(e){c.reject(e)})),c.promise;if(e.isString(u)?(s=a.getModuleConfig(u))||(s={files:[u]}):e.isObject(u)&&(s=e.isDefined(u.path)&&e.isDefined(u.type)?{files:[u]}:a.setModuleConfig(u)),null===s){var h=a._getModuleName(u);return r='Module "'+(h||"unknown")+'" is not configured, cannot load.',t._$log.error(r),c.reject(new Error(r)),c.promise}e.isDefined(s.template)&&(e.isUndefined(s.files)&&(s.files=[]),e.isString(s.template)?s.files.push(s.template):e.isArray(s.template)&&s.files.concat(s.template));var p=e.extend({},d,s);return e.isUndefined(s.files)&&e.isDefined(s.name)&&t.moduleExists(s.name)?t.inject(s.name,p,!0):(t.filesLoader(s,p).then((function(){t.inject(null,p).then((function(e){c.resolve(e)}),(function(e){c.reject(e)}))}),(function(e){c.reject(e)})),c.promise)},t}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(t){t.decorator("$ocLazyLoad",["$delegate","$q",function(t,n){return t.cssLoader=function(i,r,o){var a=[];e.forEach(i,(function(e){a.push(t.buildElement("css",e,o))})),n.all(a).then((function(){r()}),(function(e){r(e)}))},t.cssLoader.ocLazyLoadLoader=!0,t}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(t){t.decorator("$ocLazyLoad",["$delegate","$q",function(t,n){return t.jsLoader=function(i,r,o){var a=[];e.forEach(i,(function(e){a.push(t.buildElement("js",e,o))})),n.all(a).then((function(){r()}),(function(e){r(e)}))},t.jsLoader.ocLazyLoadLoader=!0,t}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(t){t.decorator("$ocLazyLoad",["$delegate","$templateCache","$q","$http",function(t,n,i,r){return t.templatesLoader=function(o,a,s){var l=[],c=t._getFilesCache();return e.forEach(o,(function(t){var o=i.defer();l.push(o.promise),r.get(t,s).then((function(i){var r=i.data;e.isString(r)&&r.length>0&&e.forEach(e.element(r),(function(e){"SCRIPT"===e.nodeName&&"text/ng-template"===e.type&&n.put(e.id,e.innerHTML)})),e.isUndefined(c.get(t))&&c.put(t,!0),o.resolve()})).catch((function(e){o.reject(new Error('Unable to load template file "'+t+'": '+e.data))}))})),i.all(l).then((function(){a()}),(function(e){a(e)}))},t.templatesLoader.ocLazyLoadLoader=!0,t}])}])}(angular),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(0===r)return-1;var o=+t||0;if(Math.abs(o)===1/0&&(o=0),o>=r)return-1;for(n=Math.max(o>=0?o:r-Math.abs(o),0);n<r;){if(n in i&&i[n]===e)return n;n++}return-1})}).call(this,n(0))},function(e,t,n){n(2),n(7),n(9),n(18),n(10),n(11),n(4),n(12),n(13),n(19),n(6),n(14),n(56),n(21),n(57),n(58),n(59),n(60),n(16),n(23),n(22),n(61),n(62),n(15),n(5),n(63),n(64),n(65),n(66),n(67),n(68),n(3),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(24),n(81),n(25),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(102)},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Droppable 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(14),n(5),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){e.widget("ui.droppable",{version:"1.14.0",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept="function"==typeof n?n:function(e){return e.is(n)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(t.scope),t.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,n){if("accept"===t)this.accept="function"==typeof n?n:function(e){return e.is(n)};else if("scope"===t){var i=e.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(n)}this._super(t,n)},_activate:function(t){var n=e.ui.ddmanager.current;this._addActiveClass(),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this._removeActiveClass(),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var i=n||e.ui.ddmanager.current,r=!1;return!(!i||(i.currentItem||i.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var n=e(this).droppable("instance");if(n.options.greedy&&!n.options.disabled&&n.options.scope===i.options.scope&&n.accept.call(n.element[0],i.currentItem||i.element)&&e.ui.intersect(i,e.extend(n,{offset:n.element.offset()}),n.options.tolerance,t))return r=!0,!1})),!r&&(!!this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",t,this.ui(i)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),e.ui.intersect=function(){function e(e,t,n){return e>=t&&e<t+n}return function(t,n,i,r){if(!n.offset)return!1;var o=(t.positionAbs||t.position.absolute).left+t.margins.left,a=(t.positionAbs||t.position.absolute).top+t.margins.top,s=o+t.helperProportions.width,l=a+t.helperProportions.height,c=n.offset.left,u=n.offset.top,d=c+n.proportions().width,h=u+n.proportions().height;switch(i){case"fit":return c<=o&&s<=d&&u<=a&&l<=h;case"intersect":return c<o+t.helperProportions.width/2&&s-t.helperProportions.width/2<d&&u<a+t.helperProportions.height/2&&l-t.helperProportions.height/2<h;case"pointer":return e(r.pageY,u,n.proportions().height)&&e(r.pageX,c,n.proportions().width);case"touch":return(a>=u&&a<=h||l>=u&&l<=h||a<u&&l>h)&&(o>=c&&o<=d||s>=c&&s<=d||o<c&&s>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,n){var i,r,o=e.ui.ddmanager.droppables[t.options.scope]||[],a=n?n.type:null,s=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||t&&!o[i].accept.call(o[i].element[0],t.currentItem||t.element))){for(r=0;r<s.length;r++)if(s[r]===o[i].element[0]){o[i].proportions().height=0;continue e}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===a&&o[i]._activate.call(o[i],n),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(t,n){var i=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,n)&&(i=this._drop.call(this,n)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))})),i},dragStart:function(t,n){t.element.parentsUntil("body").on("scroll.droppable",(function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}))},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,r,o,a=e.ui.intersect(t,this,this.options.tolerance,n),s=!a&&this.isover?"isout":a&&!this.isover?"isover":null;s&&(this.options.greedy&&(r=this.options.scope,(o=this.element.parents(":data(ui-droppable)").filter((function(){return e(this).droppable("instance").options.scope===r}))).length&&((i=e(o[0]).droppable("instance")).greedyChild="isover"===s)),i&&"isover"===s&&(i.isover=!1,i.isout=!0,i._out.call(i,n)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,n),i&&"isout"===s&&(i.isout=!1,i.isover=!0,i._over.call(i,n)))}}))},dragStop:function(t,n){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}},!0===e.uiBackCompat&&e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}});return e.ui.droppable})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Selectable 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(5),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.selectable",e.ui.mouse,{version:"1.14.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t.elementPos=e(t.element[0]).offset(),t.selectees=e(t.options.filter,t.element[0]),t._addClass(t.selectees,"ui-selectee"),t.selectees.each((function(){var n=e(this),i=n.offset(),r={left:i.left-t.elementPos.left,top:i.top-t.elementPos.top};e.data(this,"selectable-item",{element:this,$element:n,left:r.left,top:r.top,right:r.left+n.outerWidth(),bottom:r.top+n.outerHeight(),startselected:!1,selected:n.hasClass("ui-selected"),selecting:n.hasClass("ui-selecting"),unselecting:n.hasClass("ui-unselecting")})}))},this.refresh(),this._mouseInit(),this.helper=e("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(t){var n=this,i=this.options;this.opos=[t.pageX,t.pageY],this.elementPos=e(this.element[0]).offset(),this.options.disabled||(this.selectees=e(i.filter,this.element[0]),this._trigger("start",t),e(i.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var i=e.data(this,"selectable-item");i.startselected=!0,t.metaKey||t.ctrlKey||(n._removeClass(i.$element,"ui-selected"),i.selected=!1,n._addClass(i.$element,"ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",t,{unselecting:i.element}))})),e(t.target).parents().addBack().each((function(){var i,r=e.data(this,"selectable-item");if(r)return i=!t.metaKey&&!t.ctrlKey||!r.$element.hasClass("ui-selected"),n._removeClass(r.$element,i?"ui-unselecting":"ui-selected")._addClass(r.$element,i?"ui-selecting":"ui-unselecting"),r.unselecting=!i,r.selecting=i,r.selected=i,i?n._trigger("selecting",t,{selecting:r.element}):n._trigger("unselecting",t,{unselecting:r.element}),!1})))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var n,i=this,r=this.options,o=this.opos[0],a=this.opos[1],s=t.pageX,l=t.pageY;return o>s&&(n=s,s=o,o=n),a>l&&(n=l,l=a,a=n),this.helper.css({left:o,top:a,width:s-o,height:l-a}),this.selectees.each((function(){var n=e.data(this,"selectable-item"),c=!1,u={};n&&n.element!==i.element[0]&&(u.left=n.left+i.elementPos.left,u.right=n.right+i.elementPos.left,u.top=n.top+i.elementPos.top,u.bottom=n.bottom+i.elementPos.top,"touch"===r.tolerance?c=!(u.left>s||u.right<o||u.top>l||u.bottom<a):"fit"===r.tolerance&&(c=u.left>o&&u.right<s&&u.top>a&&u.bottom<l),c?(n.selected&&(i._removeClass(n.$element,"ui-selected"),n.selected=!1),n.unselecting&&(i._removeClass(n.$element,"ui-unselecting"),n.unselecting=!1),n.selecting||(i._addClass(n.$element,"ui-selecting"),n.selecting=!0,i._trigger("selecting",t,{selecting:n.element}))):(n.selecting&&((t.metaKey||t.ctrlKey)&&n.startselected?(i._removeClass(n.$element,"ui-selecting"),n.selecting=!1,i._addClass(n.$element,"ui-selected"),n.selected=!0):(i._removeClass(n.$element,"ui-selecting"),n.selecting=!1,n.startselected&&(i._addClass(n.$element,"ui-unselecting"),n.unselecting=!0),i._trigger("unselecting",t,{unselecting:n.element}))),n.selected&&(t.metaKey||t.ctrlKey||n.startselected||(i._removeClass(n.$element,"ui-selected"),n.selected=!1,i._addClass(n.$element,"ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",t,{unselecting:n.element})))))})),!1}},_mouseStop:function(t){var n=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each((function(){var i=e.data(this,"selectable-item");n._removeClass(i.$element,"ui-unselecting"),i.unselecting=!1,i.startselected=!1,n._trigger("unselected",t,{unselected:i.element})})),e(".ui-selecting",this.element[0]).each((function(){var i=e.data(this,"selectable-item");n._removeClass(i.$element,"ui-selecting")._addClass(i.$element,"ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,n._trigger("selected",t,{selected:i.element})})),this._trigger("stop",t),this.helper.remove(),!1}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Sortable 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(5),n(9),n(13),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.sortable",e.ui.mouse,{version:"1.14.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,n){return e>=t&&e<t+n},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),e.each(this.items,(function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")}))},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,n){var i=null,r=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),e(t.target).parents().each((function(){if(e.data(this,o.widgetName+"-item")===o)return i=e(this),!1})),e.data(t.target,o.widgetName+"-item")===o&&(i=e(t.target)),!!i&&(!(this.options.handle&&!n&&(e(this.options.handle,i).find("*").addBack().each((function(){this===t.target&&(r=!0)})),!r))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,n,i){var r,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.appendTo=e("parent"!==a.appendTo?a.appendTo:this.currentItem.parent()),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),e.extend(this.offset,{parent:this._getParentOffset()}),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this._storedStylesheet=e("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(t),!0},_scroll:function(e){var t=this.options,n=!1;return this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<t.scrollSensitivity?this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop+t.scrollSpeed:e.pageY-this.overflowOffset.top<t.scrollSensitivity&&(this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop-t.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<t.scrollSensitivity?this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft+t.scrollSpeed:e.pageX-this.overflowOffset.left<t.scrollSensitivity&&(this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft-t.scrollSpeed)):(e.pageY-this.document.scrollTop()<t.scrollSensitivity?n=this.document.scrollTop(this.document.scrollTop()-t.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<t.scrollSensitivity&&(n=this.document.scrollTop(this.document.scrollTop()+t.scrollSpeed)),e.pageX-this.document.scrollLeft()<t.scrollSensitivity?n=this.document.scrollLeft(this.document.scrollLeft()-t.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<t.scrollSensitivity&&(n=this.document.scrollLeft(this.document.scrollLeft()+t.scrollSpeed))),n},_mouseDrag:function(t){var n,i,r,o,a=this.options;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.scroll&&!1!==this._scroll(t)&&(this._refreshItemPositions(!0),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},n=this.items.length-1;n>=0;n--)if(r=(i=this.items[n]).item[0],(o=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(r===this.currentItem[0]||this.placeholder[1===o?"next":"prev"]()[0]===r||e.contains(this.placeholder[0],r)||"semi-dynamic"===this.options.type&&e.contains(this.element[0],r))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,r=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(a,parseInt(this.options.revert,10)||500,(function(){i._clear(t)}))}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new e.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each((function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))})),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each((function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")})),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,r=i+this.helperProportions.height,o=e.left,a=o+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||i+c>s&&i+c<l,h="y"===this.options.axis||t+u>o&&t+u<a,p=d&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<a&&s<i+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t,n,i="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),r="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);return!(!i||!r)&&(t=this.dragDirection.vertical,n=this.dragDirection.horizontal,this.floating?"right"===n||"down"===t?2:1:t&&("down"===t?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this.dragDirection.vertical,r=this.dragDirection.horizontal;return this.floating&&r?"right"===r&&n||"left"===r&&!n:i&&("down"===i&&t||"up"===i&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,i,r,o,a=[],s=[],l=this._connectWith();if(l&&t)for(n=l.length-1;n>=0;n--)for(i=(r=e(l[n],this.document[0])).length-1;i>=0;i--)(o=e.data(r[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&s.push(["function"==typeof o.options.items?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);function c(){a.push(this)}for(s.push(["function"==typeof this.options.items?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=s.length-1;n>=0;n--)s[n][0].each(c);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,(function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0}))},_refreshItems:function(t){this.items=[],this.containers=[this];var n,i,r,o,a,s,l,c,u=this.items,d=[["function"==typeof this.options.items?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--)for(i=(r=e(h[n],this.document[0])).length-1;i>=0;i--)(o=e.data(r[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&(d.push(["function"==typeof o.options.items?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(n=d.length-1;n>=0;n--)for(a=d[n][1],i=0,c=(s=d[n][0]).length;i<c;i++)(l=e(s[i])).data(this.widgetName+"-item",a),u.push({item:l,instance:a,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(t){var n,i,r,o;for(n=this.items.length-1;n>=0;n--)i=this.items[n],this.currentContainer&&i.instance!==this.currentContainer&&i.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=r.outerWidth(),i.height=r.outerHeight()),o=r.offset(),i.left=o.left,i.top=o.top)},refreshPositions:function(e){var t,n;if(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),this._refreshItemPositions(e),this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;t>=0;t--)n=this.containers[t].element.offset(),this.containers[t].containerCache.left=n.left,this.containers[t].containerCache.top=n.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(t){var n,i,r=(t=t||this).options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,i=t.currentItem[0].nodeName.toLowerCase(),r.placeholder={element:function(){var r=e("<"+i+">",t.document[0]);return t._addClass(r,"ui-sortable-placeholder",n||t.currentItem[0].className)._removeClass(r,"ui-sortable-helper"),"tbody"===i?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(r)):"tr"===i?t._createTrPlaceholder(t.currentItem,r):"img"===i&&r.attr("src",t.currentItem.attr("src")),n||r.css("visibility","hidden"),r},update:function(e,o){n&&!r.forcePlaceholderSize||(o.height()&&(!r.forcePlaceholderSize||"tbody"!==i&&"tr"!==i)||o.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,n){var i=this;t.children().each((function(){e("<td>&#160;</td>",i.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)}))},_contactContainers:function(t){var n,i,r,o,a,s,l,c,u,d,h=null,p=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(h&&e.contains(this.containers[n].element[0],h.element[0]))continue;h=this.containers[n],p=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(r=1e4,o=null,a=(u=h.floating||this._isFloating(this.currentItem))?"left":"top",s=u?"width":"height",d=u?"pageX":"pageY",i=this.items.length-1;i>=0;i--)e.contains(this.containers[p].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(l=this.items[i].item.offset()[a],c=!1,t[d]-l>this.items[i][s]/2&&(c=!0),Math.abs(t[d]-l)<r&&(r=Math.abs(t[d]-l),o=this.items[i],this.direction=c?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var n=this.options,i="function"==typeof n.helper?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||this.appendTo[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!n.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!n.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),Array.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this.offsetParent[0]===this.document[0].body&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),"document"!==r.containment&&"window"!==r.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===r.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===r.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(t=e(r.containment)[0],n=e(r.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(r[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:r.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:r.scrollLeft())*i}},_generatePosition:function(t){var n,i,r=this.options,o=t.pageX,a=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),r.grid&&(n=this.originalPageY+Math.round((a-this.originalPageY)/r.grid[1])*r.grid[1],a=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-r.grid[1]:n+r.grid[1]:n,i=this.originalPageX+Math.round((o-this.originalPageX)/r.grid[0])*r.grid[0],o=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-r.grid[0]:i+r.grid[0]:i)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay((function(){r===this.counter&&this.refreshPositions(!i)}))},_clear:function(e,t){this.reverting=!1;var n,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function r(e,t,n){return function(i){n._trigger(e,i,t._uiHash(t))}}for(this.fromOutside&&!t&&i.push((function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))})),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||i.push((function(e){this._trigger("update",e,this._uiHash())})),this!==this.currentContainer&&(t||(i.push((function(e){this._trigger("remove",e,this._uiHash())})),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||i.push(r("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(r("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this._storedStylesheet&&(this._storedStylesheet.remove(),this._storedStylesheet=null),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(n=0;n<i.length;n++)i[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Accordion 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(4),n(6),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.accordion",{version:"1.14.0",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:function(e){return e.find("> li > :first-child").add(e.find("> :not(li)").filter((function(e){return e%2==0})))},heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t,n,i=this.options.icons;i&&(t=e("<span>"),this._addClass(t,"ui-accordion-header-icon","ui-icon "+i.header),t.prependTo(this.headers),n=this.active.children(".ui-accordion-header-icon"),this._removeClass(n,i.header)._addClass(n,null,i.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){"active"!==e?("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||!1!==this.options.active||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons())):this._activate(t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,i=this.headers.length,r=this.headers.index(t.target),o=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:o=this.headers[(r+1)%i];break;case n.LEFT:case n.UP:o=this.headers[(r-1+i)%i];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:o=this.headers[0];break;case n.END:o=this.headers[i-1]}o&&(e(t.target).attr("tabIndex",-1),e(o).attr("tabIndex",0),e(o).trigger("focus"),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().trigger("focus")},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=e()):!1===t.active?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;"function"==typeof this.options.header?this.headers=this.options.header(this.element):this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,n=this.options,i=n.heightStyle,r=this.element.parent();this.active=this._findActive(n.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each((function(){var t=e(this),n=t.uniqueId().attr("id"),i=t.next(),r=i.uniqueId().attr("id");t.attr("aria-controls",r),i.attr("aria-labelledby",n)})).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===i?(t=r.height(),this.element.siblings(":visible").each((function(){var n=e(this),i=n.css("position");"absolute"!==i&&"fixed"!==i&&(t-=n.outerHeight(!0))})),this.headers.each((function(){t-=e(this).outerHeight(!0)})),this.headers.next().each((function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))})).css("overflow","auto")):"auto"===i&&(t=0,this.headers.next().each((function(){var n=e(this).is(":visible");n||e(this).show(),t=Math.max(t,e(this).css("height","").height()),n||e(this).hide()})).height(t))},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),(function(e,t){n[t]="_eventHandler"})),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n,i,r=this.options,o=this.active,a=e(t.currentTarget),s=a[0]===o[0],l=s&&r.collapsible,c=l?e():a.next(),u=o.next(),d={oldHeader:o,oldPanel:u,newHeader:l?e():a,newPanel:c};t.preventDefault(),s&&!r.collapsible||!1===this._trigger("beforeActivate",t,d)||(r.active=!l&&this.headers.index(a),this.active=s?e():a,this._toggle(d),this._removeClass(o,"ui-accordion-header-active","ui-state-active"),r.icons&&(n=o.children(".ui-accordion-header-icon"),this._removeClass(n,null,r.icons.activeHeader)._addClass(n,null,r.icons.header)),s||(this._removeClass(a,"ui-accordion-header-collapsed")._addClass(a,"ui-accordion-header-active","ui-state-active"),r.icons&&(i=a.children(".ui-accordion-header-icon"),this._removeClass(i,null,r.icons.header)._addClass(i,null,r.icons.activeHeader)),this._addClass(a.next(),"ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=i,this.options.animate?this._animate(n,i,t):(i.hide(),n.show(),this._toggleComplete(t)),i.attr({"aria-hidden":"true"}),i.prev().attr({"aria-selected":"false","aria-expanded":"false"}),n.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):n.length&&this.headers.filter((function(){return 0===parseInt(e(this).attr("tabIndex"),10)})).attr("tabIndex",-1),n.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,n){var i,r,o,a=this,s=0,l=e.css("box-sizing"),c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=c&&u.down||u,h=function(){a._toggleComplete(n)};return"number"==typeof d&&(o=d),"string"==typeof d&&(r=d),r=r||d.easing||u.easing,o=o||d.duration||u.duration,t.length?e.length?(i=e.show().outerHeight(),t.animate(this.hideProps,{duration:o,easing:r,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:o,easing:r,complete:h,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?"content-box"===l&&(s+=n.now):"content"!==a.options.heightStyle&&(n.now=Math.round(i-t.outerHeight()-s),s=0)}})):t.animate(this.hideProps,o,r,h):e.animate(this.showProps,o,r,h)},_toggleComplete:function(e){var t=e.oldPanel,n=t.prev();this._removeClass(t,"ui-accordion-content-active"),this._removeClass(n,"ui-accordion-header-active")._addClass(n,"ui-accordion-header-collapsed"),this._trigger("activate",null,e)}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Autocomplete 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(15),n(4),n(7),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.autocomplete",{version:"1.14.0",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var t,n,i,r=this.element[0].nodeName.toLowerCase(),o="textarea"===r,a="input"===r;this.isMultiLine=o||!a&&"true"===this.element.prop("contentEditable"),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(r){if(this.element.prop("readOnly"))return t=!0,i=!0,void(n=!0);t=!1,i=!1,n=!1;var o=e.ui.keyCode;switch(r.keyCode){case o.PAGE_UP:t=!0,this._move("previousPage",r);break;case o.PAGE_DOWN:t=!0,this._move("nextPage",r);break;case o.UP:t=!0,this._keyEvent("previous",r);break;case o.DOWN:t=!0,this._keyEvent("next",r);break;case o.ENTER:this.menu.active&&(t=!0,r.preventDefault(),this.menu.select(r));break;case o.TAB:this.menu.active&&this.menu.select(r);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(r),r.preventDefault());break;default:n=!0,this._searchTimeout(r)}},keypress:function(i){if(t)return t=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||i.preventDefault());if(!n){var r=e.ui.keyCode;switch(i.keyCode){case r.PAGE_UP:this._move("previousPage",i);break;case r.PAGE_DOWN:this._move("nextPage",i);break;case r.UP:this._keyEvent("previous",i);break;case r.DOWN:this._keyEvent("next",i)}}},input:function(e){if(i)return i=!1,void e.preventDefault();this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault()},menufocus:function(t,n){var i,r;if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",(function(){e(t.target).trigger(t.originalEvent)}));r=n.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:r})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value),(i=n.item.attr("aria-label")||r.value)&&String.prototype.trim.call(i).length&&(clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay((function(){this.liveRegion.html(e("<div>").text(i))}),100))},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.trigger("focus"),this.previous=i),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(t){var n=this.menu.element[0];return t.target===this.element[0]||t.target===n||e.contains(n,t.target)},_closeOnClickOutside:function(e){this._isEventTargetInWidget(e)||this.close()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,n,i=this;Array.isArray(this.options.source)?(t=this.options.source,this.source=function(n,i){i(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,r){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){r(e)},error:function(){r([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay((function(){var t=this.term===this._value(),n=this.menu.element.is(":visible"),i=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;t&&(!t||n||i)||(this.selectedItem=null,this.search(null,e))}),this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=++this.requestIndex;return function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}.bind(this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,(function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})}))},_suggest:function(t){var n=this.menu.element.empty();this._renderMenu(n,t),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var i=this;e.each(n,(function(e,n){i._renderItemData(t,n)}))},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<div>").text(n.label)).appendTo(t)},_move:function(e,t){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t);this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var i=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,(function(e){return i.test(e.label||e.value||e)}))}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var n;this._superApply(arguments),this.options.disabled||this.cancelSearch||(n=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay((function(){this.liveRegion.html(e("<div>").text(n))}),100))}}),e.ui.autocomplete})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Datepicker 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(4)],void 0===(o="function"==typeof(i=function(e){var t;function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"",selectMonthLabel:"Select month",selectYearLabel:"Select year"},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=i(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.on("mouseout",n,(function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")})).on("mouseover",n,r)}function r(){e.datepicker._isDisabledDatepicker(t.inline?t.dpDiv.parent()[0]:t.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function o(t,n){for(var i in e.extend(t,n),n)null==n[i]&&(t[i]=n[i]);return t}return e.extend(e.ui,{datepicker:{version:"1.14.0"}}),e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return o(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var i,r,o;r="div"===(i=t.nodeName.toLowerCase())||"span"===i,t.id||(this.uuid+=1,t.id="dp"+this.uuid),(o=this._newInst(e(t),r)).settings=e.extend({},n||{}),"input"===i?this._connectDatepicker(t,o):r&&this._inlineDatepicker(t,o)},_newInst:function(t,n){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?i(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var i=e(t);n.append=e([]),n.trigger=e([]),i.hasClass(this.markerClassName)||(this._attachments(i,n),i.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(n),e.data(t,"datepicker",n),n.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,n){var i,r,o,a=this._get(n,"appendText"),s=this._get(n,"isRTL");n.append&&n.append.remove(),a&&(n.append=e("<span>").addClass(this._appendClass).text(a),t[s?"before":"after"](n.append)),t.off("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),"focus"!==(i=this._get(n,"showOn"))&&"both"!==i||t.on("focus",this._showDatepicker),"button"!==i&&"both"!==i||(r=this._get(n,"buttonText"),o=this._get(n,"buttonImage"),this._get(n,"buttonImageOnly")?n.trigger=e("<img>").addClass(this._triggerClass).attr({src:o,alt:r,title:r}):(n.trigger=e("<button type='button'>").addClass(this._triggerClass),o?n.trigger.html(e("<img>").attr({src:o,alt:r,title:r})):n.trigger.text(r)),t[s?"before":"after"](n.trigger),n.trigger.on("click",(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,i,r,o=new Date(2009,11,20),a=this._get(e,"dateFormat");a.match(/[DM]/)&&(t=function(e){for(n=0,i=0,r=0;r<e.length;r++)e[r].length>n&&(n=e[r].length,i=r);return i},o.setMonth(t(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),e.input.attr("size",this._formatDate(e,o).length)}},_inlineDatepicker:function(t,n){var i=e(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(n.dpDiv),e.data(t,"datepicker",n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block"))},_dialogDatepicker:function(t,n,i,r,a){var s,l,c,u,d,h=this._dialogInst;return h||(this.uuid+=1,s="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+s+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),e("body").append(this._dialogInput),(h=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},e.data(this._dialogInput[0],"datepicker",h)),o(h.settings,r||{}),n=n&&n.constructor===Date?this._formatDate(h,n):n,this._dialogInput.val(n),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+u,c/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(n){var i,r=e(n),o=e.data(n,"datepicker");r.hasClass(this.markerClassName)&&(i=n.nodeName.toLowerCase(),e.removeData(n,"datepicker"),"input"===i?(o.append.remove(),o.trigger.remove(),r.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==i&&"span"!==i||r.removeClass(this.markerClassName).empty(),e.datepicker._hideDatepicker(),t===o&&(t=null,this._curInst=null))},_enableDatepicker:function(t){var n,i,r=e(t),o=e.data(t,"datepicker");r.hasClass(this.markerClassName)&&("input"===(n=t.nodeName.toLowerCase())?(t.disabled=!1,o.trigger.filter("button").each((function(){this.disabled=!1})).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==n&&"span"!==n||((i=r.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,(function(e){return e===t?null:e})))},_disableDatepicker:function(t){var n,i,r=e(t),o=e.data(t,"datepicker");r.hasClass(this.markerClassName)&&("input"===(n=t.nodeName.toLowerCase())?(t.disabled=!0,o.trigger.filter("button").each((function(){this.disabled=!0})).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==n&&"span"!==n||((i=r.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,(function(e){return e===t?null:e})),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,n,i){var r,a,s,l,c=this._getInst(t);if(2===arguments.length&&"string"==typeof n)return"defaults"===n?e.extend({},e.datepicker._defaults):c?"all"===n?e.extend({},c.settings):this._get(c,n):null;r=n||{},"string"==typeof n&&((r={})[n]=i),c&&(this._curInst===c&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),s=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),o(c.settings,r),null!==s&&void 0!==r.dateFormat&&void 0===r.minDate&&(c.settings.minDate=this._formatDate(c,s)),null!==l&&void 0!==r.dateFormat&&void 0===r.maxDate&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in r&&(r.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),c),this._autoSize(c),this._setDate(c,a),this._updateAlternate(c),this._updateDatepicker(c))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,i,r,o=e.datepicker._getInst(t.target),a=!0,s=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),a=!1;break;case 13:return(r=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",o.dpDiv))[0]&&e.datepicker._selectDay(t.target,o.selectedMonth,o.selectedYear,r[0]),(n=e.datepicker._get(o,"onSelect"))?(i=e.datepicker._formatDate(o),n.apply(o.input?o.input[0]:null,[i,o])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),a=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),a=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?1:-1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),a=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?-1:1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),a=t.ctrlKey||t.metaKey;break;default:a=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):a=!1;a&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,i,r=e.datepicker._getInst(t.target);if(e.datepicker._get(r,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(r,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||i<" "||!n||n.indexOf(i)>-1},_doKeyUp:function(t){var n=e.datepicker._getInst(t.target);if(n.input.val()!==n.lastVal)try{e.datepicker.parseDate(e.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,e.datepicker._getFormatConfig(n))&&(e.datepicker._setDateFromField(n),e.datepicker._updateAlternate(n),e.datepicker._updateDatepicker(n))}catch(e){}return!0},_showDatepicker:function(t){var n,i,r,a,s,l,c;("input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)||(n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),!1!==(r=(i=e.datepicker._get(n,"beforeShow"))?i.apply(t,[t,n]):{})&&(o(n.settings,r),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),a=!1,e(t).parents().each((function(){return!(a|="fixed"===e(this).css("position"))})),s={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),s=e.datepicker._checkOffset(n,s,a),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":a?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"}),n.inline||(l=e.datepicker._get(n,"showAnim"),c=e.datepicker._get(n,"duration"),n.dpDiv.css("z-index",function(e){var t,n;for(;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(n=parseInt(e.css("zIndex"),10),!isNaN(n)&&0!==n))return n;e=e.parent()}return 0}(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?n.dpDiv.show(l,e.datepicker._get(n,"showOptions"),c):n.dpDiv[l||"show"](l?c:null),e.datepicker._shouldFocusInput(n)&&n.input.trigger("focus"),e.datepicker._curInst=n)))},_updateDatepicker:function(n){this.maxRows=4,t=n,n.dpDiv.empty().append(this._generateHTML(n)),this._attachHandlers(n);var i,o=this._getNumberOfMonths(n),a=o[1],s=n.dpDiv.find("."+this._dayOverClass+" a"),l=e.datepicker._get(n,"onUpdateDatepicker");s.length>0&&r.apply(s.get(0)),n.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),a>1&&n.dpDiv.addClass("ui-datepicker-multi-"+a).css("width",17*a+"em"),n.dpDiv[(1!==o[0]||1!==o[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),n.dpDiv[(this._get(n,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),n===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(n)&&n.input.trigger("focus"),n.yearshtml&&(i=n.yearshtml,setTimeout((function(){i===n.yearshtml&&n.yearshtml&&n.dpDiv.find("select.ui-datepicker-year").first().replaceWith(n.yearshtml),i=n.yearshtml=null}),0)),l&&l.apply(n.input?n.input[0]:null,[n])},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")},_checkOffset:function(t,n,i){var r=t.dpDiv.outerWidth(),o=t.dpDiv.outerHeight(),a=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(i?0:e(document).scrollLeft()),c=document.documentElement.clientHeight+(i?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?r-a:0,n.left-=i&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=i&&n.top===t.input.offset().top+s?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+r>l&&l>r?Math.abs(n.left+r-l):0),n.top-=Math.min(n.top,n.top+o>c&&c>o?Math.abs(o+s):0),n},_findPos:function(t){for(var n,i=this._getInst(t),r=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.pseudos.hidden(t));)t=t[r?"previousSibling":"nextSibling"];return[(n=e(t).offset()).left,n.top]},_hideDatepicker:function(t){var n,i,r,o,a=this._curInst;!a||t&&a!==e.data(t,"datepicker")||this._datepickerShowing&&(n=this._get(a,"showAnim"),i=this._get(a,"duration"),r=function(){e.datepicker._tidyDialog(a)},e.effects&&e.effects.effect[n]?a.dpDiv.hide(n,e.datepicker._get(a,"showOptions"),i,r):a.dpDiv["slideDown"===n?"slideUp":"fadeIn"===n?"fadeOut":"hide"](n?i:null,r),n||r(),this._datepickerShowing=!1,(o=this._get(a,"onClose"))&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var n=e(t.target),i=e.datepicker._getInst(n[0]);(n[0].id===e.datepicker._mainDivId||0!==n.parents("#"+e.datepicker._mainDivId).length||n.hasClass(e.datepicker.markerClassName)||n.closest("."+e.datepicker._triggerClass).length||!e.datepicker._datepickerShowing||e.datepicker._inDialog&&e.blockUI)&&(!n.hasClass(e.datepicker.markerClassName)||e.datepicker._curInst===i)||e.datepicker._hideDatepicker()}},_adjustDate:function(t,n,i){var r=e(t),o=this._getInst(r[0]);this._isDisabledDatepicker(r[0])||(this._adjustInstDate(o,n,i),this._updateDatepicker(o))},_gotoToday:function(t){var n,i=e(t),r=this._getInst(i[0]);this._get(r,"gotoCurrent")&&r.currentDay?(r.selectedDay=r.currentDay,r.drawMonth=r.selectedMonth=r.currentMonth,r.drawYear=r.selectedYear=r.currentYear):(n=new Date,r.selectedDay=n.getDate(),r.drawMonth=r.selectedMonth=n.getMonth(),r.drawYear=r.selectedYear=n.getFullYear()),this._notifyChange(r),this._adjustDate(i)},_selectMonthYear:function(t,n,i){var r=e(t),o=this._getInst(r[0]);o["selected"+("M"===i?"Month":"Year")]=o["draw"+("M"===i?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(r)},_selectDay:function(t,n,i,r){var o,a=e(t);e(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||((o=this._getInst(a[0])).selectedDay=o.currentDay=parseInt(e("a",r).attr("data-date")),o.selectedMonth=o.currentMonth=n,o.selectedYear=o.currentYear=i,this._selectDate(t,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var i,r=e(t),o=this._getInst(r[0]);n=null!=n?n:this._formatDate(o),o.input&&o.input.val(n),this._updateAlternate(o),(i=this._get(o,"onSelect"))?i.apply(o.input?o.input[0]:null,[n,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var n,i,r,o=this._get(t,"altField");o&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),r=this.formatDate(n,i,this._getFormatConfig(t)),e(document).find(o).val(r))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,i){if(null==t||null==n)throw"Invalid arguments";if(""===(n="object"==typeof n?n.toString():n+""))return null;var r,o,a,s,l=0,c=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),d=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,h=(i?i.dayNames:null)||this._defaults.dayNames,p=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,f=(i?i.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,v=-1,y=-1,b=!1,_=function(e){var n=r+1<t.length&&t.charAt(r+1)===e;return n&&r++,n},x=function(e){var t=_(e),i="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,r=new RegExp("^\\d{"+("y"===e?i:1)+","+i+"}"),o=n.substring(l).match(r);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},w=function(t,i,r){var o=-1,a=e.map(_(t)?r:i,(function(e,t){return[[t,e]]})).sort((function(e,t){return-(e[1].length-t[1].length)}));if(e.each(a,(function(e,t){var i=t[1];if(n.substr(l,i.length).toLowerCase()===i.toLowerCase())return o=t[0],l+=i.length,!1})),-1!==o)return o+1;throw"Unknown name at position "+l},S=function(){if(n.charAt(l)!==t.charAt(r))throw"Unexpected literal at position "+l;l++};for(r=0;r<t.length;r++)if(b)"'"!==t.charAt(r)||_("'")?S():b=!1;else switch(t.charAt(r)){case"d":v=x("d");break;case"D":w("D",d,h);break;case"o":y=x("o");break;case"m":m=x("m");break;case"M":m=w("M",p,f);break;case"y":g=x("y");break;case"@":g=(s=new Date(x("@"))).getFullYear(),m=s.getMonth()+1,v=s.getDate();break;case"!":g=(s=new Date((x("!")-this._ticksTo1970)/1e4)).getFullYear(),m=s.getMonth()+1,v=s.getDate();break;case"'":_("'")?S():b=!0;break;default:S()}if(l<n.length&&(a=n.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===g?g=(new Date).getFullYear():g<100&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(g<=u?0:-100)),y>-1)for(m=1,v=y;;){if(v<=(o=this._getDaysInMonth(g,m-1)))break;m++,v-=o}if((s=this._daylightSavingAdjust(new Date(g,m-1,v))).getFullYear()!==g||s.getMonth()+1!==m||s.getDate()!==v)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var i,r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,o=(n?n.dayNames:null)||this._defaults.dayNames,a=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,s=(n?n.monthNames:null)||this._defaults.monthNames,l=function(t){var n=i+1<e.length&&e.charAt(i+1)===t;return n&&i++,n},c=function(e,t,n){var i=""+t;if(l(e))for(;i.length<n;)i="0"+i;return i},u=function(e,t,n,i){return l(e)?i[t]:n[t]},d="",h=!1;if(t)for(i=0;i<e.length;i++)if(h)"'"!==e.charAt(i)||l("'")?d+=e.charAt(i):h=!1;else switch(e.charAt(i)){case"d":d+=c("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),r,o);break;case"o":d+=c("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=c("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),a,s);break;case"y":d+=l("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?d+="'":h=!0;break;default:d+=e.charAt(i)}return d},_possibleChars:function(e){var t,n="",i=!1,r=function(n){var i=t+1<e.length&&e.charAt(t+1)===n;return i&&t++,i};for(t=0;t<e.length;t++)if(i)"'"!==e.charAt(t)||r("'")?n+=e.charAt(t):i=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":r("'")?n+="'":i=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var n=this._get(e,"dateFormat"),i=e.lastVal=e.input?e.input.val():null,r=this._getDefaultDate(e),o=r,a=this._getFormatConfig(e);try{o=this.parseDate(n,i,a)||r}catch(e){i=t?"":i}e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),e.currentDay=i?o.getDate():0,e.currentMonth=i?o.getMonth():0,e.currentYear=i?o.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,i){var r=null==n||""===n?i:"string"==typeof n?function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(e){}for(var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,r=i.getFullYear(),o=i.getMonth(),a=i.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(n);l;){switch(l[2]||"d"){case"d":case"D":a+=parseInt(l[1],10);break;case"w":case"W":a+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),a=Math.min(a,e.datepicker._getDaysInMonth(r,o));break;case"y":case"Y":r+=parseInt(l[1],10),a=Math.min(a,e.datepicker._getDaysInMonth(r,o))}l=s.exec(n)}return new Date(r,o,a)}(n):"number"==typeof n?isNaN(n)?i:function(e){var t=new Date;return t.setDate(t.getDate()+e),t}(n):new Date(n.getTime());return(r=r&&"Invalid Date"===r.toString()?i:r)&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var i=!t,r=e.selectedMonth,o=e.selectedYear,a=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=a.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=a.getMonth(),e.drawYear=e.selectedYear=e.currentYear=a.getFullYear(),r===e.selectedMonth&&o===e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map((function(){var t={prev:function(){e.datepicker._adjustDate(i,-n,"M")},next:function(){e.datepicker._adjustDate(i,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(i)},selectDay:function(){return e.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(i,this,"Y"),!1}};e(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])}))},_generateHTML:function(t){var n,i,r,o,a,s,l,c,u,d,h,p,f,g,m,v,y,b,_,x,w,S,T,E,C,k,L,P,A,O,I,D,$,N,M,R,B,H,z,F=new Date,V=this._daylightSavingAdjust(new Date(F.getFullYear(),F.getMonth(),F.getDate())),j=this._get(t,"isRTL"),U=this._get(t,"showButtonPanel"),W=this._get(t,"hideIfNoPrevNext"),q=this._get(t,"navigationAsDateFormat"),G=this._getNumberOfMonths(t),Z=this._get(t,"showCurrentAtPos"),X=this._get(t,"stepMonths"),Q=1!==G[0]||1!==G[1],Y=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),K=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),ee=t.drawMonth-Z,te=t.drawYear;if(ee<0&&(ee+=12,te--),J)for(n=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-G[0]*G[1]+1,J.getDate())),n=K&&n<K?K:n;this._daylightSavingAdjust(new Date(te,ee,1))>n;)--ee<0&&(ee=11,te--);for(t.drawMonth=ee,t.drawYear=te,i=this._get(t,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(te,ee-X,1)),this._getFormatConfig(t)):i,r=this._canAdjustMonth(t,-1,te,ee)?e("<a>").attr({class:"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",title:i}).append(e("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(j?"e":"w")).text(i))[0].outerHTML:W?"":e("<a>").attr({class:"ui-datepicker-prev ui-corner-all ui-state-disabled",title:i}).append(e("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(j?"e":"w")).text(i))[0].outerHTML,o=this._get(t,"nextText"),o=q?this.formatDate(o,this._daylightSavingAdjust(new Date(te,ee+X,1)),this._getFormatConfig(t)):o,a=this._canAdjustMonth(t,1,te,ee)?e("<a>").attr({class:"ui-datepicker-next ui-corner-all","data-handler":"next","data-event":"click",title:o}).append(e("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(j?"w":"e")).text(o))[0].outerHTML:W?"":e("<a>").attr({class:"ui-datepicker-next ui-corner-all ui-state-disabled",title:o}).append(e("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+(j?"w":"e")).text(o))[0].outerHTML,s=this._get(t,"currentText"),l=this._get(t,"gotoCurrent")&&t.currentDay?Y:V,s=q?this.formatDate(s,l,this._getFormatConfig(t)):s,c="",t.inline||(c=e("<button>").attr({type:"button",class:"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(t,"closeText"))[0].outerHTML),u="",U&&(u=e("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(j?c:"").append(this._isInRange(t,l)?e("<button>").attr({type:"button",class:"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(s):"").append(j?"":c)[0].outerHTML),d=parseInt(this._get(t,"firstDay"),10),d=isNaN(d)?0:d,h=this._get(t,"showWeek"),p=this._get(t,"dayNames"),f=this._get(t,"dayNamesMin"),g=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),v=this._get(t,"beforeShowDay"),y=this._get(t,"showOtherMonths"),b=this._get(t,"selectOtherMonths"),_=this._getDefaultDate(t),x="",S=0;S<G[0];S++){for(T="",this.maxRows=4,E=0;E<G[1];E++){if(C=this._daylightSavingAdjust(new Date(te,ee,t.selectedDay)),k=" ui-corner-all",L="",Q){if(L+="<div class='ui-datepicker-group",G[1]>1)switch(E){case 0:L+=" ui-datepicker-group-first",k=" ui-corner-"+(j?"right":"left");break;case G[1]-1:L+=" ui-datepicker-group-last",k=" ui-corner-"+(j?"left":"right");break;default:L+=" ui-datepicker-group-middle",k=""}L+="'>"}for(L+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+k+"'>"+(/all|left/.test(k)&&0===S?j?a:r:"")+(/all|right/.test(k)&&0===S?j?r:a:"")+this._generateMonthYearHeader(t,ee,te,K,J,S>0||E>0,g,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",P=h?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;w<7;w++)P+="<th scope='col'"+((w+d+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+p[A=(w+d)%7]+"'>"+f[A]+"</span></th>";for(L+=P+"</tr></thead><tbody>",O=this._getDaysInMonth(te,ee),te===t.selectedYear&&ee===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,O)),I=(this._getFirstDayOfMonth(te,ee)-d+7)%7,D=Math.ceil((I+O)/7),$=Q&&this.maxRows>D?this.maxRows:D,this.maxRows=$,N=this._daylightSavingAdjust(new Date(te,ee,1-I)),M=0;M<$;M++){for(L+="<tr>",R=h?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(N)+"</td>":"",w=0;w<7;w++)B=v?v.apply(t.input?t.input[0]:null,[N]):[!0,""],z=(H=N.getMonth()!==ee)&&!b||!B[0]||K&&N<K||J&&N>J,R+="<td class='"+((w+d+6)%7>=5?" ui-datepicker-week-end":"")+(H?" ui-datepicker-other-month":"")+(N.getTime()===C.getTime()&&ee===t.selectedMonth&&t._keyEvent||_.getTime()===N.getTime()&&_.getTime()===C.getTime()?" "+this._dayOverClass:"")+(z?" "+this._unselectableClass+" ui-state-disabled":"")+(H&&!y?"":" "+B[1]+(N.getTime()===Y.getTime()?" "+this._currentClass:"")+(N.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+(H&&!y||!B[2]?"":" title='"+B[2].replace(/'/g,"&#39;")+"'")+(z?"":" data-handler='selectDay' data-event='click' data-month='"+N.getMonth()+"' data-year='"+N.getFullYear()+"'")+">"+(H&&!y?"&#xa0;":z?"<span class='ui-state-default'>"+N.getDate()+"</span>":"<a class='ui-state-default"+(N.getTime()===V.getTime()?" ui-state-highlight":"")+(N.getTime()===Y.getTime()?" ui-state-active":"")+(H?" ui-priority-secondary":"")+"' href='#' aria-current='"+(N.getTime()===Y.getTime()?"true":"false")+"' data-date='"+N.getDate()+"'>"+N.getDate()+"</a>")+"</td>",N.setDate(N.getDate()+1),N=this._daylightSavingAdjust(N);L+=R+"</tr>"}++ee>11&&(ee=0,te++),T+=L+="</tbody></table>"+(Q?"</div>"+(G[0]>0&&E===G[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}x+=T}return x+=u,t._keyEvent=!1,x},_generateMonthYearHeader:function(e,t,n,i,r,o,a,s){var l,c,u,d,h,p,f,g,m=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b=this._get(e,"selectMonthLabel"),_=this._get(e,"selectYearLabel"),x="<div class='ui-datepicker-title'>",w="";if(o||!m)w+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{for(l=i&&i.getFullYear()===n,c=r&&r.getFullYear()===n,w+="<select class='ui-datepicker-month' aria-label='"+b+"' data-handler='selectMonth' data-event='change'>",u=0;u<12;u++)(!l||u>=i.getMonth())&&(!c||u<=r.getMonth())&&(w+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+s[u]+"</option>");w+="</select>"}if(y||(x+=w+(!o&&m&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",o||!v)x+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(d=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),f=(p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t})(d[0]),g=Math.max(f,p(d[1]||"")),f=i?Math.max(f,i.getFullYear()):f,g=r?Math.min(g,r.getFullYear()):g,e.yearshtml+="<select class='ui-datepicker-year' aria-label='"+_+"' data-handler='selectYear' data-event='change'>";f<=g;f++)e.yearshtml+="<option value='"+f+"'"+(f===n?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",x+=e.yearshtml,e.yearshtml=null}return x+=this._get(e,"yearSuffix"),y&&(x+=(!o&&m&&v?"":"&#xa0;")+w),x+="</div>"},_adjustInstDate:function(e,t,n){var i=e.selectedYear+("Y"===n?t:0),r=e.selectedMonth+("M"===n?t:0),o=Math.min(e.selectedDay,this._getDaysInMonth(i,r))+("D"===n?t:0),a=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,r,o)));e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),"M"!==n&&"Y"!==n||this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),r=n&&t<n?n:t;return i&&r>i?i:r},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,n,i){var r=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(n,i+(t<0?t:r[0]*r[1]),1));return t<0&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(e,o)},_isInRange:function(e,t){var n,i,r=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),a=null,s=null,l=this._get(e,"yearRange");return l&&(n=l.split(":"),i=(new Date).getFullYear(),a=parseInt(n[0],10),s=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(a+=i),n[1].match(/[+\-].*/)&&(s+=i)),(!r||t.getTime()>=r.getTime())&&(!o||t.getTime()<=o.getTime())&&(!a||t.getFullYear()>=a)&&(!s||t.getFullYear()<=s)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var r=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),r,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).on("mousedown",e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each((function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)})):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.14.0",e.datepicker})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Dialog 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(16),n(14),n(5),n(21),n(10),n(4),n(7),n(19),n(6),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){e.widget("ui.dialog",{version:"1.14.0",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(e=t.parent.children().eq(t.index)).length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n=this;this._isOpen&&!1!==this._trigger("beforeClose",t)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||e(this.document[0].activeElement).trigger("blur"),this._hide(this.uiDialog,this.options.hide,(function(){n._trigger("close",t)})))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,n){var i=!1,r=this.uiDialog.siblings(".ui-front:visible").map((function(){return+e(this).css("z-index")})).get(),o=Math.max.apply(null,r);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),i=!0),i&&!n&&this._trigger("focus",t),i},open:function(){var t=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,(function(){t._focusTabbable(),t._trigger("focus")})),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).trigger("focus")},_restoreTabbableFocus:function(){var t=this.document[0].activeElement;this.uiDialog[0]===t||e.contains(this.uiDialog[0],t)||this._focusTabbable()},_keepFocus:function(e){e.preventDefault(),this._restoreTabbableFocus()},_createWrapper:function(){this.uiDialog=e("<div>").hide().attr({tabIndex:-1,role:"dialog","aria-modal":this.options.modal?"true":null}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var n=this.uiDialog.find(":tabbable"),i=n.first(),r=n.last();t.target!==r[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay((function(){r.trigger("focus")})),t.preventDefault()):(this._delay((function(){i.trigger("focus")})),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:e("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(t,"ui-dialog-title"),this._title(t),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title?e.text(this.options.title):e.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(n)||Array.isArray(n)&&!n.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):(e.each(n,(function(n,i){var r,o;i="function"==typeof i?{click:i,text:n}:i,i=e.extend({type:"button"},i),r=i.click,o={icon:i.icon,iconPosition:i.iconPosition,showLabel:i.showLabel,icons:i.icons,text:i.text},delete i.click,delete i.icon,delete i.iconPosition,delete i.showLabel,delete i.icons,"boolean"==typeof i.text&&delete i.text,e("<button></button>",i).button(o).appendTo(t.uiButtonSet).on("click",(function(){r.apply(t.element[0],arguments)}))})),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){var t=this,n=this.options;function i(e){return{position:e.position,offset:e.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,r){t._addClass(e(this),"ui-dialog-dragging"),t._blockFrames(),t._trigger("dragStart",n,i(r))},drag:function(e,n){t._trigger("drag",e,i(n))},stop:function(r,o){var a=o.offset.left-t.document.scrollLeft(),s=o.offset.top-t.document.scrollTop();n.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(s>=0?"+":"")+s,of:t.window},t._removeClass(e(this),"ui-dialog-dragging"),t._unblockFrames(),t._trigger("dragStop",r,i(o))}})},_makeResizable:function(){var t=this,n=this.options,i=n.resizable,r=this.uiDialog.css("position"),o="string"==typeof i?i:"n,e,s,w,se,sw,ne,nw";function a(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,i){t._addClass(e(this),"ui-dialog-resizing"),t._blockFrames(),t._trigger("resizeStart",n,a(i))},resize:function(e,n){t._trigger("resize",e,a(n))},stop:function(i,r){var o=t.uiDialog.offset(),s=o.left-t.document.scrollLeft(),l=o.top-t.document.scrollTop();n.height=t.uiDialog.height(),n.width=t.uiDialog.width(),n.position={my:"left top",at:"left"+(s>=0?"+":"")+s+" top"+(l>=0?"+":"")+l,of:t.window},t._removeClass(e(this),"ui-dialog-resizing"),t._unblockFrames(),t._trigger("resizeStop",i,a(r))}}).css("position",r)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),n=e.inArray(this,t);-1!==n&&t.splice(n,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var n=this,i=!1,r={};e.each(t,(function(e,t){n._setOption(e,t),e in n.sizeRelatedOptions&&(i=!0),e in n.resizableRelatedOptions&&(r[e]=t)})),i&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(t,n){var i,r,o=this.uiDialog;"disabled"!==t&&(this._super(t,n),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:e("<a>").text(""+this.options.closeText).html()}),"draggable"===t&&((i=o.is(":data(ui-draggable)"))&&!n&&o.draggable("destroy"),!i&&n&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((r=o.is(":data(ui-resizable)"))&&!n&&o.resizable("destroy"),r&&"string"==typeof n&&o.resizable("option","handles",n),r||!1===n||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")),"modal"===t&&o.attr("aria-modal",n?"true":null))},_size:function(){var e,t,n,i=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),i.minWidth>i.width&&(i.width=i.minWidth),e=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),t=Math.max(0,i.minHeight-e),n="number"==typeof i.maxHeight?Math.max(0,i.maxHeight-e):"none","auto"===i.height?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,i.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map((function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!e(t.target).closest(".ui-dialog").length||!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay((function(){t=!1})),this.document.data("ui-dialog-overlays")||this.document.on("focusin.ui-dialog",function(e){if(!t){var n=this._trackingInstances()[0];n._allowInteraction(e)||(e.preventDefault(),n._focusTabbable())}}.bind(this)),this.overlay=e("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):(this.document.off("focusin.ui-dialog"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!0===e.uiBackCompat&&e.widget("ui.dialog",e.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(e,t){"dialogClass"===e&&this.uiDialog.removeClass(this.options.dialogClass).addClass(t),this._superApply(arguments)}});return e.ui.dialog})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Progressbar 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.progressbar",{version:"1.14.0",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=e("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(e){if(void 0===e)return this.options.value;this.options.value=this._constrainedValue(e),this._refreshValue()},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=!1===e,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,n=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).width(n.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,t===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Selectmenu 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(15),n(11),n(4),n(12),n(7),n(6),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.selectmenu",[e.ui.formResetMixin,{version:"1.14.0",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=e()},_drawButton:function(){var t,n=this,i=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(e){this.button.trigger("focus"),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),t=e("<span>").appendTo(this.button),this._addClass(t,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(i).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",(function(){n._rendered||n._refreshMenu()}))},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(e,n){e.preventDefault(),t._select(n.item.data("ui-selectmenu-item"),e)},focus:function(e,n){var i=n.item.data("ui-selectmenu-item");null!=t.focusIndex&&i.index!==t.focusIndex&&(t._trigger("focus",e,{item:i}),t.isOpen||t._select(i,e)),t.focusIndex=i.index,t.button.attr("aria-activedescendant",t.menuItems.eq(i.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var e,t=this.element.find("option");this.menu.empty(),this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,t.length&&(e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e)))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(t){var n=e("<span>");return this._setText(n,t.label),this._addClass(n,"ui-selectmenu-text"),n},_renderMenu:function(t,n){var i=this,r="";e.each(n,(function(n,o){var a;o.optgroup!==r&&(a=e("<li>",{text:o.optgroup}),i._addClass(a,"ui-selectmenu-optgroup","ui-menu-divider"+(o.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),a.appendTo(t),r=o.optgroup),i._renderItemData(t,o)}))},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,n){var i=e("<li>"),r=e("<div>",{title:n.element.attr("title")});return n.disabled&&this._addClass(i,null,"ui-state-disabled"),n.hidden?i.prop("hidden",!0):this._setText(r,n.label),i.append(r).appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var n,i,r=".ui-menu-item";this.isOpen?n=this.menuItems.eq(this.focusIndex).parent("li"):(n=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),r+=":not(.ui-state-disabled)"),(i="first"===e||"last"===e?n["first"===e?"prevAll":"nextAll"](r).eq(-1):n[e+"All"](r).eq(0)).length&&this.menuInstance.focus(t,i)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&((e=window.getSelection()).removeAllRanges(),e.addRange(this.range))},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+CSS.escape(this.ids.button)).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e=window.getSelection();e.rangeCount&&(this.range=e.getRangeAt(0))},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var n=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),n=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),n=!1}n&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex).parent("li");t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var n=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(e)),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==n&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){if("icons"===e){var n=this.button.find("span.ui-icon");this._removeClass(n,null,this.options.icons.button)._addClass(n,null,t.button)}this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"width"===e&&this._resizeButton()},_setOptionDisabled:function(e){this._super(e),this.menuInstance.option("disabled",e),this.button.attr("aria-disabled",e),this._toggleClass(this.button,null,"ui-state-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;!1!==e?(null===e&&(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()))},_getCreateOptions:function(){var e=this._super();return e.disabled=this.element.prop("disabled"),e},_parseOptions:function(t){var n=this,i=[];t.each((function(t,r){i.push(n._parseOption(e(r),t))})),this.items=i},_parseOption:function(e,t){var n=e.parent("optgroup");return{element:e,index:t,value:e.val(),label:e.text(),hidden:n.prop("hidden")||e.prop("hidden"),optgroup:n.attr("label")||"",disabled:n.prop("disabled")||e.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}])})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Slider 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(5),n(4),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){return e.widget("ui.slider",e.ui.mouse,{version:"1.14.0",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,i=this.options,r=this.element.find(".ui-slider-handle"),o=[];for(n=i.values&&i.values.length||1,r.length>n&&(r.slice(n).remove(),r=r.slice(0,n)),t=r.length;t<n;t++)o.push("<span tabindex='0'></span>");this.handles=r.add(e(o.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each((function(t){e(this).data("ui-slider-handle-index",t).attr("tabIndex",0)}))},_createRange:function(){var t=this.options;t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:Array.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=e("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==t.range&&"max"!==t.range||this._addClass(this.range,"ui-slider-range-"+t.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(t){var n,i,r,o,a,s,l,c=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),r=this._valueMax()-this._valueMin()+1,this.handles.each((function(t){var n=Math.abs(i-c.values(t));(r>n||r===n&&(t===c._lastChangedValue||c.values(t)===u.min))&&(r=n,o=e(this),a=t)})),!1!==this._start(t,a)&&(this._mouseSliding=!0,this._handleIndex=a,this._addClass(o,null,"ui-state-active"),o.trigger("focus"),s=o.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-s.left-o.width()/2,top:t.pageY-s.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,a,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,r,o;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(i=n/t)>1&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),r=this._valueMax()-this._valueMin(),o=this._valueMin()+i*r,this._trimAlignValue(o)},_uiHash:function(e,t,n){var i={handle:this.handles[e],handleIndex:e,value:void 0!==t?t:this.value()};return this._hasMultipleValues()&&(i.value=void 0!==t?t:this.values(e),i.values=n||this.values()),i},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(e,t){return this._trigger("start",e,this._uiHash(t))},_slide:function(e,t,n){var i,r=this.value(),o=this.values();this._hasMultipleValues()&&(i=this.values(t?0:1),r=this.values(t),2===this.options.values.length&&!0===this.options.range&&(n=0===t?Math.min(i,n):Math.max(i,n)),o[t]=n),n!==r&&!1!==this._trigger("slide",e,this._uiHash(t,n,o))&&(this._hasMultipleValues()?this.values(t,n):this.value(n))},_stop:function(e,t){this._trigger("stop",e,this._uiHash(t))},_change:function(e,t){this._keySliding||this._mouseSliding||(this._lastChangedValue=t,this._trigger("change",e,this._uiHash(t)))},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,t){var n,i,r;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(t),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!Array.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(n=this.options.values,i=arguments[0],r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(i[r]),this._change(null,r);this._refreshValue()},_setOption:function(e,t){var n,i=0;switch("range"===e&&!0===this.options.range&&("min"===t?(this.options.value=this._values(0),this.options.values=null):"max"===t&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(i=this.options.values.length),this._super(e,t),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(t),this.handles.css("horizontal"===t?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=i-1;n>=0;n--)this._change(null,n);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(e){this._super(e),this._toggleClass(null,"ui-state-disabled",!!e)},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this._hasMultipleValues()){for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),n=this.options.step;(e=Math.round((e-t)/n)*n+t)>this.options.max&&(e-=n),this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return-1===n?0:t.length-n-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(e){"vertical"===e&&this.range.css({width:"",left:""}),"horizontal"===e&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var t,n,i,r,o,a=this.options.range,s=this.options,l=this,c=!this._animateOff&&s.animate,u={};this._hasMultipleValues()?this.handles.each((function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](u,s.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:s.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:s.animate}))),t=n})):(i=this.value(),r=this._valueMin(),o=this._valueMax(),n=o!==r?(i-r)/(o-r)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](u,s.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},s.animate),"max"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:100-n+"%"},s.animate),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},s.animate),"max"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:100-n+"%"},s.animate))},_handleEvents:{keydown:function(t){var n,i,r,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(e(t.target),null,"ui-state-active"),!1===this._start(t,o)))return}switch(r=this.options.step,n=i=this._hasMultipleValues()?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:i=this._valueMin();break;case e.ui.keyCode.END:i=this._valueMax();break;case e.ui.keyCode.PAGE_UP:i=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;i=this._trimAlignValue(n+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;i=this._trimAlignValue(n-r)}this._slide(t,o,i)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),this._removeClass(e(t.target),null,"ui-state-active"))}}})})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Spinner 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(16),n(1),n(4),n(2)],void 0===(o="function"==typeof(i=function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.14.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t=this._super(),n=this.element;return e.each(["min","max","step"],(function(e,i){var r=n.attr(i);null!=r&&r.length&&(t[i]=r)})),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e)},mousewheel:function(e,t){var n=this.document[0].activeElement;if(this.element[0]===n&&t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay((function(){this.spinning&&this._stop(e)}),100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),function(){this.element[0]===this.document[0].activeElement||(this.element.trigger("focus"),this.previous=n)}.call(this),!1!==this._start(t)&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(e(t.currentTarget).hasClass("ui-state-active"))return!1!==this._start(t)&&void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(t){var n=this.options,i=e.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,n.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_start:function(e){return!(!this.spinning&&!1===this._trigger("start",e))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay((function(){this._repeat(40,t,n)}),e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",t,{value:n})||(this._value(n),this.counter++)},_increment:function(e){var t=this.options.incremental;return t?"function"==typeof t?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return-1===n?0:t.length-n-1},_adjustValue:function(e){var t,n,i=this.options;return n=e-(t=null!==i.min?i.min:0),e=t+(n=Math.round(n/i.step)*i.step),e=parseFloat(e.toFixed(this._precision())),null!==i.max&&e>i.max?i.max:null!==i.min&&e<i.min?i.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){var n,i,r;if("culture"===e||"numberFormat"===e)return n=this._parse(this.element.val()),this.options[e]=t,void this.element.val(this._format(n));"max"!==e&&"min"!==e&&"step"!==e||"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(i=this.buttons.first().find(".ui-icon"),this._removeClass(i,null,this.options.icons.up),this._addClass(i,null,t.up),r=this.buttons.last().find(".ui-icon"),this._removeClass(r,null,this.options.icons.down),this._addClass(r,null,t.down)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable")},_setOptions:t((function(e){this._super(e)})),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null!==e&&e===this._adjustValue(e)},_value:function(e,t){var n;""!==e&&null!==(n=this._parse(e))&&(t||(n=this._adjustValue(n)),e=this._format(n)),this.element.val(e),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t((function(e){this._stepUp(e)})),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t((function(e){this._stepDown(e)})),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t((function(e){this._stepUp((e||1)*this.options.page)})),pageDown:t((function(e){this._stepDown((e||1)*this.options.page)})),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e)},widget:function(){return this.uiSpinner}}),!0===e.uiBackCompat&&e.widget("ui.spinner",e.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}});return e.ui.spinner})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Tabs 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(4),n(6),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){e.widget("ui.tabs",{version:"1.14.0",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var n,i;n=t.href.replace(e,""),i=location.href.replace(e,"");try{n=decodeURIComponent(n)}catch(e){}try{i=decodeURIComponent(i)}catch(e){}return t.hash.length>1&&n===i}}(),_create:function(){var t=this,n=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,n.collapsible),this._processTabs(),n.active=this._initialActive(),Array.isArray(n.disabled)&&(n.disabled=e.uniqueSort(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),(function(e){return t.tabs.index(e)})))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(n.active):this.active=e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,i=location.hash.substring(1);return null===t&&(i&&this.tabs.each((function(n,r){if(e(r).attr("aria-controls")===i)return t=n,!1})),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==t&&-1!==t||(t=!!this.tabs.length&&0)),!1!==t&&-1===(t=this.tabs.index(this.tabs.eq(t)))&&(t=!n&&0),!n&&!1===t&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),i=this.tabs.index(n),r=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:i++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:r=!1,i--;break;case e.ui.keyCode.END:i=this.anchors.length-1;break;case e.ui.keyCode.HOME:i=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,r),t.ctrlKey||t.metaKey||(n.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay((function(){this.option("active",i)}),this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){var i=this.tabs.length-1;for(;-1!==e.inArray((t>i&&(t=0),t<0&&(t=i),t),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).trigger("focus"),e},_setOption:function(e,t){"active"!==e?(this._super(e,t),"collapsible"===e&&(this._toggleClass("ui-tabs-collapsible",null,t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t)):this._activate(t)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),(function(e){return n.index(e)})),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,n=this.tabs,i=this.anchors,r=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",(function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()})),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map((function(){return e("a",this)[0]})).attr({tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=e(),this.anchors.each((function(n,i){var r,o,a,s=e(i).uniqueId().attr("id"),l=e(i).closest("li"),c=l.attr("aria-controls");t._isLocal(i)?(a=(r=i.hash).substring(1),o=t.element.find(t._sanitizeSelector(r))):(r="#"+(a=l.attr("aria-controls")||e({}).uniqueId()[0].id),(o=t.element.find(r)).length||(o=t._createPanel(a)).insertAfter(t.panels[n-1]||t.tablist),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":a,"aria-labelledby":s}),o.attr("aria-labelledby",s)})),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),n&&(this._off(n.not(this.tabs)),this._off(i.not(this.anchors)),this._off(r.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(t){var n,i,r;for(Array.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1),r=0;i=this.tabs[r];r++)n=e(i),!0===t||-1!==e.inArray(r,t)?(n.attr("aria-disabled","true"),this._addClass(n,null,"ui-state-disabled")):(n.removeAttr("aria-disabled"),this._removeClass(n,null,"ui-state-disabled"));this.options.disabled=t,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===t)},_setupEvents:function(t){var n={};t&&e.each(t.split(" "),(function(e,t){n[t]="_eventHandler"})),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,i=this.element.parent();"fill"===t?(n=i.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each((function(){var t=e(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(n-=t.outerHeight(!0))})),this.element.children().not(this.panels).each((function(){n-=e(this).outerHeight(!0)})),this.panels.each((function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))})).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each((function(){n=Math.max(n,e(this).height("").height())})).height(n))},_eventHandler:function(t){var n=this.options,i=this.active,r=e(t.currentTarget).closest("li"),o=r[0]===i[0],a=o&&n.collapsible,s=a?e():this._getPanelForTab(r),l=i.length?this._getPanelForTab(i):e(),c={oldTab:i,oldPanel:l,newTab:a?e():r,newPanel:s};t.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||!1===this._trigger("beforeActivate",t,c)||(n.active=!a&&this.tabs.index(r),this.active=o?e():r,this.xhr&&this.xhr.abort(),l.length||s.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(r),t),this._toggle(t,c))},_toggle:function(t,n){var i=this,r=n.newPanel,o=n.oldPanel;function a(){i.running=!1,i._trigger("activate",t,n)}function s(){i._addClass(n.newTab.closest("li"),"ui-tabs-active","ui-state-active"),r.length&&i.options.show?i._show(r,i.options.show,a):(r.show(),a())}this.running=!0,o.length&&this.options.hide?this._hide(o,this.options.hide,(function(){i._removeClass(n.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),s()})):(this._removeClass(n.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),o.hide(),s()),o.attr("aria-hidden","true"),n.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),r.length&&o.length?n.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter((function(){return 0===e(this).attr("tabIndex")})).attr("tabIndex",-1),r.attr("aria-hidden","false"),n.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var n,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),n=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return!1===t?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+CSS.escape(e)+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each((function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")})),this.tabs.each((function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")})),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var n=this.options.disabled;!1!==n&&(void 0===t?n=!1:(t=this._getIndex(t),n=Array.isArray(n)?e.map(n,(function(e){return e!==t?e:null})):e.map(this.tabs,(function(e,n){return n!==t?n:null}))),this._setOptionDisabled(n))},disable:function(t){var n=this.options.disabled;if(!0!==n){if(void 0===t)n=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,n))return;n=Array.isArray(n)?e.merge([t],n).sort():[t]}this._setOptionDisabled(n)}},load:function(t,n){t=this._getIndex(t);var i=this,r=this.tabs.eq(t),o=r.find(".ui-tabs-anchor"),a=this._getPanelForTab(r),s={tab:r,panel:a},l=function(e,t){"abort"===t&&i.panels.stop(!1,!0),i._removeClass(r,"ui-tabs-loading"),a.removeAttr("aria-busy"),e===i.xhr&&delete i.xhr};this._isLocal(o[0])||(this.xhr=e.ajax(this._ajaxSettings(o,n,s)),"canceled"!==this.xhr.statusText&&(this._addClass(r,"ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done((function(e,t,r){a.html(e),i._trigger("load",n,s),l(r,t)})).fail((function(e,t){l(e,t)}))))},_ajaxSettings:function(t,n,i){var r=this;return{url:t.attr("href"),beforeSend:function(t,o){return r._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:o},i))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),!0===e.uiBackCompat&&e.widget("ui.tabs",e.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}});return e.ui.tabs})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Tooltip 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(4),n(7),n(6),n(1),n(2)],void 0===(o="function"==typeof(i=function(e){e.widget("ui.tooltip",{version:"1.14.0",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var t=e(this).attr("title");return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,t){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(t),e.data("ui-tooltip-id",t).attr("aria-describedby",String.prototype.trim.call(n.join(" ")))},_removeDescribedBy:function(t){var n=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),r=e.inArray(n,i);-1!==r&&i.splice(r,1),t.removeData("ui-tooltip-id"),(i=String.prototype.trim.call(i.join(" ")))?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=e([])},_setOption:function(t,n){var i=this;this._super(t,n),"content"===t&&e.each(this.tooltips,(function(e,t){i._updateContent(t.element)}))},_setOptionDisabled:function(e){this[e?"_disable":"_enable"]()},_disable:function(){var t=this;e.each(this.tooltips,(function(n,i){var r=e.Event("blur");r.target=r.currentTarget=i.element[0],t.close(r,!0)})),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter((function(){var t=e(this);if(t.is("[title]"))return t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})))},_enable:function(){this.disabledTitles.each((function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})),this.disabledTitles=e([])},open:function(t){var n=this,i=e(t?t.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&i.parents().each((function(){var t,i=e(this);i.data("ui-tooltip-open")&&((t=e.Event("blur")).target=t.currentTarget=this,n.close(t,!0)),i.attr("title")&&(i.uniqueId(),n.parents[this.id]={element:this,title:i.attr("title")},i.attr("title",""))})),this._registerCloseHandlers(t,i),this._updateContent(i,t))},_updateContent:function(e,t){var n,i=this.options.content,r=this,o=t?t.type:null;if("string"==typeof i||i.nodeType||i.jquery)return this._open(t,e,i);(n=i.call(e[0],(function(n){e.data("ui-tooltip-open")&&(t&&(t.type=o),r._open(t,e,n))})))&&this._open(t,e,n)},_open:function(t,n,i){var r,o,a,s,l=e.extend({},this.options.position);function c(e){l.of=e,o.is(":hidden")||o.position(l)}i&&((r=this._find(n))?r.tooltip.find(".ui-tooltip-content").html(i):(n.is("[title]")&&(t&&"mouseover"===t.type?n.attr("title",""):n.removeAttr("title")),r=this._tooltip(n),o=r.tooltip,this._addDescribedBy(n,o.attr("id")),o.find(".ui-tooltip-content").html(i),this.liveRegion.children().hide(),(s=e("<div>").html(o.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),s.removeAttr("id").find("[id]").removeAttr("id"),s.appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:c}),c(t)):o.position(e.extend({of:n},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(a=this.delayedShow=setInterval((function(){o.is(":visible")&&(c(l.of),clearInterval(a))}),13)),this._trigger("open",t,{tooltip:o})))},_registerCloseHandlers:function(t,n){var i={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var i=e.Event(t);i.currentTarget=n[0],this.close(i,!0)}}};n[0]!==this.element[0]&&(i.remove=function(){var e=this._find(n);e&&this._removeTooltip(e.tooltip)}),t&&"mouseover"!==t.type||(i.mouseleave="close"),t&&"focusin"!==t.type||(i.focusout="close"),this._on(!0,n,i)},close:function(t){var n,i=this,r=e(t?t.currentTarget:this.element),o=this._find(r);o?(n=o.tooltip,o.closing||(clearInterval(this.delayedShow),r.data("ui-tooltip-title")&&!r.attr("title")&&r.attr("title",r.data("ui-tooltip-title")),this._removeDescribedBy(r),o.hiding=!0,n.stop(!0),this._hide(n,this.options.hide,(function(){i._removeTooltip(e(this))})),r.removeData("ui-tooltip-open"),this._off(r,"mouseleave focusout keyup"),r[0]!==this.element[0]&&this._off(r,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,(function(t,n){e(n.element).attr("title",n.title),delete i.parents[t]})),o.closing=!0,this._trigger("close",t,{tooltip:n}),o.hiding||(o.closing=!1))):r.removeData("ui-tooltip-open")},_tooltip:function(t){var n=e("<div>").attr("role","tooltip"),i=e("<div>").appendTo(n),r=n.uniqueId().attr("id");return this._addClass(i,"ui-tooltip-content"),this._addClass(n,"ui-tooltip","ui-widget ui-widget-content"),n.appendTo(this._appendTo(t)),this.tooltips[r]={element:t,tooltip:n}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){clearInterval(this.delayedShow),e.remove(),delete this.tooltips[e.attr("id")]},_appendTo:function(e){var t=e.closest(".ui-front, dialog");return t.length||(t=this.document[0].body),t},_destroy:function(){var t=this;e.each(this.tooltips,(function(n,i){var r=e.Event("blur"),o=i.element;r.target=r.currentTarget=o[0],t.close(r,!0),e("#"+n).remove(),o.data("ui-tooltip-title")&&(o.attr("title")||o.attr("title",o.data("ui-tooltip-title")),o.removeData("ui-tooltip-title"))})),this.liveRegion.remove()}}),!0===e.uiBackCompat&&e.widget("ui.tooltip",e.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var e=this._superApply(arguments);return this.options.tooltipClass&&e.tooltip.addClass(this.options.tooltipClass),e}});return e.ui.tooltip})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;!function(a){"use strict";r=[n(0),n(1)],void 0===(o="function"==typeof(i=function(e){})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery Color Animations v3.0.0
 * https://github.com/jquery/jquery-color
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 *
 * Date: Wed May 15 16:49:44 2024 +0200
 */!function(a,s){"use strict";r=[n(0)],void 0===(o="function"==typeof(i=function(e,t){var n,i={},r=i.toString,o=/^([\-+])=\s*(\d+\.?\d*)/,a=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?(parseInt(e[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),e[4]?(parseInt(e[4]+e[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],s=e.Color=function(t,n,i,r){return new e.Color.fn.parse(t,n,i,r)},l={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=e.each;function d(e){return null==e?e+"":"object"==typeof e?i[r.call(e)]||"object":typeof e}function h(e,t,n){var i=c[t.type]||{};return null==e?n||!t.def?null:t.def:(e=i.floor?~~e:parseFloat(e),i.mod?(e+i.mod)%i.mod:Math.min(i.max,Math.max(0,e)))}function p(t){var i=s(),r=i._rgba=[];return t=t.toLowerCase(),u(a,(function(e,n){var o,a=n.re.exec(t),s=a&&n.parse(a),c=n.space||"rgba";if(s)return o=i[c](s),i[l[c].cache]=o[l[c].cache],r=i._rgba=o._rgba,!1})),r.length?("0,0,0,0"===r.join()&&e.extend(r,n.transparent),i):n[t]}function f(e,t,n){return 6*(n=(n+1)%1)<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}u(l,(function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}})),e.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){i["[object "+t+"]"]=t.toLowerCase()})),s.fn=e.extend(s.prototype,{parse:function(i,r,o,a){if(i===t)return this._rgba=[null,null,null,null],this;(i.jquery||i.nodeType)&&(i=e(i).css(r),r=t);var c=this,f=d(i),g=this._rgba=[];return r!==t&&(i=[i,r,o,a],f="array"),"string"===f?this.parse(p(i)||n._default):"array"===f?(u(l.rgba.props,(function(e,t){g[t.idx]=h(i[t.idx],t)})),this):"object"===f?(u(l,i instanceof s?function(e,t){i[t.cache]&&(c[t.cache]=i[t.cache].slice())}:function(t,n){var r=n.cache;u(n.props,(function(e,t){if(!c[r]&&n.to){if("alpha"===e||null==i[e])return;c[r]=n.to(c._rgba)}c[r][t.idx]=h(i[e],t,!0)})),c[r]&&e.inArray(null,c[r].slice(0,3))<0&&(null==c[r][3]&&(c[r][3]=1),n.from&&(c._rgba=n.from(c[r])))}),this):void 0},is:function(e){var t=s(e),n=!0,i=this;return u(l,(function(e,r){var o,a=t[r.cache];return a&&(o=i[r.cache]||r.to&&r.to(i._rgba)||[],u(r.props,(function(e,t){if(null!=a[t.idx])return n=a[t.idx]===o[t.idx]}))),n})),n},_space:function(){var e=[],t=this;return u(l,(function(n,i){t[i.cache]&&e.push(n)})),e.pop()},transition:function(e,t){var n=s(e),i=n._space(),r=l[i],o=0===this.alpha()?s("transparent"):this,a=o[r.cache]||r.to(o._rgba),d=a.slice();return n=n[r.cache],u(r.props,(function(e,i){var r=i.idx,o=a[r],s=n[r],l=c[i.type]||{};null!==s&&(null===o?d[r]=s:(l.mod&&(s-o>l.mod/2?o+=l.mod:o-s>l.mod/2&&(o-=l.mod)),d[r]=h((s-o)*t+o,i)))})),this[i](d)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),r=s(t)._rgba;return s(e.map(n,(function(e,t){return(1-i)*r[t]+i*e})))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,(function(e,t){return null!=e?e:t>2?1:0}));return 1===n[3]&&(n.pop(),t="rgb("),t+n.join(", ")+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),(function(e,t){return null==e&&(e=t>2?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e}));return 1===n[3]&&(n.pop(),t="hsl("),t+n.join(", ")+")"},toHexString:function(t){var n=this._rgba.slice(),i=n.pop();return t&&n.push(~~(255*i)),"#"+e.map(n,(function(e){return("0"+(e||0).toString(16)).substr(-2)})).join("")},toString:function(){return this.toRgbaString()}}),s.fn.parse.prototype=s.fn,l.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,i=e[0]/255,r=e[1]/255,o=e[2]/255,a=e[3],s=Math.max(i,r,o),l=Math.min(i,r,o),c=s-l,u=s+l,d=.5*u;return t=l===s?0:i===s?60*(r-o)/c+360:r===s?60*(o-i)/c+120:60*(i-r)/c+240,n=0===c?0:d<=.5?c/u:c/(2-u),[Math.round(t)%360,n,d,null==a?1:a]},l.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],i=e[2],r=e[3],o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;return[Math.round(255*f(a,o,t+1/3)),Math.round(255*f(a,o,t)),Math.round(255*f(a,o,t-1/3)),r]},u(l,(function(e,n){var i=n.props,r=n.cache,a=n.to,l=n.from;s.fn[e]=function(e){if(a&&!this[r]&&(this[r]=a(this._rgba)),e===t)return this[r].slice();var n,o=d(e),c="array"===o||"object"===o?e:arguments,p=this[r].slice();return u(i,(function(e,t){var n=c["object"===o?e:t.idx];null==n&&(n=p[t.idx]),p[t.idx]=h(n,t)})),l?((n=s(l(p)))[r]=p,n):s(p)},u(i,(function(t,n){s.fn[t]||(s.fn[t]=function(i){var r,a,s,l,c=d(i);return a=(r=this[l="alpha"===t?this._hsla?"hsla":"rgba":e]())[n.idx],"undefined"===c?a:("function"===c&&(c=d(i=i.call(this,a))),null==i&&n.empty?this:("string"===c&&(s=o.exec(i))&&(i=a+parseFloat(s[2])*("+"===s[1]?1:-1)),r[n.idx]=i,this[l](r)))})}))})),s.hook=function(t){var n=t.split(" ");u(n,(function(t,n){e.cssHooks[n]={set:function(e,t){var i;"transparent"===t||"string"===d(t)&&!(i=p(t))||(t=(t=s(i||t)).toRgbaString()),e.style[n]=t}},e.fx.step[n]=function(t){t.colorInit||(t.start=s(t.elem,n),t.end=s(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}}))},s.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),e.cssHooks.borderColor={expand:function(e){var t={};return u(["Top","Right","Bottom","Left"],(function(n,i){t["border"+i+"Color"]=e})),t}},n=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Blind 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("blind","hide",(function(t,n){var i={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},r=e(this),o=t.direction||"up",a=r.cssClip(),s={clip:e.extend({},a)},l=e.effects.createPlaceholder(r);s.clip[i[o][0]]=s.clip[i[o][1]],"show"===t.mode&&(r.cssClip(s.clip),l&&l.css(e.effects.clipToBox(s)),s.clip=a),l&&l.animate(e.effects.clipToBox(s),t.duration,t.easing),r.animate(s,{queue:!1,duration:t.duration,easing:t.easing,complete:n})}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Bounce 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("bounce",(function(t,n){var i,r,o,a=e(this),s=t.mode,l="hide"===s,c="show"===s,u=t.direction||"up",d=t.distance,h=t.times||5,p=2*h+(c||l?1:0),f=t.duration/p,g=t.easing,m="up"===u||"down"===u?"top":"left",v="up"===u||"left"===u,y=0,b=a.queue().length;for(e.effects.createPlaceholder(a),o=a.css(m),d||(d=a["top"===m?"outerHeight":"outerWidth"]()/3),c&&((r={opacity:1})[m]=o,a.css("opacity",0).css(m,v?2*-d:2*d).animate(r,f,g)),l&&(d/=Math.pow(2,h-1)),(r={})[m]=o;y<h;y++)(i={})[m]=(v?"-=":"+=")+d,a.animate(i,f,g).animate(r,f,g),d=l?2*d:d/2;l&&((i={opacity:0})[m]=(v?"-=":"+=")+d,a.animate(i,f,g)),a.queue(n),e.effects.unshift(a,b,p+1)}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Clip 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("clip","hide",(function(t,n){var i,r={},o=e(this),a=t.direction||"vertical",s="both"===a,l=s||"horizontal"===a,c=s||"vertical"===a;i=o.cssClip(),r.clip={top:c?(i.bottom-i.top)/2:i.top,right:l?(i.right-i.left)/2:i.right,bottom:c?(i.bottom-i.top)/2:i.bottom,left:l?(i.right-i.left)/2:i.left},e.effects.createPlaceholder(o),"show"===t.mode&&(o.cssClip(r.clip),r.clip=i),o.animate(r,{queue:!1,duration:t.duration,easing:t.easing,complete:n})}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Drop 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("drop","hide",(function(t,n){var i,r=e(this),o="show"===t.mode,a=t.direction||"left",s="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a?"-=":"+=",c="+="===l?"-=":"+=",u={opacity:0};e.effects.createPlaceholder(r),i=t.distance||r["top"===s?"outerHeight":"outerWidth"](!0)/2,u[s]=l+i,o&&(r.css(u),u[s]=c+i,u.opacity=1),r.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:n})}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Explode 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("explode","hide",(function(t,n){var i,r,o,a,s,l,c=t.pieces?Math.round(Math.sqrt(t.pieces)):3,u=c,d=e(this),h="show"===t.mode,p=d.show().css("visibility","hidden").offset(),f=Math.ceil(d.outerWidth()/u),g=Math.ceil(d.outerHeight()/c),m=[];function v(){m.push(this),m.length===c*u&&(d.css({visibility:"visible"}),e(m).remove(),n())}for(i=0;i<c;i++)for(a=p.top+i*g,l=i-(c-1)/2,r=0;r<u;r++)o=p.left+r*f,s=r-(u-1)/2,d.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-r*f,top:-i*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:g,left:o+(h?s*f:0),top:a+(h?l*g:0),opacity:h?0:1}).animate({left:o+(h?0:s*f),top:a+(h?0:l*g),opacity:h?1:0},t.duration||500,t.easing,v)}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Fade 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("fade","toggle",(function(t,n){var i="show"===t.mode;e(this).css("opacity",i?0:1).animate({opacity:i?1:0},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Fold 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("fold","hide",(function(t,n){var i=e(this),r=t.mode,o="show"===r,a="hide"===r,s=t.size||15,l=/([0-9]+)%/.exec(s),c=!!t.horizFirst?["right","bottom"]:["bottom","right"],u=t.duration/2,d=e.effects.createPlaceholder(i),h=i.cssClip(),p={clip:e.extend({},h)},f={clip:e.extend({},h)},g=[h[c[0]],h[c[1]]],m=i.queue().length;l&&(s=parseInt(l[1],10)/100*g[a?0:1]),p.clip[c[0]]=s,f.clip[c[0]]=s,f.clip[c[1]]=0,o&&(i.cssClip(f.clip),d&&d.css(e.effects.clipToBox(f)),f.clip=h),i.queue((function(n){d&&d.animate(e.effects.clipToBox(p),u,t.easing).animate(e.effects.clipToBox(f),u,t.easing),n()})).animate(p,u,t.easing).animate(f,u,t.easing).queue(n),e.effects.unshift(i,m,4)}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Highlight 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("highlight","show",(function(t,n){var i=e(this),r={backgroundColor:i.css("backgroundColor")};"hide"===t.mode&&(r.opacity=0),e.effects.saveStyle(i),i.css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(r,{queue:!1,duration:t.duration,easing:t.easing,complete:n})}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Puff 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3),n(24)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("puff","hide",(function(t,n){var i=e.extend(!0,{},t,{fade:!0,percent:parseInt(t.percent,10)||150});e.effects.effect.scale.call(this,i,n)}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Pulsate 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("pulsate","show",(function(t,n){var i=e(this),r=t.mode,o="show"===r,a=o||"hide"===r,s=2*(t.times||5)+(a?1:0),l=t.duration/s,c=0,u=1,d=i.queue().length;for(!o&&i.is(":visible")||(i.css("opacity",0).show(),c=1);u<s;u++)i.animate({opacity:c},l,t.easing),c=1-c;i.animate({opacity:c},l,t.easing),i.queue(n),e.effects.unshift(i,d,s+1)}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Shake 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("shake",(function(t,n){var i=1,r=e(this),o=t.direction||"left",a=t.distance||20,s=t.times||3,l=2*s+1,c=Math.round(t.duration/l),u="up"===o||"down"===o?"top":"left",d="up"===o||"left"===o,h={},p={},f={},g=r.queue().length;for(e.effects.createPlaceholder(r),h[u]=(d?"-=":"+=")+a,p[u]=(d?"+=":"-=")+2*a,f[u]=(d?"-=":"+=")+2*a,r.animate(h,c,t.easing);i<s;i++)r.animate(p,c,t.easing).animate(f,c,t.easing);r.animate(p,c,t.easing).animate(h,c/2,t.easing).queue(n),e.effects.unshift(r,g,l+1)}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Slide 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){return e.effects.define("slide","show",(function(t,n){var i,r,o=e(this),a={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},s=t.mode,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l,d=t.distance||o["top"===c?"outerHeight":"outerWidth"](!0),h={};e.effects.createPlaceholder(o),i=o.cssClip(),r=o.position()[c],h[c]=(u?-1:1)*d+r,h.clip=o.cssClip(),h.clip[a[l][1]]=h.clip[a[l][0]],"show"===s&&(o.cssClip(h.clip),o.css(c,h[c]),h.clip=i,h[c]=r),o.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:n})}))})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){var i,r,o;
/*!
 * jQuery UI Effects Transfer 1.14.0
 * https://jqueryui.com
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * https://jquery.org/license
 */!function(a){"use strict";r=[n(0),n(1),n(3)],void 0===(o="function"==typeof(i=function(e){var t;!0===e.uiBackCompat&&(t=e.effects.define("transfer",(function(t,n){e(this).transfer(t,n)})));return t})?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){n(104)},function(e,t,n){},function(e,t){angular.module("evtviewer.core",[])},function(e,t){angular.module("evtviewer.core").constant("GLOBALDEFAULTCONF",{test:{active:!1},debugAllModules:!0,debugConf:{log:!0,info:!0,warn:!0,debug:!0},modules:{interface:{active:!0}},configUrl:"./config/config.json",dataUrl:"",logoUrl:"",enableXMLdownload:!0,sourcesUrl:"",sourcesTextsUrl:"",visCollSvg:"",analoguesUrl:"",visCollTextUrl:"",visCollImageList:"",visCollStyleUrl:"",visCollDataModel:"",preferredWitness:"A",skipWitnesses:"",indexTitle:"EVT Critical Viewer",webSite:"",editionType:"critical",defaultEdition:"critical",showEditionLevelSelector:!0,availableEditionLevel:[{value:"critical",label:"Critical",title:"Critical edition",visible:!0},{value:"diplomatic",label:"Diplomatic",title:"Diplomatic edition",visible:!0},{value:"interpretative",label:"Interpretative",title:"Interpretative edition",visible:!0}],showDocumentSelector:!0,defaultViewMode:"readingTxt",availableViewModes:[{label:"READING_TEXT",icon:"reading-txt",viewMode:"readingTxt",visible:!0},{label:"MULTIPLE_RECENSIONS",icon:"mode-versions",viewMode:"versions",visible:!0},{label:"IMAGE_TEXT",icon:"mode-imgTxt",viewMode:"imgTxt",visible:!0},{label:"TEXT_TEXT",icon:"mode-txtTxt",viewMode:"txtTxt",visible:!1},{label:"COLLATION",icon:"mode-collation",viewMode:"collation",visible:!0},{label:"SOURCE_TEXT",icon:"mode-srcTxt",viewMode:"srcTxt",visible:!0},{label:"3DHOP",icon:"mode-tdhop",viewMode:"tdhop",visible:!0}],toolHeatMap:!0,toolPinAppEntries:!1,toolImageTextLinking:!0,viscollButton:!1,thumbnailsButton:!0,listDef:"<listWit>, <listChange>",versionDef:"<witness>, <change>",fragmentMilestone:"<witStart>, <witEnd>",lacunaMilestone:"<lacunaStart>, <lacunaEnd>",possibleVariantFilters:"type, cause, hand",possibleLemmaFilters:"resp, cert",notSignificantVariant:"<orig>, <sic>, [type=orthographic]",loadCriticalEntriesImmediately:!0,maxWitsLoadTogether:5,versions:[],witnessesGroups:[{groupName:"Grp_1",witnesses:["V","P","N","M","G","C","R"]},{groupName:"Grp_2",witnesses:["F","D","O","W","M5mg","B","U"]}],quoteDef:"<quote>",analogueDef:"<seg>,<ref[type=parallelPassage]>",showReadingExponent:!0,showInlineCriticalApparatus:!0,showInlineSources:!1,showInlineAnalogues:!1,variantColors:{},filterColors:{},genericColors:["rgb(52, 197, 173)","rgb(238, 194, 66)","rgb(253, 153, 54)","rgb(253, 95, 58)","rgb(235, 77, 153)","rgb(252, 144, 172)","rgb(171, 99, 219)","rgb(67, 135, 217)","rgb(163, 207, 81)","rgb(238, 194, 66)","rgb(228, 99, 220)","rgb(124, 113, 232)"],variantColorLight:"rgb(208, 220, 255)",variantColorDark:"rgb(101, 138, 255)",heatmapColor:"rgb(255, 108, 63)",xsltUrl:"",defaultBibliographicStyle:"Chicago",allowedBibliographicStyles:{Chicago:{label:"Chicago",enabled:!0},APA:{label:"APA",enabled:!1},MLA:{label:"MLA",enabled:!0}},bibliographicEntriesSortBy:{Author:"BIBLIOGRAPHY.AUTHOR",Year:"BIBLIOGRAPHY.YEAR",Title:"BIBLIOGRAPHY.TITLE",Publisher:"BIBLIOGRAPHY.PUBLISHER"},bibliographySortOrder:{ASC:"BIBLIOGRAPHY.ASC",DESC:"BIBLIOGRAPHY.DESC"},namedEntitiesSelector:!0,namedEntitiesToHandle:[],otherEntitiesToHandle:[],languages:["en","it"],showObjectSelector:!0,tdhopViewerOptions:{name:"Bewcastle",url:"data/3Dmodels/multires/bewcastle.nxz",mesh:"Bewcastle",toolHome:!0,toolZoomin:!0,toolZoomout:!0,toolLighting:!0,toolLightControl:!0,toolMeasure:!0,toolPickPoint:!0,toolPlaneSections:!0,toolSolidColor:!0,toolCamera:!0,toolFullScreen:!0}})},function(e,t,n){(function(e){angular.module("evtviewer.core").provider("Utils",(function(){this.deepExtend=function e(t,n){for(var i in n)n[i]&&n[i].constructor&&n[i].constructor===Object?(t[i]=t[i]||{},e(t[i],n[i])):t[i]=angular.copy(n[i]);return t},this.deepExtendSkipDefault=function e(t,n){for(var i in n)n[i]&&n[i].constructor&&n[i].constructor===Object?(t[i]=t[i]||{},e(t[i],n[i])):"dataUrl"===i?""!==n[i]&&(t[i]=angular.copy(n[i])):"NONE"===n[i]||"NULL"===n[i]?t[i]="":""!==n[i]&&(t[i]=angular.copy(n[i]));return t},this.getElementsBetweenTree=function(e,t){for(var n,i=this.getCommonAncestor(e,t),r=[];e.parentNode!==i;){for(n=e;n.nextSibling;)r.push(n=n.nextSibling);e=e.parentNode}for(var o=[];t.parentNode!==i;){for(n=t;n.previousSibling;)o.push(n=n.previousSibling);t=t.parentNode}for(o.reverse();(e=e.nextSibling)!==t;)r.push(e);return r.concat(o)},this.getCommonAncestor=function(t,n){for(var i=e(t).parents().addBack();n;){if(-1!==i.index(n))return n;n=n.parentNode}return null},this.isNestedInElem=function(e,t){return!(null===e.parentNode||void 0===e.parentNode||!e.parentNode.tagName)&&("text"!==e.parentNode.tagName&&(e.parentNode.tagName.toLowerCase()===t.toLowerCase()||this.isNestedInElem(e.parentNode,t)))},this.isNestedInClassElem=function(e,t){return!(null===e.parentNode||void 0===e.parentNode||!e.parentNode.className)&&(""!==e.parentNode.className&&(e.parentNode.className.indexOf(t)>=0||this.isNestedInElem(e.parentNode,t)))};var t=function(){var e=Math.floor(256*Math.random()).toString(16);return("0"+String(e)).substr(-2)};this.getRandomColor=function(e){if("hex"===e)return"#"+t()+t()+t();if("rgb"===e){var n=[256*Math.random(),256*Math.random(),256*Math.random()],i=[255,255,255];return"rgb("+[n[0]+i[0],n[1]+i[1],n[2]+i[2]].map((function(e){return Math.round(e/2)})).join(",")+")"}},this.decodeHTMLEntities=function(e){var t=document.createElement("div");return e&&"string"==typeof e&&(e=(e=e.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,"")).replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),t.innerHTML=e,e=t.textContent,t.textContent=""),t=void 0,e},this.cleanText=function(e){return e=this.cleanPunctuation(e),e=this.cleanSpace(e)},this.cleanSpace=function(e){for(var t,n=/\s\s/;e.match(n);)t=e.replace(n," "),e=t;return" "===e.charAt(0)&&(e=e.substring(1)),e},this.cleanPunctuation=function(e){for(var t,n=/[.,#!$%\^&\*;:{}\[\]\'\"=\-_`~()]/;e.match(n);)t=e.replace(n,""),e=t;return e},this.replaceStringAt=function(e,t,n,i,r){return e.slice(0,i)+e.slice(i,r).replace(t,n)+e.slice(r)},this.$get=function(){return{deepExtend:this.deepExtend,deepExtendSkipDefault:this.deepExtendSkipDefault,getRandomColor:this.getRandomColor,cleanText:this.cleanText,cleanSpace:this.cleanSpace,cleanPunctuation:this.cleanPunctuation,replaceStringAt:this.replaceStringAt,DOMutils:{getElementsBetweenTree:this.getElementsBetweenTree,getCommonAncestor:this.getCommonAncestor,isNestedInElem:this.isNestedInElem,isNestedInClassElem:this.isNestedInClassElem,decodeHTMLEntities:this.decodeHTMLEntities}}}}))}).call(this,n(0))},function(e,t){angular.module("evtviewer.core").constant("BASECONFIG",{debug:!1}).provider("config",["UtilsProvider","GLOBALDEFAULTCONF","BASECONFIG",function(e,t,n){var i={};e.deepExtend(i,t),void 0!==window.globalConfig&&angular.isObject(window.globalConfig)&&e.deepExtend(i,window.globalConfig),void 0===window.GLOBALCONFIG&&(window.GLOBALCONFIG=i),this.makeDefaults=function(t,r){var o=angular.copy(n);return void 0!==r&&e.deepExtend(o,r),void 0!==i.modules[t]&&e.deepExtend(o,i.modules[t]),i.modules[t]=o,o},this.isValid=function(){return!0},this.isModuleActive=function(e){return angular.isObject(i.modules[e])&&!0===i.modules[e].active},this.extendDefault=function(t){e.deepExtendSkipDefault(i,t)},this.$get=function(){return i.isValid=this.isValid,i.isModuleActive=this.isModuleActive,i.extendDefault=this.extendDefault,i}}])},function(e,t){angular.module("evtviewer.core").run(["$log","config",function(e,t){function n(n,i,r){return function(){var o,a=e.enabledContexts[r],s=t.modules[r];if(!1!==t.debugConf[i]&&(o=void 0!==a?a:void 0!==s&&void 0!==s.debug&&s.debug,!0===t.debugAllModules||!0===o)){var l=Array.prototype.slice.call(arguments);l.unshift("#"+r+"#"),n.apply(null,l)}}}function i(e,t){return function(){var n=function(){try{throw Error("")}catch(e){return e}},i=n(),r=i.stack.split("\n")[4],o=Array.prototype.slice.call(arguments);o.unshift("#EVTViewer "+t+"#"),o.push(r),e.apply(null,o)}}e.enabledContexts=[],e.getInstance=function(t){return{log:n(e.log,"log",t),info:n(e.info,"info",t),warn:n(e.warn,"warn",t),debug:n(e.debug,"debug",t),error:i(e.error,t),enableLogging:function(n){e.enabledContexts[t]=n}}}}])},function(e,t){angular.module("evtviewer.core").service("eventDispatcher",["$q",function(e){var t={},n={};return t.sendEvent=function(t,i){var r,o,a=[],s=0;return n[t]&&angular.forEach(n[t],(function(t){void 0!==t&&(o={args:i,resolve:function(e){s<a.length&&(a[s].resolve(e),s++)},reject:function(e){s<a.length&&(a[s].reject(e),s++)}},a.push(e.defer()),t.apply(null,[o]))})),r=a.map((function(e){return e.promise})),e.all(r)},t.addListener=function(e,t){return n[e]||(n[e]=[]),n[e].push(t),[e,t]},t.addListeners=function(e,n){var i=[];for(var r in e)i.push(t.addListener(e[r],n));return i},t.removeListener=function(e){var t=e[0],i=e[1];n[t]&&angular.forEach(n[t],(function(e,r){e===i&&(n[t].splice(r,1),0===n[t].length&&delete n[t])}))},t.getListeners=function(){var e=[];for(var t in n)e.push(t);return e},t}])},function(e,t){angular.module("evtviewer.core").config(["$compileProvider",function(e){e.directive("compile",["$compile",function(e){return function(t,n,i){t.$watch((function(e){return e.$eval(i.compile)}),(function(i){n.html(i),e(n.contents())(t)}))}}])}])},function(e,t){angular.module("evtviewer.core").filter("capitalize",(function(){return function(e,t){var n=t?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return e&&e.replace?e.replace(n,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})):""}})).filter("camelToSpaces",(function(){return function(e,t){return e&&e.replace?e.replace(/\s+/g," ").replace(/([a-z\d])([A-Z])/g,"$1 $2"):""}})).filter("underscoresToSpaces",(function(){return function(e,t){return e&&e.replace?e.replace(/\_+/g," "):""}})).filter("uppercase",(function(){return function(e,t){return e&&e.toUpperCase?e.toUpperCase():""}})).filter("stringtohtml",(function(){return function(e,t){return e&&e.replace?e.replace(/="[^"]+"/g,(function(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">")})):""}})).filter("newLinesToSpaces",(function(){return function(e){return e.replace(/\n/g," ")}})).filter("normalizeMultispaces",(function(){return function(e){return e.replace(/\s{2,}/g," ")}}))},function(e,t){angular.module("evtviewer.core").constant("XPATH",{getLineNodes:".//node()[self::lb or self::p or self::pb or self::head]",getParLineNodes:".//node()[self::p or self:l or self::pb or self::head]",getPrevLb:"count(.//preceding::lb[ancestor::body])",getPrevBody:"count(.//preceding::body)",getPrevPb:"count(.//preceding::pb)",getDiplomaticNodes:".//node()[self::lb or self::pb or self::g or self::text()][not((ancestor::corr or ancestor::reg or ancestor::expan or ancestor::ex))]",getDiplomaticChildNodes:".//node()[self::g or self::pb or self::text()][not((ancestor::corr or ancestor::reg or ancestor::expan or ancestor::ex))]",getInterpretativeNodes:"//body//node()[self::lb or self::pb or self::g or self::text()][not(ancestor::sic or ancestor::orig or ancestor::abbr or ancestor::am)]",getInterpretativeChildNodes:".//node()[self::g or self::pb or self::text()][not(ancestor::sic or ancestor::orig or ancestor::abbr or ancestor::am)]",getChildNodes:".//node()[self::g or self::pb or self::text()]",getTextGlyphNodes:".//node()[self::g or self::lb or self::pb or self::text()]",getGlyphNodes:".//node()[self::g]",getCurrentTextNode:".//ancestor::text[1]",ns:{getLineNodes:".//node()[self::ns:lb or self::ns:p or self::ns:pb or self::ns:head]",getParLineNodes:".//node()[self::ns:p or self::ns:l or self::ns:pb or self::ns:head]",getPrevLb:"count(.//preceding::ns:lb[ancestor::ns:body])",getPrevBody:"count(.//preceding::ns:body)",getPrevP:"count(.//preceding::ns:p)",getDiplomaticNodes:".//node()[self::ns:lb or self::ns:pb or self::ns:g or self::text()][not((ancestor::ns:corr or ancestor::ns:reg or ancestor::ns:expan or ancestor::ns:ex))]",getDiplomaticChildNodes:".//node()[self::ns:g or self::ns:pb or self::text()][not((ancestor::ns:corr or ancestor::ns:reg or ancestor::ns:expan or ancestor::ns:ex))]",getInterpretativeNodes:".//node()[self::ns:lb or self::ns:pb or self::ns:g or self::text()][not(ancestor::ns:sic or ancestor::ns:orig or ancestor::ns:abbr or ancestor::ns:am)]",getInterpretativeChildNodes:".//node()[self::ns:g or self::ns:pb or self::text()][not(ancestor::ns:sic or ancestor::ns:orig or ancestor::ns:abbr or ancestor::ns:am)]",getChildNodes:".//node()[self::ns:g or self::ns:pb or self::text()]",getTextGlyphNodes:".//node()[self::ns:g or self::ns:lb or self::ns:pb or self::text()]",getGlyphNodes:".//node()[self::ns:g]",getCurrentTextNode:".//ancestor::ns:text[1]"}})},function(e,t){angular.module("evtviewer.dataHandler",[])},function(e,t){angular.module("evtviewer.dataHandler").service("baseData",["$log","$q","$http","config","xmlParser","evtParser","evtCriticalApparatusParser","evtSourcesParser","evtProjectInfoParser","evtPrimarySourcesParser","evtAnaloguesParser","evtDialog","evtBibliographyParser","evtNamedEntitiesParser","evtHotSpotParser","parsedData",function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,g){var m,v={},y={XMLDocuments:[],XMLExtDocuments:[],XMLSrcDocuments:[],XMLStrings:[]},b=e.getInstance("baseData"),_={};v.addXMLString=function(e){var n=[];return n.push(x(e).promise),t.all(n)},v.getXML=function(){return m},v.getXMLDocuments=function(){return y.XMLDocuments},v.getXMLStrings=function(){return y.XMLStrings};var x=function(e){var n=t.defer();return e=e.replace(/<!--.*-->/gm,""),"TEI"===(m=r.parse(e)).documentElement.nodeName?(y.XMLStrings.push(e),S(m).promise.then((function(){y.XMLDocuments.push(m),w(m),b.log("XML TEI parsed and stored ",y.XMLDocuments),n.resolve("success")}))):(b.error("Something wrong with the XML"),n.resolve("success")),n};v.addXMLExtDocument=function(e,t){var n=r.parse(e);try{y.XMLStrings.push(e),y.XMLExtDocuments[t]=n,y.XMLExtDocuments.length++;o.parseExternalDocuments(n,t);b.log("External Files parsed and stored",y.XMLExtDocuments)}catch(e){b.log("Something wrong with the supplementary XML files "+e)}},v.addXMLSrcDocument=function(e,t){var n=r.parse(e);try{y.XMLStrings.push(e),y.XMLSrcDocuments[t]=n,y.XMLSrcDocuments.length++;o.parseExternalDocuments(n,t);b.log("Source file parsed and stored",y.XMLSrcDocuments)}catch(e){b.log("Something wrong with the supplementary XML files "+e)}},v.handleViscollSvg=function(e,t){var n=r.parse(e);o.parseSvgsForViscoll(n,t)},v.addViscollDataModel=function(e){var t=r.parse(e);o.parseViscollDatamodel(t)},v.addViscollImageList=function(e){var t=r.parse(e);o.parseViscollImageList(t)};var w=function(e){if(o.analyzeEncoding(e),c.parseZones(e),f.parseHotSpots(e),o.parseDocuments(e),a.parseWitnesses(e),""!==i.quoteDef){var n=[];n.push(s.parseQuotes(e)),t.all(n).then((function(){""===i.sourcesUrl?s.parseSources(e):s.parseSources(e,y.XMLExtDocuments.sources)}))}""!==i.analogueDef&&(""===i.analoguesUrl?u.parseAnalogues(e,""):u.parseAnalogues(e,y.XMLExtDocuments.analogues)),p.parseEntities(e),l.parseProjectInfo(e),h.parseBiblInfo(e),o.parseGlyphs(e),"internal"!==g.getEncodingDetail("variantEncodingLocation")&&(i.loadCriticalEntriesImmediately&&a.parseCriticalEntries(e),i.versions.length>1&&a.parseVersionEntries(e))},S=function(e){var o=t.defer(),a=i.dataUrl,s=0,l=e.getElementsByTagName("xi:include");if(a=a.substring(0,a.lastIndexOf("/")+1),l&&l.length>0){var c=l.length;angular.forEach(l,(function(e){var t=a+e.getAttribute("href"),i=e.getAttribute("xpointer");n.get(t).then((function(t){s++;var n,a=r.parse(t.data);if(i){var l=angular.element(a)[0];T(i,l),n=_[i]}else n=a.getElementsByTagName("text")[0];e.parentNode.replaceChild(n,e),s===c&&o.resolve("success")}),(function(t){var n=e.getElementsByTagName("fallback")[0],r=d.getById("errorMsg"),a=n?n.innerHTML:"";a+='<div style="text-align:center;">Warning! <br/> EVT could not work properly.</div>',r.updateContent(a),r.setTitle(i+" - XI:INCLUDE ERROR"),r.open(),o.resolve("success")}))}))}else o.resolve("success");return o},T=function(e,t){t.childNodes.forEach((function(t){return t.attributes&&t.hasAttribute("xml:id")&&t.getAttribute("xml:id")===e?(_[e]=t,t):t.childNodes&&t.childNodes.length>0?T(e,t):void 0}))};return v}])},function(e,t){angular.module("evtviewer.dataHandler").service("parsedData",["$log","config","Utils",function(e,t,n){var i={};e.getInstance("dataHandler").log("parsedData running");var r={},o={fileDescription:"",encodingDescription:"",textProfile:"",outsideMetadata:"",revisionHistory:"",msDesc:""},a={_indexes:[]},s={length:0,_indexes:[]},l=[],c={svgs:{_indexes:[]},quires:{_indexes:[]},imglist:{_indexes:[]},svgToLoad:[],loaded:!1},u={_indexes:[],length:0},d={length:0},h={length:0},p={length:0,_indexes:{corresp:{},subDivs:{},main:{}}},f={_indexes:{witnesses:[],groups:[],encodingStructure:[]}},g=t.genericColors,m={filtersCollection:{filters:{},length:0,forLemmas:0,forVariants:0,colors:[]},__allLoaded:!1,_maxVariance:0,_indexes:{encodingStructure:[],appEntries:[],exponents:[],depa:{start:{},end:{}}}},v={},y=[],b={_indexes:{encodingStructure:[],versionWitMap:{},versionId:{_name:{}}}},_={},x=!1,w={_indexes:[]},S={_indexes:[]},T={_indexes:[]},E={_collections:{_indexes:[]},_indexes:[]};i.getEncodingDetail=function(e){return r[e]},i.setEncodingDetail=function(e,t){r[e]=t},i.getNamedEntityTypeIcon=function(e){var t;switch(e){case"place":case"placeName":t="fa-map-marker";break;case"person":case"pers":case"persName":t="fa-user";break;case"org":case"orgName":t="fa-users";break;case"relation":t="fa-share-alt";break;default:t="fa-list-ul"}return t},i.addNamedEntitiesCollection=function(e){var t=e.id;if(void 0===E._collections[t]){var n=e&&e.type?e.type:"generic",r=i.getNamedEntityTypeIcon(n);E._collections[t]={_indexes:[],_listKeys:[],_title:e&&e.title?e.title:"",_type:n,_icon:r},E._collections._indexes.push(t)}},i.addNamedEntityInCollection=function(e,t,n){var i=e.id;void 0===E._collections[i]&&this.addNamedEntitiesCollection(e),void 0===E._collections[i][n]&&(E._collections[i][n]={_indexes:[]},E._collections[i]._listKeys.push(n));var r=t.id;E._collections[i][n][r]=t,E[r]={collectionId:i,listKey:n},E._indexes.push(r),E._collections[i]._indexes.push(r),E._collections[i][n]._indexes.push(r)},i.getNamedEntities=function(){return E},i.getNamedEntitiesCollection=function(){return E._collections},i.getNamedEntitiesCollectionByName=function(e){return E._collections[e]},i.getNamedEntitiesCollectionByNameAndPos=function(e,t){return E._collections[e][t]},i.getNamedEntity=function(e){var t;if(e){var n=E[e];void 0!==n&&void 0!==n.collectionId&&void 0!==n.listKey&&void 0!==E._collections[n.collectionId]&&void 0!==E._collections[n.collectionId][n.listKey]&&(t=E._collections[n.collectionId][n.listKey][e])}return t},i.getNamedEntityType=function(e){var t=e&&E[e]?E[e].collectionId:void 0,n=i.getNamedEntitiesCollectionByName(t);return n?n._type:"generic"};var C={_indexes:{encodingStructure:[],sourcesRef:{_id:[]}}},k={_indexes:{encodingStructure:[],quotesRef:{_id:[]},availableTexts:[],correspId:{}}},L={_indexes:{encodingStructure:[]},_refId:{_indexes:[]}};i.addPage=function(e,t){var n=e.value;if(void 0===s.length&&(s.length=0),""===e.value&&(n=e.value="page_"+(s.length+1)),void 0===s[n])e.docs=[t],s[s.length]=n,e.indexInCollection=s.length,s[n]=e,s.length++,s._indexes.push(n);else{var i=s[n];i.docs&&i.docs.indexOf(t)<0&&i.docs.push(t)}t&&""!==t&&void 0!==u[t]&&u[t].pages.push(n),l[s.length-1]={value:e.value,image:e.image,label:e.label,docs:e.docs}},i.getPages=function(){return s},i.getThumbnails=function(){return l},i.getPage=function(e){return s[e]},i.setPageText=function(e,t,n,i){var r=s[e];if(r){r.text||(r.text={});var o=r.text[t];void 0!==o&&void 0!==o[n]?o[n]+=i:void 0!==o?o[n]=i:(r.text[t]={},r.text[t][n]=i),r.docs&&r.docs.indexOf(t)<0&&r.docs.push(t)}},i.getPageText=function(e,t,n){var i=s[e];if(i&&i.text&&i.text[t])return i.text[t][n]},i.getPageImage=function(e){for(var t=[],n=0;n<t.length&&t[n].page!==e;)n++;return{}},i.addViscollSvg=function(e){var t=e.id||"svg_"+c.svgs._indexes.length;c.svgs[t]=e,c.quires[t]&&(c.quires[t].svg=e),c.svgs._indexes.push(t)},i.addViscollImageList=function(e){var t=e.id;c.imglist[t]=e,c.imglist._indexes.push(t)},i.addViscollQuire=function(e){var t=e.value;c.quires[t]=e,c.quires._indexes.push(t)},i.addViscollLeaf=function(e){var t=e.value,n=e.quire;c.quires[n].leaves[t]=e,c.quires[n].leaves._indexes.push(t)},i.setViscollSVGToLoad=function(e){c.svgToLoad=e},i.getViscollSVGToLoad=function(){return c.svgToLoad},i.updateLeafDataInQuire=function(e,t){if(c.quires[e].leaves[t.id])for(var n in t)c.quires[e].leaves[t.id][n]=t[n]},i.getViscollSvgs=function(){return c},i.setViscollSvgsLoaded=function(e){c.loaded=e},i.areViscollSvgsLoaded=function(){return c.loaded},i.getViscollSvg=function(e){return c[e]},i.addDocument=function(e){var t=e.value;""===e.value&&(t=e.value="doc_"+(u._indexes.length+1)),void 0===u[t]&&(u._indexes.push(t),u[t]=e)},i.getDocuments=function(){return u},i.getDocument=function(e){return u[e]},i.getPreviousDocument=function(e){var t=u._indexes.indexOf(e),n=u._indexes[t-1];return u[n]},i.addExternalDocument=function(e){var t=e.value;void 0===d.length&&(d.length=0),""===e.value&&(t=e.value="extDoc_"+(d.length+1)),void 0===d[t]&&(d[d.length]=t,d[t]=e,d.length++)},i.getExternalDocuments=function(){return d},i.getExternalDocument=function(e){return d[e]},i.addSourceDocument=function(e,t){var n=e.value;void 0===h.length&&(h.length=0),""===e.value&&(n=e.value=t),void 0===h[n]&&(h[h.length]=n,h[n]=e,h.length++)},i.getSourceDocuments=function(){return h},i.getSourceDocument=function(e){return h[e]},i.addDiv=function(e,t){var n=e.value;p[p.length]=n,p[n]=e,p.length++,u[t].divs.push(n),e.corresp&&angular.forEach(e.corresp,(function(t){p._indexes.corresp[t]||(p._indexes.corresp[t]=[]),p._indexes.corresp[t].push(e.value)})),e._isSubDiv||(p._indexes.subDivs[e.value]=e.subDivs||[],p._indexes.main[e.doc]||(p._indexes.main[e.doc]=[]),p._indexes.main[e.doc].push(e.value))},i.getDivs=function(){return p},i.getDiv=function(e){return p[e]},i.setCriticalEditionAvailability=function(e){x=e},i.isCriticalEditionAvailable=function(){return x},i.setEditions=function(e){y=e},i.addEdition=function(e){y.push(e)},i.getEditions=function(){return y},i.getEdition=function(e){for(var t,n=0;n<y.length&&void 0===t;)y[n].value===e&&(t=y[n]),n++;return t},i.addElementInWitnessCollection=function(e){var n=t.skipWitnesses.split(",").filter((function(e){return 0!==e.length}));e&&e.id&&n.indexOf(e.id)<0&&void 0===f[e.id]&&(f[e.id]=e,"group"===e._type?f._indexes.groups.push(e.id):f._indexes.witnesses.push(e.id),void 0===e._group&&f._indexes.encodingStructure.push(e.id))},i.addWitnessText=function(e,t,n){void 0!==f[e]&&(void 0===f[e].text&&(f[e].text={}),f[e].text[t]=n)},i.getWitnessText=function(e,t){if(void 0!==f[e]&&void 0!==f[e].text&&void 0!==f[e].text[t])return f[e].text[t]},i.getWitnessesList=function(){return f._indexes.witnesses},i.getWitnesses=function(){return f},i.getWitness=function(e){return f[e]},i.getWitnessPages=function(e){if(void 0!==f[e]){if(void 0===f[e].pages){for(var t={length:0},n=0;n<s.length;n++){var i=s[s[n]];i.ed==="#"+e&&(t[t.length]=s[n],t[s[n]]=i,t.length++)}f[e].pages=t}return f[e].pages}},i.isWitnessesGroup=function(e){return void 0!==f[e]&&"group"===f[e]._type},i.getWitnessesInGroup=function(e){var t=[];if(void 0!==f[e]&&"group"===f[e]._type){var n=f[e].content;for(var r in n){var o=n[r];i.isWitnessesGroup(o)?t.push.apply(t,i.getWitnessesInGroup(o)):t.push(o)}}return t},i.getWitnessesListFormatted=function(){var e,t=f._indexes.encodingStructure;e="<ul>";for(var n=0;n<t.length;n++){var i=f[t[n]];e+=P(i)}return e+="</ul>"};var P=function(e){var t="",n="";if("witness"===e._type)t+="<li><div>",e.attributes&&e.attributes.n?n=e.attributes.n:e.sigla&&""!==e.sigla&&(n=e.sigla),t+="<strong>"+n+"</strong>",e.description&&(3===e.description.nodeType?(""!==e.description.textContent&&""!==n&&(t+=": "),t+=e.description.textContent):(""!==e.description.innerHTML&&""!==n&&(t+=": "),t+=e.description.innerHTML)),t+="</div></li>";else{t+="<li><div>",e.attributes&&e.attributes.n?n=e.attributes.n:e.sigla&&""!==e.sigla&&(n=e.sigla),t+="<strong>"+n+"</strong>",""!==n&&""!==e.name&&(t+=": "),t+=e.name,t+="</div><ul>";for(var i=e.content?e.content.length:0,r=0;r<i;r++){var o=f[e.content[r]];t+=P(o)}t+="</ul>",t+="</li>"}return t};i.getCriticalTextsCollection=function(){return v},i.addCriticalText=function(e,t){v[t]=e},i.getCriticalText=function(e){return v[e]},i.resetCriticalEntries=function(){m={filtersCollection:{filters:{},length:0,forLemmas:0,forVariants:0,colors:[]},__allLoaded:!1,_maxVariance:0,_indexes:{encodingStructure:[],appEntries:[],exponents:[]}}};return i.addCriticalEntry=function(e){if(void 0===m[e.id]){m[e.id]=e,m._indexes.appEntries.push(e.id),e._subApp||m._indexes.encodingStructure.push(e.id);var t=function(){var e,t,n=m._indexes.appEntries.length;return n>26?(t=Math.floor(n/26)+96,e=n%26==0?"&#"+(t-1)+";z":"&#"+t+";&#"+(n%26+96)+";"):e="&#"+(n+96)+";",e}();m._indexes.exponents.push({appId:e.id,exponent:t}),m[e.id].exponent=t}e._variance>m._maxVariance&&(m._maxVariance=e._variance),"double-end-point"===r.variantEncodingMethod&&i.addCriticalEntryDepaInfo(e)},i.addCriticalEntryDepaInfo=function(e){if(m._indexes.depa||(m._indexes.depa={start:{},end:{}}),e.attributes.from){var t="#"===e.attributes.from.charAt(0)?e.attributes.from.substr(1):e.attributes.from;m._indexes.depa.start[e.id]=t}if(e.attributes.to){var n="#"===e.attributes.to.charAt(0)?e.attributes.to.substr(1):e.attributes.to;m._indexes.depa.end[e.id]=n}else"internal"===r.variantEncodingLocation?m._indexes.depa.end[e.id]=e.id:"external"===r.variantEncodingLocation&&e.attributes.from&&(m._indexes.depa.end[e.id]=e.attributes.from.substr(1))},i.setCriticalEntriesLoaded=function(e){m.__allLoaded=e},i.getCriticalEntries=function(){return m},i.getCriticalEntryById=function(e){return m[e]},i.getCriticalEntryExponent=function(e){var t=i.getCriticalEntryById(e);return t?t.exponent:""},i.getCriticalEntriesMaxVariance=function(){return m._maxVariance},i.getReadingAttributes=function(e,t){var n=[];if(void 0!==m[t].content[e]){n=m[t].attributes;var i=m[t].content[e].attributes;for(var r in i)n[r]=i[r]}return n},i.isSubApp=function(e){return m[e]._subApp},i.getGenericColorForAppEntry=function(e){var t=m.filtersCollection,r=g[e];if(void 0===t.colors||t.colors.indexOf(r)<0)r=g[e],g.splice(e,1);else{if(e>=t.colors.length-1){for(var o=n.getRandomColor("rgb");t.colors.indexOf(o)>=0;)o=n.getRandomColor("rgb");t.colors.push(o)}r=i.getGenericColorForAppEntry(e+1)}return r},i.addCriticalEntryFilter=function(e,n){var r=t.possibleVariantFilters,o=t.possibleLemmaFilters,a=m.filtersCollection;if((r.indexOf(e)>=0||o.indexOf(e)>=0)&&(void 0===a.filters[e]&&(a.filters[e]={name:e,possibleFor:{lemma:o.indexOf(e)>=0,variant:r.indexOf(e)>=0},values:{}}),void 0===a.filters[e].values[n])){var s;void 0!==t.variantColors[e]&&void 0!==t.variantColors[e][n]&&""!==t.variantColors[e][n]?(s=t.variantColors[e][n],g.indexOf(s)>=0&&g.splice(g.indexOf(s),1)):s=i.getGenericColorForAppEntry(0),s&&a.colors.push(s);var l={name:n,color:s};a.filters[e].values[n]=l,a.length++,r.indexOf(e)>=0&&a.forVariants++,o.indexOf(e)>=0&&a.forLemmas++}},i.getCriticalEntriesFiltersCollection=function(){return m.filtersCollection},i.getCriticalEntriesFilters=function(){return m.filtersCollection.filters},i.getCriticalEntriesFilterValues=function(e){return m.filtersCollection.filters[e]},i.getCriticalEntriesFilterColor=function(e,t){return m.filtersCollection.filters[e].values[t].color},i.addBibliographicRef=function(e){void 0===a[e.id]&&(a[e.id]=e,a._indexes.push(e.id))},i.getBibliographicRefsCollection=function(){return a},i.getBibliographicRefById=function(e){return a[e]},i.addVersionEntry=function(e){void 0===b[e.id]&&(b._indexes.encodingStructure.push(e.id),b[e.id]=e)},i.getVersionEntries=function(){return b},i.getVersionEntry=function(e){return b[e]},i.addVersionWitness=function(e,n){var i=b._indexes.versionWitMap;void 0===i[e]?(i[e]=[],i[e].push(n)):i[e].indexOf(n)<0&&i[e].push(n);var r=b._indexes.versionId,o=b._indexes.versionId._name;if(void 0===r[e]){var a="Version &#"+(65+t.versions.indexOf(e))+";";r[e]=a,o[a]=e}},i.addVersionText=function(e,t,n){void 0===_[t]?(_[t]={},_[t][n]=e):void 0===_[t][n]&&(_[t][n]=e)},i.getVersionText=function(e,t){return _[t][e]},i.updateProjectInfoContent=function(e,t){o[t]=e},i.getProjectInfo=function(){return o},i.addGlyph=function(e){var t,n=w._indexes;t=e&&""!==e.id?e.id:e.id="glyph_"+(n+1),void 0===w[t]&&(n[n.length]=t,w[t]=e,n.length++)},i.getGlyphs=function(){return w},i.getGlyph=function(e){return w[e]},i.getGlyphMappingForEdition=function(e,t){return w[e]?w[e].mapping[t]:void 0},i.addZone=function(e){var t,n=S._indexes;t=e&&""!==e.id?e.id:e.id="zone_"+(n+1),void 0===S[t]&&(n[n.length]=t,S[t]=e,n.length++)},i.getZones=function(){return S},i.getZone=function(e){return S[e]},i.addHotSpot=function(e){var t,n=T._indexes;t=e&&""!==e.id?e.id:e.id="hotspot_"+(n+1),void 0===T[t]&&(n[n.length]=t,T[t]=e,n.length++)},i.getHotSpots=function(){return T},i.getHotSpot=function(e){return T[e]},i.isITLAvailable=function(){return t.toolImageTextLinking&&S._indexes.length>0},i.addQuote=function(e){void 0===C[e.id]&&(C[e.id]=e,C._indexes.encodingStructure.push(e.id));var t=e._indexes.sourceRefId,n=(e._indexes.sourceId,i.getQuotes()._indexes.sourcesRef);if(t.length>0)for(var r=0;r<t.length;r++)void 0===n[t[r]]&&n._id.indexOf(t[r])<0?(n[t[r]]=[],n[t[r]].push(e.id),n._id.push(t[r])):n[t[r]].indexOf(e.id)<0&&n[t[r]].push(e.id);var o=e._indexes.correspId,a=k._indexes.correspId;if(Object.keys(o).length>0)for(var s=0;s<Object.keys(o).length;s++)for(var l=Object.keys(o)[s],c=0;c<o[l].length;c++)void 0===a[l]?(a[l]={},a[l][o[l][c]]=[e.id]):void 0===a[l][o[l][c]]?a[l][o[l][c]]=[e.id]:a[l][o[l][c]].indexOf(e.id)<0&&a[l][o[l][c]].push(e.id)},i.getQuotes=function(){return C},i.getQuote=function(e){return C[e]},i.addSource=function(e){void 0===k[e.id]&&(k[e.id]=e,k._indexes.encodingStructure.push(e.id));var t=e.quotesEntriesId,n=i.getSources()._indexes.quotesRef;if(t.length>0)for(var r=0;r<t.length;r++)void 0===n[t[r]]&&n._id.indexOf(t[r])<0?(n[t[r]]=[],n[t[r]].push(e.id),n._id.push(t[r])):n[t[r]].indexOf(e.id)<0&&n[t[r]].push(e.id);e._textAvailable&&k._indexes.availableTexts.push({id:e.id,abbr:e.abbr})},i.getSources=function(){return k},i.getSource=function(e){return k[e]},i.getAnalogue=function(e){return L[e]},i.getAnalogues=function(){return L},i.addAnalogue=function(e){if(void 0===L[e.id]){L[e.id]=e,L._indexes.encodingStructure.push(e.id);for(var t=e._indexes.sourceRefId,n=L._refId,i=0;i<t.length;i++)n._indexes.indexOf(t[i])<0?(n._indexes.push(t[i]),n[t[i]]=[],n[t[i]].push(e.id)):n[t[i]].indexOf(e.id)<0&&n[t[i]].push(e.id)}},i}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtParser",["$q","xmlParser","parsedData","config",function(e,t,n,i){var r={},o=0,a=(i.visCollSvg,"leaf"),s="mode",l="quire",c="q",u="g",d={sectionHeaders:"<sourceDesc>, ",sectionSubHeaders:"",blockLabels:"",inlineLabels:"<authority>, <settlement>, <publisher>, <pubPlace>, <availability>, <author>, <editor>, <idno>, <date>, <repository>, <msName>, <textLang>",changeDef:"<change>",changeWhenDef:"[when]",changeByDef:"[who]"};return d.sectionSubHeaders+="<projectDesc>, <refsDecl>, <notesStmt>, <seriesStmt>, <publicationStmt>, <respStmt>, <funder>, <sponsor>, <msContents>, <revisionDesc>, ",d.sectionSubHeaders+="<principal>, <langUsage>, <particDesc>, <textClass>, <variantEncoding>, <editorialDecl>, <msIdentifier>, <physDesc>, <history>, <extent>, <editionStmt>",d.blockLabels+="<edition>, <correction>, <hyphenation>, <interpretation>, <normalization>, <punctuation>, <interpGrp>",d.blockLabels+="<quotation>, <segmentation>, <stdVals>, <colophon>, <handDesc>, <decoDesc>, <supportDesc>, <origin>",r.parserProperties={},r.isNestedInElem=function(e,t){return null!==e.parentNode&&("text"!==e.parentNode.tagName&&(e.parentNode.tagName===t||r.isNestedInElem(e.parentNode,t)))},r.capitalize=function(e,t){var n=t?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return e?e.replace(n,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})):""},r.camelToSpace=function(e){return e?e.replace(/\W+/g," ").replace(/([a-z\d])([A-Z])/g,"$1 $2"):""},r.camelToUnderscore=function(e){return e?e.replace(/\W+/g," ").replace(/([a-z\d])([A-Z])/g,"$1_$2"):""},r.isInMainVersion=function(e){if(null!==e.parentNode)return"text"===e.parentNode.tagName||("rdgGrp"===e.parentNode.tagName?!(i.versions&&i.versions.length>0)||!!e.parentNode.hasAttribute("ana")&&e.parentNode.getAttribute("ana").replace(/#/,"")===i.versions[0]:r.isInMainVersion(e.parentNode))},r.parseXMLElement=function(e,t,o){var a,s=o.skip||"",l=o.exclude||void 0,c=!1;if(3===t.nodeType)(a=t).textContent&&(a.textContent=a.textContent.replace("__SPACE__"," "));else if(void 0!==t.tagName&&(s.toLowerCase().indexOf("<"+t.tagName.toLowerCase()+">")>=0||t.className.indexOf("depaAnchor")>=0||t.className.indexOf("depaContent")>=0))a=t,c=!0;else if(void 0!==t.tagName&&void 0!==l&&l.toLowerCase().indexOf("<"+t.tagName.toLowerCase()+">")>=0)a=document.createTextNode("");else{var u=void 0!==t.tagName?t.tagName.toLowerCase():"";if(void 0!==t.attributes&&void 0!==t.attributes.copyOf&&""!==t.attributes.copyOf.value){(a=document.createElement("span")).className=t.tagName+" copy";var h=t.attributes.copyOf.value.replace("#",""),p="<"+t.tagName+' xml:id="'+h+".*</"+t.tagName+">",f=new RegExp(p,"ig"),g=e.outerHTML.match(f);if(g){var m=angular.element(g[0])[0];a.appendChild(r.parseXMLElement(e,m,o))}}else if(n.getEncodingDetail("usesLineBreaks")||"l"!==u)if("note"===u&&s.indexOf("<evtNote>")<0)a=r.parseNote(t);else if("date"===u&&(!t.childNodes||t.childNodes.length<=0)){(a=document.createElement("span")).className=t.tagName?t.tagName.toLowerCase():"";for(var v="",y=0;y<t.attributes.length;y++){var b=t.attributes[y];if(b.specified&&"xml:id"!==b.name){var _=new Date(b.value),x=_&&!isNaN(_)?_.toLocaleDateString():b.value;v+=r.camelToSpace(b.name.replace(":","-")).toLowerCase()+": "+x+", "}}a.textContent=v.slice(0,-1)}else if(i.namedEntitiesSelector&&"<placeName>, <geogName>, <persName>, <orgName>".toLowerCase().indexOf("<"+u+">")>=0&&void 0!==t.getAttribute("ref"))a=r.parseNamedEntity(e,t,s);else{if((a="div"===t.tagName?document.createElement("div"):document.createElement("span")).className=void 0!==t.tagName?t.tagName.toLowerCase():"",t.attributes)for(var w=0;w<t.attributes.length;w++){var S=t.attributes[w];S.specified&&"xml:id"!==S.name&&a.setAttribute("data-"+S.name.replace(":","-"),S.value)}var T;if("div"===t.tagName)T=t.attributes&&t.getAttribute("xml:id")?t.getAttribute("xml:id"):r.xpath(t).substr(1),a.setAttribute("id",T);if(t.childNodes)for(var E=0;E<t.childNodes.length;E++){var C=t.childNodes[E].cloneNode(!0);a.appendChild(r.parseXMLElement(e,C,o))}else a.innerHTML=t.innerHTML+" ";if(o.context&&"projectInfo"===o.context&&""!==a.innerHTML.replace(/\s/g,"")){var k=document.createElement("span"),L=!1;if(k.className="label-"+t.tagName,k.innerHTML="{{ 'PROJECT_INFO."+r.camelToUnderscore(t.tagName).toUpperCase()+"' | translate }}",d.sectionHeaders.toLowerCase().indexOf("<"+u+">")>=0?(k.className+=" projectInfo-sectionHeader",L=!0):d.sectionSubHeaders.toLowerCase().indexOf("<"+u+">")>=0?(k.className+=" projectInfo-sectionSubHeader",L=!0):d.blockLabels.toLowerCase().indexOf("<"+u+">")>=0?(k.className+=" projectInfo-blockLabel",L=!0):d.inlineLabels.toLowerCase().indexOf("<"+u+">")>=0&&(k.className+=" projectInfo-inlineLabel",k.innerHTML+=": ",L=!0),d.changeDef.toLowerCase().indexOf("<"+u+">")>=0){var P="",A=t.getAttribute(d.changeWhenDef.replace(/[\[\]]/g,""));A&&(P+=A+" ");var O=t.getAttribute(d.changeByDef.replace(/[\[\]]/g,""));O&&(P+="["+O+"]"),""!==P&&(a.innerHTML=P+" - "+a.innerHTML)}L&&a.insertBefore(k,a.childNodes[0])}if("lb"===u){a.id=t.getAttribute("xml:id"),a.appendChild(document.createElement("br"));var I=document.createElement("span");I.className="lineN";var D=t.getAttribute("n");I.textContent=D,D&&a.appendChild(I)}}else a=r.parseLine(e,t,o)}return c||3===t.nodeType||a.innerHTML&&""!==a.innerHTML.replace(/\s/g,"")||a.className&&(a.className.indexOf("depaAnchor")>=0||a.className.indexOf("depaContent")>=0)?a:document.createTextNode("")},r.parseElementAttributes=function(e){var t={_indexes:[]};if(e&&e.attributes)for(var n=0;n<e.attributes.length;n++){var i=e.attributes[n];if(i.specified){var r=i.name.replace(":","-");t[r]=i.value,t._indexes.push(r)}}return t},r.parseExternalDocuments=function(e,t){var i={value:t,content:e};"analogues"!==t&&"sources"!==t?n.addSourceDocument(i,t):n.addExternalDocument(i,t),console.log("## Source Documents ##",n.getSourceDocuments()),console.log("## External Documents ##",n.getExternalDocuments())},r.createRegExpr=function(e){for(var t="(",n=e.split(","),i=0;i<n.length;i++){if(n[i].indexOf("[")<0)t+=n[i].replace(/[>]/g,"");else{var r=n[i].indexOf("[");"["!==n[i].substring(1,r)&&(t+=n[i].substring(0,r)),t+="[^<>]*?";var o=n[i].indexOf("]"),a=n[i].indexOf("=");t+=n[i].substring(r+1,a),t+="\\s*?=\\s*?['\"]\\s*?",t+=n[i].substring(a+1,o)}i<n.length-1?t+="|":i===n.length-1&&(t+=")")}return new RegExp(t,"i")},r.createAbbreviation=function(e,t){var n=t/2,i=e.substring(0,n),r=e.substring(e.length-n-1,e.length-1),o=i.lastIndexOf("",i.length-1),a=r.indexOf("",1),s=i.substring(0,o),l=i.substring(o,i.length),c=r.substring(a,r.length);return'<span class="textNode">'+s+'<span class="blurredText">'+l+'</span> [...] <span class="blurredText">'+r.substring(0,a)+"</span>"+c+"</span>"},r.balanceXHTML=function(e){if(e){e.lastIndexOf("<")>e.lastIndexOf(">")&&(e=e.substring(0,e.lastIndexOf("<")));var t=e.match(/<(?!\!)[^>]+>/g),n=[],i=[];for(var r in t)if(1===t[r].search("/")){var o=t[r].replace(/[<\/>]/gi,""),a=n[n.length-1];a&&(a.search("<"+o+" ")>=0||a.search("<"+o+">")>=0)?n.pop():i.push(o)}else t[r].search("/>")<=0&&n.push(t[r]);for(;n.length>0;){var s=n.pop();e+="</"+(s=s.substring(1,s.search(/[ >]/)))+">"}for(;i.length>0;){e="<"+i.shift()+">"+e}}return e||""},r.analyzeEncoding=function(e){var t=angular.element(e),i=t.find("body "+"<lb>".replace(/[<>]/g,""));n.setEncodingDetail("usesLineBreaks",i.length>0);var r=t.find("<l>".replace(/[<>]/g,"")+"[n]");n.setEncodingDetail("lineNums",r.length>0)},r.parseNote=function(e){var t=document.createElement("evt-popover"),n=e.getAttribute("n")?e.getAttribute("n"):"",i=e.getAttribute("type")||"generic";return t.setAttribute("data-trigger","click"),t.setAttribute("data-tooltip",e.innerHTML),t.setAttribute("data-n",n),t.setAttribute("data-type",i),t.innerHTML='<i class="evt_note"><span class="'+i+'">'+n+"</span></i>",t},r.parseNamedEntity=function(e,t,n){var i=document.createElement("evt-named-entity-ref"),o=t.getAttribute("ref"),a=o?o.replace("#",""):void 0;a&&""!==a&&i.setAttribute("data-entity-id",a);var s=t.tagName?t.tagName:"generic";i.setAttribute("data-entity-type",s);for(var l=0;l<t.childNodes.length;l++){var c,u=t.childNodes[l].cloneNode(!0);c=r.parseXMLElement(e,u,{skip:n}),i.appendChild(c)}return i},r.parseLines=function(e){for(var t=e.getElementsByTagName("l");0<t.length;){var n=t[0],i=r.parseLine(e,n,{});n.parentNode.replaceChild(i,n)}},r.parseLine=function(e,t,i){var o=document.createElement("div");o.className=t.tagName+" l-block";for(var a=0;a<t.attributes.length;a++){var s=t.attributes[a];s.specified&&o.setAttribute("data-"+s.name.replace(":","-"),s.value)}o.innerHTML=t.innerHTML;var l=t.getAttribute("n");if(l&&""!==l){var c=document.createElement("span");c.className="lineN",c.textContent=l,o.className+=" l-hasLineN";var u=r.parseXMLElement(e,o,i);o.innerHTML=c.outerHTML+'<span class="lineContent">'+u.outerHTML+"</span>"}else if(n.getEncodingDetail("lineNums")){o.className+=" l-indent";u=r.parseXMLElement(e,o,i);o.innerHTML='<span class="lineContent">'+u.outerHTML+"</span>"}return o},r.parseGlyphs=function(e){var t=angular.element(e);angular.forEach(t.find("glyph, char"),(function(t){var i={};i.id=t.getAttribute("xml:id")||"",i.xmlCode=t.outerHTML,i.mapping={},angular.forEach(angular.element(t).find("mapping"),(function(e){var t=e.getAttribute("type");i.mapping[t]={element:e.outerHTML,content:e.innerHTML,attributes:[]};for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n];r.specified&&i.mapping[t].attributes.push({name:r.name.replace(":","-"),value:r.value})}}));var o=r.parseXMLElement(e,t,{skip:""});i.parsedXml=o?o.outerHTML:"",n.addGlyph(i)})),console.log("# GLYPHS #",n.getGlyphs())},r.xpath=function(e){try{if("string"==typeof e)return document.evaluate(e,document,null,0,null);if(!e||1!==e.nodeType)return"";var t=[];e.parentNode&&(t=[].filter.call(e.parentNode.children,(function(t){return t.tagName===e.tagName})));var n=t.length>1?[].indexOf.call(t,e)+1:"";n=n>1?n-1:"";var i="tei"!==e.tagName.toLowerCase()?"-"+e.tagName.toLowerCase():"";return r.xpath(e.parentNode)+i+n}catch(e){return"-id"+ ++o}},r.parsePages=function(e,t){var r=angular.element(e);angular.forEach(r.find("pb"),(function(e){var r={};e.getAttribute("ed")?r.value=e.getAttribute("xml:id")||e.getAttribute("ed").replace("#","")+"-"+e.getAttribute("n")||"page_"+(n.getPages().length+1):r.value=e.getAttribute("xml:id")||"page_"+(n.getPages().length+1),r.image=e.getAttribute("src")||i.singleImagesUrl+r.value+".jpg",r.svgId=e.getAttribute("svg:id")||n.getPages().length+1,r.label=e.getAttribute("n")||"Page "+(n.getPages().length+1),r.title=e.getAttribute("n")||"Page "+(n.getPages().length+1);for(var o=0;o<e.attributes.length;o++){var a=e.attributes[o];a.specified&&(r[a.name.replace(":","-")]=a.value)}e.getAttribute("facs")?r.source=e.getAttribute("facs"):r.source=i.singleImagesUrl+r.value+".jpg",n.addPage(r,t)}))},r.parseSvgsForViscoll=function(e,t){var i=angular.element(e),r=e.lastChild,o="";try{o=r.firstElementChild.innerHTML.match(/quire\s\d*\sfor/)[0].match(/\d+/)[0]}catch(e){}var a={id:t,quireN:o,svgLeaves:[],textSvg:r},s=n.getViscollSvgs();angular.forEach(i.find(u),(function(e){if(e.hasAttribute("id")){var i={id:e.id.replace("#",""),value:e.id.replace("#",""),label:e.id.replace("#","")};angular.forEach(s.imglist._indexes,(function(e){if(i.id===e.slice(0,-2))if(null==i.img){if(i.img=s.imglist[e].url,i.imgConjoin=s.imglist[e].conjoinUrl,i.imageId=s.imglist[e].value,void 0!==s.imglist[e].conjoinUrl)for(var t in s.imglist)s.imglist[e].id===s.imglist[t].conjoin&&(i.conjoinId=s.imglist[t].value)}else if(i.img2=s.imglist[e].url,i.imgConjoin2=s.imglist[e].conjoinUrl,i.imageId2=s.imglist[e].value,void 0!==s.imglist[e].conjoinUrl)for(var n in s.imglist)s.imglist[e].id==s.imglist[n].conjoin&&(i.conjoinId2=s.imglist[n].value)})),a.svgLeaves.push(i),n.updateLeafDataInQuire(t,i)}})),n.addViscollSvg(a)},r.parseViscollDatamodel=function(e){var t=angular.element(e),i=angular.element(t.find("shelfmark")),r=[];angular.forEach(t.find(l),(function(e){var t={value:e.getAttribute("xml:id")||"",n:e.getAttribute("n")||"quire"+(n.getViscollQuires().length+1),leaves:{length:0,_indexes:[]}};n.addViscollQuire(t),i&&r.push({fileName:"id-"+i.text()+"-"+t.n+".svg",id:t.value})})),angular.forEach(t.find(a),(function(e){var t=angular.element(e).find(c);if(t=t?t[0]:void 0){var i=angular.element(e).find(s),r=t.childNodes,o=null==r[1]?r[0]:r[1],a={value:e.getAttribute("xml:id")||"",leafno:t.getAttribute("leafno")||"",quire:t.getAttribute("target").replace("#","")||"target",conjoin:o.getAttribute("target").replace("#","")||"target",mode:i&&i[0]?i[0].getAttribute("val"):""};n.addViscollLeaf(a)}})),n.setViscollSVGToLoad(r),console.log("## parseViscollDatamodel ##",n.getViscollSvgs())},r.parseViscollImageList=function(e){var t=angular.element(e),i=n.getViscollSvgs();angular.forEach(t.find("image"),(function(e){var t={value:e.getAttribute("val")||"val",url:e.getAttribute("url")||"url",id:e.getAttribute("id")||"id"},r=t.id.slice(0,-2);angular.forEach(i.quires._indexes,(function(e){var n=i.quires[e].leaves;angular.forEach(n._indexes,(function(e){var i=n[e];r===i.value&&(t.conjoin=i.conjoin,"v"===t.id.substr(t.id.length-1)?t.conjoin+="-r":t.conjoin+="-v")}))})),n.addViscollImageList(t)})),angular.forEach(i.imglist._indexes,(function(e){angular.forEach(i.imglist._indexes,(function(t){t===i.imglist[e].conjoin&&(i.imglist[e].conjoinUrl=i.imglist[t].url)}))}))},r.parseDocuments=function(e){var t,o=angular.element(e),a="body";return o.find("text group text").length>0?t="text group text":o.find("text").length>0?t="text":o.find('div[subtype="edition_text"]').length>0&&(t='div[subtype="edition_text"]',a="div"),r.parserProperties.defDocElement=t,r.parserProperties.defContentEdition=a,n.setCriticalEditionAvailability(o.find(i.listDef.replace(/[<>]/g,"")).length>0),angular.forEach(o.find(t),(function(t){r.parseDocument(t,e)})),console.log("## PAGES ##",n.getPages()),console.log("## Documents ##",n.getDocuments()),console.log("## DIVS ##",n.getDivs()),n.getDocuments()},r.parseDocument=function(e,t){for(var o={value:e.getAttribute("xml:id")||r.xpath(t).substr(1)||"doc_"+(n.getDocuments()._indexes.length+1),label:"",title:"",content:e,front:void 0,pages:[],divs:[]},a=0;a<e.attributes.length;a++){var s=e.attributes[a];s.specified&&(o[s.name.replace(":","-")]=s.value)}if(void 0===o["xml-id"]?r.createTitle(o,"Doc"):r.createTitle(o,""),r.parseFront(o,e),n.addDocument(o),r.parsePages(e,o.value),"body"===r.parserProperties.defContentEdition){var l=e.querySelector("front"),c=e.querySelector("body");l&&r.parseDivs(l,o.value,"front"),r.parseDivs(c,o.value,"body")}else r.parseDivs(e,o.value,"body");if("critical"!==i.defaultEdition||!n.isCriticalEditionAvailable()){i.defaultEdition="diplomatic";var u=n.getPages(),d=o.pages;angular.forEach(angular.element(e).find(r.parserProperties.defContentEdition),(function(e){r.splitPages(u,e,o.value,r.parserProperties.defContentEdition,d)}))}},r.parseDivs=function(e,t,n){var i=e.getAttribute("xml:lang")?e.getAttribute("xml:lang"):"",o=angular.element(e);angular.forEach(o.children("div"),(function(e){r.parseDiv(e,t,n,i)}))},r.parseDiv=function(e,t,i){var o={doc:t,section:i,subDivs:[],title:"",_isSubDiv:r.isNestedInElem(e,"div")};angular.forEach(Object.values(e.attributes),(function(e){e.specified&&(o[e.name.replace(":","-")]=e.value)})),o.corresp&&(o.corresp=o.corresp.replace("#","").split(" ")),o.value=o["xml-id"]||r.xpath(e).substr(1)||"div_"+(n.getDivs().length+1),r.createTitle(o,"Div");var a=angular.element(e);return angular.forEach(a.children("div"),(function(e){o.subDivs.push(r.parseDiv(e,t,i).value)})),n.addDiv(o,t),o},r.createTitle=function(e,t){switch(e.type?e.title+=e.type.substr(0,1).toUpperCase()+e.type.substr(1):e.title+=t,e.subtype&&(e.title+=" - "+e.subtype.substr(0,1).toUpperCase()+e.subtype.substr(1)),e.title+=" ",t){case"Div":e.title+=e.n||n.getDivs().length+1;break;case"Doc":var i,r=n.getWitnessesList().find((function(t){return i=t,n.getWitness(t).corresp===e.value}));e.title+=r?i:e.n||n.getDocuments()._indexes.length+1;break;default:e.title=e.n||e["xml-id"]}e.label=e.title},r.parseFront=function(e,t){var n=t.querySelectorAll("<front>".replace(/[<\/>]/gi,""));if(n&&n[0]){var i=n[0].cloneNode(!0),o=i.querySelectorAll("<biblStruct>".replace(/[<\/>]/gi,""));if(o)for(var a=o.length-1;a>=0;a--){var s=document.createElement("evt-bibl-elem"),l=o[a],c=l.getAttribute("xml:id")||r.xpath(l).substr(1);s.setAttribute("data-bibl-id",c),l.parentNode.replaceChild(s,l)}var u=r.parseXMLElement(t,i,{skip:"<biblStruct><evt-bibl-elem>"}),d=r.parseElementAttributes(i);e.front={attributes:d,parsedContent:u&&u.outerHTML?u.outerHTML.trim():"",originalContent:i.outerHTML}}},r.splitLineBreaks=function(e,t){var n="",i="<"+t+"(.|[\r\n])*?>",o=new RegExp(i+"(.|[\r\n])*?<lb(.|[\r\n])*?/>","ig"),a=e.outerHTML.match(o);if(a&&a.length>0){var s=new RegExp(i,"ig"),l=a[0].replace(s,"");n+="<evtLB>"+(l=r.balanceXHTML(l))+"</evtLB>"}for(var c=new RegExp("<lb(.|[\r\n])*?(?=(<lb|</"+t+">))","ig"),u=e.outerHTML.match(c),d=u?u.length:0,h=0;h<d;h++){n+="<evtLB>"+r.balanceXHTML(u[h])+"</evtLB>"}return n},r.splitPages=function(e,t,i,r,o){var a,s=new RegExp("<body(.|[\r\n])*?(?=<pb)","ig"),l=t.outerHTML.match(s),c=new RegExp("<pb(.|[\r\n])*?(?=(<pb|</"+r+">))","ig"),u=t.outerHTML.match(c);if(l&&l.length>0){var d=n.getPreviousDocument(i);if(d&&d.pages&&d.pages.length>0){var h=d.pages[d.pages.length-1],p=e.length-o.length;if(h&&""!==h)for(var f=0,g=p;g<e.length;g++)(a=e[g])&&""!==a&&(n.setPageText(a,i,"original",u[f]),f++)}else for(var m=0;m<e.length;m++)(a=e[m])&&""!==a&&n.setPageText(a,i,"original",u[m])}},r.parseTextForEditionLevel=function(i,o,a,s){var l=r.balanceXHTML(s);l=l.replace(/>\s+</g,">__SPACE__<");var c=e.defer(),u=l,d=t.parse('<div id="mainContentToTranform" class="'+a+'">'+l+"</div>");if(void 0!==d){for(var h,p,f=d.getElementById("mainContentToTranform"),g=f.getElementsByTagName("pb"),m=0;m<g.length;)(h=g[m]).parentNode.removeChild(h);if("diplomatic"===a?p="_reg":"interpretative"===a&&(p="_orig"),p){var v=f.getElementsByTagName("lb");for(m=0;m<v.length;){var y=v[m],b=y.getAttribute("xml:id");b&&null!==b&&b.indexOf(p)>=0?y.parentNode.removeChild(y):m++}}var _=f.getElementsByTagName("g");for(m=0;m<_.length;){var x=_[m],w=x.getAttribute("ref"),S=document.createElement("span");if(S.className="glyph",w&&""!==w){w=w.replace("#","");var T=a;T="interpretative"===T?"normalized":T,(r.isNestedInElem(x,"abbr")||r.isNestedInElem(x,"orig"))&&(T="diplomatic");var E=n.getGlyphMappingForEdition(w,T);E&&S.appendChild(angular.element(E.element)[0])}S&&x.parentNode.insertBefore(S,x.nextSibling),x.parentNode.removeChild(x)}f.innerHTML=f.innerHTML.replace(/>[\s\r\n]*?</g,"><"),angular.forEach(f.children,(function(e){e.parentNode.replaceChild(r.parseXMLElement(d,e,{skip:"<pb>,<g>"}),e)})),u=f.outerHTML}else u="<span> {{ 'TEXT_NOT_AVAILABLE' | translate }}</span>";if(void 0===u){u="<span class=\"alert-msg alert-msg-error\">{{'MESSAGES.ERROR_IN_PARSING_TEXT' | translate}} <br />{{'MESSAGES.TRY_DIFFERENT_BROWSER_OR_CONTACT_DEVS' | translate}}</span>"}return u=u.replace(/__SPACE__/g," "),n.setPageText(i,o,a,u),c.resolve("success"),c},r}])},function(e,t,n){(function(e){angular.module("evtviewer.dataHandler").service("evtCriticalApparatusParser",["$q","parsedData","evtParser","config","evtCriticalElementsParser","evtDepaParser",function(t,n,i,r,o,a){var s={};r.quoteDef,r.skipWitnesses.split(",").filter((function(e){return 0!==e.length}));s.findCriticalEntryById=function(t,n){if(void 0!==t){var i=n.replace(/\w-/g,"$&0>").replace(/[0-9]+/g,":eq($&)").replace(/-:eq/g,":eq"),r=e(t).find(i);o.handleAppEntry(r.get(0))}else console.log("ERROR")};var l=function(e,t){var o,a=r.skipWitnesses.split(",").filter((function(e){return 0!==e.length})),s={id:t.getAttribute("xml:id")||i.xpath(t).substr(1),sigla:t.getAttribute("xml:id"),name:"",content:[],_type:"group",_group:void 0,text:{}};if(void 0!==r.versions&&r.versions.length>1&&t.hasAttribute("ana")){var c=t.getAttribute("ana").replace("#","");r.versions.indexOf(c)>=0&&(o=c)}return angular.forEach(t.childNodes,(function(t){if(1===t.nodeType)if("head"===t.tagName)s.name=t.innerHTML;else if(r.listDef.indexOf("<"+t.tagName+">")>=0){if(a.indexOf(s.id)<0){var c=l(e,t);c._group=s.id,n.addElementInWitnessCollection(c),s.content.push(c.id)}}else if(r.versionDef.indexOf("<"+t.tagName+">")>=0){var u={id:t.getAttribute("xml:id")||i.xpath(t).substr(0),sigla:t.getAttribute("xml:id"),attributes:i.parseElementAttributes(t),description:i.parseXMLElement(e,t,{skip:""}),_group:s.id,_type:"witness"};a.indexOf(u.id)<0&&(n.addElementInWitnessCollection(u),s.content.push(u.id),void 0!==o&&n.addVersionWitness(o,u.id))}})),s};return s.parseWitnesses=function(e){var t=r.skipWitnesses.split(",").filter((function(e){return 0!==e.length})),o=angular.element(e).find(r.listDef.replace(/[<>]/g,""));o.length>0?angular.forEach(o,(function(o){i.isNestedInElem(o,o.tagName)||angular.forEach(o.childNodes,(function(o){if(1===o.nodeType){var a={};if(a.id=o.getAttribute("xml:id"),t.indexOf(a.id)<0){if(r.listDef.indexOf("<"+o.tagName+">")>=0)a=l(e,o);else if(r.versionDef.indexOf("<"+o.tagName+">")>=0){var s;if(a={id:o.getAttribute("xml:id")||i.xpath(o).substr(0),sigla:o.getAttribute("xml:id"),description:i.parseXMLElement(e,o,{skip:""}),_group:void 0,_type:"witness",text:{}},void 0!==r.versions&&r.versions.length>1&&o.hasAttribute("ana")){var c=o.getAttribute("ana").replace("#","");r.versions.indexOf(c)>=0&&(s=c)}void 0!==s&&n.addVersionWitness(s,a.id)}n.addElementInWitnessCollection(a)}}}))})):console.log("WARNING: "+r.listDef+" missing. Please add this element to make EVT work properly with different witnesses."),console.log("## Witnesses ##",n.getWitnesses())},s.parseCriticalEntries=function(e){n.resetCriticalEntries();var i=t.defer(),s=angular.element(e);return angular.forEach(s.find("<app>".replace(/[<>]/g,"")),(function(t){if(!t.hasAttribute("type")||"recensio"!==t.getAttribute("type")){var i=o.handleAppEntry(t);i.lemma||"double-end-point"!==n.getEncodingDetail("variantEncodingMethod")||a.getLemma(i,e)}})),n.setCriticalEntriesLoaded(r.loadCriticalEntriesImmediately),console.log("## Critical entries ##",n.getCriticalEntries()),i.resolve("success"),i},s.parseVersionEntries=function(e){var i=t.defer(),r=angular.element(e);return angular.forEach(r.find("<app>".replace(/[<>]/g,"")+"[type=recensio]"),(function(e){o.handleVersionEntry(e)})),console.log("## Version Entries ##",n.getVersionEntries()),i.resolve("success"),i},s.containsWitnessElement=function(e,t){return null!==e&&(void 0!==t.group&&e.indexOf("#"+t.group)>=0||e.indexOf("#")>=0&&e.indexOf("#"+t.id)>=0||e.indexOf(t.id)>=0)},s.parseWitnessPageBreaks=function(e,t){for(var n=e.getElementsByTagName("pb");0<n.length;){var i=n[0];if(s.containsWitnessElement(i.getAttribute("ed"),t)){var r,o=document.createElement("span");r=i.getAttribute("ed")?i.getAttribute("xml:id")||i.getAttribute("ed").replace("#","")+"-"+i.getAttribute("n")||"page_0":i.getAttribute("xml:id")||"page_0",o.className="pb",o.setAttribute("data-wit",i.getAttribute("ed")),o.setAttribute("data-id",r),o.setAttribute("id","pb_"+r),o.textContent=i.getAttribute("n"),i.parentNode.replaceChild(o,i)}else i.parentNode.removeChild(i)}},s.parseWitnessLacunas=function(e,t){for(var r,o,a,s=e.getElementsByTagName("lacunaStart"),l=e.getElementsByTagName("lacunaEnd"),c=[],u=[],d=0;d<s.length;d++)r=s[d].parentNode.getAttribute("data-app-id"),o=s[d].parentNode.getAttribute("data-reading-id"),void 0!==(a=n.getCriticalEntryById(r).content[o].wits)&&a.indexOf(t)>=0&&c.push(s[d]);for(var h=0;h<l.length;h++)r=l[h].parentNode.getAttribute("data-app-id"),o=l[h].parentNode.getAttribute("data-reading-id"),void 0!==(a=n.getCriticalEntryById(r).content[o].wits)&&a.indexOf(t)>=0&&u.push(l[h]);if(c.length===u.length)for(var p=c.length-1;p>=0;p--){var f=c[p].parentNode,g=u[p].parentNode,m=f.getAttribute("data-app-id"),v=g.getAttribute("data-app-id"),y=new RegExp("<evt-reading.*data-app-id.*"+m+".*</evt-reading>(.|[\r\n])*?<evt-reading.*data-app-id.*"+v+".*</evt-reading>","ig"),b='<span data-app-id-start="'+m+'" data-app-id-end="'+v+'" class="lacuna">[LACUNA]</span>';e.innerHTML=e.innerHTML.replace(y,b),e.innerHTML=i.balanceXHTML(e.innerHTML)}else e.innerHTML="<span class=\"error\">{{ 'MESSAGES.ERROR_IN_PARSING_LACUNA' | translate }}</span>"},s.isFragmentaryWitness=function(e,t){try{return e.querySelectorAll("witStart[wit*='#"+t+"']").length>0||(e.querySelectorAll("rdg[wit*='#"+t+"'] witStart:not([wit]").length>0||e.querySelectorAll("lem[wit*='#"+t+"'] witStart:not([wit]").length>0)}catch(e){return!1}},s.parseFragmentaryWitnessText=function(e,t){for(var i,r,o,a=e.getElementsByTagName("witStart"),s=e.getElementsByTagName("witEnd"),l=[],c=[],u=0;u<a.length;u++)i=a[u].parentNode.getAttribute("data-app-id"),r=a[u].parentNode.getAttribute("data-reading-id"),void 0!==(o=n.getCriticalEntryById(i).content[r].wits)&&o.indexOf(t)>=0&&l.push(a[u]);for(var d=0;d<s.length;d++)i=s[d].parentNode.getAttribute("data-app-id"),r=s[d].parentNode.getAttribute("data-reading-id"),void 0!==(o=n.getCriticalEntryById(i).content[r].wits)&&o.indexOf(t)>=0&&c.push(s[d]);var h="";if(a.length===s.length){for(var p=l.length-1;p>=0;p--){var f=l[p].parentNode,g=c[p].parentNode,m=f.getAttribute("data-app-id"),v=g.getAttribute("data-app-id"),y=new RegExp('<evt-reading data-app-id="'+m+".*</evt-reading>(.|[\r\n])*?<evt-reading data-app-id.*"+v+".*</evt-reading>","ig");h='<span class="fragment fragment-start"></span>'+e.innerHTML.match(y)+'<span class="fragment fragment-end"></span>'+h}return h}return"<span class=\"error\">{{ 'MESSAGES.ERROR_IN_PARSING_FRAGMENTARY_TEXT' | translate }}</span>"},s}])}).call(this,n(0))},function(e,t){angular.module("evtviewer.dataHandler").service("evtCriticalApparatus",["parsedData","config",function(e,t){var n={},i=t.skipWitnesses.split(",").filter((function(e){return 0!==e.length}));n.getContent=function(e,i,r){var o={attributes:{values:e.attributes||{},_keys:Object.keys(e.attributes)||[]},lemma:{content:"",attributes:{values:{},_keys:[]}},significantReadings:[],notSignificantReadings:[],readingGroups:[],criticalNote:"",witnessesGroups:JSON.parse(JSON.stringify(t.witnessesGroups))};n.getWitnessesGroups(e,r,o.witnessesGroups);var a=e.content[e.lemma];void 0!==a&&(o.lemma.content+='<span class="app_lemma_content">'+n.getLemma(a,r)+"</span>",o.lemma.attributes.values=a.attributes||{},o.lemma.attributes._keys=Object.keys(a.attributes)||[]);for(var s=e._indexes.readings,l=s._indexes,c=0;c<l.length;c++){var u=e.content[l[c]];if(void 0!==u){var d=n.getSignificantReading(u,r);s._significant.indexOf(u.id)>=0?o.significantReadings.push(d):o.notSignificantReadings.push(d)}}if(!i&&e._indexes.groups.length>0)for(var h=0;h<e._indexes.groups.length;h++){var p=e.content[e._indexes.groups[h]];if(void 0!==p){var f=[];for(var g in p.attributes)f.push({label:g,values:p.attributes[g]});for(var m=[],v=0;v<p.content.length;v++){var y=e.content[p.content[v]];void 0!==y&&m.push(n.getSignificantReading(y,r))}m.length>0&&o.readingGroups.push({header:f,readings:m})}}return o.criticalNote+=e.note,o},n.getWitnessesGroups=function(e,t,i){for(var r in i){for(var o in i[r].wits=[],i[r].significant={},i[r].significantContent={},i[r].notSignificant={},i[r].notSignificantContent={},e._indexes.witMap)i[r].witnesses.indexOf(o)>=0&&i[r].wits.push(o);for(var a in delete i[r].witnesses,i[r].wits){var s=e._indexes.witMap[i[r].wits[a]],l=e.content[s];l._significant?(i[r].significantContent[s]=l,void 0===i[r].significant[s]?(i[r].significant[s]=[],i[r].significant[s].push(i[r].wits[a])):i[r].significant[s].push(i[r].wits[a])):(i[r].notSignificantContent[s]=l,void 0===i[r].notSignificant[s]?(i[r].notSignificant[s]=[],i[r].notSignificant[s].push(i[r].wits[a])):i[r].notSignificant[s].push(i[r].wits[a]))}var c,u,d;if(0===Object.keys(i[r].significant).length)delete i[r].significant,delete i[r].significantContent;else{for(c in i[r].significantText="",i[r].significant){for(d in u='<span class="',c===e.lemma?u+='lem inWitGrp">':u+='rdg inWitGrp">',u+=n.getReadingForGroup(i[r].significantContent[c],t)+'</span><span class="witnesses">',i[r].significant[c])u+='<evt-witness-ref witness="'+i[r].significant[c][d]+'" data-scope-wit="'+t+'"></evt-witness-ref>';u+="</span>",i[r].significantText+=u}delete i[r].significant,delete i[r].significantContent}if(0===Object.keys(i[r].notSignificant).length)delete i[r].notSignificant,delete i[r].notSignificantContent;else{for(c in i[r].notSignificantText="",i[r].notSignificant){for(d in u='<span class="',c===e.lemma?u+='lem inWitGrp">':u+='rdg inWitGrp">',u+=n.getReadingForGroup(i[r].notSignificantContent[c],t)+'</span><span class="witnesses">',i[r].notSignificant[c])u+='<evt-witness-ref witness="'+i[r].notSignificant[c][d]+'" data-scope-wit="'+t+'"></evt-witness-ref>';u+="</span>",i[r].notSignificantText+=u}delete i[r].notSignificant,delete i[r].notSignificantContent}}},n.getReadingForGroup=function(e,t){for(var i="",r=0;r<e.content.length;r++)"string"==typeof e.content[r]?i+=e.content[r]:"subApp"===e.content[r].type?i+=n.getSubApparatus(e.content[r].id,t):"genericElement"===e.content[r].type?i+=n.getGenericContent(e.content[r],t):"quote"===e.content[r].type||"analogue"===e.content[r].type?i+=n.getCriticalElementContent(e.content[r],t):i+=e.content[r].outerHTML;return""===i&&(i=" <i>om.</i> "),i=(i=n.transformCriticalEntryLacunaMilestones(i)).replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),i=n.transformCriticalEntryFragmentMilestones(i)},n.getGenericContent=function(e,t){var i;i=' <span class="'+e.tagName+' inApparatus">';for(var r=0;r<e.content.length;r++)"string"==typeof e.content[r]?i+=e.content[r]:"subApp"===e.content[r].type?i+=n.getSubApparatus(e.content[r].id,t):"genericElement"===e.content[r].type?i+=n.getGenericContent(e.content[r],t):i+=e.content[r].outerHTML;return i+="</span>"},n.getLemma=function(e,t){for(var i="",r=0;r<e.content.length;r++)"subApp"===e.content[r].type?i+=n.getSubApparatus(e.content[r].id,t):"quote"===e.content[r].type||"analogue"===e.content[r].type?i+=n.getCriticalElementContent(e.content[r],t):"genericElement"===e.content[r].type?i+=n.getGenericContent(e.content[r],t):i+=e.content[r];return""!==(i=n.transformCriticalEntryLacunaMilestones(i))&&(i+=n.getCriticalEntryWitnesses(e,"lem",t)),i=i.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),i=n.transformCriticalEntryFragmentMilestones(i)},n.getSubApparatus=function(t,i){var r="",o=e.getCriticalEntryById(t),a=n.getContent(o,!0,i);r+='<span class="sub_app"> (('+a.lemma.content+" ";for(var s=0;s<a.significantReadings.length;s++)r+=a.significantReadings[s].content,s<a.significantReadings.length-1&&(r+="; ");return r+=")) </span>"},n.getSignificantReading=function(e,t){for(var i="",r={},o=0;o<e.content.length;o++)"string"==typeof e.content[o]?i+=e.content[o]:"subApp"===e.content[o].type?i+=n.getSubApparatus(e.content[o].id,t):"genericElement"===e.content[o].type?i+=n.getGenericContent(e.content[o],t):"quote"===e.content[o].type||"analogue"===e.content[o].type?i+=n.getCriticalElementContent(e.content[o],t):i+=e.content[o].outerHTML;""===i&&(i=" <i>om.</i> "),i=n.transformCriticalEntryLacunaMilestones(i);var a=n.getCriticalEntryWitnesses(e,"rdg",t);return void 0!==e.wits&&""===a||(i=(i+=a).replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),r={content:i=n.transformCriticalEntryFragmentMilestones(i),attributes:{values:e.attributes||{},_keys:Object.keys(e.attributes)||[]}}),r},n.getCriticalElementContent=function(e,t){var i=e.content||[],o='<span class="'+e.type+' inApparatus">';for(var a in i)if("string"==typeof i[a])o+='<span class="textNode">'+i[a]+"</span>";else{if(["EVT-POPOVER","lb","ptr","link","linkGrp","pb"].indexOf(i[a].tagName)>=0)o+="";else if("app"===i[a].type){o+=r(i[a],t)}else"analogue"===i[a].type||"quote"===i[a].type?o+=n.getCriticalElementContent(i[a],t):void 0!==i[a].content&&(o+=n.getText(i[a]))}return o+="</span>"},n.getText=function(e){var t="",i=e.content;if(void 0!==i)for(var r=0;r<i.length;r++)"string"==typeof i[r]?t+='<span class="textNode">'+i[r]+"</span>":void 0!==i[r].content&&(t+=n.getText(i[r]));return t};var r=function(e,t){var i="";if(""===t||void 0===t||void 0===e._indexes.witMap[t]){var r=e.lemma;i+=n.getText(e.content[r])}else{var o=e._indexes.witMap[t];i+=n.getText(e.content[o])}return i};return n.getCriticalEntryWitnesses=function(e,t,n){var r="";if(void 0!==e.wits&&e.wits.length>0)for(var o in e.wits)o&&e.wits[o]&&i.indexOf(o)<0&&(r+='<evt-witness-ref witness="'+e.wits[o]+'" data-scope-wit="'+n+'"></evt-witness-ref>');else if("lem"===t&&void 0!==e.autoWits&&e.autoWits.length>0)for(var a in e.autoWits)a&&e.autoWits[a]&&i.indexOf(a)<0&&(r+='<evt-witness-ref witness="'+e.autoWits[a]+'" data-scope-wit="'+n+'"></evt-witness-ref>');return""!==r&&(r='<span class="witnesses witnesses-'+t+'">'+r+"</span>"),r},n.getCriticalEntryAttributes=function(e,t){var n="";if(void 0!==e.attributes)for(var i in e.attributes)"wit"!==i&&"xml:id"!==i&&(n+='<span class="'+i+'">'+i+": "+e.attributes[i]+"</span>");return""!==n&&(n='<span class="attributes" style="display:none">'+n+"</span>"),n},n.transformCriticalEntryLacunaMilestones=function(e){return e=(e=e.replace(/<lacunaStart(.|[\r\n])*?\/>/gi,"<i> {{ 'CRITICAL_APPARATUS.LACUNA_START' | translate }} </i>")).replace(/<lacunaEnd(.|[\r\n])*?\/>/gi,"<i> {{ 'CRITICAL_APPARATUS.LACUNA_END' | translate }} </i>")},n.transformCriticalEntryFragmentMilestones=function(e){var t=e.match(/<witStart(.|[\r\n])*?\/>/gi);if(null!==t)for(var n=0;n<t.length;n++){var i=t[n],r=i.match(/"#.*"/g);r=null!==r?" of "+r[0].replace(/["#]/g,""):"";var o=new RegExp(i,"ig");e=e.replace(o,"<i> [beginning of fragment"+r+"] </i>")}var a=e.match(/<witEnd(.|[\r\n])*?\/>/gi);if(null!==a)for(var s=0;s<a.length;s++){var l=a[s],c=l.match(/"#.*"/g);c=null!==c?" of "+c[0].replace(/["#]/g,""):"";var u=new RegExp(l,"ig");e=e.replace(u,"<i> [end of fragment"+c+"] </i>")}return e},n}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtNamedEntitiesParser",["parsedData","evtParser",function(e,t){var n={},i=[{listDef:"<listPlace>",contentDef:"<place>",contentForLabelDef:"<placeName>",type:"place"},{listDef:"<listPerson>",contentDef:"<person>",contentForLabelDef:"<persName>",type:"person"},{listDef:"<listOrg>",contentDef:"<org>",contentForLabelDef:"<orgName>",type:"org"},{listDef:"<list>",contentDef:"<item>",contentForLabelDef:"",type:"generic"}];n.parseEntities=function(o){for(var a=angular.element(o),l="",c=0;c<i.length;c++){var u="<sourceDesc>".replace(/[<>]/g,"")+" > "+i[c].listDef.replace(/[<>]/g,""),d=i[c].contentDef.replace(/[<>]/g,""),h=i[c].type||"generic",p="LISTS."+h.toUpperCase();l+=u+" "+"<relation>".replace(/[<>]/g,"")+", ",angular.forEach(a.find(u),(function(o){if(!t.isNestedInElem(o,o.tagName)){var a=o.getAttribute("xml:id")||void 0;if("generic"!==h||"generic"===h&&void 0!==a){var l={id:a||t.xpath(o),type:h,title:p};angular.forEach(o.childNodes,(function(t){if(1===t.nodeType){var o=s(t,l),a={};i[c].listDef.indexOf("<"+t.tagName+">")>=0?n.parseDirectSubList(t,i[c],l):d.indexOf(t.tagName)>=0&&(a=r(t,i[c]),e.addNamedEntityInCollection(o,a,a.id.substr(0,1).toLowerCase()))}})),o.parentNode.removeChild(o)}}}))}var f=a.find(l.slice(0,-2));if(f&&f.length>0){var g={id:"parsedRelations",type:"relation",title:"LISTS.RELATION"};angular.forEach(f,(function(e){n.parseRelationsInList(e,g)}))}console.log("## parseEntities ##",e.getNamedEntitiesCollection())},n.parseDirectSubList=function(t,n,o){var a=n.contentDef;i.listDef;angular.forEach(t.childNodes,(function(t){if(1===t.nodeType){var i=s(t,o),l={};a.indexOf(t.tagName)>=0&&(l=r(t,n),e.addNamedEntityInCollection(i,l,l._listPos))}}))},n.parseRelationsInList=function(n,i){var r=t.parseXMLElement(n,n,{skip:"<evtNote>"}),o=n.getAttribute("active"),a=n.getAttribute("mutual"),s=n.getAttribute("passive"),l=n.getAttribute("name"),c=n.getAttribute("type");!c&&n.parentNode&&"<listRelation>".indexOf("<"+n.parentNode.tagName+">")>=0&&(c=n.parentNode.getAttribute("type")),l=l?t.camelToSpace(l):l;var u={id:n.getAttribute("xml:id")||t.xpath(n),label:"",content:{_indexes:[]},_listPos:"",_xmlSource:n.outerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")};u.content.name=[{attributes:{_indexes:[]},text:l}],u.content._indexes.push("name"),u.label=l?l.toLowerCase():"",l&&(u.label+=" ("),u.label+=c||"generic",u.label+=" relation",l&&(u.label+=")");var d='<span class="relation">',h="",p="",f="",g=o?o.split("#").filter((function(e){return 0!==e.length})):[],m=a?a.split("#").filter((function(e){return 0!==e.length})):[],v=s?s.split("#").filter((function(e){return 0!==e.length})):[];if(o||a||s||l){for(var y,b,_=0;_<g.length;_++)y=document.createElement("evt-named-entity-ref"),(b=g[_].trim())&&""!==b&&y.setAttribute("data-entity-id",b),y.textContent="#"+b,d+=y.outerHTML+" ",h+=y.outerHTML.trim()+", ";for(var x=0;x<m.length;x++)0===x&&o&&""!==o&&(d+="{{ 'AND' | translate}} "),y=document.createElement("evt-named-entity-ref"),(b=m[x].trim())&&""!==b&&y.setAttribute("data-entity-id",b),y.textContent="#"+b,d+=y.outerHTML+" ",p+=y.outerHTML.trim()+", ";d+=l?'<span class="relation-name">'+l+" </span>":"";for(var w=0;w<v.length;w++)y=document.createElement("evt-named-entity-ref"),(b=v[w].trim())&&""!==b&&y.setAttribute("data-entity-id",b),y.textContent="#"+b,d+=y.outerHTML+" ",f+=y.outerHTML.trim()+", "}d+="</span>",d+=r?r.innerHTML:n.innerHTML;for(var S=0;S<g.length;S++){var T=e.getNamedEntity(g[S].trim());T&&""!==d&&(T.content.relations||(T.content.relations=[],T.content._indexes.push("relations")),T.content.relations.push({text:"{{ 'LISTS.RELATION_ACTIVE_ROLE ' | translate:'{relationType:\""+c+"\"}'}}: "+d,attributes:[]}),T._xmlSource+=n.outerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""))}for(var E=0;E<m.length;E++){var C=e.getNamedEntity(m[E].trim());C&&""!==d&&(C.content.relations||(C.content.relations=[],C.content._indexes.push("relations")),C.content.relations.push({text:"{{ 'LISTS.RELATION_MUTUAL_ROLE ' | translate:'{relationType:\""+c+"\"}'}}: "+d,attributes:[]}),C._xmlSource+=n.outerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""))}for(var k=0;k<v.length;k++){var L=e.getNamedEntity(v[k].trim());L&&""!==d&&(L.content.relations||(L.content.relations=[],L.content._indexes.push("relations")),L.content.relations.push({text:"{{ 'LISTS.RELATION_PASSIVE_ROLE ' | translate:'{relationType:\""+c+"\"}'}}: "+d,attributes:[]}),L._xmlSource+=n.outerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""))}if(u.label=t.capitalize(u.label+": "+d),u._listPos=u.label.substr(0,1).toLowerCase(),""!==h||""!==p||""!==f){var P=[];""!==h&&P.push({attributes:{type:"LISTS.RELATION_ACTIVE",_indexes:["type"]},text:h.slice(0,-2)}),""!==p&&P.push({attributes:{type:"LISTS.RELATION_MUTUAL",_indexes:["type"]},text:p.slice(0,-2)}),""!==f&&P.push({attributes:{type:"LISTS.RELATION_PASSIVE",_indexes:["type"]},text:f.slice(0,-2)}),u.content.actors=P,u.content._indexes.push("actors")}e.addNamedEntityInCollection(i,u,u._listPos)};var r=function(e,n){var i=n.contentDef,r=n.listDef,s=n.contentForLabelDef,l=e.getAttribute("xml:id")||t.xpath(e),c={id:l,label:"",content:{_indexes:[]},_listPos:l.substr(0,1).toLowerCase(),_xmlSource:e.outerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")},u=e.getElementsByTagName(s.replace(/[<>]/g,""));if(u&&u.length>0){var d=t.parseXMLElement(u[0],u[0],{skip:"<evtNote>"});c.label=d?d.innerHTML:l}else c.label=l;return angular.forEach(e.childNodes,(function(e){1===e.nodeType&&(s.indexOf("<"+e.tagName+">")>=0&&e.children&&e.children.length>0?angular.forEach(e.children,(function(e){1===e.nodeType&&o(c,e,i,r)})):o(c,e,i,r))})),"<placeName>"===s&&a(c,e),c},o=function(e,i,r,o){var a;void 0===e.content[i.tagName]&&(e.content[i.tagName]=[],e.content._indexes.push(i.tagName)),a=r.indexOf("<"+i.tagName+">")>=0?n.parseSubEntity(i,r,o):t.parseXMLElement(i,i,{skip:"<evtNote>"}),e.content[i.tagName].push({text:a?a.innerHTML:i.innerHTML,attributes:t.parseElementAttributes(i)})},a=function(e,t){var n=t.outerHTML.search("<geo");if(n>=0){var i=t.outerHTML.search("</geo>"),r=t.outerHTML.substring(n,i),o=(r=r.substring(r.indexOf(">")+1)).split(", ");2===o.length&&(e.map={lat:o[0],lng:o[1]})}};n.parseSubEntity=function(e,i,r){var o=document.createElement("evt-named-entity-ref"),a=e.getAttribute("ref"),s=a?a.replace("#",""):void 0;s&&""!==s&&o.setAttribute("data-entity-id",s);var l=e.tagName?e.tagName:"generic";o.setAttribute("data-entity-type",l);for(var c=0;c<e.childNodes.length;c++){var u,d=e.childNodes[c].cloneNode(!0);u=1===d.nodeType&&r.toLowerCase().indexOf("<"+d.tagName.toLowerCase()+">")>=0?n.parseNamedEntitySubList(d,d,"<evtNote>"):t.parseXMLElement(d,d,{skip:"<evtNote>"}),o.appendChild(u)}return o},n.parseNamedEntitySubList=function(e,n,i){var r=document.createElement("span"),o=document.createElement("span"),a="";r.className=n.tagName.toLowerCase(),o.className=n.tagName.toLowerCase()+"-attributes";for(var s=0;s<n.attributes.length;s++){var l=n.attributes[s];l.specified&&(r.setAttribute("data-"+l.name.replace(":","-"),l.value),a+=t.camelToSpace(l.value)+", ")}""!==a&&(o.textContent=a.slice(0,-2),r.appendChild(o));for(var c=0;c<n.childNodes.length;c++){var u=n.childNodes[c].cloneNode(!0),d=t.parseXMLElement(e,u,{skip:i});r.appendChild(d)}return r};var s=function(e,n){var i=n;if(e.previousElementSibling&&"<head>".indexOf("<"+e.previousElementSibling.tagName+">")>=0)i.id=e.previousElementSibling.textContent.trim().replace(/\s/g,""),i.title=e.previousElementSibling.textContent.trim();else{var r,o=e.parentNode;if(o&&o.getAttribute("xml:id")&&(r=o.getAttribute("xml:id").trim().replace(/\s/g,""),i.id=r,i.title=r),o&&o.getAttribute("type")){var a=o.getAttribute("type").trim();r&&void 0!==r||(i.id=a),a=t.camelToSpace(a),i.title=a.substr(0,1).toUpperCase()+a.substr(1)}}return i},l=function(e){var t=new RegExp('xml:id=".*"',"ig"),n=e.match(t);t=new RegExp('xml:id=(?:"[^"]*"|^[^"]*$)',"ig");var i=n?n[0].match(t):void 0;return i?i[0].replace(/xml:id/,"").replace(/(=|\"|\')/gi,""):""};return n.parseEntitiesOccurrences=function(t,n){var i=t&&t.content?t.content:void 0,r=i?i.outerHTML:void 0,o=[];if(r&&n&&""!==n)for(var a=new RegExp("<pb(.|[\r\n])*?/>(.|[\r\n])*?(?=#"+n+")","ig"),s=r.match(a),c=s?s.length:0,u=0;u<c;u++){var d=new RegExp("<pb(.|[\r\n])*?/>","ig"),h=s[u].match(d),p=h&&h.length>0?h[h.length-1]:"",f=l(p);if(f){var g=e.getPage(f);o.push({pageId:f,pageLabel:g?g.label:f,docId:t?t.value:"",docLabel:t?t.label:""})}}return o},n}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtPrimarySourcesParser",["parsedData",function(e){var t={};return t.parseZones=function(t){var n=angular.element(t);angular.forEach(n.find("surface"),(function(t){t.getAttribute("xml:id");var n=t.getAttribute("corresp");n=n?n.replace("#",""):n,angular.forEach(t.childNodes,(function(t){if("zone"===t.tagName){var i={};if(t.attributes)for(var r=0;r<t.attributes.length;r++){var o=t.attributes[r];if(o.specified)i["xml:id"===o.name?"id":o.name.replace(":","-")]=o.value}i.page=n,e.addZone(i)}}))})),console.log("## ZONES ##",e.getZones())},t}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtProjectInfoParser",["parsedData","evtParser",function(e,t){var n={};n.parseProjectInfo=function(t){var i=angular.element(t);angular.forEach(i.find("<teiHeader>".replace(/[<>]/g,"")),(function(e){n.parseEditionReference(e),n.parseFileDescription(e),n.parseEncodingDescription(e),n.parseTextProfile(e),n.parseOutsideMetadata(e),n.parseRevisionHistory(e),n.parseMsDescription(e),n.parselistObjectDescription(e)})),console.log("## parseProjectInfo ##",e.getProjectInfo())};return n.parseEditionReference=function(t){var n=angular.element(t),i=n.find("<titleStmt>".replace(/[<>]/g,"")+" title")[0],r=n.find("<titleStmt>".replace(/[<>]/g,"")+" author")[0],o=n.find("<publicationStmt>".replace(/[<>]/g,"")+" publisher")[0],a={title:i?i.textContent:"",author:r?r.textContent:"",publisher:o?o.textContent:""};e.updateProjectInfoContent(a,"editionReference")},n.parseFileDescription=function(n){var i=angular.element(n);angular.forEach(i.find("<fileDesc>".replace(/[<>]/g,"")),(function(i){if(i.children.length>0){var r=t.parseXMLElement(n,i,{skip:"<evtNote>",exclude:"<listBibl>, <listWit>",context:"projectInfo"}).outerHTML;e.updateProjectInfoContent(r,"fileDescription")}}))},n.parseEncodingDescription=function(i){var r=angular.element(i);angular.forEach(r.find("<encodingDesc>".replace(/[<>]/g,"")),(function(r){if(r.children.length>0){var o="",a=angular.element(r).find("variantEncoding")[0];if(a){var s=t.parseXMLElement(i,r,{skip:"<evtNote>",exclude:"<listBibl>, <listWit>",context:"projectInfo"}).outerHTML;o=s||"",o+="<span class=\"variantEncoding\">{{ 'PROJECT_INFO.ENCODING_METHOD_USED' | translate:'{ method:  \""+a.getAttribute("method")+"\" }' }}</span>",n.parseVariantEncodingInfo(a)}e.updateProjectInfoContent(o,"encodingDescription")}}))},n.parseVariantEncodingInfo=function(t){t.hasAttribute("method")&&e.setEncodingDetail("variantEncodingMethod",t.getAttribute("method")),t.hasAttribute("location")&&e.setEncodingDetail("variantEncodingLocation",t.getAttribute("location"))},n.parseTextProfile=function(n){var i=angular.element(n);angular.forEach(i.find("<profileDesc>".replace(/[<>]/g,"")),(function(i){if(i.children.length>0){var r=t.parseXMLElement(n,i,{skip:"<evtNote>",exclude:"<listBibl>, <listWit>",context:"projectInfo"}).outerHTML;e.updateProjectInfoContent(r,"textProfile")}}))},n.parseOutsideMetadata=function(n){var i=angular.element(n);angular.forEach(i.find("<xenoData>".replace(/[<>]/g,"")),(function(i){if(i.children.length>0){var r=t.parseXMLElement(n,i,{skip:"<evtNote>",exclude:"<listBibl>, <listWit>",context:"projectInfo"}).outerHTML;e.updateProjectInfoContent(r,"outsideMetadata")}}))},n.parseRevisionHistory=function(n){var i=angular.element(n);angular.forEach(i.find("<revisionDesc>".replace(/[<>]/g,"")),(function(i){var r=t.parseXMLElement(n,i,{skip:"<evtNote>",exclude:"<listBibl>, <listWit>",context:"projectInfo"}).outerHTML;e.updateProjectInfoContent(r,"revisionHistory")}))},n.parseMsDescription=function(n){var i=angular.element(n);angular.forEach(i.find("<msDesc>".replace(/[<>]/g,"")),(function(i){var r=t.parseXMLElement(n,i,{skip:"<evtNote>",exclude:"<listBibl>, <listWit>",context:"projectInfo"}).outerHTML;e.updateProjectInfoContent(r,"msDesc")}))},n.parselistObjectDescription=function(n){var i=angular.element(n);angular.forEach(i.find("<listObject>".replace(/[<>]/g,"")),(function(i){var r=t.parseXMLElement(n,i,{skip:"<evtNote>",exclude:"<listBibl>, <listWit>",context:"projectInfo"}).outerHTML;e.updateProjectInfoContent(r,"listObject")})),console.log("## parselistObjectDescription ##",e.getProjectInfo().listObject)},n}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtCriticalParser",["$q","parsedData","evtParser","evtCriticalApparatusParser","evtCriticalElementsParser","config","evtDepaParser",function(e,t,n,i,r,o,a){var s={},l=o.quoteDef,c=o.analogueDef,u=(n.createRegExpr(c),"<evt-reading>,<pb>,<app>,<lem>, <rdg>,<rdgGrp>,"+l+","+c+",<evt-quote>,<evt-analogue>,<evt-version-reading>");o.skipWitnesses.split(",").filter((function(e){return 0!==e.length}));return s.parseWitnessText=function(r,a,l){var c,d=e.defer();if(void 0!==r){var h=s.getDocToParse(r),p=h.getElementsByTagName("body")[0],f=t.getWitness(l);if(s.parseCriticalElementsInText(p,h,l,null),p.innerHTML=p.innerHTML.replace(/>[\s\r\n]*?</g,"><"),angular.forEach(p.querySelectorAll("[exclude]"),(function(e){var t=e.getAttribute("exclude");t&&t.indexOf("#"+l)>=0&&e.parentNode.removeChild(e)})),angular.forEach(p.children,(function(e){var t=u+","+o.lacunaMilestone+","+o.fragmentMilestone;e.parentNode.replaceChild(n.parseXMLElement(h,e,{skip:t}),e)})),i.parseWitnessPageBreaks(p,f),i.parseWitnessLacunas(p,l),i.isFragmentaryWitness(p,l)){p.innerHTML=p.innerHTML.replace(/xmlns="http:\/\/www\.w3\.org\/1999\/xhtml"/g,"");var g=i.parseFragmentaryWitnessText(p,l);c=n.balanceXHTML(g)}else c=p.innerHTML;c=n.balanceXHTML(c)}else c="<span> {{ 'MESSAGES.TEXT_NOT_AVAILABLE' | translate }}</span>";return t.addWitnessText(l,a,c),d.resolve("success"),d},s.parseCriticalText=function(i,r,a){var l,c=e.defer();if(void 0!==i){var d=s.getDocToParse(i),h=d.getElementsByTagName("body")[0];s.parseCriticalElementsInText(h,d,"",a);for(var p=h.getElementsByTagName("pb");0<p.length;){var f=p[0];f.parentNode.removeChild(f)}angular.forEach(h.children,(function(e){var t=u+","+o.lacunaMilestone+","+o.fragmentMilestone;e.parentNode.replaceChild(n.parseXMLElement(d,e,{skip:t}),e)})),l=h.outerHTML}else l="<span>Text not available.</span>";if(void 0===l){l="<span class=\"alert-msg alert-msg-error critical-text-error\"># Critical Text Error. # <br/>{{'MESSAGES.ERROR_IN_PARSING_TEXT' | translate}} <br />{{'MESSAGES.TRY_DIFFERENT_BROWSER_OR_CONTACT_DEVS' | translate}}</span>"}return""!==a&&void 0!==a&&a!==o.versions[0]||t.addCriticalText(l,r),void 0!==a&&t.addVersionText(l,r,a),c.resolve("success"),c},s.getDocRoot=function(e){if(e&&e.tagName&&"tei"===e.tagName.toLowerCase())return e;if(e&&e.parentNode)return s.getDocRoot(e.parentNode);var t=e?e.querySelector("tei"):e;return t?s.getDocRoot(t):e},s.getDocToParse=function(e){var t,i=s.getDocRoot(e).cloneNode(!0);return angular.forEach(angular.element(i).find(n.parserProperties.defDocElement),(function(n){0===n.outerHTML.localeCompare(e.outerHTML)&&(t=n)})),t||e},s.parseCriticalElementsInText=function(e,i,r,u){for(var d=e.getElementsByTagName("<app>".replace(/[<>]/g,""))||[],h=d.length-1;h<d.length&&h>=0;)n.isNestedInElem(d[h],"<app>".replace(/[<>]/g,""))||s.appendAppNode(d[h],i,r,u),h--;if("double-end-point"===t.getEncodingDetail("variantEncodingMethod")&&"external"===t.getEncodingDetail("variantEncodingLocation")){var p=Object.values(t.getCriticalEntries()._indexes.depa.start),f=[];p.map((function(e){f.indexOf(e)<0&&f.push(e)}));for(var g=f.length-1;g>=0;){var m=e.querySelector("[*|id="+f[g]+"]");m&&a.setAppInText(m,r,e),g--}}if(o.quoteDef){var v=[],y=l.split(",");angular.forEach(y,(function(t){var n=e.getElementsByTagName(t.replace(/[<>]/g,""))||[];v=v.concat(n)}));for(var b=v.length-1;b<v.length&&b>=0;)s.appendQuoteNode(v[b],i,r),b--}if(o.analogueDef){var _=[],x=c.split(",")||[];angular.forEach(x,(function(t){var n=e.querySelectorAll(t.replace("<","").replace(">",""));angular.forEach(n,(function(e){_.push(e)}))}));for(var w=_.length-1;w<_.length&&w>=0;)s.appendAnalogueNode(_[w],i,r),w--}},s.appendAnalogueNode=function(e,n,i){var o,a=s.getParsedNodeId(e),l=t.getAnalogue(a);l&&(o=r.getAnalogueText(l,i,n)),o&&e.parentNode.replaceChild(o,e)},s.appendQuoteNode=function(e,n,i){var o,a=s.getParsedNodeId(e),l=t.getQuote(a);l&&(o=r.getQuoteText(l,i,n)),o&&e.parentNode.replaceChild(o,e)},s.appendAppNode=function(e,n,i,l){var c,u=s.getParsedNodeId(e),d="recensio"===e.getAttribute("type")?t.getVersionEntry(u):t.getCriticalEntryById(u);if(!o.loadCriticalEntriesImmediately||void 0===d)if("recensio"===e.getAttribute("type"))r.handleVersionEntry(e),d=t.getVersionEntry(u);else{r.handleAppEntry(e);var h=e.getElementsByTagName("<app>".replace(/[<>]/g,""));angular.forEach(Object.values(h),(function(e){r.handleAppEntry(e)})),d=t.getCriticalEntryById(u)}if(d)switch(i){case"":"double-end-point"===t.getEncodingDetail("variantEncodingMethod")?a.setInternalAppInText(e,d,i,n):c="recensioApp"===d.type?r.getVersionEntryLemma(d,i,l):r.getEntryLemmaText(d,i);break;default:"double-end-point"===t.getEncodingDetail("variantEncodingMethod")?a.setInternalAppInText(e,d,i,n):c="recensioApp"===d.type?r.getVersionEntryReadingText(d,i):r.getEntryWitnessReadingText(d,i)}else c=s.createErrorElement(null,"encodingError");c?e.parentNode.replaceChild(c,e):"double-end-point"===t.getEncodingDetail("variantEncodingMethod")&&e.parentNode.removeChild(e)},s.createErrorElement=function(e,t){var n=document.createElement("span");return n.className=e||"errorMsg",n.textContent=t||"ERROR",n},s.getParsedNodeId=function(e){var t;return e.attributes&&e.getAttribute("xml:id")?(t=e.getAttribute("xml:id"),t="app"===e.tagName?"app_"+t:t):t=n.xpath(e).substr(1),t},s.parseSourceText=function(i,r){var o,a=e.defer();angular.element(p);if(void 0!==i){for(var l,c,d,h,p=s.getDocToParse(i),f=p.getElementsByTagName("body")[0],g=f.getElementsByTagName("seg"),m=g.length-1,v=t.getSources()._indexes.correspId[r];m>=0;)(l=g[m]).hasAttribute("type")&&"srcTxtLink"===l.getAttribute("type")&&(l.hasAttribute("xml:id")&&(c=l.getAttribute("xml:id")),void 0!==v[c]&&((d=document.createElement("evt-source-seg")).setAttribute("data-seg-id",c),d.setAttribute("data-source-id",r),h=l.innerHTML,d.innerHTML=h,l.parentNode.replaceChild(d,l))),m--;angular.forEach(f.children,(function(e){var t=u+"<evt-source-seg>";e.parentNode.replaceChild(n.parseXMLElement(p,e,{skip:t}),e)})),o=f.outerHTML}else o="<span>Text not available.</span>";if(void 0===o){o="<span class=\"alert-msg alert-msg-error\">{{'MESSAGES.ERROR_IN_PARSING_TEXT' | translate}} <br />{{'MESSAGES.TRY_DIFFERENT_BROWSER_OR_CONTACT_DEVS' | translate}}</span>"}return t.getSource(r).text=o,a.resolve("success"),a},s}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtSourcesParser",["$q","parsedData","evtParser","evtCriticalElementsParser","config",function(e,t,n,i,r){var o={},a=r.quoteDef||"<quote>",s=function(e){var n=t.getQuotes()._indexes.sourcesRef._id;if(3!==e.nodeType&&1===e.nodeType)if(e.attributes.length>0){for(var r=0;r<e.attributes.length;r++)if("xml:id"===e.attributes[r].name){var o=e.attributes[r].value;n.indexOf(o)>=0&&i.parseSource(e)}}else if(e.childNodes.length>0)for(var a=0;a<e.childNodes.length;a++)s(e.childNodes[a])};o.parseQuotes=function(r){var o=e.defer(),s=angular.element(r);return angular.forEach(s.find(a.replace(/[<>]/g,"")),(function(e){if(n.isNestedInElem(e,"body")){var r=i.parseQuote(e);t.addQuote(r)}})),console.log("## Quotes ##",t.getQuotes()),o.resolve("success"),o};var l=function(){for(var e=t.getSources()._indexes.quotesRef._id,n=t.getQuotes()._indexes.encodingStructure,i=[],r=0;r<n.length;r++)e.indexOf(n[r])<0&&(i.push(n[r]),n.splice(r,1));for(var o=0;o<i.length;o++)delete t.getQuotes()[i[o]]};return o.parseSources=function(n,i){var a=e.defer();if(t.getQuotes()._indexes.sourcesRef._id.length>0)if(""===r.sourcesUrl){var c,u=angular.element(n);u.find("text group text").length>0?c="text group text":u.find("text").length>0?c="text":u.find('div[subtype="edition_text"]').length>0&&(c='div[subtype="edition_text"]'),angular.forEach(u.find(c),(function(e){s(e)})),console.log("## Sources ##",t.getSources()),l()}else i&&o.parseExternalSources(i);return a.resolve("success"),a},o.parseExternalSources=function(n){for(var i=e.defer(),r=0;r<n.childNodes.length;r++)s(n.childNodes[r]);return console.log("## External Sources ##",t.getSources()),l(),i.resolve("success"),i},o}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtSourcesApparatus",["parsedData","evtCriticalApparatus",function(e,t){var n={getContent:function(t,i){for(var r,o,a={attributes:{values:t.attributes||{},_keys:Object.keys(t.attributes)||[]},sources:[],quote:"",abbrQuote:{begin:"",end:""},quoteCorresp:t._indexes.correspId,_xmlSource:t._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")},s=t._indexes.sourceId||[],l=t._indexes.sourceRefId||[],c=0;c<s.length;c++)r=e.getSource(s[c]),(o=n.getSource(r))&&a.sources.push(o);for(var u=0;u<l.length;u++)r=e.getSource(l[u]),(o=n.getSource(r))&&a.sources.push(o);if(a.quote=n.getQuote(t,i),a.quote.length>=140){var d=a.quote.indexOf(" ",20),h=a.quote.lastIndexOf(" ");a.abbrQuote.begin='<span class="beginQuote">'+a.quote.substring(0,d)+"</span>",a.abbrQuote.end='<span class="endQuote">'+a.quote.substring(h)+"</span>"}return a},getSource:function(e){if(e){var t={id:e.id,abbr:"",text:"",bibl:"",url:"",_xmlSource:e._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")};if(e.abbr.msId.length>0)for(var i=0;i<e.abbr.msId.length;i++)t.abbr+='<span class="msId inSource">'+n.getText(e.abbr.msId[i])+"</span>";else e.abbr.author.length>0&&(t.abbr+='<span class="author inSource">'+n.getText(e.abbr.author[0])+"</span>",e.abbr.author.length>1?t.abbr+="et al., ":t.abbr+=", "),e.abbr.title.length>0&&(t.abbr+='<span class="title inSource">'+n.getText(e.abbr.title[0])+"</span>");""===t.abbr&&(t.abbr=e.id);for(var r=e.bibl,o=0;o<r.length;o++)t.bibl+=n.getText(r[o]);var a="";if(e.quote.length>0){for(var s=0;s<e.quote.length;s++)a+=n.getText(e.quote[s]);""!==a&&(t.text=a)}for(var l=0;l<e.url.length;l++)e.url[l].indexOf("http")>=0?t.url+='<span class="linkLabel">{{ \'CRITICAL_APPARATUS.SEE_FULL_SOURCE_WEB\' | translate }}</span><a target="_blank" href="'+e.url[l]+'">'+e.url[l]+"</a><br/>":e.url[l].indexOf(e.id)>=0&&(t.url+='<span class="linkLabel"><evt-source-ref data-source-id="'+e.id+"\">{{ 'CRITICAL_APPARATUS.SEE_FULL_SOURCE' | translate }}</evt-source-ref></span>");return t}},getSourceAbbr:function(e){var t="";if(e.abbr)if(e.abbr.msId&&e.abbr.msId.length>0)for(var i=0;i<e.abbr.msId.length;i++)t+=n.getText(e.abbr.msId[i])+" ";else e.abbr.author&&e.abbr.author.length>0&&(t+=n.getText(e.abbr.author[0]),e.abbr.author.length>1?t+="et al., ":t+=", "),e.abbr.title&&e.abbr.title.length>0&&(t+=n.getText(e.abbr.title[0]));return""===t&&(t=e.id),t},getQuote:function(e,i){var r=e.content||[],o="";for(var a in r)if("string"==typeof r[a])o+=" "+r[a];else{["EVT-POPOVER","lb","ptr","link","linkGrp","pb"].indexOf(r[a].tagName)>=0?o+="":"app"===r[a].type?o+=n.getAppText(r[a],i):"analogue"===r[a].type?o+=t.getCriticalElementContent(r[a],i):"quote"===r[a].type?o+=" (("+n.getQuote(r[a],i)+"))":void 0!==r[a].content?o+=n.getText(r[a]):o+=n.getQuote(r[a])}return o},getText:function(e){var t="",i=e.content;if(void 0!==i)for(var r=0;r<i.length;r++)"string"==typeof i[r]?t+=" "+i[r]:void 0!==i[r].content&&(t+=n.getText(i[r]));return t},getAppText:function(e,t){var i="";if(""===t||void 0===t||void 0===e._indexes.witMap[t]){var r=e.lemma;i+=n.getText(e.content[r])}else{var o=e._indexes.witMap[t];i+=n.getText(e.content[o])}return i}};return n}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtAnaloguesParser",["$q","evtParser","parsedData","evtCriticalElementsParser","config",function(e,t,n,i,r){var o={},a=(r.quoteDef,r.analoguesUrl||""),s=r.analogueDef||"<seg>,<ref[type=parallelPassage]>";return o.parseAnalogues=function(r,l){var c,u=e.defer(),d=angular.element(r);(angular.forEach(d.find(s.replace(/[<>]/g,"")),(function(e){if(t.isNestedInElem(e,"body")){var r=i.parseAnalogue(e);(r._indexes.sourceId.length>0||r._indexes.sourceRefId.length>0)&&n.addAnalogue(r)}})),n.getAnalogues()._refId._indexes.length>0)&&(""===a||void 0===a?(d.find("text group text").length>0?c="text group text":d.find("text").length>0?c="text":d.find('div[subtype="edition_text"]').length>0&&(c='div[subtype="edition_text"]'),angular.forEach(d.find(c),(function(e){o.handleAnalogue(e)})),o.updateAnalogues()):void 0!==l&&o.parseExternalAnalogues(l));return console.log("## Analogues ##",n.getAnalogues()),u.resolve("success"),u},o.handleAnalogue=function(e){var t=n.getAnalogues()._refId,r=n.getAnalogues()._refId._indexes;if(3!==e.nodeType&&1===e.nodeType){var a=e.getAttribute("xml:id");if(a&&r.indexOf(a)>=0)for(var s=i.parseAnalogueSource(e),l=0;l<t[a].length;l++){n.getAnalogue(t[a][l]).sources.push(s)}else if(e.childNodes.length>0)for(var c=0;c<e.childNodes.length;c++)o.handleAnalogue(e.childNodes[c])}},o.updateAnalogues=function(){for(var e=n.getAnalogues(),t=n.getAnalogues()._indexes.encodingStructure,i=0;i<t.length;i++){var r=n.getAnalogue(t[i]);r.sources.length<=0&&(delete e[t[i]],t.splice(t.indexOf(r.id),1))}},o.parseExternalAnalogues=function(t){for(var i=e.defer(),r=0;r<t.childNodes.length;r++)o.handleAnalogue(t.childNodes[r]);return console.log("## External Analogues Received ##",n.getAnalogues()),o.updateAnalogues(),i.resolve("success"),i},o}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtAnaloguesApparatus",["evtSourcesApparatus",function(e){var t={getContent:function(e,n){for(var i={attributes:{values:e.attributes||{},_keys:Object.keys(e.attributes)||[]},sources:[],header:"",_xmlSource:e._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")},r=0;r<e.sources.length;r++){var o=t.getSource(e.sources[r]);o&&i.sources.push(o)}return i.header=t.getHeader(e,n),i},getSource:function(e){var n={id:e.id,abbr:"",text:"",bibl:"",url:e.url,_xmlSource:e._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")};if(e.abbr)if(e.abbr.msId&&e.abbr.msId.length>0)for(var i=0;i<e.abbr.msId.length;i++)n.abbr+='<span class="msId inSource">'+t.getText(e.abbr.msId[i])+"</span>";else e.abbr.author&&e.abbr.author.length>0&&(n.abbr+='<span class="author inSource">'+t.getText(e.abbr.author[0])+"</span>",e.abbr.author.length>1?n.abbr+="et al., ":n.abbr+=", "),e.abbr.title&&e.abbr.title.length>0&&(n.abbr+='<span class="title inSource">'+t.getText(e.abbr.title[0])+"</span>");""===n.abbr&&(n.abbr=e.id);for(var r=e.bibl,o=0;o<r.length;o++)n.bibl+=t.getText(r[o]);var a="";if(e.text.length>0){for(var s=0;s<e.text.length;s++)a+=t.getText(e.text[s]);""!==a&&(n.text=a)}return n},getHeader:function(n,i){var r=n.content||[],o='<span class="analogue-header">';for(var a in r)if("string"==typeof r[a])o+='<span class="textNode inAnalogueHeader">'+r[a]+"</span>";else{if(["EVT-POPOVER","lb","ptr","link","linkGrp","pb"].indexOf(r[a].tagName)>=0)o+="";else if("app"===r[a].type){o+='<span class="app inAnalogueHeader">'+t.getAppText(r[a],i)+"</span>"}else"analogue"===r[a].type?o+='<span class="subAnalogue inAnalogueHeader">(('+t.getHeader(r[a],i)+"))</span>":"quote"===r[a].type?o+='<span class="quote inAnalogueHeader">'+e.getQuote(r[a],i)+"</span>":"analogueContent"===r[a].type?o+=t.getHeader(r[a],i):void 0!==r[a].content&&(o+='<span class="textNode inAnalogueHeader">'+t.getText(r[a])+"</span>")}return o+="</span>"},getText:function(e){var n="",i=e.content;if(void 0!==i)for(var r=0;r<i.length;r++)"string"==typeof i[r]?n+=" "+i[r]:void 0!==i[r].content&&(n+=t.getText(i[r]));return n},getAppText:function(e,n){var i="";if(""===n||void 0===n||void 0===e._indexes.witMap[n]){var r=e.lemma;i+=t.getText(e.content[r])}else{var o=e._indexes.witMap[n];i+=t.getText(e.content[o])}return i}};return t}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtCriticalElementsParser",["evtParser","parsedData","config","xmlParser",function(e,t,n,i){var r={},o="<lem>, <rdg>",a=n.quoteDef||"<quote>",s=n.analogueDef||"<seg>,<ref[type=parallelPassage]>",l=e.createRegExpr(s),c=function(e){if(n.lacunaMilestone.indexOf("<"+e.tagName+">")<0&&n.fragmentMilestone.indexOf("<"+e.tagName+">")<0){var t={tagName:e.tagName,type:"genericElement",attributes:[],content:[]};if(e.attributes)for(var i=0;i<e.attributes.length;i++){var o=e.attributes[i];o.specified&&(t.attributes[o.name]=o.value)}return angular.forEach(e.childNodes,(function(i){if(3===i.nodeType)""!==i.textContent.trim()&&t.content.push(i.textContent.trim());else if("<"+i.tagName+">"=="<app>"){var o=r.handleAppEntry(i);t.content.push({id:o.id,type:"subApp"})}else{var s=angular.element(i)[0].innerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),u=angular.element(i)[0].outerHTML.replace(s,"");if(n.fragmentMilestone.indexOf(i.tagName)>=0&&null===i.getAttribute("wit")){var d=e.getAttribute("wit");i.setAttribute("wit",d)}if(n.lacunaMilestone.indexOf(i.tagName)>=0&&null===i.getAttribute("wit")){var h=e.getAttribute("wit");i.setAttribute("wit",h)}a.indexOf("<"+i.tagName+">")>=0&&t.content.push(r.parseQuote(i)),l.test(u)&&t.content.push(r.parseAnalogue(i)),angular.element(i).find("<app>".replace(/[<>]/g,""))?t.content.push(c(i)):t.content.push(i.cloneNode(!0))}})),t}return e},u=function(i,o){var s,u={id:"",attributes:[],content:[],note:"",_significant:!0,_group:void 0,_xmlTagName:o.tagName,_xmlSource:o.outerHTML};s=o.getAttribute("xml:id")?"rdg_"+o.getAttribute("xml:id"):e.xpath(o).substr(1),u.id=s;for(var d=0;d<o.attributes.length;d++){var h=o.attributes[d];if(h.specified){if(u.attributes[h.name]=h.value,"wit"===h.name||"source"===h.name){var p=h.value.split("#").filter((function(e){return 0!==e.length}));for(var f in u.wits=[],p){var g=p[f].replace(" ","");if(void 0!==t.getWitness(g))if(t.isWitnessesGroup(g)){var m=t.getWitnessesInGroup(g);for(var v in u.wits.push.apply(u.wits,m),m)void 0===i._indexes.witMap[m[v]]&&(i._indexes.witMap[m[v]]=s)}else u.wits.push(g),void 0===i._indexes.witMap[g]&&(i._indexes.witMap[g]=s)}}u._significant&&n.notSignificantVariant.indexOf("["+h.name+"="+h.value+"]")>=0&&(u._significant=!1),t.addCriticalEntryFilter(h.name,h.value)}}return angular.forEach(o.childNodes,(function(e){if(3===e.nodeType)""!==e.textContent.trim()&&u.content.push(e.textContent.trim());else if(1===e.nodeType)if("note"===e.tagName)u.note=e.innerHTML;else if("<app>".indexOf("<"+e.tagName+">")>=0){var t=r.handleAppEntry(e,i.id);if("recensioApp"===i.type&&"rdgGrp"===o.parentNode.tagName){var s=r.handleAppEntry(e,o);u.content.push(s)}else u.content.push({id:t.id,type:"subApp"}),i._indexes.subApps.push(t.id)}else{var d="",h="";if(void 0!==angular.element(e)[0].innerHTML&&(d=angular.element(e)[0].innerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),h=angular.element(e)[0].outerHTML.replace(d,"")),u._significant&&n.notSignificantVariant.indexOf("<"+e.tagName+">")>=0&&(u._significant=!1),n.fragmentMilestone.indexOf(e.tagName)>=0&&null===e.getAttribute("wit")){var p=o.getAttribute("wit");e.setAttribute("wit",p)}if(n.lacunaMilestone.indexOf(e.tagName)>=0&&null===e.getAttribute("wit")){var f=o.getAttribute("wit");e.setAttribute("wit",f)}a.indexOf("<"+e.tagName+">")>=0?u.content.push(r.parseQuote(e)):l.test(h)?u.content.push(r.parseAnalogue(e)):angular.element(e).find("<app>".replace(/[<>]/g,""))?u.content.push(c(e)):u.content.push(e.cloneNode(!0))}})),u},d=function(i){var a,s={type:"app",id:"",attributes:[],lemma:"",note:"",content:{},_indexes:{encodingStructure:[],readings:{_indexes:[],_significant:[]},groups:[],subApps:[],witMap:{}},_subApp:!1,_xmlSource:i.outerHTML||""};if(a=i.getAttribute("xml:id")?"app_"+i.getAttribute("xml:id"):e.xpath(i).substr(1),s.id=a,i.attributes)for(var l=0;l<i.attributes.length;l++){var c=i.attributes[l];c.specified&&(s.attributes[c.name]=c.value,t.addCriticalEntryFilter(c.name,c.value))}return"app"===i.parentNode.parentNode.parentNode.tagName&&"recensio"===i.parentNode.parentNode.parentNode.getAttribute("type")?s._subApp=!1:s._subApp=e.isNestedInElem(i,"<app>".replace(/[<>]/g,"")),n.versions.length>0&&(s._isInMainVersion=e.isInMainVersion(i)),angular.forEach(i.childNodes,(function(i){if(1===i.nodeType)if(o.indexOf("<"+i.tagName+">")>=0){var l=u(s,i);"<lem>".indexOf("<"+i.tagName+">")>=0?s.lemma=l.id:(s._indexes.readings._indexes.push(l.id),l._significant&&s._indexes.readings._significant.indexOf(l.id)<0&&s._indexes.readings._significant.push(l.id)),s.content[l.id]=l,s._indexes.encodingStructure.push(l.id)}else if("<rdgGrp>".indexOf("<"+i.tagName+">")>=0)!function(i,r){var a,s={attributes:[],content:[]};a=r.getAttribute("xml:id")?"rdg_"+r.getAttribute("xml:id"):e.xpath(r).substr(1),s.id=a,angular.forEach(r.childNodes,(function(e){if(o.indexOf("<"+e.tagName+">")>=0){var a=u(i,e);a._group=s.id,s.content.push(a.id);for(var l=0;l<r.attributes.length;l++){var c=r.attributes[l];c.specified&&(s.attributes[c.name]=c.value,void 0===a.attributes[c.name]&&(a.attributes[c.name]=c.value,a._significant&&n.notSignificantVariant.indexOf("["+c.name+"="+c.value+"]")>=0&&(a._significant=!1)),t.addCriticalEntryFilter(c.name,c.value))}i._indexes.readings._indexes.push(a.id),i.content[a.id]=a,(a._significant||"lem"===e.tagName)&&i._indexes.readings._significant.push(a.id)}else"<rdgGrp>".indexOf("<"+e.tagName+">")})),i._indexes.groups.push(s.id),i.content[s.id]=s,i._indexes.encodingStructure.push(s.id)}(s,i);else if("<app>".indexOf("<"+i.tagName+">")>=0){var c=r.handleAppEntry(i,a),d={id:c.id,type:"subApp"};s.content[c.id]=d,s._indexes.encodingStructure.push(c.id),s._indexes.subApp.push(c.id)}else"note"===i.tagName&&(s.note=i.innerHTML)})),s};r.handleAppEntry=function(e,n){var i=d(e)||void 0;(e.querySelectorAll("rdg lacunaStart").length>0||e.querySelectorAll("rdg lacunaEnd").length>0)&&(i._lacuna=!0),(e.querySelectorAll("rdg witStart").length>0||e.querySelectorAll("rdg witEnd").length>0)&&(i._fragment=!0);var r=i._indexes.readings._significant,o=r.length;""!==i.lemma&&r.indexOf(i.lemma)>=0&&(o-=1);var a=t.getWitnessesList(),s=o/a.length;i._variance=s;var l=Object.keys(i._indexes.witMap),c=[];if(l.length<a.length)for(var u in a)l.indexOf(a[u])<0&&c.push(a[u]);i._indexes.missingWits=c;var h=i.content[i.lemma];return h&&(h.wits&&0!==h.wits.length||(h.autoWits=c)),n&&(i._indexes._parentEntry=n),t.addCriticalEntry(i),i};r.handleVersionEntry=function(i){var r={type:"recensioApp",id:"",attributes:[],lemma:"",content:{},_indexes:{witMap:{}},_xmlSource:i.outerHTML||""};if(i.hasAttribute("xml:id")?r.id=i.getAttribute("xml:id"):r.id=e.xpath(i).substr(1),i.attributes)for(var o=0;o<i.attributes.length;o++){var a=i.attributes[o];a.specified&&(r.attributes[a.name]=a.value,r.attributes.length++)}return angular.forEach(i.childNodes,(function(e){if(1===e.nodeType)if("note"===e.tagName)r.note=e.innerHTML;else if("<rdgGrp>".indexOf("<"+e.tagName+">")>=0){var i=function(e,i){var r={id:"",versionId:"",attributes:[],content:{},lemma:""},o="";if(i.attributes)for(var a=0;a<i.attributes.length;a++){var s=i.attributes[a];if(s.specified&&(r.attributes[s.name]=s.value,r.attributes.length++,"ana"===s.name)){o=s.value.replace("#",""),r.id=o;var l=n.versions.indexOf(o);l>=0&&(r.versionId="Version &#"+(l+65)+";")}}return angular.forEach(i.childNodes,(function(n){if(1===n.nodeType){var i=u(e,n);if(void 0===i.wits){var a=t.getVersionEntries()._indexes.versionWitMap[o];if(void 0!==a&&a.length>0){i.wits=[];for(var s=0;s<a.length;s++)i.wits.push(a[s])}}"lem"===n.tagName&&(r.lemma=i.id),r.content[i.id]=i}})),e.content[o]=r,r}(r,e);i.lemma;i.id===n.versions[0]&&""!==i.lemma&&(r.lemma=i.lemma)}})),t.addVersionEntry(r),r},r.getEntryWitnessReadingText=function(e,n){var i;if(null!==e){var o=e._indexes.readings._indexes;if(i=document.createElement("evt-reading"),""!==e.lemma&&!e._lacuna&&1===o.length)(e.content[o[0]].wits||[]).length===t.getWitnessesList().length&&((i=document.createElement("span")).className=e.content[o[0]]._xmlTagName);i.setAttribute("data-app-id",e.id),i.setAttribute("data-scope-wit",n);var a=e._indexes.witMap[n];if(void 0!==a&&""!==a){i.setAttribute("data-reading-id",a);var s=e.content[a].content;if(s.length>0)for(var l in s)if("string"==typeof s[l])i.appendChild(document.createTextNode(s[l]));else if("subApp"===s[l].type){var c=t.getCriticalEntryById(s[l].id),u=r.getEntryWitnessReadingText(c,n),d=c._indexes.witMap[n]||"";u.setAttribute("data-reading-id",d),null!==u&&i.appendChild(u)}else if("quote"===s[l].type){var p=r.getQuoteText(s[l],n);i.appendChild(p)}else if("analogue"===s[l].type){var f=r.getAnalogueText(s[l],n);i.appendChild(f)}else if("genericElement"===s[l].type){var g=h(s[l],n);i.appendChild(g)}else i.appendChild(s[l]);else if(e._lacuna){var m=document.createElement("span");m.className="lacunaApp evt_note",i.appendChild(m)}else{var v=document.createElement("span");v.className="omission",i.appendChild(v)}}else if(e.lemma&&e.lemma.indexOf("depa-lem")<0)i=r.getEntryLemmaText(e,n);else if("double-end-point"!==t.getEncodingDetail("variantEncodingMethod")){var y=document.createElement("span");y.className="empty",y.setAttribute("title","noRdg"),i.appendChild(y)}}else{var b=document.createElement("span");b.className="encodingError",b.setAttribute("title","General error"),i.appendChild(b)}return i.setAttribute("data-type","variant"),i.childNodes.length<=0&&(i.innerHTML='<span class="emptyText"></span>'),i};var h=function(e,n){var i=document.createElement("span");i.className=e.tagName;var o=Object.keys(e.attributes);for(var a in o){var s=o[a],l=e.attributes[s];"xml:id"!==s&&i.setAttribute("data-"+s.replace(":","-"),l)}var c=e.content;for(var u in c)if("string"==typeof c[u])i.appendChild(document.createTextNode(c[u]));else if("subApp"===c[u].type){var d=t.getCriticalEntryById(c[u].id),p=""===n?r.getEntryLemmaText(d,n):r.getEntryWitnessReadingText(d,n),f=d._indexes.witMap[n]||"";p.setAttribute("data-reading-id",f),null!==p&&i.appendChild(p)}else if("quote"===c[u].type){var g=r.getQuoteText(c[u],n);i.appendChild(g)}else if("analogue"===c[u].type){var m=r.getAnalogueText(c[u],n);i.appendChild(m)}else if("genericElement"===c[u].type){var v=h(c[u],n);i.appendChild(v)}return i};r.getVersionEntryReadingText=function(e,n){var i,o,a,s,l,c="",u=[];if(null!==e){(i=document.createElement("evt-version-reading")).setAttribute("data-app-id",e.id);var d,p,f,g=document.createElement("i");if(g.className="iconbis-evt_fork",g.setAttribute("title","There are alternative versions of this part of text"),i.appendChild(g),0!==Object.keys(e._indexes.witMap).length){if(""!==(c=e._indexes.witMap[n])){for(o in e.content)for(a in e.content[o].content)a===c&&(u=e.content[o].content[a].content);if(void 0!==u&&u.length>0)for(s in u)if("string"==typeof u[s])i.appendChild(document.createTextNode(u[s]));else if("app"===u[s].type){var m=t.getCriticalEntryById(u[s].id),v=r.getEntryWitnessReadingText(m,n);null!==v&&i.appendChild(v)}else if("quote"===u[s].type)d=r.getQuoteText(u[s],n),i.appendChild(d);else if("analogue"===u[s].type)p=r.getAnalogueText(u[s],n),i.appendChild(p);else if("genericElement"===u[s].type)f=h(u[s],n),i.appendChild(f);else if("recensioApp"===u[s].type){var y=r.getVersionEntryReadingText(u[s],n);i.appendChild(y)}else i.appendChild(u[s])}}else{var b,_=t.getVersionEntries()._indexes.versionWitMap;for(o in _)_[o].indexOf(n)>=0&&(b=o);if(void 0!==b){if(i.setAttribute("data-scope-version",b),void 0===e.content[b])return null;var x=e.content[b].lemma,w=Object.keys(e.content[b].content)[0],S=e.content[b].content[w];if(void 0!==x&&""!==x){var T=e.content[b].content[x].content;for(a in T)if("string"==typeof T[a])i.appendChild(document.createTextNode(T[a]));else if("subApp"===T[a].type||"app"===T[a].type){var E=t.getCriticalEntryById(T[a].id),C=""===n?r.getEntryLemmaText(E,n):r.getEntryWitnessReadingText(E,n),k=E._indexes.witMap[n]||"";C.setAttribute("data-reading-id",k),null!==C&&i.appendChild(C)}else"quote"===T[a].type?(d=r.getQuoteText(T[a],n),i.appendChild(d)):"analogue"===T[a].type?(p=r.getAnalogueText(T[a],n),i.appendChild(p)):"genericElement"===T[a].type&&(f=h(T[a],n),i.appendChild(f));c=x}else if(void 0!==S&&""!==S){u=S.content;for(a in u)if("string"==typeof u[a])i.appendChild(document.createTextNode(u[a]));else if("subApp"===u[a].type||"app"===u[a].type){E=t.getCriticalEntryById(u[a].id),C=r.getEntryWitnessReadingText(E,n),k=E._indexes.witMap[n]||"";C.setAttribute("data-reading-id",k),null!==C&&i.appendChild(C)}else"quote"===u[a].type?(d=r.getQuoteText(u[a],n),i.appendChild(d)):"analogue"===u[a].type?(p=r.getAnalogueText(u[a],n),i.appendChild(p)):"genericElement"===u[a].type&&(f=h(u[a],n),i.appendChild(f));c=x}}else{var L=document.createTextNode("Warning: no version has been defined for the current witness. Please check your encoded file.");(l=document.createElement("span")).className="encodingError",l.appendChild(L),i.appendChild(l)}}i.setAttribute("data-reading-id",c),i.setAttribute("data-scope-wit",n)}else(l=document.createElement("span")).className="encodingError",l.setAttribute("title","General error"),i.appendChild(l);return i.setAttribute("data-type","versionVariant"),i},r.getEntryLemmaText=function(e,i){var o,a;if(null!==e){if((o=document.createElement("evt-reading")).setAttribute("data-app-id",e.id),o.setAttribute("data-scope-wit",i),o.setAttribute("data-type","lemma"),e._lacuna){var s=document.createElement("span");s.className="lacunaApp evt_note",o.appendChild(s)}else if(e.lemma&&e.lemma.indexOf("depa-lem")<0){o.setAttribute("data-reading-id",e.lemma);var l=e.content[e.lemma].content;for(var c in l)if("string"==typeof l[c])o.appendChild(document.createTextNode(l[c]));else if("subApp"===l[c].type){var u=t.getCriticalEntryById(l[c].id),d=""===i?r.getEntryLemmaText(u,i):r.getEntryWitnessReadingText(u,i),p=u._indexes.witMap[i]||"";d.setAttribute("data-reading-id",p),null!==d&&o.appendChild(d)}else if("quote"===l[c].type){var f=r.getQuoteText(l[c],i);o.appendChild(f)}else if("analogue"===l[c].type){var g=r.getAnalogueText(l[c],i);o.appendChild(g)}else if("genericElement"===l[c].type){var m=h(l[c],i);o.appendChild(m)}}else""!==n.preferredWitness?null!==(o=r.getEntryWitnessReadingText(e,n.preferredWitness))&&(o.className="autoLemma"):"double-end-point"!==t.getEncodingDetail("variantEncodingMethod")&&((a=document.createElement("span")).className="encodingError",a.setAttribute("title","General error"),o.appendChild(a));if(null!==o){var v=Object.keys(e.attributes);for(var y in v){var b=v[y],_=e.attributes[b];"xml:id"!==b&&o.setAttribute("data-"+b.replace(":","-"),_)}void 0!==e._variance&&o.setAttribute("data-variance",e._variance)}}else(a=document.createElement("span")).className="encodingError",a.setAttribute("title","General error"),o.appendChild(a);return o.childNodes.length<=0&&(o.innerHTML='<span class="emptyText"></span>'),o},r.getVersionEntryLemma=function(e,n,i){var o,a;if(null!==e){(o=document.createElement("evt-version-reading")).setAttribute("data-app-id",e.id),o.setAttribute("data-type","versionLemma"),o.setAttribute("data-scope-version",i);var s=document.createElement("i");if(s.className="iconbis-evt_fork",s.setAttribute("title","There are alternative versions of this part of text"),o.appendChild(s),void 0!==e.content[i]){var l=e.content[i].lemma,c=Object.keys(e.content[i].content)[0],u=e.content[i].content[c];if(void 0!==l&&""!==l){o.setAttribute("data-reading-id",l);var d=e.content[i].content[e.content[i].lemma].content;for(var h in d)if("string"==typeof d[h])o.appendChild(document.createTextNode(d[h]));else if("app"===d[h].type){var p=t.getCriticalEntryById(d[h].id);null!==(y=r.getEntryLemmaText(p,""))&&o.appendChild(y)}else if("quote"===d[h].type){var f=r.getQuoteText(d[h],n);o.appendChild(f)}else if("analogue"===d[h].type){var g=r.getAnalogueText(d[h],n);o.appendChild(g)}else if("recensioApp"===d[h].type){var m=r.getVersionEntryLemma(d[h],n,i);o.appendChild(m)}}else if(void 0!==u&&""!==u){o.setAttribute("data-reading-id",c);var v=u.content;for(var h in v)if("string"==typeof v[h])o.appendChild(document.createTextNode(v[h]));else if("app"===v[h].type){var y;p=t.getCriticalEntryById(v[h].id);null!==(y=r.getEntryWitnessReadingText(p,""))&&o.appendChild(y)}else if("quote"===v[h].type){f=r.getQuoteText(v[h],n);o.appendChild(f)}else if("analogue"===v[h].type){g=r.getAnalogueText(v[h],n);o.appendChild(g)}else if("recensioApp"===v[h].type){m=r.getVersionEntryLemma(v[h],n,i);o.appendChild(m)}}else(a=document.createElement("span")).className="encodingError",a.setAttribute("title","lem missing inside of the version rdgGrp"),o.appendChild(a)}else(a=document.createElement("span")).className="encodingError",a.setAttribute("title","Wrong version id"),o.appendChild(a);if(null!==o){var b=Object.keys(e.attributes);for(var _ in b){var x=b[_],w=e.attributes[x];"xml:id"!==x&&o.setAttribute("data-"+x.replace(":","-"),w)}}}else(a=document.createElement("span")).className="encodingError",a.setAttribute("title","General error"),o.appendChild(a);return o};var p=function(t){var n={tagName:t.tagName,type:"quoteContent",attributes:[],content:[],_xmlSource:t.outerHTML};if(t.attributes)for(var i=0;i<t.attributes.length;i++){var o=t.attributes[i];o.specified&&(n.attributes[o.name]=o.value)}return angular.forEach(t.childNodes,(function(t){if(3===t.nodeType)""!==t.textContent.trim()&&n.content.push(t.textContent.trim());else if(1===t.nodeType){var i=angular.element(t)[0].innerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),o=angular.element(t)[0].outerHTML.replace(i,"");if(a.indexOf("<"+t.tagName+">")>=0)n.content.push(r.parseQuote(t));else if("<app>".indexOf("<"+t.tagName+">")>=0)n.content.push(r.handleAppEntry(t));else if(l.test(o))n.content.push(r.parseAnalogue(t));else if("note"===t.tagName)n.content.push(e.parseNote(t));else if(t.children.length>0)for(var s=0;s<t.children.length;s++)n.content.push(t.children[s].cloneNode(!0)),p(t.children[s]);else n.content.push(p(t))}})),n};r.parseQuote=function(i){var o,s,c,u={type:"quote",id:"",attributes:[],content:[],_indexes:{sourceId:[],sourceRefId:[],correspId:{},subQuotes:[]},_subQuote:!1,_xmlSource:i.outerHTML};if(c=i.getAttribute("xml:id")?i.getAttribute("xml:id"):e.xpath(i).substr(1),u.id=c,n.versions.length>0&&(u._isInMainVersion=e.isInMainVersion(i)),i.attributes)for(o=0;o<i.attributes.length;o++){var d,h=i.attributes[o];if(h.specified&&(u.attributes[h.name]=h.value),"source"===h.name&&(d=h.value.replace(/#/g,"").split(" "),u._indexes.sourceRefId=d),"ref"===h.name&&(d=h.value.replace(/#/g,"").split(" "),u._indexes.sourceRefId=d),"corresp"===h.name)for(s in d=h.value.replace(/#/g,"").split(" ")){var f=d[s].indexOf("/"),g=d[s].substring(0,f);void 0===u._indexes.correspId[g]?(u._indexes.correspId[g]=[],u._indexes.correspId[g].push(d[s].substring(f+1))):u._indexes.correspId[g].push(d[s].substring(f+1))}}var m=a.split(",");for(o=0;o<m.length&&!u._subQuote;)u._subQuote=e.isNestedInElem(i,m[o].replace(/[<>]/g,"")),o++;return angular.forEach(i.childNodes,(function(t){if(3===t.nodeType)""!==t.textContent.trim()&&u.content.push(t.textContent.trim());else if(1===t.nodeType){var n=angular.element(t)[0].innerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),s=angular.element(t)[0].outerHTML.replace(n,""),c=["bibl","biblStruct","biblFull","msDesc"],d=["ptr","ref","link"];if("listBibl"===t.tagName)for(o=0;o<t.children.length;o++)if(c.indexOf(t.children[o].tagName)>=0){var h=r.parseSource(t.children[o],i);u._indexes.sourceId.push(h.id),u.content.push(h)}else u.content.push(p(t.children[o]));else if(c.indexOf(t.tagName)>=0){var f=r.parseSource(t,i);u._indexes.sourceId.push(f.id),u.content.push(f)}else if(d.indexOf(t.tagName)>=0){if(u.content.push(p(t)),t.hasAttribute("target")){var g=t.getAttribute("target").replace(/#/g,"").split(" ");for(o=0;o<g.length;o++)u._indexes.sourceRefId.push(g[o])}}else if("linkGrp"===t.tagName){for(o=0;o<t.children.length;o++)if(d.indexOf(t.children[o].tagName)>=0&&(u.content.push(p(t.children[o])),t.children[o].hasAttribute("target"))){var m=t.children[o].getAttribute("target").replace(/#/g,"").split(" ");for(o=0;o<m.length;o++)u._indexes.sourceRefId.push(m[o])}}else if("<app>".indexOf("<"+t.tagName+">")>=0)u.content.push(r.handleAppEntry(t));else if(a.indexOf("<"+t.tagName+">")>=0){var v=r.parseQuote(t);u.content.push(v),u._indexes.subQuotes.push(v.id)}else l.test(s)?u.content.push(r.parseAnalogue(t)):"note"===t.tagName?u.content.push(e.parseNote(t)):u.content.push(p(t))}})),t.addQuote(u),u};var f=function(e,t){var n={tagName:e.tagName,type:"sourceContent",attributes:[],content:[],url:[]};if(e.attributes)for(var i=0;i<e.attributes.length;i++){var r=e.attributes[i];r.specified&&(n.attributes[r.name]=r.value)}return angular.forEach(e.childNodes,(function(e){if(3===e.nodeType)""!==e.textContent.trim()&&n.content.push(e.textContent.trim());else if(1===e.nodeType)if("citedRange"===e.tagName)null!==e.getAttribute("target")&&""!==e.getAttribute("target")&&n.url.push(e.getAttribute("target")),n.content.push(f(e));else if(e.children.length>0)for(var t=0;t<e.children.length;t++)n.content.push(f(e.children[t]));else n.content.push(f(e))})),n};r.parseSource=function(n,i){var r,o,a,s={id:"",abbr:{title:[],author:[],msId:[]},attributes:[],quotesEntriesId:[],bibl:[],quote:[],url:[],text:{},_textAvailable:!1,_xmlSource:n.outerHTML};if(n.attributes)for(r=0;r<n.attributes.length;r++){var l=n.attributes[r];if(l.specified){if("xml:id"===l.name&&(a=l.value),"target"===l.name||"source"===l.name||"ref"===l.name){var c=l.value.replace(/#/g,"").split(" ");for(o=0;o<c.length;o++)s.url.push(c[o])}s.attributes[l.name]=l.value,s.attributes.length++}}void 0===a&&(a=e.xpath(n).substr(1)),s.id=a,void 0!==t.getQuotes()._indexes.sourcesRef[s.id]?s.quotesEntriesId=t.getQuotes()._indexes.sourcesRef[s.id]:i.hasAttribute("xml:id")?s.quotesEntriesId.push(i.getAttribute("xml:id")):s.quotesEntriesId.push(e.xpath(i).substr(1));var u=angular.element(n);for(r in"msDesc"===n.tagName?angular.forEach(u.find("idno"),(function(e){s.abbr.msId.push(f(e))})):(angular.forEach(u.find("author"),(function(e){s.abbr.author.push(f(e))})),angular.forEach(u.find("title"),(function(e){s.abbr.title.push(f(e))}))),angular.forEach(n.childNodes,(function(e){if(3===e.nodeType)""!==e.textContent.trim()&&s.bibl.push(e.textContent.trim());else if(1===e.nodeType){var t,i=["ptr","ref","link"];if("cit"===n.tagName&&"quote"===e.tagName){var a=f(e);s.quote.push(a)}else if(i.indexOf(e.tagName)>=0){if("ref"===e.tagName?s.bibl.push(f(e)):s.bibl.push(e),e.hasAttribute("target"))for(t=e.getAttribute("target").replace(/#/g,"").split(" "),r=0;r<t.length;r++)s.url.push(t[r])}else if("linkGrp"===e.tagName){for(r=0;r<e.children.length;r++)if(i.indexOf(e.children[r].tagName)>=0&&("ref"===e.tagName?s.bibl.push(f(e)):s.bibl.push(e.children[r]),e.children[r].hasAttribute("target")))for(t=e.children[r].getAttribute("target").replace(/#/g,"").split(" "),o=0;o<t.length;o++)s.url.push(t[o])}else if("citedRange"===e.tagName){if(null!==e.getAttribute("target")&&""!==e.getAttribute("target"))for(t=e.getAttribute("target").replace(/#/g,"").split(" "),r=0;r<t.length;r++)s.url.push(t[r]);s.bibl.push(f(e))}else{var l=f(e,n);for(s.bibl.push(l),r=0;r<l.url.length;r++)s.url.push(l.url[r])}}})),s.url)s.url[r].indexOf(".xml")>=0&&(s._textAvailable=!0);return t.addSource(s),s};var g=function(t,n,o){var a;if(void 0!==t.content)if(0===t.content.length){var s=i.parse(t._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")).children[0];if("pb"===t.tagName){if(""!==n&&s.getAttribute("ed").indexOf(n)>=0){var l,c=document.createElement("span");l=s.getAttribute("ed")?s.getAttribute("xml:id")||s.getAttribute("ed").replace("#","")+"-"+s.getAttribute("n"):s.getAttribute("xml:id"),c.className="pb",c.setAttribute("data-wit",s.getAttribute("ed")),c.setAttribute("data-id",l),c.setAttribute("id","pb_"+l),c.textContent=s.getAttribute("n"),a=c}}else a=e.parseXMLElement(o,s,{skip:""})}else if(1===t.content.length&&"string"==typeof t.content[0]){var u=i.parse(t._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")).children[0];a=e.parseXMLElement(o,u,{skip:""})}else{(a=document.createElement("span")).className=t.tagName?t.tagName.toLowerCase():"";var d=Object.keys(t.attributes);for(var h in d){var p=d[h],f=t.attributes[p];"xml:id"!==p&&a.setAttribute("data-"+p.replace(":","-"),f)}var m=t.content;for(var v in m){var y;"string"==typeof m[v]?((y=document.createElement("span")).setAttribute("class","textNode"),y.appendChild(document.createTextNode(m[v])),a.appendChild(y)):"quote"===m[v].type?a.appendChild(r.getQuoteText(m[v])):"EVT-POPOVER"===m[v].tagName?a.appendChild(m[v]):"app"===m[v].type?""===n?a.appendChild(r.getEntryLemmaText(m[v])):a.appendChild(r.getEntryWitnessReadingText(m[v],n)):"analogue"===m[v].type?a.appendChild(r.getAnalogueText(m[v])):void 0!==(y=g(m[v],n,o))&&a.appendChild(y)}}return a};r.getQuoteText=function(e,t,n){var i;(i=document.createElement("evt-quote")).setAttribute("data-quote-id",e.id),e._subQuote?i.setAttribute("data-type","subquote"):i.setAttribute("data-type","quote"),""!==t&&void 0!==t&&i.setAttribute("data-scope-wit",t);var o=e.content,a=["link","ptr","linkGrp"];for(var s in o){var l;"string"==typeof o[s]?((l=document.createElement("span")).setAttribute("class","textNode"),l.appendChild(document.createTextNode(o[s])),i.appendChild(l)):"EVT-POPOVER"===o[s].tagName?i.appendChild(o[s]):"app"===o[s].type?""===t?i.appendChild(r.getEntryLemmaText(o[s])):i.appendChild(r.getEntryWitnessReadingText(o[s],t)):"quote"===o[s].type?i.appendChild(r.getQuoteText(o[s],t,n)):"analogue"===o[s].type?i.appendChild(r.getAnalogueText(o[s],t,n)):"quoteContent"===o[s].type&&a.indexOf(o[s].tagName)<0&&void 0!==(l=g(o[s],t,n))&&i.appendChild(l)}return i};var m=function(t){var n={tagName:t.tagName,type:"analogueContent",attributes:[],content:[],_xmlSource:t.outerHTML};if(t.attributes)for(var i=0;i<t.attributes.length;i++){var o=t.attributes[i];o.specified&&(n.attributes[o.name]=o.value)}return angular.forEach(t.childNodes,(function(t){if(3===t.nodeType)""!==t.textContent.trim()&&n.content.push(t.textContent.trim());else if(1===t.nodeType){var i=angular.element(t)[0].innerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),o=angular.element(t)[0].outerHTML.replace(i,"");if(a.indexOf("<"+t.tagName+">")>=0)n.content.push(r.parseQuote(t));else if("<app>".indexOf("<"+t.tagName+">")>=0)n.content.push(r.handleAppEntry(t));else if(e.createRegExpr(s).test(o))n.content.push(r.parseAnalogue(t));else if("note"===t.tagName)n.content.push(e.parseNote(t));else if(t.children.length>0)for(var l=0;l<t.children.length;l++)n.content.push(t.children[l].cloneNode(!0)),m(t.children[l]);else n.content.push(m(t))}})),n};r.parseAnalogue=function(t){var i,o,l={id:"",type:"",attributes:[],content:[],sources:[],_indexes:{sourceId:[],sourceRefId:[],subAnalogues:[]},_subAnalogue:!1,_xmlSource:t.outerHTML||""},c=t.getAttribute("xml:id")||e.xpath(t).substr(1);if(l.id=c,n.versions.length>0&&(l._isInMainVersion=e.isInMainVersion(t)),t.attributes)for(i=0;i<t.attributes.length;i++){var u,d=t.attributes[i];d.specified&&(l.attributes[d.name]=d.value),"source"===d.name&&(u=d.value.replace(/#/g,"").split(" "),l._indexes.sourceRefId=u),"corresp"===d.name&&(u=d.value.replace(/#/g,"").split(" "),l._indexes.sourceRefId=u),"ref"===d.name&&(u=d.value.replace(/#/g,"").split(" "),l._indexes.sourceRefId=u)}return angular.forEach(t.childNodes,(function(n){if(3===n.nodeType)""!==n.textContent.trim()&&l.content.push(n.textContent.trim());else if(1===n.nodeType){var c=angular.element(n)[0].innerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,""),u=angular.element(n)[0].outerHTML.replace(c,""),d=["bibl","biblStruct","biblFull","msDesc"],h=["ptr","ref","link"];if("listBibl"===n.tagName)for(i=0;i<n.children.length;i++)if(d.indexOf(n.children[i].tagName)>=0){var p=r.parseAnalogueSource(n.children[i],t);l._indexes.sourceId.push(p.id),l.sources.push(p)}else l.content.push(m(n.children[i]));else if(d.indexOf(n.tagName)>=0){var f=r.parseAnalogueSource(n,t);l._indexes.sourceId.push(f.id),l.sources.push(f)}else if(h.indexOf(n.tagName)>=0){if(l.content.push(m(n)),n.hasAttribute("target")){var g=n.getAttribute("target").replace(/#/g,"").split(" ");for(i=0;i<g.length;i++)l._indexes.sourceRefId.push(g[i])}}else if("linkGrp"===n.tagName){for(i=0;i<n.children.length;i++)if(h.indexOf(n.children[i].tagName)>=0&&(l.content.push(m(n.children[i])),n.children[i].hasAttribute("target"))){var v=n.children[i].getAttribute("target").replace(/#/g,"").split(" ");for(o=0;o<v.length;o++)l._indexes.sourceRefId.push(v[o])}}else"<app>".indexOf("<"+n.tagName+">")>=0?l.content.push(r.handleAppEntry(n)):a.indexOf("<"+n.tagName+">")>=0?l.content.push(r.parseQuote(n)):e.createRegExpr(s).test(u)?l.content.push(r.parseAnalogue(n)):"note"===n.tagName?l.content.push(e.parseNote(n)):l.content.push(m(n))}})),0===l._indexes.sourceId.length&&0===l._indexes.sourceRefId.length||(l.type="analogue"),l},r.parseAnalogueSource=function(t){var n,i,r,o={id:"",abbr:{title:[],author:[],msId:[]},attributes:[],bibl:[],text:[],url:[],_xmlSource:t.outerHTML||""};if(t.attributes)for(n=0;n<t.attributes.length;n++){var a=t.attributes[n];if(a.specified){if("xml:id"===a.name&&(r=a.value),"target"===a.name||"source"===a.name||"ref"===a.name){var s=a.value.replace(/#/g,"").split(" ");for(i=0;i<s.length;i++)o.url.push(s[i])}o.attributes[a.name]=a.value,o.attributes.length++}}void 0===r&&(r=e.xpath(t).substr(1)),o.id=r;var l=angular.element(t);return"msDesc"===t.tagName?angular.forEach(l.find("idno"),(function(e){o.abbr.msId.push(v(e))})):(angular.forEach(l.find("author"),(function(e){o.abbr.author.push(v(e))})),angular.forEach(l.find("title"),(function(e){o.abbr.title.push(v(e))}))),angular.forEach(t.childNodes,(function(e){if(3===e.nodeType)""!==e.textContent.trim()&&o.bibl.push(e.textContent.trim());else if(1===e.nodeType){var r,a=["ptr","ref","link"];if("cit"===t.tagName&&"quote"===e.tagName){var s=v(e);o.text.push(s)}else if(a.indexOf(e.tagName)>=0){if("ref"===e.tagName?o.bibl.push(v(e)):o.bibl.push(e),e.hasAttribute("target"))for(r=e.getAttribute("target").replace(/#/g,"").split(" "),n=0;n<r.length;n++)o.url.push(r[n])}else if("linkGrp"===e.tagName){for(n=0;n<e.children.length;n++)if(a.indexOf(e.children[n].tagName)>=0&&("ref"===e.tagName?o.bibl.push(v(e)):o.bibl.push(e.children[n]),e.children[n].hasAttribute("target")))for(r=e.children[n].getAttribute("target").replace(/#/g,"").split(" "),i=0;i<r.length;i++)o.url.push(r[i])}else if("citedRange"===e.tagName){if(null!==e.getAttribute("target")&&""!==e.getAttribute("target"))for(r=e.getAttribute("target").replace(/#/g,"").split(" "),n=0;n<r.length;n++)o.url.push(r[n]);o.bibl.push(f(e))}else{var l=v(e,t);for(o.bibl.push(l),n=0;n<l.url.length;n++)o.url.push(l.url[n])}}})),o};var v=function(e){var t={tagName:e.tagName,type:"sourceContent",attributes:[],content:[],url:[]};if(e.attributes)for(var n=0;n<e.attributes.length;n++){var i=e.attributes[n];i.specified&&(t.attributes[i.name]=i.value)}return angular.forEach(e.childNodes,(function(e){if(3===e.nodeType)""!==e.textContent.trim()&&t.content.push(e.textContent.trim());else if(1===e.nodeType)if("citedRange"===e.tagName)null!==e.getAttribute("target")&&""!==e.getAttribute("target")&&t.url.push(e.getAttribute("target")),t.content.push(f(e));else if(e.children.length>0)for(var n=0;n<e.children.length;n++)t.content.push(v(e.children[n]));else t.content.push(v(e))})),t},y=function(t,n,o){var a;if(void 0!==t.content)if(0===t.content.length){var s=i.parse(t._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")).children[0];if("pb"===t.tagName){if(""!==n&&s.getAttribute("ed").indexOf(n)>=0){var l,c=document.createElement("span");l=s.getAttribute("ed")?s.getAttribute("xml:id")||s.getAttribute("ed").replace("#","")+"-"+s.getAttribute("n"):s.getAttribute("xml:id"),c.className="pb",c.setAttribute("data-wit",s.getAttribute("ed")),c.setAttribute("data-id",l),c.setAttribute("id","pb_"+l),c.textContent=s.getAttribute("n"),a=c}}else a=e.parseXMLElement(o,s,{skip:""})}else if(1===t.content.length&&"string"==typeof t.content[0]){var u=i.parse(t._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")).children[0];a=e.parseXMLElement(o,u,{skip:""})}else{(a=document.createElement("span")).className=t.tagName?t.tagName.toLowerCase():"";var d=Object.keys(t.attributes);for(var h in d){var p=d[h],f=t.attributes[p];"xml:id"!==p&&a.setAttribute("data-"+p.replace(":","-"),f)}var g=t.content;for(var m in g)if("string"==typeof g[m])a.appendChild(document.createTextNode(g[m]));else if("quote"===g[m].type)a.appendChild(r.getQuoteText(g[m]));else if("EVT-POPOVER"===g[m].tagName)a.appendChild(g[m]);else if("app"===g[m].type)""===n?a.appendChild(r.getEntryLemmaText(g[m])):a.appendChild(r.getEntryWitnessReadingText(g[m],n));else if("analogue"===g[m].type)a.appendChild(r.getAnalogueText(g[m]));else{var v=y(g[m],n,o);void 0!==v&&a.appendChild(v)}}return a};return r.getAnalogueText=function(e,t,n){var i;(i=document.createElement("evt-analogue")).setAttribute("data-analogue-id",e.id),i.setAttribute("data-type","analogue"),""!==t&&void 0!==t&&i.setAttribute("data-scope-wit",t);var o=e.content,a=["link","ptr","linkGrp"];for(var s in o){var l;"string"==typeof o[s]?((l=document.createElement("span")).setAttribute("class","textNode"),l.appendChild(document.createTextNode(o[s])),i.appendChild(l)):"EVT-POPOVER"===o[s].tagName?i.appendChild(o[s]):"app"===o[s].type?""===t?i.appendChild(r.getEntryLemmaText(o[s])):i.appendChild(r.getEntryWitnessReadingText(o[s],t)):"quote"===o[s].type?i.appendChild(r.getQuoteText(o[s],t,n)):"analogue"===o[s].type?i.appendChild(r.getAnalogueText(o[s])):"analogueContent"===o[s].type&&a.indexOf(o[s].tagName)<0?void 0!==(l=y(o[s],t,n))&&i.appendChild(l):void 0!==o[s].content&&0!==o[s].content.length&&void 0!==(l=y(o[s],t,n))&&i.appendChild(l)}return i},r}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtVersionApparatus",["config","evtCriticalApparatus","evtParser",function(e,t,n){var i={getContent:function(t,n,r){var o={attributes:{values:t.attributes||{},_keys:Object.keys(t.attributes)||[]},versions:[],note:"",_readings:!1,_xmlSource:t._xmlSource.replace('xmlns="http://www.tei-c.org/ns/1.0"',"")};for(var a in t.content){var s=i.getVersionContent(t.content[a],n,r),l=e.versions.indexOf(s.value);o.versions.splice(l,0,s)}return void 0!==t.note&&""!==t.note&&(o.note+=t.note),(s.significantReadings.length>0||s.notSignificantReadings.length>0)&&(o._readings=!0),o},getVersionContent:function(e,i,r){var o={id:e.versionId,value:e.id,lem:"",significantReadings:[],notSignificantReadings:[],attributes:{values:e.attributes||{},_keys:Object.keys(e.attributes)||[]}},a=e.content[e.lemma];if(void 0!==a){var s=t.getLemma(a,i);if(t.getText(a).replace(/<span class="textNode">|<\/span>/g,"").length<=70)o.lem+='<span class="versionApp_lemma_content">'+s+"</span>";else{var l=s.substring(0,s.indexOf('<span class="witnesses')),c=s.substring(s.indexOf('<span class="witnesses'),s.length);o.lem=n.createAbbreviation(l,70)+c}}for(var u in e.content)if(u!==e.lemma){var d=t.getSignificantReading(e.content[u]);e.content[u]._significant?o.significantReadings.push(d):o.notSignificantReadings.push(d)}return o}};return i}])},function(e,t,n){(function(e){angular.module("evtviewer.dataHandler").service("evtBibliographyParser",["parsedData","evtParser","config",function(t,n,i){const r=i.allowedBibliographicStyles.Chicago.label,o=i.allowedBibliographicStyles.APA.label,a=i.allowedBibliographicStyles.MLA.label;i.defaultBibliographicStyle;var s=!1,l=!1,c=!1,u=!1,d=!1,h={biblStruct:"<biblStruct>",bibl:"<bibl>"},p={parseBiblInfo:function(e){var n=angular.element(e);for(var i in h)f(i,n);console.log("## parseBiblInfo ##",t.getBibliographicRefsCollection())}},f=function(e,n){var i=n.find("<listBibl>".replace(/[<>]/g,"")).find(">"+h[e].replace(/[<>]/g,""));angular.forEach(i,(function(e){var n=p.extractInfo(e);P(n);t.addBibliographicRef(n)}))};p.extractInfo=function(t){for(var i={id:"",type:"",author:[],titleAnalytic:"",titleMonogr:"",editionMonogr:"",date:"",editor:[],publisher:"",pubPlace:"",biblScope:{},note:{},idno:{},outputs:{},plainText:""},r=angular.element(t),o=!1,a=r[0].childNodes,s=0;s<a.length;s++)3===a[s].nodeType&&""!==a[s].textContent.trim()&&(o=!0);if(i.id=r.attr("xml:id")?r.attr("xml:id"):n.xpath(t),o)(a=(a=r.find("*")).sort((function(t,n){return e(n).parents().length-e(t).parents().length}))).replaceWith((function(){return'<span class="unstructuredBibl '+this.tagName+'">'+e(this).html()+"</span>"})),i.plainText=e(r).html();else{x(r,i);var l=r.find("<analytic>".replace(/[<>]/g,""));if(v(angular.element(l),i),g(r.find("author"),i.author),g(r.find("<editor>".replace(/[<>]/g,"")),i.editor),r[0].tagName===h.bibl.replace(/[<>]/g,"")){b(r[0],i),_(r.find("<biblScope>".replace(/[<>]/g,"")),i.biblScope),_(r.find("<citedRange>".replace(/[<>]/g,"")),i.biblScope);var c=r.children();c=e(c).filter((function(e,t){return t.tagName===h.bibl.replace(/[<>]/g,"")})),angular.forEach(c,(function(e){b(e,i)}))}else _(r.find("<citedRange>".replace(/[<>]/g,"")),i.biblScope),y(r,i);var u=r.find("<monogr>".replace(/[<>]/g,""));if(u){u=angular.element(u),v(u,i);u.find("<editor>".replace(/[<>]/g,""));var p=u.find("edition");i.editionMonogr=p&&p.length>0?p[0].textContent:i.editionMonogr;var f=p.find("date");""===i.date&&(i.date=f&&f.length>0?f[0].textContent:""),_(u.find("<biblScope>".replace(/[<>]/g,"")),i.biblScope),x(u,i);var m=angular.element(u.find("<imprint>".replace(/[<>]/g,"")));if(m&&m.length>0){var w=angular.element(m[0]);_(w.find("<biblScope>".replace(/[<>]/g,"")),i.biblScope);var S=m.find("date");i.date=S&&S.length>0?S[0].textContent:"";var C=m.find("publisher");""===i.publisher&&(i.publisher=C&&C.length>0?C[0].textContent:"");var k=m.find("pubPlace");""===i.pubPlace&&(i.pubPlace=k&&k.length>0?k[0].textContent:""),x(m,i)}}var L=angular.element(r.find("<series>".replace(/[<>]/g,"")));if(L&&L.length>0){var P=L.find("date");""===i.date&&(i.date=P&&P.length>0?P[0].textContent:"");var O=L.find("publisher");""===i.publisher&&(i.publisher=O&&O.length>0?O[0].textContent:"");var D=L.find("pubPlace");""===i.pubPlace&&(i.pubPlace=D&&D.length>0?D[0].textContent:""),x(L,i),_(L.find("<biblScope>".replace(/[<>]/g,"")),i.biblScope)}angular.forEach(r.find("<idno>".replace(/[<>]/g,"")),(function(e){var t=e.getAttribute("type");null!==t&&(i.idno[t]=e.textContent||"")})),E(i)||(i.plainText=r[0].textContent),A(i)&&I(i)&&(d=!0)}return T(i,!0,!0),i};var g=function(e,t){angular.forEach(e,(function(e){var n={name:"",surname:"",forename:""};if(m(e,e,n),""!==n.name&&""===n.surname){var i=C(n.name);n.surname=""!==i.surname?i.surname:n.surname,n.name=""!==i.name?i.name:n.name}t.push(n)}))},m=function(e,t,n){if(3===e.nodeType){var i=e.textContent.substr(0,1).toUpperCase()+e.textContent.substr(1);if(t)switch(t.tagName){case"author":case"editor":case"name":n.name+=i+" ";break;case"surname":n.surname+=i+" ";break;case"forename":n.forename+=i+" "}}angular.forEach(e.childNodes,(function(e){switch(e.tagName){case"author":case"editor":case"name":case"surname":case"forename":m(e,e,n);break;default:m(e,t,n)}}))},v=function(e,t){var n=e.find("title");if(n&&n.length>0){var i=n[0].getAttribute("level")||"";i=null!==i?i.substr(0,1):"",e[0].tagName==="<monogr>".replace(/[<>]/g,"")?(i=""===i?"m":i,t.titleMonogr=n[0].textContent,t.type+=i):e[0].tagName==="<analytic>".replace(/[<>]/g,"")&&(i=""===i?"a":i,t.titleAnalytic=n[0].textContent,t.type+=i)}},y=function(e,t){angular.forEach(e.children(),(function(e){"date"===e.tagName?t.date=e.innerText:"pubPlace"===e.tagName?t.pubPlace=""===t.pubPlace?e.innerText:t.pubPlace:"publisher"===e.tagName&&(t.publisher=""===t.publisher?e.innerText:t.publisher)}))},b=function(e,t){for(var n,i=e.children,r=0;r<i.length;r++)if("title"===i[r].tagName&&(null!=(n=i[r].getAttribute("level"))&&(n=n.substring(0,1)),"m"!==n&&"j"!==n&&"u"!==n&&null!=n||(t.titleMonogr=i[r].textContent,t.type+=n),"a"===n&&null!=n&&(t.titleAnalytic=i[r].textContent,t.type+=n)),null==n||"m"===n)if("date"===i[r].tagName)t.date=i[r].textContent;else if("pubPlace"===i[r].tagName)t.pubPlace=""===t.pubPlace?i[r].textContent:t.pubPlace;else if("publisher"===i[r].tagName)t.publisher=""===t.publisher?i[r].textContent:t.publisher;else if("edition"===i[r].tagName){t.editionMonogr=""===t.editionMonogr?i[r].textContent:t.editionMonogr;var o=angular.element(i[r]).find("date");o&&o.length>0&&(t.date=""===t.date?o[0].textContent:t.date)}},_=function(e,t){angular.forEach(e,(function(e){angular.forEach(["type","unit"],(function(n){var i=e.getAttribute(n),r=e.getAttribute("from"),o=e.getAttribute("to");null!==i&&!i in t&&(null!==o&&null!==r&&""!==o&&""!==r?t[i]=r+"-"+o:""!==e.textContent&&(t[i]=e.textContent))}))}))},x=function(e,t){angular.forEach(e.find("note"),(function(e){var n=e.getAttribute("type");if(null===n){var i=1;for(n="note-"+i;n in t.note;)n="note"+ ++i}t.note[n]=e.textContent}))},w=function(e){return e&&"object"===(typeof e).toLowerCase()},S=function(e){return w(e)&&e instanceof Array},T=function(e,t,n){if("string"==typeof e)return t&&(e=e.replace(/\.$/,"")),n&&(e=(e=e.trim()).replace(/\s+/g," ")),e;if(S(e))for(var i=0,r=e.length;i<r;i++)T(e[i],!0,!0);else if(w(e))for(var o in e){var a;void 0!==(a=T(e[o],"author"!==o,!0))&&(e[o]=a)}},E=function(e){var t=!1;if("string"===(typeof e).toLowerCase())""!==e&&(t=!0);else if(S(e))e.length>0&&(t=!0);else if(w(e))for(var n in e)"id"!==n&&(t=t||E(e[n])),"author"===n&&e[n].length>0&&(l=!0),"date"===n&&""!==e[n]&&(s=!0),"titleAnalytic"!==n&&"titleMonogr"!==n||""===e[n]||(c=!0),"publisher"===n&&""!==e[n]&&(u=!0);return t};p.formatResult=function(e,t){if(!t.outputs[e]){var n,i,s,l="";if(null==e||""===e)""!==t.plainText&&(l+='<span data-style="unstructuredBibl">'+t.plainText+"<span>");else if(e===r){if(""!==t.plainText&&(l+='<span data-style="chicago">'+t.plainText+"<span>"),t.author&&t.author.length>0){if(l+='<span data-style="chicago" class="authors">',i=""!==(n=t.author[0]).name?n.name:n.forename,s=n.surname,""!==i&&""===s){var c=C(i);s=""!==c.surname?c.surname:s,i=""!==c.name?c.name:i}l+='<span data-style="chicago" class="author">',""!==s&&(l+='<span data-style="chicago" class="surname">'+s+"</span>"),""!==i&&""!==s?l+='<span data-style="chicago" class="name">'+L(i)+"</span>":""!==i&&(l+='<span data-style="chicago" class="name">'+i+"</span>"),l+="</span>",angular.forEach(t.author,(function(e,t){if(t>0){var n=""!==e.name?e.name:e.forename,i=e.surname;if(""!==n&&""===i){var r=C(n);i=""!==r.surname?r.surname:i,n=""!==r.name?r.name:n}l+='<span data-style="chicago" class="author">',""!==n&&""!==i?l+='<span data-style="chicago" class="name">'+L(n)+"</span>":""!==n&&(l+='<span data-style="chicago" class="name">'+n+"</span>"),""!==i&&(l+='<span data-style="chicago" class="surname">'+i+"</span>"),l+="</span>"}}))}l+="</span>",V(t)?(N(t)&&(l+='<span data-style="chicago" class="date">'+N(t)+"</span>"),O(t)&&(l+='<span data-style="chicago" data-attr="titolo" class="titleAnalytic">'+O(t)+"</span>"),I(t)&&(l+='<span data-style="chicago" data-attr="titolo" class="titleMonogr">'+I(t)+"</span>"),D(t)&&(l+='<span data-style="chicago" data-attr="titolo" class="edition">'+D(t)+"</span>"),$(t)&&(l+='<span data-style="chicago" class="pubPlace">'+$(t)+"</span>"),j(t)&&(l+='<span data-style="chicago" class="publisher">'+j(t)+"</span>"),R(t)&&(l+='<span data-style="chicago" class="url">'+R(t)+"</span>")):(N(t)&&(l+='<span data-style="chicago" class="date">'+N(t)+"</span>"),O(t)&&(l+='<span data-style="chicago" class="titleAnalytic">'+O(t)+"</span>"),I(t)&&(l+='<span data-style="chicago" class="titleMonogr">'+I(t)+"</span>"),U(t)&&(l+='<span data-style="chicago" class="editors">',angular.forEach(U(t),(function(e,t){l+='<span data-style="chicago" class="editor">';var n=""!==e.name?e.name:e.forename,i=e.surname;if(""!==n&&""===i){var r=C(n);i=""!==r.surname?r.surname:i,n=""!==r.name?r.name:n}""!==i&&(l+='<span data-style="chicago" class="editor surname">'+i+"</span>"),""!==n&&(l+='<span data-style="chicago" class="editor name">'+n+"</span>"),l+="</span>"})),l+="</span>"),$(t)&&(l+='<span data-style="chicago" class="pubPlace">'+$(t)+"</span>"),j(t)&&(l+='<span data-style="chicago" class="publisher">'+j(t)+"</span>"),M(t)&&(l+='<span data-style="chicago" class="pp">'+M(t)+"</span>"))}else if(e===o)if(""!==t.plainText&&(l+='<span data-style="apa">'+t.plainText+"<span>"),V(t))t.author&&t.author.length>0&&(l+='<span data-style="apa" class="authors">',i=""!==(n=t.author[0]).name?n.name:n.forename,s=n.surname,l+='<span data-style="apa" class="author">',""!==s&&(l+='<span data-style="apa" class="surname">'+s+"</span>"),""!==i&&""!==s&&(l+='<span data-style="apa" class="name">'+k(i)+"</span>"),""!==i&&""===s&&(l+='<span data-style="apa" class="name">'+i+"</span>"),l+="</span>",angular.forEach(t.author,(function(e,t){if(t>0){var i=""!==e.name?e.name:n.forename,r=""!==e.surname?e.surname:"";l+='<span data-style="apa" class="author">',""!==r&&(l+='<span data-style="apa" class="surname">'+r+"</span>"),""!==i&&""!==r&&(l+='<span data-style="apa" class="name">'+k(i)+"</span>"),""!==i&&""===r&&(l+='<span data-style="apa" class="name">'+i+"</span>"),l+="</span>"}})),l+="</span>"),N(t)&&(l+='<span data-style="apa" class="date">'+N(t)+"</span>"),I(t)&&(l+='<span data-style="apa" data-attr="titolo" class="titleMonogr">'+I(t)+"</span>"),M(t)&&(l+='<span data-style="apa" class="pp">'+M(t)+"</span>"),$(t)&&(l+='<span data-style="apa" class="pubPlace">'+$(t)+"</span>"),j(t)&&(l+='<span data-style="apa" class="publisher">'+j(t)+"</span>");else{if(t.author&&t.author.length>0&&(l+='<span data-style="apa" class="authors">',i=""!==(n=t.author[0]).name?n.name:n.forename,s=n.surname,l+='<span data-style="apa" class="author">',""!==s&&(l+='<span data-style="apa" class="surname">'+s+"</span>"),""!==i&&""!==s&&(l+='<span data-style="apa" class="name">'+k(i)+"</span>"),""!==i&&""===s&&(l+='<span data-style="apa" class="name">'+i+"</span>"),l+="</span>",angular.forEach(t.author,(function(e,t){if(t>0){var i=""!==e.name?e.name:n.forename,r=""!==e.surname?e.surname:"";if(""!==i&&""===r){var o=C(i);r=""!==o.surname?o.surname:r,i=""!==o.name?o.name:i}l+='<span data-style="apa" class="author">',""!==r&&(l+='<span data-style="apa" class="surname">'+r+"</span>"),""!==i&&""!==r&&(l+='<span data-style="apa" class="name">'+k(i)+"</span>"),""!==i&&""===r&&(l+='<span data-style="apa" class="name">'+i+"</span>"),l+="</span>"}})),l+="</span>"),N(t)&&(l+='<span data-style="apa" class="date">'+N(t)+"</span>"),O(t)&&(l+='<span data-style="apa" data-attr="titolo" class="titleAnalytic">'+O(t)+"</span>"),I(t)&&(l+='<span data-style="apa" data-attr="titolo" class="titleMonogr">'+I(t)+"</span>"),B(t)){var u=B(t);if(H(t)){var d=H(t);l+='<span data-style="apa" class="vol">'+u+"("+d+")</span>"}else l+='<span data-style="apa" class="vol">'+u+"</span>"}M(t)&&(l+='<span data-style="apa" class="pp">'+M(t)+"</span>"),$(t)&&(l+='<span data-style="apa" class="pubPlace">'+$(t)+"</span>"),j(t)&&(l+='<span data-style="apa" class="publisher">'+j(t)+"</span>")}else e===a&&(""!==t.plainText&&(l+='<span data-style="mla">'+t.plainText+"<span>"),V(t),t.author&&t.author.length>0&&(l+='<span data-style="mla" class="authors">',i=""!==(n=t.author[0]).name?n.name:n.forename,s=n.surname,l+='<span data-style="mla" class="author">',""!==s&&(l+='<span data-style="mla" class="surname">'+s+"</span>"),""!==i&&""!==s?l+='<span data-style="mla" class="name">'+L(i)+"</span>":""!==i&&(l+='<span data-style="mla" class="name">'+i+"</span>"),l+="</span>",angular.forEach(t.author,(function(e,t){if(t>0){var n=""!==e.name?e.name:e.forename,i=e.surname;l+='<span data-style="mla" class="author">',""!==n&&""!==i?l+='<span data-style="mla" class="name">'+L(n)+"</span>":""!==n&&(l+='<span data-style="mla" class="name">'+n+"</span>"),""!==i&&(l+='<span data-style="mla" class="surname">'+i+"</span>"),l+="</span>"}})),l+="</span>"),O(t)&&(l+='<span data-style="mla" data-attr="titolo" class="titleAnalytic">'+O(t)+"</span>"),I(t)&&(l+='<span data-style="mla" data-attr="titolo" class="titleMonogr">'+I(t)+"</span>"),$(t)&&(l+='<span data-style="mla" class="pubPlace">'+$(t)+"</span>"),j(t)&&(l+='<span data-style="mla" class="publisher">'+j(t)+"</span>"),N(t)&&(l+='<span data-style="mla" class="date">'+N(t)+"</span>"),M(t)&&(l+='<span data-style="mla" class="pp">'+M(t)+"</span>"),R(t)&&(l+='<span data-style="mla" class="generic">Web</span>'));if(""!==l&&F(t)){var h="";angular.forEach(F(t),(function(e){h+="<p>"+e+"</p>"})),l+='<evt-popover data-trigger="click"  data-tooltip="'+h+'"><i class="icon-evt_note"></i></evt-popover>'}t.outputs[e]=l}};var C=function(e){for(var t={surname:"",name:""},n=0,i=0,r=0;r<e.length;r++)","===e[r]&&(n++,i=r);return 1===n&&i>0&&(t.surname=e.substr(0,i),t.name=e.substr(i+1,e.length-1)),t},k=function(e){for(var t="",n=0;n<e.length;n++)0!==n&&" "!==e[n-1]&&"."!==e[n-1]||" "===e[n]||e[n]!==e[n].toUpperCase()||(t+="",t+=e[n],t+=".");var i=t.length;return"."===t[i-1]&&(t=t.substr(0,i-1)),t},L=function(e){for(var t=-1,n=0,i=0;i<e.length;i++)if(-1===t&&" "!==e[i]&&e[i]===e[i].toUpperCase()&&(t=i,n=i),-1!==t){if(" "===e[i]||"."===e[i])break;n++}var r=e.substr(t,n),o=k(e.substr(n+1));return""!==o&&(r+=" "),r+o};p.yearInfoDetected=function(){return s},p.authorInfoDetected=function(){return l},p.titleInfoDetected=function(){return c},p.publisherInfoDetected=function(){return u},p.bibliographicStyleInfoDetected=function(){return d},p.getType=function(e){return z(e)};var P=function(e){if(""!==e.id)return e.id},A=function(e){if(e.author&&e.author.length>0)return e.author},O=function(e){if(""!==e.titleAnalytic)return e.titleAnalytic},I=function(e){if(""!==e.titleMonogr)return e.titleMonogr},D=function(e){if(""!==e.editionMonogr)return e.editionMonogr},$=function(e){if(""!==e.pubPlace)return e.pubPlace},N=function(e){if(""!==e.date)return e.date},M=function(e){var t;return void 0!==e.note&&(void 0!==e.note.pp?t=e.note.pp:void 0!==e.note.pages&&(t=e.note.pages)),void 0!==e.biblScope.pages?t=e.biblScope.pages:void 0!==e.biblScope.pp?t=e.biblScope.pp:void 0!==e.biblScope.page&&(t=e.biblScope.page),t},R=function(e){if(void 0!==e.note.url)return'<a href="'+e.note.url+'" target="_blank">'+e.note.url+"</a>"},B=function(e){return void 0!==e.biblScope.vol?e.biblScope.vol:void 0!==e.biblScope.volume?e.biblScope.volume:void 0!==e.biblScope.volumes?e.biblScope.volumes:void 0},H=function(e){if(void 0!==e.biblScope.issue)return e.biblScope.issue},z=function(e){if(""!==e.type)return"am"===e.type||"ma"===e.type||("aj"===e.type||"ja"===e.type?e.type="j":e.type.includes("a")?e.type="a":e.type=e.type.substr(0,1)),e.type},F=function(e){if(e.note&&Object.keys(e.note).length>0)return e.note},V=function(e){return z(e)&&"m"===z(e).toLowerCase().substr(0,1)},j=function(e){if(""!==e.publisher)return e.publisher},U=function(e){if(e.editor&&e.editor.length>0)return e.editor};return p}])}).call(this,n(0))},function(e,t){angular.module("evtviewer.dataHandler").service("evtHotSpotParser",["$q","xmlParser","evtParser","parsedData","config",function(e,t,n,i,r){var o={};return o.parseHotSpots=function(e){var t=angular.element(e);angular.forEach(t.find("div[type='hotspot']"),(function(e){angular.forEach(e.childNodes,(function(e){if("div"===e.tagName){var t={};if(e.attributes)for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n];if(r.specified)t["xml:id"===r.name?"id":r.name.replace(":","-")]=r.value}t.content=angular.element(e).text(),t.images=angular.element(e).find("graphic"),i.addHotSpot(t)}}))})),console.log("## HOTSPOTS ##",i.getHotSpots())},o}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtGlyph",["parsedData",function e(t){e.prototype.getGlyph=function(e,n){var i=function(e){var n,i=t.getGlyphs(),r=e.getAttribute("ref");try{r=r.replace("#",""),(n=i[r].mapping).id=r}catch(e){return console.log(e),!0}return n}(e);return(i.runic?{diplomatic:function(){return void 0!==i.runic?i.runic.content:""},interpretative:function(){return void 0!==i.transliterated?i.transliterated.content:""}}:{diplomatic:function(){return void 0!==i.diplomatic?i.diplomatic.content:""},interpretative:function(){return void 0!==i.normalized?i.normalized.content:""}})[n]()}}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtDepaParser",["parsedData","evtCriticalElementsParser","Utils","evtParser","config","xmlParser",function(e,t,n,i,r,o){var a={},s="<evt-reading>,<pb>,<app>,<lem>, <rdg>,<rdgGrp>,"+r.quoteDef+","+r.analogueDef+",<evt-quote>,<evt-analogue>,<evt-version-reading>";return a.setAppInText=function(i,r,o){if(e.getCriticalEntries()._indexes.depa){var s=e.getCriticalEntries()._indexes.depa.start,l=i.getAttribute("xml:id"),c=Object.keys(s).filter((function(e){return s[e]===l}))||[];angular.forEach(c,(function(s){var l=e.getCriticalEntryById(s);if(l){var c=e.getCriticalEntries()._indexes.depa.end[s],u=o.querySelector('[*|id="'+c+'"]');if(u){var d=r?t.getEntryWitnessReadingText(l,r):t.getEntryLemmaText(l,r),h=e.getEncodingDetail("variantEncodingMethod");if(d.setAttribute("data-method",h||"double-end-point"),!d.firstChild||!d.firstChild.className||d.firstChild.className.indexOf("empty")<0){if(i===u)a.removeChildNodes(i);else{if(i.childNodes&&i.childNodes.length>0||a.isDescendant(i,u)){var p=document.createTextNode("");i.parentNode.insertBefore(p,i),i=p}var f=n.DOMutils.getElementsBetweenTree(i,u);angular.forEach(f,(function(e){e.parentNode.removeChild(e)}))}i.parentNode.insertBefore(d,i)}else{var g=a.createAnchorElement(l,r);i.parentNode.insertBefore(g,i),d.setAttribute("data-no-text",!0),u.parentNode.insertBefore(d,u.nextSibling)}}}}))}},a.setInternalAppInText=function(e,i,r,o){var s=r?t.getEntryWitnessReadingText(i,r):t.getEntryLemmaText(i,r),l=i.attributes.from.replace("#",""),c=i.attributes.to?i.attributes.to.replace("#",""):null,u=l&&o.querySelector('[*|id="'+l+'"]')||null,d=c?o.querySelector('[*|id="'+c+'"]')||null:e;if(u&&d){if(u.childNodes&&u.childNodes.length>0||a.isDescendant(u,d)){var h=document.createTextNode("");u.parentNode.insertBefore(h,u),u=h}var p=n.DOMutils.getElementsBetweenTree(u,d);if(!s.firstChild||!s.firstChild.className||s.firstChild.className.indexOf("empty")<0)angular.forEach(p,(function(e){var t=document.createTextNode("");e.parentNode.replaceChild(t,e)})),u.parentNode.insertBefore(s,u.nextSibling);else{s.setAttribute("data-overlap",!0);var f=a.createAnchorElement(i,r);u.parentNode.insertBefore(f,u.nextSibling),angular.forEach(p,(function(e){var t=a.createDepaContentNode(e,o);t&&e.parentNode.replaceChild(t,e)})),s.setAttribute("data-no-text",!0),d.parentNode.insertBefore(s,d.nextSibling)}return s}},a.getLemma=function(t,n){n=n.documentElement||n;var r="",o=e.getCriticalEntries()._indexes.depa.start,s=e.getCriticalEntries()._indexes.depa.end,l=o[t.id],c=s[t.id];if(l){if(l===c){var u=n.querySelector("[*|id="+l+"]");u&&(r=u.outerHTML)}else{var d=n.outerHTML.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"");r=a.findReadingString(d,c,l,t),r=i.balanceXHTML(r)}r=r.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"").trim(),a.parseLemma(t,r,n)}},a.findReadingString=function(t,n,i,r){var o,a=t.indexOf('xml:id="'+i),s=t.substring(0,a).lastIndexOf("<"),l=0,c=e.getEncodingDetail("variantEncodingLocation");if("internal"===c){var u=r._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"");l=t.indexOf(u,s)}else l=t.indexOf('xml:id="'+n+'"');return o=(o=t.substring(s,l)).substring(o.indexOf(">")+1),"external"===c&&(o=o.substring(0,o.lastIndexOf("<"))),o},a.parseLemma=function(e,t,n){var r;content=t,"string"!=typeof t&&(r=o.parse(t),content=i.parseXMLElement(n,r,{skip:s}),content=content.textContent?content.textContent:r.textContent);var a={id:e.id+"-depa-lem",attributes:[],content:[content],note:"",_significant:!0,_group:void 0,_xmlTagName:"",_xmlSource:t};e.content[a.id]=a,e.lemma=a.id},a.removeChildNodes=function(e){if(e.childNodes&&!(e.childNodes.length<=0))for(var t=e.childNodes.length-1;t>=0;)e.removeChild(e.childNodes[t]),t--},a.isDescendant=function(e,t){if(t){for(var n=t.parentNode;n;)return n===e||a.isDescendant(e,n.parentNode);return!1}},a.createAnchorElement=function(e,t){var n=document.createElement("span");return n.setAttribute("data-app-id",e.id),n.setAttribute("class","depaAnchor"),n.setAttribute("id","depaAnchor-"+e.id+"-"+t),n},a.createDepaContentNode=function(e,t){var n;return 3===e.nodeType?((n=document.createElement("span")).setAttribute("class","depaContent"),n.textContent=e.textContent):(!e.className||e.className.indexOf("depaContent")<0)&&((n=i.parseXMLElement(t,e,{skip:s})).className+=" depaContent"),n},a}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtBuilder",["EvtParagraphLineParser","EvtLbParser","evtSearchDocument","evtAbstractSearchParserInterface",function e(t,n,i,r){function o(e,t){if(arguments.length<2)throw new Error("Function Interface.ensureImplements called with "+arguments.length+" arguments, but expected at least 2.");for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i.constructor!==t.constructor)throw new Error("Function Interface.ensureImplements expects arguments two and above to be instances of Interface.");i.methods.forEach((function(t){if(!e.prototype[t]||"function"!=typeof e.prototype[t])throw new Error("Function Interface.ensureImplements: object does not implement the "+i.name+" interface. Method "+t+" was not found.")}))}}e.prototype.createParser=function(e){var a=i.hasLbElement(e);return a?(o(n,r),new n(e)):a?void 0:(o(t,r),new t(e))}}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtSearch",["evtSearchDocument","evtBuilder","evtSearchIndex",function e(t,n,i){var r=0,o={};e.prototype.initSearch=function(e){var a,s={},l=t.getXmlDocBody(e);t.removeNoteElements(e),t.removeAddElements(e);for(var c=0;c<l.length;c++)a=(s=n.createParser(l[c])).parseElements(r),r=s.getPrevDocsLines(),o=angular.extend(o,a);i.createIndex(o)},e.prototype.getParsedElementsForIndexing=function(){return o},e.prototype.getPrevDocsLines=function(){return r}}])},function(e,t){angular.module("evtviewer.dataHandler").factory("EvtSearchInterface",(function(){return function(e,t){if(2!==arguments.length)throw new Error("Interface constructor called with "+arguments.length+" arguments, but expected exactly 2.");this.name=e,this.methods=t.map((function(e){if("string"!=typeof e)throw new Error("Interface constructor expects method names to be passed in as a string.");return e}))}}))},function(e,t){angular.module("evtviewer.dataHandler").service("evtSearchDocument",["parsedData","evtGlyph","XPATH","Utils","config",function e(t,n,i,r,o){var a=this;a.ns=!1,a.nsResolver="",e.prototype.hasNamespace=function(e){return null!==e.documentElement.namespaceURI&&(a.ns=!0,a.nsResolver=function(t){if("ns"===t)return e.documentElement.namespaceURI}),a.ns},e.prototype.isAlsoInterpEdition=function(){var e,t;return o.availableEditionLevel.forEach((function(n){"diplomatic"===n.value&&(e=n.visible),"interpretative"===n.value&&(t=n.visible)})),e&&t},e.prototype.isInterpEdition=function(){var e;return o.availableEditionLevel.forEach((function(t){"interpretative"===t.value&&(e=t.visible)})),e},e.prototype.isDiplEdition=function(){var e;return o.availableEditionLevel.forEach((function(t){"diplomatic"===t.value&&(e=t.visible)})),e},e.prototype.hasLbElement=function(e){return 0!==e.getElementsByTagName("lb").length},e.prototype.getXmlDocBody=function(e){return e.getElementsByTagName("body")},e.prototype.getCurrentXmlDoc=function(e,n,r,o){var a=function(){var e=t.getDocuments(),n=e._indexes,i=[],r={};return n.forEach((function(t){r.id=t,r.title=e[r.id].title,r.textNode=e[r.id].content,i.push(r),r={}})),i}(),s=r?e.evaluate(i.ns.getCurrentTextNode,n,o,XPathResult.ANY_TYPE,null):e.evaluate(i.getCurrentTextNode,n,null,XPathResult.ANY_TYPE,null);for(var l in s=s.iterateNext(),a)if(s===a[l].textNode)return a[l]},e.prototype.getCurrentPage=function(e){return e.getAttribute("n")},e.prototype.getCurrentPageId=function(e){return e.getAttribute("xml:id")||"page_"+e.getAttribute("n")},e.prototype.getCurrentPageNodes=function(e,t){for(var n=[];0<t.length;){if("pb"===t[0].nodeName)return n;n.push(t[0]),t.splice(0,1)}return n},e.prototype.getLineNodes=function(e,t,n,r,o,a){for(var s,l,c,u,d,h=[];0<t.length;){if(s=o?e.evaluate(i.ns.getPrevBody,t[0],a,XPathResult.ANY_TYPE,null):e.evaluate(i.getPrevBody,t[0],null,XPathResult.ANY_TYPE,null),l=o?e.evaluate(i.ns.getPrevLb,t[0],a,XPathResult.ANY_TYPE,null):e.evaluate(i.getPrevLb,t[0],null,XPathResult.ANY_TYPE,null),c=0!==(s.numberValue>=1?l.numberValue-n:l.numberValue),u="lb"===t[0].nodeName,d="pb"===t[0].nodeName,c||u){for(;u||d;){if(t.splice(0,1),0===t.length)return;u="lb"===t[0].nodeName,d="pb"===t[0].nodeName}for(;void 0!==t[0]&&"lb"!==t[0].nodeName&&"pb"!==t[0].nodeName;)h.push(t[0]),t.splice(0,1);return h}t.splice(0,1)}return h},e.prototype.removeEmptyTextNodes=function(e){return e.filter((function(e){var t="#text"===e.nodeName&&""===e.textContent.trim(),n="#text"===e.nodeName;return!t||!n}))},e.prototype.getChildNodes=function(e,t,n,r){var o,a=[],s=n?e.evaluate(i.ns.getChildNodes,t,r,XPathResult.ANY_TYPE,null):e.evaluate(i.getChildNodes,t,null,XPathResult.ANY_TYPE,null);for(o=s.iterateNext();null!==o;)a.push(o),o=s.iterateNext();return a},e.prototype.getBodyTextGlyphNodes=function(e,t,n,r){var o,a=[],s=n?e.evaluate(i.ns.getTextGlyphNodes,t,r,XPathResult.ANY_TYPE,null):e.evaluate(i.getTextGlyphNodes,t,null,XPathResult.ANY_TYPE,null);for(o=s.iterateNext();null!==o;)a.push(o),o=s.iterateNext();return a},e.prototype.getParagraph=function(e,t){return e.getAttribute("n")||t.toString()},e.prototype.getLine=function(e,t){return e.getAttribute("n")||t.toString()},e.prototype.getContent=function(e,t){var i,o="";return e.forEach((function(e){({g:function(){i=n.getGlyph(e,t),o+=i},"#text":function(){o+=e.textContent}})[e.nodeName]()})),r.cleanSpace(o)},e.prototype.removeNoteElements=function(e){for(var t=e.getElementsByTagName("note");t.length>0;)t[0].parentNode.removeChild(t[0])},e.prototype.removeAddElements=function(e){for(var t=e.getElementsByTagName("add");t.length>0;)t[0].parentNode.removeChild(t[0])}}])},function(e,t){angular.module("evtviewer.dataHandler").factory("evtAbstractSearchParserInterface",["EvtSearchInterface",function(e){return new e("evtAbstractSearchParserInterface",["parseElements","getPrevDocsLines"])}])},function(e,t){angular.module("evtviewer.dataHandler").factory("EvtParagraphLineParser",["evtSearchDocument","evtSearchDiplomaticParLineHandler","XPATH",function(e,t,n){function i(e){this.parsedElementsForIndexing={},this.xmlDocBody=e}return i.prototype.getPrevDocsLines=function(){},i.prototype.parseElements=function(){var i,r,o=this.xmlDocBody.ownerDocument;return e.hasNamespace(o),i=e.ns,r=e.nsResolver,this.parsedElementsForIndexing=function(e,i,r,o){var a=function(e,t,i,r){return i?e.evaluate(n.ns.getParLineNodes,t,r,XPathResult.ANY_TYPE,null):e.evaluate(n.getParLineNodes,t,null,XPathResult.ANY_TYPE,null)}(e,i,r,o);return function(e,n,i,r,o){return t.getParLineInfo(e,n,i,r,o)}(e,i,a,r,o)}(o,this.xmlDocBody,i,r),this.parsedElementsForIndexing},i}])},function(e,t){angular.module("evtviewer.dataHandler").factory("EvtLbParser",["evtSearchDocument","evtDiplomaticEditionHandler","evtInterpretativeEditionHandler","evtSearchDiplomaticLbHandler","evtGlyph","Utils","XPATH",function(e,t,n,i,r,o,a){function s(e){this.parsedElementsForIndexing={},this.xmlDocBody=e}return s.prototype.getPrevDocsLines=function(){return this.parsedElementsForIndexing.countAllLines},s.prototype.parseElements=function(t){var n,r,o=this.xmlDocBody.ownerDocument;return e.hasNamespace(o),n=e.ns,r=e.nsResolver,this.parsedElementsForIndexing=function(e,t,n,r,o){var s=function(e,t,n,i){return n?e.evaluate(a.ns.getLineNodes,t,i,XPathResult.ANY_TYPE,null):e.evaluate(a.getLineNodes,t,null,XPathResult.ANY_TYPE,null)}(e,t,r,o);return function(e,t,n,r,o,a){return i.getLineInfo(e,t,n,r,o,a)}(e,t,s,n,r,o)}(this.xmlDocBody.ownerDocument,this.xmlDocBody,t,n,r),this.parsedElementsForIndexing},s}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtDiplomaticEditionHandler",["XPATH",function e(t){e.prototype.getDiplomaticNodes=function(e,n,i,r){for(var o=[],a=i?e.evaluate(t.ns.getDiplomaticNodes,n,r,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null):e.evaluate(t.getDiplomaticNodes,n,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),s=0;s<a.snapshotLength;s++)o.push(a.snapshotItem(s));return o},e.prototype.getDiplomaticChildNodes=function(e,n,i,r){for(var o=[],a=i?e.evaluate(t.ns.getDiplomaticChildNodes,n,r,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null):e.evaluate(t.getDiplomaticChildNodes,n,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),s=0;s<a.snapshotLength;s++)o.push(a.snapshotItem(s));return o}}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtInterpretativeEditionHandler",["XPATH",function e(t){e.prototype.getInterpretativeNodes=function(e,n,i,r){for(var o=[],a=i?e.evaluate(t.ns.getInterpretativeNodes,n,r,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null):e.evaluate(t.getInterpretativeNodes,n,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),s=0;s<a.snapshotLength;s++)o.push(a.snapshotItem(s));return o},e.prototype.getInterpretativeChildNodes=function(e,n,i,r){for(var o=[],a=i?e.evaluate(t.ns.getInterpretativeChildNodes,n,r,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null):e.evaluate(t.getInterpretativeChildNodes,n,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),s=0;s<a.snapshotLength;s++)o.push(a.snapshotItem(s));return o}}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtSearchDiplomaticParLineHandler",["evtSearchDocument","evtDiplomaticEditionHandler","evtInterpretativeEditionHandler","XPATH","Utils",function e(t,n,i,r,o){e.prototype.getParLineInfo=function(e,r,o,a,s){for(var l,c,u=t.getCurrentXmlDoc(e,r,a,s),d=t.isInterpEdition(),h=t.isDiplEdition(),p=1,f=1,g=1,m={},v={},y=o.iterateNext();null!==y;){var b={head:function(){},pb:function(){l=t.getCurrentPage(y)||p,c=t.getCurrentPageId(y,p),p++},default:function(){var r=[];h&&(r=n.getDiplomaticChildNodes(e,y,a,s));var o=[];d&&(o=i.getInterpretativeChildNodes(e,y,a,s)),r.forEach((function(n){var i,a;if("pb"===n.nodeName&&(l=t.getCurrentPage(n),c=t.getCurrentPageId(n,p),p++,r.splice(0,1),d&&o.splice(0,1)),l&&(m.page=l,m.pageId=c),m.xmlDocTitle=u.title,m.xmlDocId=u.id,{p:function(){m.paragraph=t.getParagraph(y,f),m.docId=m.xmlDocId+"-"+m.page+"-"+m.paragraph,f++},l:function(){m.line=t.getLine(y,g),m.docId=m.xmlDocId+"-"+m.page+"-"+m.line,g++}}[y.nodeName](),m.content={},h){if(i=t.getCurrentPageNodes(e,r),0===(a=t.removeEmptyTextNodes(i)).length)return void(m={});m.content.diplomatic=t.getContent(a,"diplomatic")}var s=[];if(d){s=t.getCurrentPageNodes(e,o);var b=t.removeEmptyTextNodes(s);if(0===b.length)return void(m={});m.content.interpretative=t.getContent(b,"interpretative")}v[m.docId]=m,m={},i=[],d&&(s=[])}))}};(b[y.nodeName]||b.default)(),y=o.iterateNext()}return v}}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtSearchDiplomaticLbHandler",["evtSearchDocument","evtDiplomaticEditionHandler","evtInterpretativeEditionHandler","evtParser",function e(t,n,i,r){var o=0;e.prototype.getLineInfo=function(e,r,a,s,l,c){var u,d,h,p=t.getCurrentXmlDoc(e,r,l,c),f=n.getDiplomaticNodes(e,r,l,c),g=t.isInterpEdition(),m=t.isDiplEdition(),v=1,y=1,b={},_=1,x=0,w={},S={},T=1,E=a.iterateNext(),C=[];for(g&&(C=i.getInterpretativeNodes(e,r,l,c));null!==E;){var k={pb:function(){u=t.getCurrentPage(E)||v,d=t.getCurrentPageId(E,v),v++,_=0},p:function(){h=t.getParagraph(E,y),y++},default:function(){b.line=E.getAttribute("n")||_.toString(),x!==b.line?(u&&(b.page=u,b.pageId=d),h&&(b.paragraph=h),b.xmlDocTitle=p.title,b.xmlDocId=p.id,b.docId=b.xmlDocId+"-"+b.pageId+"-"+b.line+"-line"+T,b.lbId=E.getAttribute("xml:id"),m?(w.diplomatic=t.getLineNodes(e,f,s,T,l,c),t.removeEmptyTextNodes(w.diplomatic)):(w.diplomatic=[],[]),g?(w.interpretative=t.getLineNodes(e,C,s,T,l,c),t.removeEmptyTextNodes(w.interpretative)):(w.interpretative=[],[]),b.content={},m&&(b.content.diplomatic=t.getContent(w.diplomatic,"diplomatic")),g&&(b.content.interpretative=t.getContent(w.interpretative,"interpretative")),_++,T++,o++,x=b.line,S[b.docId]=b,w=[]):0}};(k[E.nodeName]||k.default)(),E=a.iterateNext(),b={}}return S.countAllLines=o,S}}])},function(e,t){angular.module("evtviewer.dataHandler").service("evtKeyboard",["evtSearchDocument","baseData","parsedData","XPATH",function e(t,n,i,r){function o(e,t){for(var n in t)if(n===e)return!0;return!1}e.prototype.getDefaultKeyboardKeys=function(){return function(e){var t,n=i.getGlyphs(),r={};for(var o in n)for(var a=0;a<e.length;a++)e[a]===o&&(t=n[o].mapping.runic,r[e[a]]=t?n[o].mapping.runic.content:n[o].mapping.diplomatic.content);return r}(function(e){var t=[],n=e.length,i=30;for(;n<i;)i--;for(var r=0;r<i;r++)t.push(e[r]);return t}(function(e){return Object.keys(e).sort((function(t,n){return e[n]-e[t]}))}(function(e){for(var t,n,i,r={},a=0;a<e.length-1;a++)t=e[a],n=e[a+1],0===Object.keys(r).length&&(r[e[0]]=1),i=o(n,r),t===n?r[t]++:i?r[n]++:r[n]=1;return r}(e.prototype.getGlyphInXmlDoc()))))},e.prototype.getConfigKeyboardKeys=function(e){var t=i.getGlyphs(),n={};for(var r in t)for(var o=0;o<e.length;o++)r===e[o]&&(n[e[o]]=t[r].mapping.diplomatic.content);return n},e.prototype.getGlyphInXmlDoc=function(){for(var e,o=n.getXML(),a=function(e){var n={};return t.hasNamespace(e),n.ns=t.ns,n.nsResolver=t.nsResolver,n}(o),s=function(e,t,n){return t?e.evaluate(r.ns.getGlyphNodes,e,n,XPathResult.ANY_TYPE,null):e.evaluate(r.getGlyphNodes,e,null,XPathResult.ANY_TYPE,null)}(o,a.ns,a.nsResolver),l=i.getGlyphs(),c=s.iterateNext(),u=[];null!==c;){for(var d in e=c.getAttribute("ref").replace("#",""),l)e===d&&u.push(e);c=s.iterateNext()}return u}}])},function(e,t){angular.module("evtviewer.bibliography",[])},function(e,t){angular.module("evtviewer.bibliography").directive("evtScrollIf",["$timeout",function(e){return function(t,n,i){i.$observe("evtScrollIf",(function(t){"true"===t&&e((function(){n[0].scrollIntoView()}),100)}))}}])},function(e,t){angular.module("evtviewer.bibliography").service("evtHighlight",(function(){var e={},t="";return e.setHighlighted=function(e){t=e},e.getHighlighted=function(){return t},e}))},function(e,t){angular.module("evtviewer.bibliography").provider("evtBibliography",(function(){this.defaults;this.setDefaults=function(e){e},this.$get=["$log","config","parsedData","evtBibliographyParser","evtHighlight",function(e,t,n,i,r){var o={},a={},s=[],l=0,c=(e.getInstance("bibliography"),function(e){var t=this,n=t.getBibliographicRefById(e);return t.initialSelectedStyle?(n.outputs[t.initialSelectedStyle.label]||i.formatResult(t.initialSelectedStyle.label,n),n.outputs[t.initialSelectedStyle.label]?n.outputs[t.initialSelectedStyle.label]:n.plainText):n.plainText}),u=function(e){var t=this.getBibliographicRefById(e),n=i.getType(t);return n=n||"unknown"},d=function(e){return""!==r.getHighlighted()&&r.getHighlighted()===e},h=function(e){return n.getBibliographicRefById(e)};return o.build=function(e){var r,o,p,f,g,m,v=e.id||l++,y=t.allowedBibliographicStyles||{},b=!0,_=!0,x=!0;for(var w in""!==t.defaultBibliographicStyle&&void 0!==y[t.defaultBibliographicStyle]&&y[t.defaultBibliographicStyle].enabled&&(o=y[t.defaultBibliographicStyle]),y)o||!y[w].enabled||o||(o=y[w]),y[w].enabled||delete y[w];if(void 0===a[v]){if(i.bibliographicStyleInfoDetected()||(_=!1,o=""),f=t.bibliographicEntriesSortBy||{},i.authorInfoDetected()||delete f.Author,i.yearInfoDetected()||delete f.Year,i.titleInfoDetected()||delete f.Title,i.publisherInfoDetected()||delete f.Publisher,f&&Object.keys(f).length>0)b=!0,p=f[Object.keys(f)[0]];else b=!1;m=(g=t.bibliographySortOrder).ASC,b||(x=!1),r=n.getBibliographicRefsCollection();var S;if(void 0===a[v])return S={uid:v,biblRefsCollection:r,styles:y,initialSelectedStyle:o,selectedSorting:p,biblSortStyleSelectVisibility:_,biblSortSelectVisibility:b,biblSortOrderSelectVisibility:x,sortBy:f,sortOrder:g,selectedSortOrder:m,getFormattedBibl:c,pubblicationType:u,isEntryHighlighted:d,getBibliographicRefById:h},a[v]=angular.extend(e.vm,S),s.push({id:v}),a[v]}},o.destroy=function(e){delete a[e]},o}]}))},function(e,t){angular.module("evtviewer.bibliography").controller("BibliographyCtrl",["$log","evtBibliography",function(e,t){e.getInstance("BibliographyCtrl");var n=this;this.myComparator=function(e,t){var i=e,r=t;switch(e=n.getBibliographicRefById(e),t=n.getBibliographicRefById(t),n.selectedSorting){case n.sortBy.Author:e&&e.author&&e.author.length>0&&(i=""!==e.author[0].name?e.author[0].name:"",i=""!==e.author[0].surname?e.author[0].surname:i),t&&t.author&&t.author.length>0&&(r=""!==t.author[0].name?t.author[0].name:"",r=""!==t.author[0].surname?t.author[0].surname:r);break;case n.sortBy.Year:e&&e.date&&(i=""!==e.date&&Number(e.date)?Number(e.date):""),t&&t.date&&(r=""!==t.date&&Number(t.date)?Number(t.date):"");break;case n.sortBy.Title:e&&e.titleAnalytic&&(i=""!==e.titleAnalytic&&""===i?e.titleAnalytic:i),e&&e.titleMonogr&&(i=""!==e.titleMonogr&&""===i?e.titleMonogr:i),t&&t.titleAnalytic&&(r=""!==t.titleAnalytic&&""===r?t.titleAnalytic:r),t&&t.titleMonogr&&(r=""!==t.titleMonogr&&""===r?t.titleMonogr:r);break;case n.sortBy.Publisher:e&&e.publisher&&(i=""!==e.publisher?e.publisher:""),t&&t.publisher&&(r=""!==t.publisher?t.publisher:"")}return i="number"==typeof i?i.toString():i,r="number"==typeof r?r.toString():r,i.localeCompare(r)},this.biblId=function(e){return e},this.getSortedBibl=function(){const e=n.biblRefsCollection._indexes;return e.sort(n.myComparator),n.selectedSortOrder===n.sortOrder.DESC&&e.reverse(),e},this.destroy=function(){t.destroy(this.uid)}}])},function(e,t,n){angular.module("evtviewer.bibliography").directive("evtBibliography",["evtBibliography",function(e){return{restrict:"E",template:n(152),scope:{id:"@"},controllerAs:"vm",controller:"BibliographyCtrl",link:function(t,n,i){var r=e.build(t);r.sortedBibl=r.getSortedBibl(),t.$watch((function(){return r.selectedSorting}),(function(e,t){t!==e&&(r.sortedBibl=r.getSortedBibl())}),!0),t.$watch((function(){return r.selectedSortOrder}),(function(e,t){t!==e&&(r.sortedBibl=r.getSortedBibl())}),!0),t.$on("$destroy",(function(){r&&r.destroy()}))}}}])},function(e,t){e.exports='<div class="evt-bibliography">\n\t<div class="evt-bibliography__header"\n\t\tng-if="::vm.biblSortStyleSelectVisibility || vm.biblSortSelectVisibility || vm.biblSortOrderSelectVisibility">\n\n\t\t<div ng-if="::vm.biblSortStyleSelectVisibility">\n\t\t\t<label for="biblStyleSelect"> {{ \'BIBLIOGRAPHY.STYLE\' | translate }} </label>\n\t\t\t<select id="biblStyleSelect" ng-model="vm.initialSelectedStyle"\n\t\t\t\tng-options="value as (value.label | translate) for (key, value) in vm.styles"></select>\n\t\t</div>\n\n\t\t<div ng-if="::vm.biblSortSelectVisibility">\n\t\t\t<label for="biblSortingSelect">{{ \'BIBLIOGRAPHY.SORT_BY\' | translate }} </label>\n\t\t\t<select id="biblSortingSelect" ng-model="vm.selectedSorting"\n\t\t\t\tng-options="value as (value | translate) for (key , value) in vm.sortBy"></select>\n\t\t</div>\n\n\t\t<div ng-if="::vm.biblSortOrderSelectVisibility">\n\t\t\t<label for="biblSortOrder">{{ \'BIBLIOGRAPHY.ORDER\' | translate }} </label>\n\t\t\t<select id="biblSortOrder" ng-model="vm.selectedSortOrder"\n\t\t\t\tng-options="value as (value | translate) for (key , value) in vm.sortOrder"></select>\n\t\t</div>\n\n\t</div>\n\t<div class="evt-bibliography__content"\n\t\tng-class="{\'noSorter\': !vm.biblSortStyleSelectVisibility && !vm.biblSortSelectVisibility }">\n\t\t<div class="biblRef" id="{{ ::bibl }}"\n\t\t\tng-repeat="bibl in vm.sortedBibl"\n\t\t\tcompile="vm.getFormattedBibl(bibl)" ng-attr-highlight="{{ vm.isEntryHighlighted(bibl) }}"\n\t\t\tevt-scroll-if="{{ vm.isEntryHighlighted(bibl) }}"\n\t\t\tng-attr-pubblicationType="{{ ::vm.pubblicationType(bibl) }}">\n\t\t</div>\n\t</div>\n</div>'},function(e,t){angular.module("evtviewer.bibliography").controller("BiblElemCtrl",["$scope","$log","parsedData","config","evtBibliographyParser",function(e,t,n,i,r){t.getInstance("BiblElemCtrl");var o=this;o.styles=i.allowedBibliographicStyles,o.initialSelectedStyle=i.defaultBibliographicStyle,o.getFormattedBibl=function(){var t=n.getBibliographicRefById(e.biblId);return t?(t.outputs[o.initialSelectedStyle]||r.formatResult(o.initialSelectedStyle,t),t.outputs[o.initialSelectedStyle]):""}}])},function(e,t,n){angular.module("evtviewer.bibliography").directive("evtBiblElem",(function(){return{restrict:"E",scope:{biblId:"@"},transclude:!0,template:n(155),controllerAs:"vm",controller:"BiblElemCtrl"}}))},function(e,t){e.exports='<div class="evtBiblRef" compile="vm.getFormattedBibl()">\n</div>\n'},function(e,t){angular.module("evtviewer.interface",[])},function(e,t){angular.module("evtviewer.interface").config(["$routeProvider","$locationProvider","$translateProvider",function(e,t,n){t.hashPrefix(""),e.when("/:viewMode",{template:"index.html",controller:"InterfaceCtrl",reloadOnSearch:!1}).otherwise({redirectTo:"/",reloadOnSearch:!1}),n.useStaticFilesLoader({prefix:"./i18n/",suffix:".json"}),n.useSanitizeValueStrategy(null),n.fallbackLanguage("en").preferredLanguage("en")}]).run(["$injector","config",function(e,t){t.isValid()&&(t.isModuleActive("interface")&&e.get("evtInterface").boot())}])},function(e,t){angular.module("evtviewer.interface").controller("InterfaceCtrl",["$log","$timeout","$scope","evtInterface","evtTranslation","evtPinnedElements","evtButtonSwitch","evtBox","evtApparatuses","parsedData","evtSelect","evtPopover","evtCommunication","evtDialog",function(e,t,n,i,r,o,a,s,l,c,u,d,h,p){document.body.style="display: block";var f=e.getInstance("interface");n.getCurrentViewMode=function(){return i.getState("currentViewMode")},n.getCurrentPage=function(){return i.getState("currentPage")},n.getCurrentDocument=function(){return i.getState("currentDoc")},n.getCurrentEdition=function(){return i.getState("currentEdition")},n.getCurrentComparingEdition=function(){return i.getState("currentComparingEdition")},n.getAvailableWitnesses=function(){return i.getProperty("availableWitnesses")},n.isWitnessSelectorActive=function(){return i.getProperty("witnessSelector")},n.addWitness=function(e){void 0!==e&&(i.addWitness(e),i.updateUrl()),t((function(){var e=window.getComputedStyle(document.getElementsByClassName("box")[0]).width.replace("px","");document.getElementById("compareWits_box").scrollLeft=e*(i.getState("currentWits").length+1)})),i.updateProperty("witnessSelector",!1)},n.getWitness=function(e){var t=e+" - "+c.getWitness(e).description.textContent.trim()||e;return t=t.length>30?t.substr(0,30)+"...":t},n.getCurrentWitnesses=function(){return i.getState("currentWits")},n.getCurrentWitnessPage=function(e){return i.getCurrentWitnessPage(e)},n.getAvailableViewModes=function(){return i.getProperty("availableViewModes")},n.existCriticalText=function(){return i.existCriticalText()},n.getCurrentAppEntry=function(){return i.getState("currentAppEntry")},n.updateCurrentAppEntry=function(e){i.updateState("currentAppEntry",e),"readingTxt"===i.getState("currentViewMode")&&(s.alignScrollToApp(e),l.alignScrollToApp(e)),i.updateUrl()},n.updateCurrentQuote=function(e){i.updateState("currentQuote",e)},n.getCurrentApparatus=function(){return i.getState("currentApparatus")},n.evtPinnedElements=o,n.isLoading=function(){var e=h.getError();return i.isLoading()&&""===e.title},n.isPinnedAppBoardOpened=function(){return i.getState("isPinnedAppBoardOpened")},n.isToolAvailable=function(e){return i.isToolAvailable(e)},n.getSecondaryContentOpened=function(){return i.getState("secondaryContent")},n.getProjectInfo=function(){return c.getProjectInfo()},n.getWitnessesListFormatted=function(){return c.getWitnessesListFormatted()},n.getAvailableLists=function(){return c.getNamedEntitiesCollection()._indexes},n.getProperty=function(e){return i.getProperty(e)},n.getState=function(e){return i.getState(e)},n.getWebSite=function(){var e=i.getProperty("webSite");return e.indexOf("http://")<0?"http://"+e:e},n.handleGenericClick=function(e){var t=e.target;if(0===angular.element(t).parents("evt-select").length&&u.closeAll(),0===angular.element(t).parents("button-switch").length){a.unselectAllSkipByBtnType("",["standAlone","toggler"]),i.updateState("mainMenu",!1)}0===angular.element(t).parents("evt-popover").length&&d.closeAll(),0===angular.element(t).parents(".witnessSelector").length&&i.getProperty("witnessSelector")&&i.updateProperty("witnessSelector",!1)},n.handleKeydownEvent=function(e){e.target&&e.target.tagName&&"input"===e.target.tagName.toLowerCase()&&"text"===e.target.getAttribute("type")||(27===e.keyCode?p.closeAll():37===e.keyCode?n.isVisCollOpened()||n.isThumbNailsOpened()||(e.metaKey?i.goToFirstPage():i.goToPrevPage()):39===e.keyCode&&(n.isVisCollOpened()||n.isThumbNailsOpened()||(e.metaKey?i.goToLastPage():i.goToNextPage())))},n.getBookmark=function(){var e=c.getProjectInfo().editionReference||{},t='<div class="bookmark">';return t+=e.author?e.author+". ":"",t+=e.title?"<em>"+e.title+"</em>. ":"",t+=e.publisher?"{{ 'PUBLISHED_BY' | translate }} "+e.publisher+". ":"",t+='<<a href="'+window.location+'" target="blank">'+window.location+"</a>>",t+="</div>"},n.getErrorMsg=function(){return h.getError()},n.getAvailableSourcesTexts=function(){return i.getProperty("availableSourcesTexts")},n.getCurrentSourceText=function(){return i.getState("currentSourceText")},n.isApparatusBoxOpen=function(){return i.getState("isApparatusBoxOpen")},n.showApparatusesBox=function(){return i.getState("isApparatusBoxOpen")&&"critical"===i.getState("currentEdition")},n.getCurrentVersions=function(){return i.getState("currentVersions")},n.getAvailableVersions=function(){return i.getProperty("availableVersions")},n.isVersionSelectorActive=function(){return i.getProperty("versionSelector")},n.getAllVersionsNumber=function(){return i.getAllVersionsNumber()},n.getVersion=function(e){var t=c.getVersionEntries(),n=t?t._indexes:{};return n&&n.versionId?n.versionId[e]:""},n.addVersion=function(e){void 0!==e&&i.addVersion(e),t((function(){var e=window.getComputedStyle(document.getElementsByClassName("box")[0]).width.replace("px","");document.getElementById("compareVer_box").scrollLeft=e*(i.getState("currentVersions").length+1)})),i.updateProperty("versionSelector",!1)},n.openGlobalDialogInfo=function(){i.updateState("secondaryContent","globalInfo"),p.openByType("globalInfo")},n.openGlobalDialogLists=function(){i.updateState("secondaryContent","entitiesList"),p.openByType("entitiesList")},n.openToc=function(){i.updateState("secondaryContent","toc"),p.openByType("toc")},n.generateBookmark=function(){i.updateState("secondaryContent","bookmark"),p.openByType("bookmark")},n.downloadXML=function(){window.open(i.getProperty("dataUrl"),"_blank")},n.getAvailableLanguages=function(){return r.getLanguages()},n.getCurrentLanguage=function(){return r.getCurrentLanguage()},n.setLanguage=function(e){r.setLanguage(e)},n.isNavBarOpened=function(){return i.getProperty("enableNavBar")&&i.getState("isNavBarOpened")},n.isNavBarEnabled=function(){return i.getProperty("enableNavBar")},n.isVisCollOpened=function(){return i.getState("isVisCollOpened")},n.isThumbNailsOpened=function(){return i.getState("isThumbNailsOpened")},n.getThumbnails=function(){return c.getThumbnails()},n.goToPageFromThumb=function(e){i.getState("currentPage")!==e.value&&(i.updateState("isThumbNailsOpened",!1),i.setCurrentPage(e))},n.toggleNavBar=function(){var e=i.getState("isNavBarOpened");i.updateState("isNavBarOpened",!e),t((function(){n.$broadcast("rzSliderForceRender")}))},f.log("InterfaceCtrl running")}]).directive("evt-g",["parsedData",function(e){return{restrict:"E",scope:{ref:"@"},template:'<span class="glyph" compile="::content"></span>',replace:!0,link:function(t,n,i){var r=t.ref,o="["+t.ref+"]";if(r&&""!==r){r=r.replace("#","");var a=e.getGlyph(r);a&&""!==a.parsedXml&&(o=a.parsedXml)}t.content=o}}}])},function(e,t){angular.module("evtviewer.interface").service("evtInterface",["$rootScope","$timeout","evtTranslation","evtCommunication","evtCriticalApparatusParser","evtCriticalParser","evtPinnedElements","config","$routeParams","parsedData","evtReading","$q",function(e,t,n,i,r,o,a,s,l,c,u,d){var h={},p={currentViewMode:void 0,currentDoc:void 0,currentPage:void 0,currentDivs:{},currentWits:void 0,currentWitsPages:void 0,currentEdition:void 0,currentComparingEdition:void 0,currentAppEntry:void 0,currentHighlightedZone:void 0,isLoading:!0,isPinnedAppBoardOpened:!1,isNavBarOpened:!0,isVisCollOpened:!1,isThumbNailsOpened:!1,indexingInProgress:!1,secondaryContent:"",dialog:{home:""},isApparatusBoxOpen:!0,currentApparatus:void 0,currentQuote:void 0,currentAnalogue:void 0,currentSource:void 0,currentSourceText:void 0,currentVersions:void 0,currentVersionEntry:void 0,currentVersion:void 0,mainMenu:!1},f={indexTitle:"",webSite:"",dataUrl:"",logoUrl:"",enableXMLdownload:!1,toolHome:!0,availableViewModes:[],availableWitnesses:[],witnessSelector:!1,namedEntitiesLists:!1,availableSourcesTexts:[],isSourceLoading:!1,parsedSourcesTexts:[],availableVersions:[],versionSelector:!1,tabsContainerOpenedContent:"",tabsContainerOpenedTab:"",visCollTextUrl:"",visCollStyleUrl:"",enableNavBar:!0},g={};return h.boot=function(){i.getExternalConfig(s.configUrl).then((function(){f.indexTitle=s.indexTitle,f.logoUrl=s.logoUrl,f.webSite=s.webSite,f.enableXMLdownload=s.enableXMLdownload,f.toolHome=s.toolHome,f.availableViewModes=s.availableViewModes,f.visCollTextUrl=s.visCollTextUrl,f.visCollStyleUrl=s.visCollStyleUrl,f.enableNavBar=angular.isDefined(s.enableNavBar)?s.enableNavBar:p.enableNavBar,p.isNavBarOpened=angular.isDefined(s.initNavBarOpened)?s.initNavBarOpened:p.isNavBarOpened,n.setLanguages(s.languages);var u=n.getUserLanguage(),g=n.getFallbackLanguage();n.setFallbackLanguage(g),n.setLanguage(u),""!==s.sourcesUrl&&i.getExternalData(s.sourcesUrl),""!==s.analoguesUrl&&i.getExternalData(s.analoguesUrl),h.updateProperty("dataUrl",s.dataUrl),""===s.dataUrl?(i.err("","","dataUrlEmpty",!1),e.$applyAsync(p.isLoading=!1)):i.getData(s.dataUrl).then((function(){for(var n=0,u=f.availableViewModes.length;n<u;n++){var g=f.availableViewModes[n].viewMode;"collation"===g&&0===c.getWitnessesList().length&&(f.availableViewModes[n].visible=!1),"versions"===g&&h.getAllVersionsNumber()<2&&(f.availableViewModes[n].visible=!1),"srcTxt"!==g||c.getSources()._indexes.availableTexts&&0!==c.getSources()._indexes.availableTexts.length||(f.availableViewModes[n].visible=!1)}if(f.namedEntitiesLists=c.getNamedEntitiesCollection()._indexes.length>0,s.availableEditionLevel)for(var m=0;m<s.availableEditionLevel.length;m++){var v=s.availableEditionLevel[m];v.visible&&c.addEdition(v)}h.updateParams(l);var y=[];""!==s.sourcesUrl&&y.push(i.getExternalData(s.sourcesUrl)),""!==s.analoguesUrl&&y.push(i.getExternalData(s.analoguesUrl));var b=c.getDocument(p.currentDoc);void 0!==b&&("internal"===c.getEncodingDetail("variantEncodingLocation")&&(s.loadCriticalEntriesImmediately&&y.push(r.parseCriticalEntries(b.content).promise),s.versions.length>1&&y.push(r.parseVersionEntries(b.content).promise)),"critical"!==s.editionType&&"multiple"!==s.editionType||!c.isCriticalEditionAvailable()||(s.versions.length>0&&void 0!==s.versions[0]?y.push(o.parseCriticalText(b.content,p.currentDoc,s.versions[0]).promise):y.push(o.parseCriticalText(b.content,p.currentDoc).promise)),d.all(y).then((function(){var n=[];""!==s.visCollDataModel&&(n.push(i.getViscollDataModel(s.visCollDataModel)),""!==s.visCollImageList&&n.push(i.getViscollImageList(s.visCollImageList)),d.all(n).then((function(){var e=[],t=c.getViscollSVGToLoad();""!==s.visCollSvg&&t.length>0&&t.forEach((function(t){e.push(i.getViscollSvgs(s.visCollSvg+t.fileName,t.id))})),d.all(e).then((function(){c.setViscollSvgsLoaded(!0)}))}))),void 0!==p.currentAppEntry&&void 0===c.getCriticalEntryById(p.currentAppEntry)&&h.updateState("currentAppEntry","");var r=c.getSources()._indexes.availableTexts;if(0!==Object.keys(r).length){for(var o in r)f.availableSourcesTexts.push(r[o].id);h.updateCurrentSourceText(f.availableSourcesTexts[0])}if(p.currentVersions=[],2===s.versions.length)p.currentVersions.push(s.versions[1]);else for(var l=1;l<s.versions.length;l++)f.availableVersions.push(s.versions[l]);h.updateUrl();var u=c.getQuotes()._indexes.encodingStructure||[],g=!s.showInlineSources&&u.length>0,m=c.getAnalogues()._indexes.encodingStructure||[],v=!s.showInlineAnalogues&&m.length>0;p.isApparatusBoxOpen=!s.showInlineCriticalApparatus||g||v,e.$applyAsync(p.isLoading=!1),t((function(){a.getElementsFromCookies()}),10)})))}))}))},h.setTabContainerPanel=function(e){p.dialog.tabContainerPanel=e},h.getTabContainerPanel=function(){return p.dialog.tabContainerPanel},h.setHomePanel=function(e){p.dialog.home=e},h.getHomePanel=function(){return p.dialog.home},h.isLoading=function(){return p.isLoading},h.isToolAvailable=function(e){return s[e]},h.getToolState=function(e){return g[e]?g[e].status:void 0},h.getStates=function(){return p},h.getProperties=function(){return f},h.getProperty=function(e){return f[e]},h.getStates=function(){return p},h.getState=function(e){return p[e]},h.getCurrentWitnessPage=function(e){return p.currentWitsPages[e]},h.existCriticalText=function(){return void 0!==c.getCriticalText(p.currentDoc)},h.isCriticalApparatusInline=function(){return s.showInlineCriticalApparatus||"readingTxt"!==h.getState("currentViewMode")},h.isSourcesInline=function(){return s.showInlineSources||"readingTxt"!==h.getState("currentViewMode")},h.isAnaloguesInline=function(){return s.showInlineAnalogues||"readingTxt"!==h.getState("currentViewMode")},h.setToolStatus=function(e,t){g[e]||(g[e]={}),g[e].status=t},h.updateProperty=function(e,t){f[e]=t},h.updateState=function(e,t){p[e]=t},h.toggleState=function(e){p[e]=!p[e]},h.updateCurrentHighlightedZone=function(e){var t=p.currentHighlightedZone;t&&e&&t.id===e.id&&t.name===e.name||(p.currentHighlightedZone=e)},h.updateCurrentSourceText=function(e){var t=c.getSource(e);void 0!==t&&t._textAvailable&&(Object.keys(c.getSource(e).text).length>0||(f.isSourceLoading=!f.isSourceLoading,i.getSourceTextFile(s.sourcesTextsUrl+e+".xml",e).then((function(){f.isSourceLoading=!f.isSourceLoading,f.parsedSourcesTexts.push(e)}))));p.currentSourceText=e},h.removeAvailableVersion=function(e){var t=f.availableVersions.indexOf(e);void 0!==t&&f.availableVersions.splice(t,1)},h.addAvailableVersion=function(e){-1===f.availableVersions.indexOf(e)&&f.availableVersions.push(e)},h.addVersion=function(e,t){void 0===t?p.currentVersions.push(e):p.currentVersions.splice(t,0,e),h.removeAvailableVersion(e)},h.removeVersion=function(e){var t=p.currentVersions.indexOf(e);t>=0&&p.currentVersions.splice(t,1),f.availableVersions.indexOf(e)<0&&f.availableVersions.push(e)},h.switchVersions=function(e,t){var n=p.currentVersions.indexOf(t),i=p.currentVersions.indexOf(e);n>=0?p.currentVersions[n]=e:h.addAvailableVersion(e),p.currentVersions[i]=t,h.removeAvailableVersion(t)},h.getAllVersionsNumber=function(){return s.versions?s.versions.length:0},h.updateCurrentVersionEntry=function(e){void 0!==e&&(p.currentVersionEntry=e)},h.getCurrentVersionEntry=function(e){return p.currentVersionEntry},h.updateCurrentVersion=function(e){void 0!==e&&-1!==s.versions.indexOf(e)&&(p.currentVersion=e)},h.getCurrentVersion=function(e){return p.currentVersion},h.removeAvailableWitness=function(e){var t=f.availableWitnesses.indexOf(e);void 0!==t&&f.availableWitnesses.splice(t,1)},h.updateWitnessesPage=function(e,t){p.currentWitsPages[e]=t},h.updateDiv=function(e,t){p.currentDivs[e]=t},h.addWitness=function(e){p.currentWits.push(e),h.removeAvailableWitness(e)},h.addWitnessAtIndex=function(e,t){p.currentWits.splice(t,0,e),h.removeAvailableWitness(e)},h.removeWitness=function(e){var t=p.currentWits.indexOf(e);t>=0&&(p.currentWits.splice(t,1),delete p.currentWitsPages[e]),f.availableWitnesses.indexOf(e)<0&&f.availableWitnesses.push(e)},h.switchWitnesses=function(e,t){var n=p.currentWits.indexOf(t),i=p.currentWits.indexOf(e);n>=0&&(p.currentWits[n]=e),i>=0&&(p.currentWits[i]=t)},h.updateAvailableWitnessesByVersion=function(e){var t=c.getVersionEntries()._indexes.versionWitMap[e],n=[],i=[];if(void 0!==t&&t.length>0){for(var r=0;r<p.currentWits.length;r++)t.indexOf(p.currentWits[r])>=0&&n.push(p.currentWits[r]);p.currentWits=n;for(var o=0;o<t.length;o++)n.indexOf(t[o])<0&&i.push(t[o]);f.availableWitnesses=i}else if(e===s.versions[0]){for(var a=c.getWitnessesList(),l=0;l<p.currentWits.length;l++)a.indexOf(p.currentWits[l])>=0&&n.push(p.currentWits[l]);p.currentWits=n;for(var u=0;u<a.length;u++)n.indexOf(a[u])<0&&i.push(a[u]);f.availableWitnesses=i}h.updateUrl()},h.isViewModeAvailable=function(e){for(var t=0,n=f.availableViewModes.length;t<n;t++)if(f.availableViewModes[t].viewMode===e)return f.availableViewModes[t].visible},h.setCurrentPage=function(e){if(void 0!==e){var t=h.getState("currentDoc");h.updateState("currentPage",e.value),e.docs.length>0&&e.docs.indexOf(t)<0&&h.updateState("currentDoc",e.docs[0]),h.updateUrl()}},h.goToNextPage=function(){var e=c.getPages(),t=e[h.getState("currentPage")].indexInCollection,n=h.getState("currentDoc"),i=e[t+1];if(i){var r=e[i];h.updateState("currentPage",i),r.docs.length>0&&r.docs.indexOf(n)<0&&h.updateState("currentDoc",r.docs[0]),r.docs.length>1&&h.updateState("currentDoc",r.docs[0]),h.updateUrl()}return{newPageId:i,isFirst:i===e[0],isLast:i===e[e.length-1]}},h.goToPrevPage=function(){var e=c.getPages(),t=e[h.getState("currentPage")].indexInCollection,n=h.getState("currentDoc"),i=e[t-1];if(i){var r=e[i];h.updateState("currentPage",i),r.docs.length>0&&r.docs.indexOf(n)<0&&h.updateState("currentDoc",r.docs[0]),r.docs.length>1&&h.updateState("currentDoc",r.docs[0]),h.updateUrl()}return{newPageId:i,isFirst:i===e[0],isLast:i===e[e.length-1]}},h.goToFirstPage=function(){var e=c.getPages(),t=e[h.getState("currentPage")].indexInCollection,n=h.getState("currentDoc"),i=e[t-t];if(i){var r=e[i];h.updateState("currentPage",i),r.docs.length>0&&r.docs.indexOf(n)<0&&h.updateState("currentDoc",r.docs[0]),r.docs.length>1&&h.updateState("currentDoc",r.docs[0]),h.updateUrl()}return{newPageId:i,isFirst:i===e[0],isLast:i===e[e.length-1]}},h.goToLastPage=function(){var e=c.getPages(),t=h.getState("currentDoc"),n=e[e.length-1];if(n){var i=e[n];h.updateState("currentPage",n),i.docs.length>0&&i.docs.indexOf(t)<0&&h.updateState("currentDoc",i.docs[0]),i.docs.length>1&&h.updateState("currentDoc",i.docs[0]),h.updateUrl()}return{newPageId:n,isFirst:n===e[0],isLast:n===e[e.length-1]}},h.isCurrentPageFirst=function(){return h.getState("currentPage")===c.getPages()[0]},h.isCurrentPageLast=function(){var e=h.getState("currentPage"),t=c.getPages();return e===t[t.length-1]},h.updateParams=function(e){var t,n,i,r,o,a,l=s.defaultViewMode,d=s.defaultEdition,p=[],g={};void 0!==e.viewMode&&h.isViewModeAvailable(e.viewMode)&&(l=e.viewMode);var m,v=c.getEditions();if(void 0!==e.e?c.getEdition(e.e)?d=e.e:v&&v.length>0&&(d=v[0].value):c.getEdition(d)?"readingTxt"===l&&"critical"===d&&c.isCriticalEditionAvailable()&&(d=c.getEdition("critical")?"critical":v[0].value):v&&v.length>0&&(d=v[0].value),void 0!==e.ce)t=e.ce;else for(var y=0;!t&&y<v.length;)v[y].value!==d&&(t=v[y].value),y++;if(void 0!==e.p&&c.getEdition(e.ce))n=e.p;else{var b=c.getPages();b.length>0&&(n=b[b[0]].value||void 0)}if(void 0!==e.d&&void 0!==c.getDocument(e.d))i=e.d;else{var _=c.getDocuments();_._indexes.length>0&&(i=_[_._indexes[0]].value||void 0)}if(e.s&&c.getDiv(e.s)?a=e.s:c&&c.getDocument(i)&&(a=c.getDocument(i).divs[0]),void 0!==e.ws)for(var x in r=e.ws.split(",").filter((function(e){return 0!==e.length})),m=c.getWitnessesList(),f.availableWitnesses=m.slice(0,m.length),r){var w=r[x].split("@")[0],S=r[x].split("@")[1];void 0!==c.getWitness(w)&&(p.push(w),h.removeAvailableWitness(w),void 0!==S&&void 0!==c.getPage(w+"-"+S)&&(g[w]=S))}else if("collation"===l)s.versions.length>1?p=c.getVersionEntries()._indexes.versionWitMap[s.versions[0]]:void 0!==(p=c.getWitnessesList())&&p.length>s.maxWitsLoadTogether?(f.availableWitnesses=p.slice(s.maxWitsLoadTogether),p=p.slice(0,s.maxWitsLoadTogether)):f.availableWitnesses=[];else if(s.versions.length>1){var T=c.getVersionEntries()._indexes.versionWitMap[s.versions[0]];void 0!==T&&T.length>0&&(f.availableWitnesses=T.slice(0,T.length))}else m=c.getWitnessesList(),f.availableWitnesses=m.slice(0,m.length);void 0!==e.app&&(o=e.app),void 0!==l&&h.updateState("currentViewMode",l),void 0!==d?h.updateState("currentEdition",d):"collation"===l&&h.updateState("currentEdition","critical"),h.updateState("currentComparingEdition",t),void 0!==n&&h.updateState("currentPage",n),a&&i&&h.updateDiv(i,a),void 0!==i&&h.updateState("currentDoc",i),void 0!==p&&h.updateState("currentWits",p),g!=={}&&h.updateState("currentWitsPages",g),void 0!==o&&(h.updateState("currentAppEntry",o),u.setCurrentAppEntry(o)),h.updateUrl()},h.updateUrl=function(){var e=p.currentViewMode,t=p.currentDoc,n="";if(n+=void 0===p.currentDoc?"":(""===n?"":"&")+"d="+p.currentDoc,n+=void 0===p.currentPage?"":(""===n?"":"&")+"p="+p.currentPage,n+=p.currentDivs[t]?(""===n?"":"&")+"s="+p.currentDivs[t]:"",n+=void 0===p.currentEdition?"":(""===n?"":"&")+"e="+p.currentEdition,n+=void 0===p.currentComparingEdition?"":(""===n?"":"&")+"ce="+p.currentComparingEdition,"collation"===e&&void 0!==p.currentWits&&p.currentWits.length>0)for(var i in""!==n&&(n+="&"),n+="ws=",p.currentWits){n+=n.indexOf("ws=")<0?"ws=":"";var r=p.currentWits[i],o=h.getCurrentWitnessPage(r);n+=r,void 0!==o&&(n+="@"+o),i<p.currentWits.length-1&&(n+=",")}void 0!==p.currentAppEntry&&""!==p.currentAppEntry&&(""!==n&&(n+="&"),n+="app="+p.currentAppEntry),void 0!==e&&(window.location="#/"+e+"?"+n)},h}])},function(e,t){angular.module("evtviewer.reference",[])},function(e,t){angular.module("evtviewer.reference").constant("REFDEFAULTS",{}).config(["evtRefProvider","configProvider","REFDEFAULTS",function(e,t,n){var i=t.makeDefaults("ref",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.reference").provider("evtRef",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["$log",function(t){var n={},i={},r=[],o=0;t.getInstance("reference");return n.build=function(t){var n,a=t.id||o++,s=t.type||"link",l=t.target||"";if(void 0===i[a])return n={uid:a,defaults:angular.copy(e),type:s,target:l},i[a]=angular.extend(t.vm,n),r.push({id:a,type:s}),i[a]},n.destroy=function(e){delete i[e]},n.getListByType=function(e){var t=[];for(var n in i)i[n].type===e&&t.push(i[n]);return t},n.getById=function(e){angular.forEach(i,(function(t){if(t.uid===e)return t}))},n}]}))},function(e,t){angular.module("evtviewer.reference").controller("RefCtrl",["$log","evtRef","parsedData","evtDialog","evtHighlight","evtInterface","$timeout","evtCommunication",function(e,t,n,i,r,o,a,s){var l=this;e.getInstance("reference");l.handleRefClick=function(e){if("biblRef"===l.type||"biblio"===l.type||"#"===l.target.substr(0,1)){var t=l.target.replace("#","");n.getBibliographicRefById(t)?(o.updateState("secondaryContent","toc"),i.openByType("toc"),o.updateProperty("tabsContainerOpenedContent","bibliography"),r.setHighlighted(t),a((function(){r.setHighlighted("")}),2500)):s.err("MESSAGES.REFERENCE_NOT_FOUND","","405",!0)}else if(l.target&&""!==l.target){var c=l.target.indexOf("http")<0?"http://"+l.target:l.target;window.open(c,"_blank")}},l.destroy=function(){var e=l.uid;t.destroy(e)}}])},function(e,t){angular.module("evtviewer.reference").directive("ref",["evtRef",function(e){return{restrict:"C",scope:{target:"@",type:"@"},replace:!0,transclude:!0,controllerAs:"vm",controller:"RefCtrl",template:'<span class="evtRef" ng-click="vm.handleRefClick($event)" ng-transclude></span>',link:function(t){var n=e.build(t);t.$on("$destroy",(function(){n&&n.destroy&&n.destroy()}))}}}])},function(e,t){angular.module("evtviewer.communication",[])},function(e,t,n){"use strict";angular.module("evtviewer.communication").constant("COMMUNICATIONDEFAULTS",{mode:"xml",errorMsgs:{404:{title:"MESSAGES.FILE_NOT_FOUND",code:"404",msg:"MESSAGES.SOMETHING_WRONG_DURING_FILE_LOADING"},405:{title:"MESSAGES.MISSING_PARAMETERS",code:"405",msg:"MESSAGES.BIBL_REF_NOT_FOUND"},dataUrlEmpty:{title:"MESSAGES.MISSING_PARAMETERS",code:"404",msg:"MESSAGES.PATH_TO_EDITION_EMPTY"}}}).service("evtCommunication",["$http","$log","baseData","config","evtDialog","COMMUNICATIONDEFAULTS",function(e,t,n,i,r,o){var a={},s=o,l=t.getInstance("communication"),c={code:"",title:"",msg:""};return a.getExternalConfig=function(t){return e.get(t).then((function(e){i.extendDefault(e.data)}),(function(e){a.err("Something wrong while loading configuration file","",e,!0)}))},a.getData=function(t){return e.get(t).then((function(e){if("string"==typeof e.data)return l.log("XML Data received"),n.addXMLString(e.data)}),(function(e){s.errorMsgs[e.status]?a.err(s.errorMsgs[e.status].msg,t,e.status,!0):a.err(s.errorMsgs[404].msg,t,e.status,!0)}))},a.getViscollSvgs=function(t,i){return e.get(t).then((function(e){return n.handleViscollSvg(e.data,i)}),(function(e){}))},a.getViscollDataModel=function(t){return e.get(t).then((function(e){if("string"==typeof e.data)return l.log("XML Data received"),n.addViscollDataModel(e.data)}),(function(e){s.errorMsgs[e.status]?a.err(s.errorMsgs[e.status].msg,t,e.status,!0):a.err(s.errorMsgs[404].msg,t,e.status,!0)}))},a.getViscollImageList=function(t){return e.get(t).then((function(e){if("string"==typeof e.data)return l.log("XML Data received"),n.addViscollImageList(e.data)}),(function(e){s.errorMsgs[e.status]?a.err(s.errorMsgs[e.status].msg,t,e.status,!0):a.err(s.errorMsgs[404].msg,t,e.status,!0)}))},a.getExternalData=function(t){return e.get(t).then((function(e){if("string"==typeof e.data){var r="";t===i.sourcesUrl?r="sources":t===i.analoguesUrl&&(r="analogues"),n.addXMLExtDocument(e.data,r),l.log("XML Data received")}}),(function(e){s.errorMsgs[e]?a.err(s.errorMsgs[e].msg,t,e,!0):a.err(s.errorMsgs[404].msg,t,e,!0)}))},a.getSourceTextFile=function(t,i){return e.get(t).then((function(e){"string"==typeof e.data&&(n.addXMLSrcDocument(e.data,i),l.log("XML Data received"))}),(function(e){s.errorMsgs[e]?a.err(s.errorMsgs[e].msg,t,e,!0):a.err(s.errorMsgs[404].msg,t,e,!0)}))},a.getError=function(){return c},a.updateError=function(e){c=e},a.err=function(e,t,n,i){n=void 0!==n?n:"";var o=s.errorMsgs[n],l={code:o?o.code:n,msg:e&&""!==e||!o?e:o.msg,info:t,title:o?o.title:"MESSAGES.COMMUNICATION_ERROR "};if(a.updateError(l),i){var u=r.getById("errorMsg");u.updateContent('{{ "'+c.msg+'" | translate }} '+c.info),u.setTitle(c.title),u.open()}},a}])},function(e,t){angular.module("evtviewer.translation",[])},function(e,t){angular.module("evtviewer.translation").constant("TRANSLATIONDEFAULTS",{}).service("evtTranslation",["TRANSLATIONDEFAULTS","$translate",function(e,t){var n,i={},r=["en","it"];return i.setLanguage=function(e){n=e,t.use(e)},i.setLanguages=function(e){r=e},i.setFallbackLanguage=function(e){t.fallbackLanguage(e)},i.getLanguages=function(){return r},i.getCurrentLanguage=function(){return n},i.getUserLanguage=function(){var e=navigator.language;return e.indexOf("_")>=0&&e.split("_")[0],e.indexOf("-")>=0?e.split("-")[0]:e},i.getFallbackLanguage=function(){return r&&r.length>0?r[0]:"en"},i}])},function(e,t){angular.module("evtviewer.UItools",[])},function(e,t){angular.module("evtviewer.UItools").service("evtImageTextLinking",["evtInterface","Utils","parsedData","imageViewerHandler",function(e,t,n,i){var r={};const o=/lb/;r.turnOnITL=function(){this.activateITL(),e.setToolStatus("ITL","active")},r.turnOnHTS=function(){this.activateHotSpots(),e.setToolStatus("HTS","active")},r.turnOffITL=function(){this.deactivateITL(),e.setToolStatus("ITL","inactive"),e.updateCurrentHighlightedZone(void 0),this.switchingOffHighlightInImage(),this.switchingOffHighlightInImageSelected()},r.turnOffHTS=function(){this.deactivateHotSpots(),e.setToolStatus("HTS","inactive"),e.updateCurrentHighlightedZone(void 0),this.switchingOffHighlightInImage(),this.switchingOffHighlightInImageSelected()},r.activateITL=function(){this.prepareLines(),this.prepareZoneInImgInteractions()},r.activateHotSpots=function(){var t=r.prepareHotSpotZones().filter((function(t){return t.page===e.getState("currentPage")}));i.showHotSpot(t)},r.prepareHotSpotZones=function(){for(var e=n.getZones(),t=e._indexes,i=[],r=0;r<t.length;r++){var o=t[r];if(o){var a,s=e[o],l=s.corresp?s.corresp.replace("#",""):s.start?s.start.replace("#",""):o;(a=n.getHotSpot(l))&&(s.content=a.content),i.push(s)}}return i.filter((function(e){return"HotSpot"===e.rendition}))},r.deactivateITL=function(){var t=e.getState("currentHighlightedZone");t&&this.changeLinesHighlightStatus(t.id,"unselect"),this.resetTextNodes()},r.deactivateHotSpots=function(){var e=r.prepareHotSpotZones();i.hiddenHotSpot(e)},r.prepareLines=function(){for(var e=document.getElementsByClassName("lb"),n=0;n<e.length;n++){var i;if(n===e.length-1){var r=e[n].nextSibling;for(i=e[n].id;r&&(3===r.nodeType||r.className&&r.className.indexOf("inLine")<0);){if(3===r.nodeType){var o=document.createElement("span");o.className="textNode",o.textContent=r.textContent,r.parentElement.replaceChild(o,r),r=o}this.preapareElementInLine(r,i),r=r.nextSibling||e[n].parentNode.nextSibling||void 0}}else{var a=e[n],s=e[n+1];if((i=a.id)&&a&&s){var l=t.DOMutils.getElementsBetweenTree(a,s);for(var c in l){var u=l[c];if(3===u.nodeType){var d=document.createElement("span");d.className="textNode",d.textContent=u.textContent,u.parentElement.replaceChild(d,u),u=d}this.preapareElementInLine(u,i)}}}}},r.preapareElementInLine=function(t,n){t.className&&t.className.indexOf("inLine")<0&&(t.className+=" inLine",t.setAttribute("data-line",n),t.onmouseover=function(){var e=this.getAttribute("data-line");r.changeLinesHighlightStatus(e,"over");var t=e.replace(o,"line");r.highlightZoneInImage(t)},t.onmouseout=function(){var e=this.getAttribute("data-line");r.changeLinesHighlightStatus(e,"out"),r.switchingOffHighlightInImage()},t.onclick=function(){var t=this.getAttribute("data-line"),n=e.getState("currentHighlightedZone");n&&"Line"===n.name&&(r.changeLinesHighlightStatus(n.id,"unselect"),r.switchingOffHighlightInImage(),r.switchingOffHighlightInImageSelected()),!n||"Line"===n.name&&n.id!==t?(e.updateCurrentHighlightedZone({name:"Line",id:t}),r.changeLinesHighlightStatus(t,"select"),r.selectHighlightedZone(t)):e.updateCurrentHighlightedZone(void 0)})},r.resetTextNodes=function(){var e=document.getElementsByClassName("textNode");for(var t in e){var n=e[t];if(n&&n.textContent){var i=document.createTextNode(n.textContent);n.parentElement.replaceChild(i,n)}}},r.changeLinesHighlightStatus=function(t,n){var i="active"===e.getToolState("ITL"),r=e.getState("currentViewMode");if(i&&"imgTxt"===r)for(var o=document.querySelectorAll("[data-line='"+t+"']"),a=0;a<o.length;a++)switch(n){case"over":o[a].className+=" lineHover";break;case"out":o[a].className=o[a].className.replace(" lineHover","")||"";break;case"select":o[a].className+=" lineSelected";break;case"unselect":o[a].className=o[a].className.replace(" lineSelected","")||""}},r.prepareZoneInImgInteractions=function(){if(0==document.getElementsByClassName("line-overlay").length)for(var t=n.getZones()._indexes.filter((function(e){return e.includes("line")})),r=0;r<t.length;r++){var o=t[r];if(n.getZone(o).page===e.getState("currentPage"))i.lineZone(n.getZone(o))}};return r.highlightZoneInImage=function(t){if("active"===e.getToolState("ITL")){var r=n.getZone(t);r&&i.highlightOverlay(r)}},r.switchingOffHighlightInImage=function(){i.turnOffOverlay()},r.switchingOffHighlightInImageSelected=function(){i.turnOffOverlaySelected()},r.selectHighlightedZone=function(t){if("active"===e.getToolState("ITL")){var r=n.getZone(t.replace(o,"line"));i.turnOffOverlaySelected(),i.highlightSelectedOverlay(r,t.replace(o,"line")),i.moveToZone(r)}},r}])},function(e,t){angular.module("evtviewer.UItools").service("evtPinnedElements",["parsedData",function(e){var t={},n={_indexes:[],_indexesByType:{_types:[]}},i=[];return t.getElementsFromCookies=function(){var n=document.cookie.split(";");for(var i in n){var r=n[i].split("=");if("pinned"===r[0].trim())for(var o=JSON.parse(r[1]),a=0;a<o._indexes.length;a++){var s=o._indexes[a],l=o[s],c=!1;l&&("criticalApparatusEntry"===l.type?c=void 0!==e.getCriticalEntryById(s):l.type.indexOf("namedEntity")>=0&&(c=void 0!==e.getNamedEntity(s)),c&&t.addElement(o[s]))}}},t.addElement=function(e){n[e.id]=e,n._indexes.push(e.id),void 0===n._indexesByType[e.type]&&(n._indexesByType[e.type]=[],n._indexesByType._types.push(e.type)),n._indexesByType[e.type].push(e.id),document.cookie="pinned="+JSON.stringify(n)+"; 1"},t.removeElement=function(e){var t=n._indexes.indexOf(e.id);if(n._indexes.splice(t,1),n._indexesByType[e.type]){var i=n._indexesByType[e.type].indexOf(e.id);if(n._indexesByType[e.type].splice(i,1),0===n._indexesByType[e.type].length){delete n._indexesByType[e.type];var r=n._indexesByType._types.indexOf(e.type);n._indexesByType._types.splice(r,1)}}delete n[e.id],document.cookie="pinned="+JSON.stringify(n)+"; 1"},t.getPinnedData=function(){return n},t.getPinned=function(){return n._indexes},t.getAvailablePinnedTypes=function(){return n._indexesByType._types},t.getPinnedByType=function(e){return n._indexesByType[e]},t.getPinnedElement=function(e){return n[e]},t.getPinnedElementType=function(e){return n[e].type},t.isPinned=function(e){return void 0!==n[e]},t.addVisibleType=function(e){i.indexOf(e)<0&&i.push(e)},t.removeVisibleType=function(e){var t=i.indexOf(e);t>=0&&i.splice(t,1)},t.setAllTypesVisible=function(){i=t.getAvailablePinnedTypes()},t.resetVisibleTypes=function(){i=[]},t.getVisibleTypes=function(){return i},t}])},function(e,t){angular.module("evtviewer.box",[])},function(e,t){angular.module("evtviewer.box").constant("BOXDEFAULTS",{menuClosed:!1}).config(["evtBoxProvider","configProvider","BOXDEFAULTS",function(e,t,n){var i=t.makeDefaults("box",n);e.setDefaults(i)}])},function(e,t,n){angular.module("evtviewer.box").provider("evtBox",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["$log","$q","$timeout","config","parsedData","evtParser","evtCriticalParser","evtInterface","evtImageTextLinking","evtNamedEntityRef","evtGenericEntity","evtSourcesApparatus",function(t,n,i,r,o,a,s,l,c,u,d,h){var p={},f={},g=[],m=0,v=t.getInstance("box"),y=function(e,t){return this.state[e]=t,this.state[e]},b=function(e){return this.state[e]},_=function(){var e=this.uid;delete f[e]},x=function(e,t){var n=this.state.filters;void 0===n[e]&&(n[e]={name:e,any:!0,totActive:0,values:{length:0}}),void 0===n[e].totActive&&(n[e].totActive=0);var i=n[e].values;void 0===i[t]?(i[i.length]=t,i[t]={name:t,active:!0,color:o.getCriticalEntriesFilterColor(e,t)},i.length++):i[t].active=!i[t].active,i[t].active?(n[e].totActive++,n._totActive++):(n[e].totActive--,n._totActive--),n[e].any=0===n[e].totActive},w=function(e){this.state.filters[e].values={length:0},this.state.filters._totActive-=this.state.filters[e].totActive,this.state.filters[e].totActive=0},S=function(){void 0!==this.state.topBoxOpened&&(this.state.topBoxOpened=!this.state.topBoxOpened)},T=function(){void 0!==this.state.filterBox&&(this.state.filterBox=!this.state.filterBox)},E=function(e){this&&(this.topBoxContent=e)},C=function(){return"font-size:"+this.state.fontSize+"%"||!1},k=function(){this.state.fontSize=parseInt(this.state.fontSize)+4},L=function(){this.state.fontSize=parseInt(this.state.fontSize)-4},P=function(){this.state.fontSize="100"},A=function(){return"active"===l.getToolState("ITL")},O=function(){for(var e=u.getActiveEntityTypes(),t="",n=0;n<e.length;n++)t+=e[n]+"-active ";return t},I=function(){var e="";return 0===this.bottomMenuList.buttons.length&&0===this.bottomMenuList.selectors.length&&(e="noBottomMenu"),e};return p.build=function(t,u){var p,D,$=u.id||m++,N=u.model,M=u.type||"default",R=u.edition,B={selectors:[],buttons:[],appLabels:[]},H={selectors:[],buttons:[]},z={topBoxOpened:!1,fontSizeBtn:!1,fontSize:"100",topBoxContent:"",searchBox:!1},F=[],V=!0;if(void 0===f[$]){var j;switch(M){case"image":B.selectors.push({id:"page_"+$,type:"page",initValue:l.getState("currentPage")}),o.isITLAvailable()&&(B.buttons.push({title:"BUTTONS.IMAGE_TEXT_LINKING",label:"",icon:"itl",type:"itl"}),B.buttons.push({title:"BUTTONS.HOTSPOTS",label:"",icon:"hts",type:"hts"})),B.buttons.push({title:"BUTTONS.MS",label:"BUTTONS.MSD",type:"msDesc"}),r.enableNavBar||(r.thumbnailsButton&&B.buttons.push({title:"BUTTONS.THUMBNAILS",icon:"thumb-nails",type:"thumbNails"}),r.viscollButton&&B.buttons.push({title:"BUTTONS.VISCOLL",icon:"viscoll",type:"visColl"})),p=function(){t.vm.isLoading=!0;var e=l.getState("currentPage"),n=e?o.getPage(e):void 0,i=n?n.source:"";i=""===i?r.singleImagesUrl+e+".jpg":i,t.vm.content='<img src="'+i+'" alt="Image of page '+e+" of "+l.getState("currentDoc")+"\" onerror=\"this.setAttribute('src', 'images/fol_214v.jpg')\"/>";var a="",s=o.getZones();for(var c in s._indexes){var u=s[s._indexes[c]];if(u&&u.page===e){if(a+='<div class="zoneInImg" data-zone-id="'+u.id+'" data-zone-name="'+u.rendition+'"',u.corresp&&""!==u.corresp){var d=u.corresp.replace("#","");a+=' data-corresp-id="'+d+'"',"Line"===u.rendition?a+=' data-line="'+d+'"':"HotSpot"===u.rendition&&(a+=' data-hs="'+d+'"')}a+=">"+u.id+" ("+u.lrx+", "+u.lry+") ("+u.ulx+", "+u.uly+") </div>"}}t.vm.content+=a,t.vm.isLoading=!1};break;case"text":if("mainText"===$||"mainText1"===$?(H.buttons.push({title:"Search",label:"Search",icon:"search",type:"searchInternal",show:function(){return!0},disabled:function(){return!0}}),H.buttons.push({title:"Create index for enable search",label:"Create index",icon:"",type:"searchIndex",show:function(){return!0}})):H.buttons.push({title:"Search",label:"Search",icon:"search",type:"searchInternal",show:function(){return!0},disabled:function(){return!0}}),(r.showDocumentSelector&&o.getDocuments()._indexes.length>0||o.getDocuments()._indexes.length>1)&&B.selectors.push({id:"document_"+$,type:"document",initValue:l.getState("currentDoc")}),o.isCriticalEditionAvailable()){if(o.getDivs().length>0)(W=(U=l.getState("currentDocument"))?l.getState("currentDivs")[U]||o.getDocument(U).divs.find((function(e){return"body"===o.getDiv(e).section})):o.getDocument(o.getDocuments()._indexes[0]).divs.find((function(e){return"body"===o.getDiv(e).section})))&&B.selectors.push({id:"div_"+$,type:"div",initValue:W});B.buttons.push({title:"BUTTONS.WITNESSES_LIST",label:"",icon:"witnesses",type:"witList"}),"collation"===l.getState("currentViewMode")&&r.versions.length>1&&Object.keys(o.getVersionEntries()._indexes.versionWitMap>0)&&B.selectors.push({id:"version_"+$,type:"version",initValue:l.getState("currentVersion")})}else B.selectors.push({id:"page_"+$,type:"page",initValue:l.getState("currentPage")});(r.showEditionLevelSelector&&r.availableEditionLevel.length>0||r.availableEditionLevel.length>1)&&("comparing"===t.subtype?B.selectors.push({id:"comparingEditionLevel_"+$,type:"comparingEdition",initValue:l.getState("currentComparingEdition")}):B.selectors.push({id:"editionLevel_"+$,type:"edition",initValue:l.getState("currentEdition")})),B.buttons.push({title:"BUTTONS.INFO_ABOUT_TEXT",label:"BUTTONS.INFO",icon:"info-alt",type:"front"}),"tdhop"===l.getState("currentViewMode")&&B.buttons.push({title:"BUTTONS.3D",label:"BUTTONS.OBJ",type:"listObject"}),(F=o.getCriticalEntriesFiltersCollection()).forLemmas>0&&(B.buttons.push({title:"BUTTONS.COLOR_KEY",label:"",icon:"color-legend",type:"colorLegend"}),H.buttons.push({title:"BUTTONS.FILTERS",label:"BUTTONS.FILTERS",icon:"filters",type:"toggleFilterApp",show:function(){return"critical"===u.edition}}),F=F.filters),r.namedEntitiesSelector&&H.selectors.push({id:"namedEntities_"+$,type:"named-entities",initValue:"NONE",multiselect:!0}),z.filters={_totActive:0},z.filterBox=!1,z.docId=l.getState("currentDoc"),r.toolHeatMap&&H.buttons.push({title:"BUTTONS.HEAT_MAP",label:"BUTTONS.HEAT_MAP",icon:"heatmap",type:"heatmap",show:function(){return"text"===u.type&&"critical"===u.edition}}),H.buttons.push({title:"BUTTONS.FONT_CHANGE",label:"",icon:"font-size",type:"fontSizeTools",show:function(){return!0}}),p=function(){t.vm.isLoading=!0;var e,h=[],p="active"===l.getToolState("ITL"),f="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.ERROR_IN_PARSING_TEXT' | translate }} <br /> {{ 'MESSAGES.TRY_DIFFERENT_BROWSER_OR_CONTACT_DEVS' | translate }}</span>",g="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.TEXT_NOT_AVAILABLE' | translate }}</span>";if(t.vm.edition&&"critical"===t.vm.edition&&!u.version){if(e=o.getCriticalText(t.vm.state.docId))t.vm.content=e||g,t.vm.isLoading=!1,i((function(){d.highlightActiveTypes()}));else if(void 0!==(e=o.getDocument(t.vm.state.docId)))try{r.versions.length>2?h.push(s.parseCriticalText(e.content,t.vm.state.docId,r.versions[0]).promise):h.push(s.parseCriticalText(e.content,t.vm.state.docId).promise),n.all(h).then((function(){t.vm.content=o.getCriticalText(t.vm.state.docId)||g,t.vm.isLoading=!1,i((function(){d.highlightActiveTypes()}))}))}catch(e){v.log(e),j=f,t.vm.isLoading=!1}}else if(t.vm.edition&&"critical"===t.vm.edition&&t.vm.version){var m=l.getState("currentDoc");if(void 0===(e=t.vm.version===r.versions[0]?o.getCriticalText(m)||void 0:o.getVersionText(u.version,m)||void 0)){e=o.getDocument(t.vm.state.docId);try{h.push(s.parseCriticalText(e.content,t.vm.state.docId,t.vm.version).promise),n.all(h).then((function(){r.versions[0]===t.vm.version?t.vm.content=o.getCriticalText(t.vm.state.docId)||g:t.vm.content=o.getVersionText(u.version,m)||g,t.vm.isLoading=!1}))}catch(e){v.log(e),j=f,t.vm.isLoading=!1}}else t.vm.content=e||g,t.vm.isLoading=!1}else{var y=l.getState("currentPage"),b=l.getState("currentDoc"),_="comparing"===t.subtype?l.getState("currentComparingEdition"):l.getState("currentEdition");if(void 0===(e=o.getPageText(y,b,_))){e=o.getPageText(y,b,"original");try{h.push(a.parseTextForEditionLevel(y,b,_,e).promise),n.all(h).then((function(){t.vm.content=o.getPageText(y,b,_)||g,t.vm.isLoading=!1,p&&i((function(){c.prepareLines(),c.prepareZoneInImgInteractions()})),i((function(){d.highlightActiveTypes()}))}))}catch(e){v.log(e),j=f,t.vm.isLoading=!1}}else t.vm.content=e||g,t.vm.isLoading=!1,p&&i((function(){c.prepareLines(),c.prepareZoneInImgInteractions()})),i((function(){d.highlightActiveTypes()}));t.vm.isLoading=!1}};break;case"witness":var U,W,q=void 0!==u.witPage&&""!==u.witPage?u.witness+"-"+u.witPage:"";if(B.selectors.push({id:"witnesses_"+$,type:"witness",initValue:u.witness},{id:"page_"+$,type:"witness-page",initValue:q}),o.getDivs().length>0)(W=(U=l.getState("currentDocument"))?l.getState("currentDivs")[U]||o.getDocument(U).divs.find((function(e){return"body"===o.getDiv(e).section})):o.getDocument(o.getDocuments()._indexes[0]).divs.find((function(e){return"body"===o.getDiv(e).section})))&&B.selectors.push({id:"div_"+$+"_"+u.witness,type:"div",initValue:W});B.buttons.push({title:"BUTTONS.INFO_ABOUT_TEXT",label:"BUTTONS.INFO",icon:"info-alt",type:"toggleInfoWit"},{title:"BUTTONS.WITNESS_CLOSE",label:"",icon:"remove",type:"removeWit"}),(F=o.getCriticalEntriesFiltersCollection()).forVariants>0&&(H.buttons.push({title:"BUTTONS.FILTERS",label:"BUTTONS.FILTERS",icon:"filters",type:"toggleFilterApp",show:function(){return"true"}}),F=F.filters),z.filters={_totActive:0},z.filterBox=!1,H.buttons.push({title:"BUTTONS.FONT_CHANGE",label:"",icon:"font-size",type:"fontSizeTools",show:function(){return!0}}),p=function(){t.vm.isLoading=!0;var e="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.TEXT_OF_WITNESS_NOT_AVAILABLE' | translate:'{ witness:  \""+u.witness+"\" }' }}</span>";if(void 0!==u.witness){var i=l.getState("currentDoc"),r=o.getWitnessText(u.witness,i)||void 0;if(void 0===r){var a=o.getDocuments(),c="";if(a._indexes.length>0&&(c=a[i]),void 0!==c)try{var d=[];d.push(s.parseWitnessText(c.content,i,u.witness).promise),n.all(d).then((function(){t.vm.content=o.getWitnessText(u.witness,i)||e,t.vm.isLoading=!1}))}catch(e){v.log(e),t.vm.content="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.ERROR_IN_PARSING_TEXT' | translate }} <br /> {{ 'MESSAGES.TRY_DIFFERENT_BROWSER_OR_CONTACT_DEVS' | translate }}</span>",t.vm.isLoading=!1}else t.vm.content=e,t.vm.isLoading=!1}else t.vm.content=r,t.vm.isLoading=!1}};break;case"source":B.selectors.push({id:"sources_"+$,type:"source",initValue:l.getState("currentSourceText")}),B.buttons.push({title:"BUTTONS.BIBLIOGRAPHIC_REF",label:"",icon:"info",type:"toggleInfoSrc"}),H.buttons.push({title:"BUTTONS.FONT_CHANGE",label:"",icon:"font-size",type:"fontSizeTools",show:function(){return!0}}),p=function(){t.vm.isLoading=!0;var e="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.ERROR_IN_PARSING_TEXT' | translate }} <br /> {{ 'MESSAGES.TRY_DIFFERENT_BROWSER_OR_CONTACT_DEVS' | translate }}</span>",i="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.TEXT_OF_SOURCE_NOT_AVAILABLE' | translate:'{ source:  \""+t.vm.source+"\" }' }}</span>",r=o.getSource(t.vm.source),a=r?r.text:void 0;if(r&&0!==Object.keys(r.text).length&&void 0!==a)t.vm.content=a,t.vm.isLoading=!1;else{var c=o.getSourceDocument(t.vm.source);if(void 0!==c)try{var u=[];u.push(s.parseSourceText(c.content,t.vm.source).promise),n.all(u).then((function(){t.vm.content=o.getSource(t.vm.source).text||i,t.vm.isLoading=!1}));var d=h.getSource(o.getSource(l.getState("currentSourceText")));d&&E(d)}catch(n){v.log(n),t.vm.content=e,t.vm.isLoading=!1}else t.vm.content=e,t.vm.isLoading=!1}};break;case"version":o.getVersionEntries()._indexes.versionId[u.version];B.selectors.push({id:"version_"+$,type:"version",initValue:u.version}),l.getAllVersionsNumber()>2&&B.buttons.push({title:"BUTTONS.VERSION_CLOSE",label:"",icon:"remove",type:"removeVer"}),H.buttons.push({title:"BUTTONS.FONT_CHANGE",label:"",icon:"font-size",type:"fontSizeTools",show:function(){return!0}}),p=function(){t.vm.isLoading=!0;var e="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.TEXT_OF_VERSION_NOT_AVAILABLE' | translate:'{ version:  \""+u.version+"\" }' }}</span>";if(void 0!==u.version){var i=l.getState("currentDoc"),r=o.getVersionText(u.version,i)||void 0;if(void 0===r){var a=o.getDocuments(),c="";if(a._indexes.length>0&&(c=a[i]),void 0!==c)try{var d=[];d.push(s.parseCriticalText(c.content,i,u.version).promise),n.all(d).then((function(){t.vm.content=o.getVersionText(u.version,i)||e,t.vm.isLoading=!1}))}catch(e){v.log(e),t.vm.content="<span class=\"alert-msg alert-msg-error\">{{ 'MESSAGES.ERROR_IN_PARSING_TEXT' | translate }} <br /> {{ 'MESSAGES.TRY_DIFFERENT_BROWSER_OR_CONTACT_DEVS' | translate }}</span>",t.vm.isLoading=!1}else t.vm.content=e,t.vm.isLoading=!1}else t.vm.content=r,t.vm.isLoading=!1}};break;case"tdhop":if(B.selectors.push({id:"modelSelector",type:"generic",initValue:"Ruthwell Cross"}),B.buttons.push({title:"BUTTONS.IMAGE_TEXT_LINKING",label:"",icon:"itl",type:"itl"}),B.buttons.push({title:"BUTTONS.HOTSPOTS",label:"",icon:"hts",type:"hts"}),B.buttons.push({title:"BUTTONS.3D",label:"BUTTONS.OBJ",type:"objDesc"}),r.showObjectSelector){var G=JSON.stringify(r.tdhopViewerOptions.Models);B.selectors.push({id:"model_"+N,type:"model",initValue:G})}p=function(){t.vm.isLoading=!0;t.vm.source;t.vm.content=j,t.vm.isLoading=!1};break;default:V=!1,"pinnedBoard"===M?(B.buttons.push({title:"BUTTONS.BOARD_CLOSE",label:"",icon:"remove",type:"closePinned"}),r.toolPinAppEntries&&H.selectors.push({id:"pinnedFilter_"+$,type:"pinned-filter",initValue:"NONE",multiselect:!0})):B.buttons.push({title:"BUTTONS.BOX_CLOSE",label:"",icon:"remove",type:"removeBox"}),p=function(e){t.vm.content=e}}return D={currentEdition:R,uid:$,defaults:angular.copy(e),topMenuList:B,bottomMenuList:H,content:void 0,topBoxContent:'<span class="alert-msg">No info available</span>',state:z,appFilters:F,isLoading:V,genericTools:{fontSizeBtn:[{title:"BUTTONS.FONT_RESET",label:"",icon:"font-size-reset",type:"fontSizeReset"},{title:"BUTTONS.FONT_DECREASE",label:"",icon:"font-size-minus",type:"fontSizeDecrease"},{title:"BUTTONS.FONT_INCREASE",label:"",icon:"font-size-plus",type:"fontSizeIncrease"}]},osdTools:{osdBtn:[{title:"BUTTONS.ZOOM-RESET",label:"",icon:"zoom-reset",type:"zoomReset"},{title:"BUTTONS.ZOOM-OUT",label:"",icon:"zoom-out",type:"zoomOut"},{title:"BUTTONS.ZOOM-IN",label:"",icon:"zoom-in",type:"zoomIn"}]},updateContent:p,updateTopBoxContent:E,updateState:y,getState:b,destroy:_,toggleCriticalAppFilter:x,toggleFilterBox:T,toggleTopBox:S,clearFilter:w,fontSize:C,fontSizeIncrease:k,fontSizeDecrease:L,fontSizeReset:P,getNamedEntitiesActiveTypes:O,getAdditionalClass:I,isITLactive:A},f[$]=angular.extend(u,D),g.push({id:$,type:M}),f[$]}},p.getById=function(e){if("undefined"!==f[e])return f[e]},p.getList=function(){return g},p.getListByType=function(e){var t=[];for(var n in f)f[n].type===e&&t.push(f[n]);return t},p.getElementByValueOfParameter=function(e,t){var n;for(var i in f)f[i][e]===t&&(n=f[i]);return n},p.alignScrollToApp=function(e){for(var t in f)void 0!==f[t].scrollToAppEntry&&f[t].scrollToAppEntry(e)},p.alignScrollToQuote=function(e,t){for(var n in f)void 0!==f[n].scrollToQuotesEntry&&("source"===f[n].type?f[n].scrollToQuotesEntry(t):f[n].scrollToQuotesEntry(e))},p.alignScrollToAnalogue=function(e){for(var t in f)void 0!==f[t].scrollToAnaloguesEntry&&f[t].scrollToAnaloguesEntry(e)},p.getEditionById=function(e){return f[e].edition},p.getState=function(e,t){return f[e].state[t]},p.updateState=function(e,t,n){f[e].state[t]=n},p}]}))},function(e,t,n){(function(e){angular.module("evtviewer.box").directive("box",["$timeout","evtBox","evtInterface","xmlParser","config","parsedData","evtSearchResults","evtSearchBox","evtVirtualKeyboard","evtButtonSwitch",function(t,i,r,o,a,s,l,c,u,d){return{restrict:"E",scope:{id:"@",type:"@",subtype:"@",witness:"@",witpage:"@",edition:"@",source:"@",version:"@"},transclude:!0,template:n(176),link:function(n,h,p){n.vm={id:n.id,type:n.type,subtype:n.subtype,witness:n.witness,witPage:n.witpage,edition:n.edition,source:n.source,version:n.version};var f,g,m=i.build(n,n.vm),v=angular.element(h).find(".box")[0];t((function(){if(f=angular.element(h).find(".box-body")[0],g=angular.element(h).find(".box-top-box")[0],m.updateContent(),"witness"===m.type||"text"===m.type){var t,i,o=v.scrollTop+42,l=o+angular.element(v).height(),c=function(){s.getDivs().length>0&&function(){if("text"===m.type){for(var t=angular.element(h).find(".div"),i=0,a=!1,c="";i<t.length&&!a;){c=t[i].getAttribute("id");var u,d=e("#"+c).offset();d&&(u=d.top),u&&u<=l&&u>=o?a=!0:i++}a&&c&&s.getDiv(c)&&n.vm.state.divId!==c&&(n.vm.state.divId=c,r.updateDiv(s.getDiv(c).doc,c),r.updateUrl())}}(),s.getPages().length>0&&function(){if("witness"===m.type){for(var t=angular.element(h).find(".pb"),i=0,a=!1,s="";i<t.length&&!a;){s=t[i].getAttribute("data-id");var c,u=e("span.pb[data-id='"+s+"']").offset();u&&(c=u.top),c&&c<=l&&c>=o?a=!0:i++}a&&r.getCurrentWitnessPage(n.witness)!==id.split("-")[1]&&(r.updateWitnessPage(n.witness,id.split("-")[1]),r.updateUrl())}}()};angular.element(f).on("DOMMouseScroll mousewheel scroll",(function(){t&&window.clearTimeout(t),t=window.setTimeout(c(),1e3)})),angular.element(g).on("DOMMouseScroll mousewheel scroll",(function(){i&&window.clearTimeout(i),i=window.setTimeout(c(),1e3)}))}m.type,y(n,a.xsltUrl)}));var y=function(e,t){if(""!==t){var i=o.parse(n.vm.content),r=function(e){var t;(t=window.ActiveXObject?new ActiveXObject("Msxml2.XMLHTTP"):new XMLHttpRequest).open("GET",e,!1);try{t.responseType="msxml-document"}catch(e){}return t.send(""),t.responseXML}(t);if(window.ActiveXObject){var a=i.transformNode(r);n.vm.content=a}else if(document.implementation&&document.implementation.createDocument){var s=new XSLTProcessor;s.importStylesheet(r);var l=s.transformToFragment(i,document);n.vm.content=l}}};if(n.vm.getTotElementsOfType=function(e){return i.getListByType(e).length},"witness"===m.type||"text"===m.type||"version"===m.type){n.vm.scrollToPage=function(n){t((function(){var t=e("#"+m.uid).find("#pb_"+n),i=1*window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","");t.length>0&&void 0!==t[0]&&(f.scrollTop=t[0].offsetTop-i)}))},n.vm.scrollToAppEntry=function(n){t((function(){var t=e("#"+m.uid).find("[data-app-id='"+n+"']"),i=1*window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","");t.length>0&&void 0!==t[0]&&(f.scrollTop=t[0].offsetTop-i)}))},n.vm.scrollToDiv=function(n){t((function(){var t=e("#"+n),i=1*window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","");t.length>0&&void 0!==t[0]&&(f.scrollTop=t[0].offsetTop-i)}))};var b,_=r.getState("currentAppEntry"),x=r.getState("currentDoc"),w=r.getState("currentDivs"),S=w?w[x]:void 0;"witness"===m.type?b=n.vm.witness+"-"+r.getCurrentWitnessPage(n.vm.witness):"text"===m.type&&(b=r.getState("currentPage")),n.vm.scrollToPage(b),S&&n.vm.scrollToDiv(S),n.vm.scrollToAppEntry(_),n.$watch((function(){return r.getState("currentDivs")}),(function(e,t){if(t!==e){var i=r.getState("currentDoc"),o=e?e[i]:void 0;o&&n.vm.state.divId!==o&&(n.vm.state.divId=o,n.vm.scrollToDiv(o))}}),!0)}"witness"!==m.type&&"text"!==m.type&&"textdhop"!==m.type||(n.$watch((function(){return r.getState("currentDoc")}),(function(e,t){if(t!==e&&n.vm.state.docId!==e)if(n.vm.state.docId=e,n.vm.isLoading=!0,m.updateContent(),"text"===n.vm.currentType){var i=s.getDocument(e),r=i?i.front:void 0,o=r&&r.parsedContent?r.parsedContent:"<div class=\"warningMsg\">{{ 'MESSAGES.FRONT_NOT_AVAILABLE' | translate }}</div>";n.vm.updateTopBoxContent(o)}else if("image"===n.vm.currentType){var a=s.getProjectInfo().msDesc?s.getProjectInfo().msDesc:"<div class=\"warningMsg\">{{ 'MESSAGES.FRONT_NOT_AVAILABLE' | translate }}</div>";n.vm.updateTopBoxContent(a)}else if("tdhop"===n.vm.currentType||"text"===n.vm.currentType){var l=s.getProjectInfo().listObject?s.getProjectInfo().listObject:"<div class=\"warningMsg\">{{ 'MESSAGES.FRONT_NOT_AVAILABLE' | translate }}</div>";!s.getProjectInfo().listObject||s.getProjectInfo().listObject,n.vm.updateTopBoxContent(l)}}),!0),n.$watch((function(){return n.vm.state.filters._totActive}),(function(e,n){n!==e&&t((function(){var e=angular.element(h).find(".filters-in-box")[0],t=angular.element(e).height(),n=angular.element(h).find(".box-body > *:last-child")[0];angular.element(n).css("margin-bottom",t+20+"px")}))}),!0)),"witness"!==m.type&&"text"!==m.type&&"version"!==m.type||(n.vm.scrollToQuotesEntry=function(n){t((function(){var t=e("#"+m.uid).find("[data-quote-id='"+n+"']"),i=1*window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","");t.length>0&&void 0!==t[0]&&(f.scrollTop=t[0].offsetTop-i)}))},n.vm.scrollToAnaloguesEntry=function(n){t((function(){var t=e("#"+m.uid).find("[data-analogue-id='"+n+"']"),i=1*window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","");t.length>0&&void 0!==t[0]&&(f.scrollTop=t[0].offsetTop-i)}))},n.vm.scrollToVersionApparatus=function(n){t((function(){var t=e("#"+m.uid).find("evt-version-apparatus-entry[data-app-id='"+n+"']");window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","");if(t.length>0&&void 0!==t[0]){var i=angular.element(t[0]).position().top,r=t[0].offsetParent.clientHeight,o=e("#"+m.uid).find("div[class='version-apparatus-entry']"),a=angular.element(o).outerHeight()||0;i+a>r&&(f.scrollTop+=i-r+a)}}))}),"source"===m.type&&(n.vm.scrollToQuotesEntry=function(n){t((function(){var t=e("#"+m.uid).find("[data-seg-id='"+n+"']"),i=1*window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","");t.length>0&&void 0!==t[0]&&(f.scrollTop=t[0].offsetTop-i)}))}),"text"===m.type&&("comparing"===m.subtype?n.$watch((function(){return r.getState("currentComparingEdition")}),(function(e,i){i!==e&&n.vm.edition!==e&&(n.vm.edition=e,m.updateContent(),u.unselectCurrentKeyboard(d,m.id),t((function(){var e=n.id,t=c.getInputValue(e);""!==t&&l.highlightSearchResults(e,t)})))}),!0):n.$watch((function(){return r.getState("currentEdition")}),(function(e,i){i!==e&&n.vm.edition!==e&&(n.vm.edition=e,m.updateContent(),u.unselectCurrentKeyboard(d,m.id),t((function(){var e=n.id,t=c.getInputValue(e);""!==t&&l.highlightSearchResults(e,t)})))}),!0),n.$watch((function(){var e=n.id;return i.getState(e,"searchBox")}),(function(n,i){!0===n&&t((function(){e("input").trigger("focus")}),100)}),!0),n.$watch((function(){return r.getState("currentPage")}),(function(e,i){m.updateContent(),t((function(){var e=n.id,t=c.getInputValue(e);""!==t&&l.highlightSearchResults(e,t)}))}),!0)),"image"===m.type&&n.$watch((function(){return r.getState("currentPage")}),(function(e,t){t!==e&&n.vm.state.docId!==e&&(n.vm.state.pageId=e,m.updateContent())}),!0),"source"===m.type&&(n.$watch((function(){return r.getProperty("isSourceLoading")}),(function(e,t){t!==e&&(e||(n.vm.source=r.getState("currentSourceText"),m.updateContent()))})),n.$watch((function(){return r.getState("currentSourceText")}),(function(e,t){t!==e&&r.getProperty("parsedSourcesTexts").indexOf(e)>=0&&(n.vm.source=e,m.updateContent())}))),"text"===m.type&&"collation"===r.getState("currentViewMode")&&n.$watch((function(){return r.getState("currentVersion")}),(function(e,t){n.vm.version=e,m.updateContent()})),n.$on("$destroy",(function(){m&&m.destroy()}))}}}])}).call(this,n(0))},function(e,t){e.exports='<section class="box box-{{::vm.type}}"\n         id="{{::vm.uid}}"\n         data-position="left"\n         data-getTotElementsOfType="{{vm.getTotElementsOfType(\'witness\')}}"\n         ng-class="{\'span9of9\' : (vm.type === \'witness\' && vm.getTotElementsOfType(\'witness\') === 1) || (vm.type === \'version\' && vm.getTotElementsOfType(\'version\') === 1),\n                    \'span6of12\': vm.type === \'witness\' && vm.getTotElementsOfType(\'witness\') === 2 || (vm.type === \'version\' && vm.getTotElementsOfType(\'version\') === 2),\n                    \'span6of18\': (vm.type === \'witness\' && vm.getTotElementsOfType(\'witness\') === 3) || (vm.type === \'version\' && vm.getTotElementsOfType(\'version\') === 3) || (vm.type === \'text\' && vm.getTotElementsOfType(\'version\') > 1) || (vm.type === \'text\' && vm.getTotElementsOfType(\'witness\') > 1) || (vm.type === \'critical_apparatus\'),\n                    \'topBoxOpened\': vm.state.topBoxOpened,\n                    \'filterNotActive\': vm.state.filters._totActive <= 0,\n                    \'ITLactive\': vm.isITLactive()}">\n\n    <div class="box-menu"\n        data-position="top"\n        ng-if="::vm.type !== \'critical_apparatus\'  && vm.type !== \'empty\' && vm.type !== \'tdhop\'">\n\n        <evt-select\n            data-id="{{::selector.id}}"\n            data-type="{{::selector.type}}"\n            data-init="{{::selector.initValue}}"\n            ng-repeat="selector in ::vm.topMenuList.selectors track by $index">\n        </evt-select>\n        <button-switch\n            title="{{::button.title}}"\n            data-label="{{::button.label}}"\n            data-icon="{{::button.icon}}"\n            data-icon-pos="{{::button.iconPos}}"\n            data-type="{{::button.type}}"\n            ng-repeat="button in ::vm.topMenuList.buttons track by $index">\n        </button-switch>\n    </div>\n    \x3c!-- add by FS button switch --\x3e\n    <div class="box-menu" data-position="top" ng-if="::vm.type === \'tdhop\'">\n    </div>\n\n    <div\n        class="box-top-box avoidBlur"\n        ng-class="{\'open\': vm.state.topBoxOpened}"\n        compile="::vm.topBoxContent">\n    </div>\n\n    <div ng-if="::vm.type !== \'image\' && vm.type !== \'tdhop\'"\n         class="box-body {{vm.edition}}Edition {{vm.getNamedEntitiesActiveTypes()}} {{vm.getAdditionalClass()}}"\n         ng-class="{\n             \'search-opened\': vm.getState(\'searchBox\')\n         }"\n         style="{{vm.fontSize();}}"\n         id="box_body_{{::vm.uid}}"\n         compile="::vm.content" ng-transclude>\n    </div>\n\n    <div ng-if="::vm.type === \'image\'"\n         class="box-body {{vm.edition}}Edition {{vm.getNamedEntitiesActiveTypes()}} {{vm.getAdditionalClass()}}"\n         style="{{vm.fontSize();}}"\n         id="box_body_{{::vm.uid}}">\n\n         <div ng-app="evtviewer.imageViewer" ng-controller="imageViewerCtrl" style="height:100%">\n            <osd name="osdViewer"></osd>\n            \x3c!--i class="icon icon-evt_imgtxt buttonSwitch-icon"> </i--\x3e\n         </div>\n    </div>\n\n    <div  ng-if="::vm.type === \'tdhop\'"\n     class="box-body {{vm.edition}}Edition {{vm.getNamedEntitiesActiveTypes()}} {{vm.getAdditionalClass()}}" style="padding: 0px;" ng-controller="TreDHOPCtrl">\n      <evt-tredhop id=\'tdhop\' name="tredhopViewer">\n            \x3c!--div  class=\'box-tdhop box-body Edition noBottomMenu\'></div--\x3e\n      </evt-tredhop>\n   </div>\n\n    \x3c!-- <div class="box-body" id="box_body_{{vm.uid}}">{{ vm.content }}</div> --\x3e\n    <div class="loading" ng-if="vm.isLoading"><i class="fa fa-spinner fa-pulse loader"></i></div>\n    <div class="filters-in-box"\n         ng-if="(vm.type==\'witness\' || vm.type==\'text\') && vm.state.filters._totActive > 0">\n        <span\n            class="filter-group"\n            ng-repeat="filter in vm.state.filters track by $index"\n            ng-if="filter.totActive > 0">\n            <span\n                class="filter-value"\n                ng-repeat="value in filter.values track by $index"\n                ng-if="filter.values[value].active"\n                ng-click="vm.toggleCriticalAppFilter(filter.name, filter.values[value].name);"\n                style="background:{{::filter.values[value].color}}"\n                title="Remove \'\'{{::filter.values[value].name}}\'\'">\n                {{::filter.values[value].name}}\n            </span>\n        </span>\n    </div>\n    \x3c!-- <div class="box-bottom-box"> </div> --\x3e\n    <div\n        class="filters-box"\n        ng-if="::vm.type==\'witness\' || vm.type==\'text\'"\n        ng-class="{\'open\': vm.state.filterBox}">\n\n        <div class="filter-group"\n             ng-repeat="filter in vm.appFilters track by $index"\n             ng-if="::(vm.type==\'witness\' && filter.possibleFor.variant) || (vm.type==\'text\' && filter.possibleFor.lemma)">\n            <div class="filters-section-title">{{::filter.name}}</div>\n            <div class="filter-value-outer">\n                <div\n                    class="filter-value">\n                    <span\n                        class="filter-value-label filter-any"\n                        title="Toggle \'\'any\'\'"\n                        ng-class="{\'active\': vm.state.filters[filter.name] === undefined || vm.state.filters[filter.name].totActive === 0}"\n                        ng-click="vm.clearFilter(filter.name);"> any </span>\n                </div>\n            </div>\n            <div class="filter-value-outer" ng-repeat="value in filter.values track by $index">\n                <div\n                    style="background:{{::value.color}}"\n                    class="filter-value">\n                    <span\n                        class="filter-value-label"\n                        title="Toggle \'\'{{::value.name}}\'\'"\n                        ng-class="{\'active\': vm.state.filters[filter.name].values[value.name].active !== undefined && vm.state.filters[filter.name].values[value.name].active}"\n                        ng-click="vm.toggleCriticalAppFilter(filter.name, value.name);">\n                        {{::value.name}}</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n   <evt-search-box\n        ng-if="vm.type==\'text\'"\n        ng-controller="SearchBoxCtrl as searchBox">\n    </evt-search-box>\n\n   \x3c!--<evt-search-box-index\n      ng-if="vm.type==\'text\'">\n   </evt-search-box-index>--\x3e\n\n    <div\n        class="tools-group-box"\n        ng-if="::vm.type!==\'image\'"\n        ng-class="{\'open\': vm.getState(\'fontSizeBtn\')}">\n        <div\n            class="fontSizeBtnGroup">\n            <button-switch\n                class="no-background"\n                title="{{::button.title}}"\n                data-label="{{::button.label}}"\n                data-icon="{{::button.icon}}"\n                data-icon-pos="{{::button.iconPos}}"\n                data-type="{{::button.type}}"\n                ng-repeat="button in vm.genericTools.fontSizeBtn track by $index">\n            </button-switch>\n        </div>\n    </div>\n\n    <div\n        class="box-menu"\n        data-position="bottom"\n        ng-if="::vm.bottomMenuList.buttons.length > 0 || vm.bottomMenuList.selectors.length > 0">\n        <evt-select\n            data-id="{{::selector.id}}"\n            data-type="{{::selector.type}}"\n            data-init="{{::selector.initValue}}"\n            data-open-up="true"\n            data-multiselect="{{::selector.multiselect}}"\n            ng-repeat="selector in ::vm.bottomMenuList.selectors track by $index">\n        </evt-select>\n\n        <button-switch\n            title="{{::button.title}}"\n            data-label="{{::button.label}}"\n            data-icon="{{::button.icon}}"\n            data-icon-pos="{{::button.iconPos}}"\n            data-type="{{::button.type}}"\n            ng-repeat="button in vm.bottomMenuList.buttons track by $index"\n            ng-if="button.show()">\n        </button-switch>\n    </div>\n</section>\n'},function(e,t){angular.module("evtviewer.select",[])},function(e,t){angular.module("evtviewer.select").constant("SELECTORDEFAULTS",{expanded:!1,elementWidth:150,containerMaxHeight:170}).config(["evtSelectProvider","configProvider","SELECTORDEFAULTS",function(e,t,n){var i=t.makeDefaults("select",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.select").provider("evtSelect",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["$log","config","Utils","parsedData","evtInterface","evtNamedEntityRef","evtGenericEntity","evtPinnedElements","evtSourcesApparatus",function(t,n,i,r,o,a,s,l,c){var u={},d={},h=[],p=0;t.getInstance("select");return u.build=function(t,u){var f,g,m,v,y,b,_,x=t.id||p++,w=t.type||"default",S=t.init||void 0,T=t.openUp||!1,E=t.multiselect||!1,C=[];if(void 0===d[x]){switch(w){case"page":m=function(e,t){if(void 0!==t){u.selectOption(t);var n=o.getState("currentDoc");o.updateState("currentPage",t.value),t.docs.length>0&&t.docs.indexOf(n)<0&&o.updateState("currentDoc",t.docs[0]),o.updateUrl()}},y=function(e){return e},C=(v=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[e[n]]);return t})(r.getPages());break;case"document":m=function(e,t){if(void 0!==t){u.selectOption(t);var n=o.getState("currentPage");o.updateState("currentDoc",t.value),t.pages.length>0&&t.pages.indexOf(n)<0&&o.updateState("currentPage",t.pages[0]),t.divs.length>0&&o.updateDiv(t.value,t.divs[0]),o.updateUrl()}},y=function(e){return e},C=(v=function(e){for(var t=[],n=0;n<e._indexes.length;n++)t.push(e[e._indexes[n]]);return t})(r.getDocuments());break;case"div":m=function(e,t){if(t){u.selectOption(t);var n=t.doc;o.updateDiv(n,t.value),o.updateUrl()}},v=function(e,t,n){var i=r.getDivs();angular.forEach(e,(function(e){i[e].section===n&&(!i[e]._isSubDiv&&i[e].subDivs.length>0&&(i[e].type="groupTitle"),t.push(i[e]),r.getDivs()._indexes.subDivs[e]&&r.getDivs()._indexes.subDivs[e].length>0&&v(i[e].subDivs,t,n))}))},y=function(e){return e};var k=o.getState("currentDoc"),L=r.getDiv(o.getState("currentDivs")[k]),P=L?L.section:"body";v(r.getDivs()._indexes.main[k],C,P);break;case"edition":case"comparingEdition":m=function(e,t){var n,i;void 0!==t&&void 0!==e&&void 0!==e[0]&&t.value!==e[0].value&&(u.selectOption(t),"edition"===w?(n="currentEdition",i="currentComparingEdition"):"comparingEdition"===w&&(n="currentComparingEdition",i="currentEdition"),o.getState(i)===t.value&&o.updateState(i,e[0].value),o.updateState(n,t.value),o.updateUrl())},y=function(e){return e},C=(v=function(e){return e})(r.getEditions());break;case"named-entities":g=S,b={value:"ALL",label:"SELECTS.SELECT_ALL",title:"SELECTS.SELECT_ALL_NAMED_ENTITIES",additionalClass:"doubleBorderTop"},m=function(e,t){if(void 0!==t)if(u.selectOption(t),"ALL"===t.value){for(var n=C&&C.length>3?C.length-2:0,i=0;i<n;i++){var r=C[i];u.isOptionSelected(r)||(u.selectOption(r),"namedEntity"===r.type?a.addActiveType(r.value):"groupTitle"!==r.type&&s.addActiveType(r.value,r.color))}u.selectOption(t)}else if("NONE"===t.value){for(var o=u.optionSelected?u.optionSelected:[],l=0;l<o.length;l++){var c=C[l];"ALL"!==c.value&&("namedEntity"===c.type?a.removeActiveType(c.value):s.removeActiveType(c.value,c.color))}u.optionSelected=[],u.selectOption(t)}else"namedEntity"===t.type?u.isOptionSelected(t)?a.addActiveType(t.value):a.removeActiveType(t.value):u.isOptionSelected(t)?s.addActiveType(t.value,t.color):s.removeActiveType(t.value,t.color)},y=function(e){return e};var A=(v=function(e,t){var n=[];if(e)for(var i=0;i<e.length;i++){var o=e[i];if(o.available){var a="fa-circle";"namedEntity"===t&&(a=r.getNamedEntityTypeIcon(o.tagName)||a);var s={icon:a,type:t,value:o.tagName,label:o.label,title:o.label,color:o.color};n.push(s)}}return n})(n.namedEntitiesToHandle,"namedEntity"),O=v(n.otherEntitiesToHandle,"");C=[],A.length>0&&(C.push({label:"SELECTS.NAMED_ENTITIES",type:"groupTitle"}),C=C.concat(A)),O.length>0&&(C.push({label:"SELECTS.OTHER_ENTITIES",type:"groupTitle"}),C=C.concat(O)),C.length>0&&(C.push(b),C.push({value:"NONE",label:"SELECTS.CLEAR",title:"SELECTS.CLEAR_SELECTION"}));break;case"witness":g=S,m=function(e,t){u.collapse(),void 0!==e&&void 0!==e[0]?void 0!==t&&(o.switchWitnesses(e[0].value,t.value),o.updateUrl()):void 0!==t&&(o.addWitness(t.value),o.updateUrl())},y=function(e){return{value:e.id,label:e.id,title:e.description}},C=(v=function(e){for(var t=[],i=e._indexes.witnesses,r=0;r<i.length;r++){var a=e[i[r]],s={value:a.id,label:a.id,title:a.description};(n.versions.length>0&&o.getProperty("availableWitnesses").indexOf(i[r])>=0||n.versions.length<=0)&&t.push(s)}return t})(r.getWitnesses());break;case"witness-page":var I=t.$parent.vm.witness;g=S,m=function(e,n){void 0!==n&&(u.selectOption(n),o.updateWitnessesPage(I,n.value.split("-")[1]),o.updateUrl(),t.$parent.vm.scrollToPage(n.value))},y=function(e){return e},C=(v=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[e[n]]);return t})(r.getWitnessPages(I));break;case"pinned-filter":g=S,f=[],b={value:"ALL",label:"SELECTS.SELECT_ALL",title:"SELECTS.SELECT_ALL_TYPES",additionalClass:"doubleBorderTop"},m=function(e,t){if(void 0!==t)if(u.selectOption(t),"ALL"===t.value){for(var n=C&&C.length>3?C.length-2:0,i=0;i<n;i++){var r=C[i];u.isOptionSelected(r)||u.selectOption(r)}l.setAllTypesVisible(),u.selectOption(t)}else"NONE"===t.value?(u.optionSelected=[],u.selectOption(t),l.resetVisibleTypes()):u.isOptionSelected(t)?l.addVisibleType(t.value):l.removeVisibleType(t.value)},v=function(e){var t=[];if(e)for(var n=0;n<e.length;n++){var i=e[n],r={value:i,label:i,title:i};t.push(r)}return t.length>0&&(t.push(b),t.push({value:"NONE",label:"SELECTS.CLEAR",title:"SELECTS.CLEAR_SELECTION"})),t},y=function(e){return e};var D=l.getAvailablePinnedTypes();C=v(D);break;case"source":m=function(e,t){void 0!==t&&(u.selectOption(t),o.updateCurrentSourceText(t.value),o.updateState("currentSource",t.value))},y=function(e){return{value:e.id,label:c.getSourceAbbr(e),title:"SELECTS.SEE_FULL_TEXT"}},C=(v=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r={value:i.id,label:c.getSourceAbbr(i),title:"SELECTS.SEE_FULL_TEXT"};t.push(r)}return t})(r.getSources()._indexes.availableTexts);break;case"version":g=S,m=function(e,t){u.collapse(),"collation"!==o.getState("currentViewMode")?void 0!==e?void 0!==t&&o.switchVersions(e[0].value,t.value):void 0!==t&&o.addVersion(t.value):void 0!==t&&(o.updateCurrentVersion(t.value),o.updateAvailableWitnessesByVersion(t.value))},y=function(e){var t=r.getVersionEntries()._indexes.versionId[e];return{value:e,label:i.DOMutils.decodeHTMLEntities(t),title:"MESSAGES.SEE_VERSION_TEXT"}},C=(v=function(e){var t=[],a=e._indexes.versionId;for(var s in a){var l,c;if("collation"!==o.getState("currentViewMode"))s!==n.versions[0]&&"_name"!==s&&(l=a[s],c={value:s,label:i.DOMutils.decodeHTMLEntities(l),title:"MESSAGES.SEE_VERSION_TEXT"},t.push(c));else{var u=r.getVersionEntries()._indexes.versionWitMap[s];void 0!==u&&u.length>0&&(l=a[s],c={value:s,label:i.DOMutils.decodeHTMLEntities(l),title:"MESSAGES.SEE_WITNESS"},t.push(c))}}return t})(r.getVersionEntries());break;case"generic":C=t.options,g=S,m=function(e,t){u.collapse(),u.selectOption(t)}}return t.emptyOption&&C&&(!C[0]||C[0].value)&&C.unshift({value:"",label:"---",title:""}),_={uid:x,defaults:angular.copy(e),callback:m,initValue:S,currentType:w,multiselect:E,openUp:T,smaller:t.smaller,selectedOption:t.selectedOption,optionList:C,optionSelected:f,optionSelectedValue:g,formatOptionList:v,formatOption:y},d[x]=angular.extend(u,_),h.push({id:x,type:w}),d[x]}},u.getById=function(e){if(void 0!==d[e])return d[e]},u.getList=function(){return h},u.expandById=function(e,t){"undefined"!==d[e]&&(d[e].expand(),t&&u.closeAll())},u.closeAll=function(e){angular.forEach(d,(function(t,n){n!==e&&t.collapse()}))},u.addOption=function(e,t){"undefined"!==d[e]&&d[e].optionList.push(t)},u.setCallback=function(e,t){"undefined"!==d[e]&&(d[e].callback=t)},u.destroy=function(e){delete d[e]},u}]}))},function(e,t){angular.module("evtviewer.select").controller("SelectCtrl",["$log","$element","$scope","evtSelect","parsedData",function(e,t,n,i,r){var o=this;e.getInstance("select");o.expand=function(){o.expanded=!0},o.collapse=function(){o.expanded=!1},o.toggleExpand=function(e){e||i.closeAll(o.uid),o.openUp&&o.updateContainerPosition(o.currentType),o.expanded=!o.expanded},o.getOptionSelected=function(){return o.optionSelected&&o.optionSelected.length>0?1===o.optionSelected.length?o.optionSelected[0]:{value:"MULTI",label:"SELECTS.MULTIPLE_SELECTION",title:"SELECTS.MULTIPLE_OPTIONS_SELECTED"}:{value:"",label:"SELECTS.NO_SELECTION",title:"SELECTS.OPEN_TO_SELECT_ELEMENT"}},o.selectOption=function(e){if(e){if(o.expanded&&o.toggleExpand(),"NONE"===e.value&&o.multiselect&&(e={value:"",label:"SELECTS.NO_SELECTION",title:"SELECTS.OPEN_TO_SELECT_ELEMENT"}),o.multiselect){var t=o.getSelectedOptionIndex(e);t>=0?o.optionSelected.splice(t,1):(void 0===o.optionSelected?o.optionSelected=[]:o.optionSelected.length>0&&(""!==o.optionSelected[0].value&&"ALL"!==o.optionSelected[0].value&&"NONE"!==o.optionSelected[0].value||o.optionSelected.splice(0,1)),o.optionSelected.push(e))}else o.optionSelected=[e];o.optionSelected&&o.optionSelected.length>1?o.optionSelectedValue="SELECTS.MULTIPLE_SELECTION":o.optionSelectedValue=void 0!==e?e.value:void 0}},o.getSelectedOptionIndex=function(e){for(var t=o.optionSelected||[],n=0,i=!1;n<t.length&&!i;)i=t[n].value===e.value,n++;return i?n-1:-1},o.selectOptionByValue=function(e){var t;if(void 0!==e&&""!==e)switch(o.currentType){case"page":t=o.formatOption(r.getPage(e));break;case"document":t=o.formatOption(r.getDocument(e));break;case"div":t=o.formatOption(r.getDiv(e));break;case"edition":case"comparingEdition":t=o.formatOption(r.getEdition(e));break;case"witness":t=o.formatOption(r.getWitness(e));break;case"witness-page":t=o.formatOption(r.getPage(e));break;case"source":var n,i=r.getSources()._indexes.availableTexts;for(var a in i)i[a].id===e&&(n=i[a]);t=o.formatOption(n);break;case"version":t=o.formatOption(e);break;case"generic":if(o.optionList)t=(s=o.optionList.filter((function(t){return t.value===e})))?s[0]:void 0;break;default:var s;if("NONE"===e&&o.multiselect)t={value:"",label:"SELECTS.NO_SELECTION",title:"SELECTS.OPEN_TO_SELECT_ELEMENT"};else if(o.optionList)t=(s=o.optionList.filter((function(t){return t&&t.value===e})))&&s[0]?s[0]:o.optionList[0]}else t="NONE"===e&&o.multiselect?{value:"",label:"SELECTS.NO_SELECTION",title:"SELECTS.OPEN_TO_SELECT_ELEMENT"}:o.optionList[0];void 0!==t&&o.selectOption(t)},o.isOptionSelected=function(e){if(void 0!==e){if(void 0===o.optionSelected)return;if(o.multiselect){for(var t=o.optionSelected||[],n=0,i=!1;n<t.length&&!i;)i=t[n].value===e.value,n++;return i}return o.optionSelected&&1===o.optionSelected.length&&o.optionSelected[0].value===e.value}},o.doCallback=function(e,t){o.callback(e,t),n.onOptionSelected({option:t})},o.destroy=function(){var e=o.uid;i.destroy(e)}}])},function(e,t,n){angular.module("evtviewer.select").directive("evtSelect",["$timeout","evtSelect","evtInterface","evtPinnedElements","parsedData",function(e,t,i,r,o){return{restrict:"E",scope:{id:"@",type:"@",init:"@",openUp:"@",multiselect:"@",options:"=",smaller:"@",emptyOption:"@",selectedOption:"@",onOptionSelected:"&"},template:n(182),controllerAs:"vm",controller:"SelectCtrl",link:function(n,a){var s=t.build(n,n.vm);if(n.vm.updateContainerPosition=function(e){var t,n=a.find(".option_container");a.find(".selector"),a.find(".label_selected");n.css("position","absolute"),t=n.height()+2,n.css("margin-top",-t+"px")},e((function(){if(s.openUp&&s.updateContainerPosition(n.type),void 0!==s)if(void 0!==n.init&&""!==n.init)s.selectOptionByValue(n.init);else if(!n.multiselect){var e=n.vm.optionList?n.vm.optionList[0]:void 0;s.callback(void 0,e)}if("div"===n.type){var t=i.getState("currentDoc"),r=i.getState("currentDivs"),o=r?r[t]:void 0;o&&s.selectOptionByValue(o)}})),n.$watch((function(){return n.selectedOption}),(function(e,t){t!==e&&s.selectOptionByValue(n.selectedOption)}),!0),"witness-page"===n.type){var l=n.$parent.vm.witness;n.$watch((function(){return i.getCurrentWitnessPage(l)}),(function(e,t){t!==e&&s.selectOptionByValue(l+"-"+e)}),!0)}"page"===n.type&&n.$watch((function(){return i.getState("currentPage")}),(function(e,t){t!==e&&s.selectOptionByValue(e)}),!0),"edition"===n.type&&n.$watch((function(){return i.getState("currentEdition")}),(function(e,t){t!==e&&s.selectOptionByValue(e)}),!0),"comparingEdition"===n.type&&n.$watch((function(){return i.getState("currentComparingEdition")}),(function(e,t){t!==e&&s.selectOptionByValue(e)}),!0),"source"===n.type&&n.$watch((function(){return i.getState("currentSource")}),(function(e,t){t!==e&&s.selectOptionByValue(e)}),!0),"document"===n.type&&n.$watch((function(){return i.getState("currentDoc")}),(function(e,t){t!==e&&s.selectOptionByValue(e)}),!0),"div"===n.type&&n.$watch((function(){var e=i.getState("currentDoc");return i.getState("currentDivs")[e]}),(function(e,t){if(t!==e){var n=o.getDiv(t),i=o.getDiv(e);n&&i&&(s.optionList=[],s.formatOptionList(o.getDivs()._indexes.main[i.doc],s.optionList,i.section)),s.selectOptionByValue(e)}}),!0),"version"===n.type&&"collation"===i.getState("currentViewMode")&&n.$watch((function(){return i.getState("currentVersion")}),(function(e,t){t!==e&&s.selectOptionByValue(e)}),!0),"pinned-filter"===n.type&&n.$watch((function(){return r.getAvailablePinnedTypes()}),(function(t,n){if(n!==t){s.optionList=s.formatOptionList(t);var i=a.find(".selector");s.optionList.length>0?i.show():i.hide(),e((function(){var e=s.getOptionSelected();if("ALL"===e.value||"MULTI"===e.value){s.callback(e,{value:"ALL",label:"SELECTS.SELECTS_ALL",title:"SELECTS.SELECTS_ALL_TYPES",additionalClass:"doubleBorderTop"})}s.updateContainerPosition(s.type)}))}}),!0),n.$on("$destroy",(function(){s&&s.destroy()}))}}}])},function(e,t){e.exports='<div class="selector" ng-class="{\'smaller\': vm.smaller}"\n     data-parent="{{ ::vm.parent }}"\n     ng-show="::vm.optionList.length > 0">\n   <span \n      class="label_selected" \n      title="{{ vm.getOptionSelected().title | translate }}"\n      data-value="{{ vm.getOptionSelected().value }}">\n      {{ vm.getOptionSelected().label | translate | camelToSpaces | underscoresToSpaces | capitalize  }}\n   </span>\n   <div \n      class="open_options" \n      ng-click="vm.toggleExpand()">\n      <i class="fa fa-sort-desc"></i>\n   </div>\n   <div \n      class="option_container"\n      ng-class="{ \'expanded\':vm.expanded,\n                  \'openUp\': vm.openUp }" >\n      <div ng-repeat="option in vm.optionList" ng-switch="::option.type">\n         <div ng-switch-when="groupTitle" class="option groupTitle">\n            {{ option.label | translate | camelToSpaces | underscoresToSpaces | capitalize }}\n         </div>\n         <div \n            ng-switch-default\n            class="option {{ ::option.additionalClass }}" \n            title="{{option.title | translate | camelToSpaces | underscoresToSpaces | capitalize  }}" \n            data-value="{{::option.value }}"\n            data-wit="{{::option.ed}}"\n            ng-click="vm.doCallback(vm.optionSelected, option);"\n            ng-class="{\'selected\': vm.isOptionSelected(option)}">\n            <i class="fa {{::option.icon}} option-icon-label" \n               style="color: {{ ::option.color }}"\n               ng-if="::option.icon"></i>\n            {{ option.label  | translate | camelToSpaces | underscoresToSpaces | capitalize }}\n         </div>\n      </div>\n   </div>\n</div>'},function(e,t){angular.module("evtviewer.buttonSwitch",[])},function(e,t,n){(function(e){angular.module("evtviewer.buttonSwitch").provider("evtButtonSwitch",(function(){var t=this.defaults;this.setDefaults=function(e){t=e},this.$get=["$q","$log","config","baseData","parsedData","evtInterface","evtDialog","evtSelect","evtImageTextLinking","evtSourcesApparatus","evtBox","evtSearch","evtSearchBox","evtSearchResults","evtSearchResult","evtVirtualKeyboard",function(n,i,r,o,a,s,l,c,u,d,h,p,f,g,m,v){var y={},b={},_=[],x=0,w=(i.getInstance("buttonSwitch"),function(){this.active=!this.active}),S=function(e){this.active=e},T=function(){this.disabled=!0},E=function(){this.disabled=!1},C=function(){var e=this.uid;delete b[e]};return y.build=function(i,k){var L,P=i.id||x++,A=i.type||"default",O=i.title||"",I=i.label||"",D=function(e){var t="";if(!e)return"";switch(e.toLowerCase()){case"add":t="icon-evt_add";break;case"bookmark":t="icon-evt_bookmark";break;case"case-sensitive":t="icon-evt_case-sensitive";break;case"color-legend":t="icon-evt_color-legend";break;case"close":t="icon-evt_close";break;case"download":t="fa fa-download";break;case"download-xml":t="fa fa-file-code-o";break;case"exact-word":t="icon-evt_exact-match";break;case"filter":case"filters":t="icon-evt_filter";break;case"font-size":t="icon-evt_font-size";break;case"font-size-minus":t="icon-evt_font-size-minus-alt";break;case"font-size-plus":t="icon-evt_font-size-plus-alt";break;case"font-size-reset":t="icon-evt_font-size-reset-alt";break;case"heatmap":t="icon-evt_heatmap-alt";break;case"info":t="icon-evt_info";break;case"info-alt":t="icon-evt_info-alt";break;case"itl":t="icon-evt_link";break;case"keyboard":t="icon-evt_keyboard";break;case"hts":t="icon-evt_hotspot";break;case"language":t="fa fa-language";break;case"list":t="icon-evt_list";break;case"list-alt":t="fa fa-list-alt";break;case"menu":case"menu-vert":t="icon-evt_more-vert";break;case"mode-imgtxt":t="icon-evt_imgtxt";break;case"mode-txttxt":t="icon-evt_txttxt";break;case"reading-txt":t="icon-evt_txt";break;case"mode-collation":t="icon-evt_collation";break;case"mode-srctxt":t="iconbis-evt_srctxt";break;case"mode-versions":t="iconbis-evt_versions";break;case"mode-viscoll":t="iconbis-evt_srctxt";break;case"mode-bookreader":t="icon-evt_bookreader";break;case"next":t="icon-evt_next";break;case"pin":t="icon-evt_pin-alt-on";break;case"pin-off":t="icon-evt_pin-off";break;case"pin-on":t="icon-evt_pin-on";break;case"previous":t="icon-evt_previous";break;case"remove":t="icon-evt_close";break;case"search":t="icon-evt_search";break;case"search-advanced":t="icon-evt_advanced-search";break;case"search-results-hide":t="icon-evt_search-results-close";break;case"search-results-show":t="icon-evt_search-results-open";break;case"txt":t="icon-evt_txt";break;case"v-align":t="icon-evt_align";break;case"witnesses":t="icon-evt_books";break;case"zoom-in":t="icon-evt_zoom-in";break;case"zoom-out":t="icon-evt_zoom-out";break;case"zoom-reset":t="icon-evt_zoom-reset";break;case"next-page":t="fa fa-caret-right";break;case"prev-page":t="fa fa-caret-left";break;case"first-page":t="fa fa-step-backward";break;case"last-page":t="fa fa-step-forward";break;case"hide-bar":t="fa fa-caret-down";break;case"show-bar":t="fa fa-caret-up";break;case"thumb-nails":t="fa fa-th";break;case"viscoll":t="icon-evt_viscoll";break;case"tdhop":case"mode-tdhop":t="icon-evt_3dhop"}return t}(i.icon)||"",$=i.iconPos||"right",N=i.type||"",M=i.value||"",R=i.active||!1,B=i.disabled||!1,H=i.btnType||"",z=function(){console.log("TODO "+N)},F=function(){};switch(N){case"addWit":H="standAlone",z=function(){s.updateProperty("witnessSelector",!0),i.vm.active=!1};break;case"alignReadings":break;case"bookmark":z=function(){s.updateState("secondaryContent","bookmark"),l.openByType("bookmark"),this.active=!this.active};break;case"changeViewMode":H="standAlone",z=function(){if(void 0!==this.value){if("srcTxt"===this.value){var e=s.getState("currentSourceText");s.updateCurrentSourceText(e)}s.updateState("currentViewMode",this.value),s.updateUrl(),"active"===s.getToolState("ITL")&&("imgTxt"===this.value?u.activateITL():u.deactivateITL())}};break;case"colorLegend":H="toggler",z=function(){var e=i.$parent.vm;if(e.getState("topBoxOpened")&&"colorLegend"===e.getState("topBoxContent"))e.toggleTopBox();else{var t=a.getCriticalEntriesFiltersCollection(),n="";if(t.length>0){for(var r in n+='<div class="colorLegend">',t.filters){var o=t.filters[r],s="";for(var l in o.values){var c=o.values[l].name;s+='<span class="colorLegend-filter-value">'+('<i class="colorLegend-filter-color" style="background:'+o.values[l].color+'"></i>')+c+"</span>"}""!==s&&(n+='<span class="colorLegend-filter-name">'+r+"</span>"+s)}n+="</div>"}else n="<span>No filters available</span>";var u=n||"<span class=\"errorMsg\">{{ 'MESSAGES.GENERIC_ERROR' | translate }}</span>";e.updateTopBoxContent(u),e.updateState("topBoxContent","colorLegend"),e.getState("topBoxOpened")||e.toggleTopBox()}},F=function(){i.$parent.vm.updateState("topBoxOpened",!1)};break;case"closeDialog":z=function(){l.closeAll(),s.updateState("secondaryContent",""),this.active=!this.active};break;case"closePinned":z=function(){s.toggleState("isPinnedAppBoardOpened")};break;case"download-xml":z=function(){window.open(r.dataUrl,"_blank")};break;case"fontSizeDecrease":H="standAlone",z=function(){i.$parent.vm.fontSizeDecrease(),this.active=!this.active};break;case"fontSizeIncrease":H="standAlone",z=function(){i.$parent.vm.fontSizeIncrease(),this.active=!this.active};break;case"fontSizeReset":H="standAlone",z=function(){i.$parent.vm.fontSizeReset(),this.active=!this.active};break;case"fontSizeTools":z=function(){var e=i.$parent.vm.getState("fontSizeBtn")||!1;i.$parent.vm.updateState("fontSizeBtn",!e)},F=function(){i.$parent.vm.updateState("fontSizeBtn",!1)};break;case"front":H="toggler",z=function(){var e=i.$parent.vm;if(e.getState("topBoxOpened")&&"front"===e.getState("topBoxContent"))e.toggleTopBox();else{var t,n=s.getState("currentDoc");if(n){var r=a.getDocument(n),o=r?r.front:void 0;t=o&&o.parsedContent?o.parsedContent:"<div class=\"warningMsg\">{{ 'MESSAGES.FRONT_NOT_AVAILABLE' | translate }}</div>",i.$parent.vm.updateTopBoxContent(t),i.$parent.vm.toggleTopBox()}var l=t||"<span class=\"errorMsg\">{{ 'MESSAGES.GENERIC_ERROR' | translate }}</span>";e.updateTopBoxContent(l),e.updateState("topBoxContent","front"),e.getState("topBoxOpened")||e.toggleTopBox()}},F=function(){i.$parent.vm.updateState("topBoxOpened",!1)};break;case"msDesc":H="standAlone",z=function(){var e=i.$parent.vm;if(document.getElementsByClassName("box-top-box")[0].setAttribute("id","msDesc"),e.getState("topBoxOpened")&&"msDesc"===e.getState("topBoxContent"))e.toggleTopBox();else{var t;s.getState("currentDoc")&&(t=a.getProjectInfo().msDesc?a.getProjectInfo().msDesc:"<div class=\"warningMsg\">{{ 'MESSAGES.FRONT_NOT_AVAILABLE' | translate }}</div>",i.$parent.vm.updateTopBoxContent(t),i.$parent.vm.toggleTopBox());var n=t||"<span class=\"errorMsg\">{{ 'MESSAGES.GENERIC_ERROR' | translate }}</span>";e.updateTopBoxContent(n),e.updateState("topBoxContent","msDesc"),e.getState("topBoxOpened")||e.toggleTopBox()}},F=function(){i.$parent.vm.updateState("topBoxOpened",!1)};break;case"listObject":H="toggler",z=function(){var e=i.$parent.vm;if(document.getElementsByClassName("box-top-box")[0].setAttribute("id","listObject"),e.getState("topBoxOpened")&&"listObject"===e.getState("topBoxContent"))e.toggleTopBox();else{var t;s.getState("currentDoc")&&(t=a.getProjectInfo().listObject?a.getProjectInfo().listObject:"<div class=\"warningMsg\">{{ 'MESSAGES.FRONT_NOT_AVAILABLE' | translate }}</div>",i.$parent.vm.updateTopBoxContent(t),i.$parent.vm.toggleTopBox());var n=t||"<span class=\"errorMsg\">{{ 'MESSAGES.GENERIC_ERROR' | translate }}</span>";e.updateTopBoxContent(n),e.updateState("topBoxContent","listObject"),e.getState("topBoxOpened")||e.toggleTopBox()}},F=function(){i.$parent.vm.updateState("topBoxOpened",!1)};break;case"heatmap":H="standAlone",z=function(){var e=i.$parent.vm.getState("heatmap")||!1;i.$parent.vm.updateState("heatmap",!e)};break;case"itl":R="active"===s.getToolState("ITL"),H="standAlone",z=function(){this.active?u.turnOnITL():u.turnOffITL()};break;case"hts":R="active"===s.getToolState("HTS"),H="standAlone",z=function(){this.active?u.turnOnHTS():u.turnOffHTS()};break;case"mainMenu":H="standAlone",z=function(){var e=s.getState("mainMenu");s.updateState("mainMenu",!e)};break;case"openEntity":z=function(){this.active=!this.active};break;case"openGlobalDialogInfo":z=function(){s.updateState("secondaryContent","globalInfo"),l.openByType("globalInfo"),this.active=!this.active};break;case"openGlobalDialogWitnesses":z=function(){s.updateState("secondaryContent","witnessesList"),l.openByType("witnessesList"),this.active=!this.active};break;case"openGlobalDialogLists":z=function(){s.updateState("secondaryContent","entitiesList"),l.openByType("entitiesList"),this.active=!this.active};break;case"openToc":H="standAlone",z=function(){s.updateState("secondaryContent","toc"),l.openByType("toc"),this.active=!this.active};break;case"pin":case"pin-on":case"pin-off":z=function(){};break;case"removeWit":z=function(){var e=i.$parent.vm.witness;s.removeWitness(e),s.updateUrl()};break;case"search":z=function(){var e,t=i.$parent.id,n=f.getInputValue(t),r="";m.setPlaceholder(t,r),f.setSearchedTerm(t,n),((e={"":function(){r="Enter your query in the search box above",m.setVisibleRes(t,[]),m.setPlaceholder(t,r)},default:function(){var e=f.getStatus(t,"searchCaseSensitive"),i=f.getStatus(t,"searchExactWord"),r=g.getSearchResults(n,e,i),o=h.getEditionById(t),a=g.getCurrentEditionResults(r,o),s=g.getVisibleResults(a);m.setCurrentEditionResults(t,a),m.setVisibleRes(t,s)}})[n]||e.default)(),f.setStatus(t,"searchResultBox",!0),f.hideBtn(t,"searchResultsShow"),f.showBtn(t,"searchResultsHide"),v.unselectCurrentKeyboard(y,t)};break;case"searchIndex":function V(){var e;(e=n.defer(),s.updateState("indexingInProgress",!0),setTimeout((function(){e.resolve()}),100),e.promise).then((function(){var e,t,n=o.getXML();for(var i in(t=y.getByType("searchIndex")[0]).active=!1,t.disable(),p.initSearch(n),s.setToolStatus("isDocumentIndexed","true"),e=y.getByType("searchInternal"))e[i].disabled=!1;s.updateState("indexingInProgress",!1)}))}H="standAlone",B=function(){if("true"===s.getToolState("isDocumentIndexed"))return!0}(),R=function(){if("true"===s.getToolState("isDocumentIndexed"))return!1}(),z=function(){if("true"!==s.getToolState("isDocumentIndexed"))return V();i.vm.active=!1};break;case"searchResultsShow":z=function(){var e=i.$parent.id;m.setPlaceholder(e,"Enter your query in the search box above"),f.updateStatus(e,"searchResultBox"),f.hideBtn(e,"searchResultsShow"),f.showBtn(e,"searchResultsHide"),v.unselectCurrentKeyboard(y,e)};break;case"searchResultsHide":z=function(){var e=i.$parent.id;f.updateStatus(e,"searchResultBox"),f.hideBtn(e,"searchResultsHide"),f.showBtn(e,"searchResultsShow"),v.unselectCurrentKeyboard(y,e)};break;case"searchCaseSensitive":H="standAlone",z=function(){var e=i.$parent.id,t=f.getInputValue(e);f.updateStatus(e,"searchCaseSensitive"),g.highlightSearchResults(e,t)};break;case"searchInternal":H="standAlone",B="true"!==s.getToolState("isDocumentIndexed");z=function(){if("true"===s.getToolState("isDocumentIndexed"))return e=i.$parent.id,t=h.getState(e,"searchBox"),h.updateState(e,"searchBox",!t),f.closeBox(e,"searchResultBox"),f.showBtn(e,"searchResultsShow"),void f.hideBtn(e,"searchResultsHide");var e,t;i.vm.active=!1};break;case"searchAdvanced":H="standAlone",z=function(){window.alert("Advanced search coming soon!")};break;case"searchVirtualKeyboard":H="standAlone",z=function(){var t=i.$parent.id,n=v.getKeyboardId(t),r=e("#"+n).getkeyboard(),o=y.getByType("searchVirtualKeyboard");if(r.isOpen||!1===this.active)r.close();else if(r.reveal(),o.length>1)for(var a in o)o[a].uid!==this.currentId&&o[a].setActive(!1)};break;case"searchExactWord":H="standAlone",z=function(){var e=i.$parent.id,t=f.getInputValue(e);f.updateStatus(e,"searchExactWord"),g.highlightSearchResults(e,t)};break;case"searchPrevResult":case"searchNextResult":B=!0,z=function(){};break;case"searchClear":H="standAlone",z=function(){var e,t=i.$parent.id;f.clearInputValue(t),e=f.getInputValue(t),g.highlightSearchResults(t,e)};break;case"share":z=function(){alert(window.location)};break;case"toggleInfoWit":H="toggler",z=function(){var e=a.getWitness(i.$parent.vm.witness).description||i.$parent.vm.topBoxContent;i.$parent.vm.updateTopBoxContent(e),i.$parent.vm.toggleTopBox()},F=function(){i.$parent.vm.updateState("topBoxOpened",!1)};break;case"toggleFilterApp":F=z=function(){i.$parent.vm.toggleFilterBox()};break;case"togglePinned":H="toggler",z=function(){s.toggleState("isPinnedAppBoardOpened")};break;case"witList":H="toggler",z=function(){var e=i.$parent.vm;if(e.getState("topBoxOpened")&&"witList"===e.getState("topBoxContent"))e.toggleTopBox();else{var t=a.getWitnessesListFormatted()||"<span class=\"errorMsg\">{{ 'MESSAGES.GENERIC_ERROR' | translate }}</span>";e.updateTopBoxContent(t),e.updateState("topBoxContent","witList"),e.getState("topBoxOpened")||e.toggleTopBox()}},F=function(){i.$parent.vm.updateState("topBoxOpened",!1)};break;case"toggleInfoSrc":H="toggler",z=function(){var e=d.getSource(a.getSource(s.getState("currentSourceText")));if(e){var t=e.bibl||i.$parent.vm.topBoxContent;i.$parent.vm.updateTopBoxContent(t),i.$parent.vm.toggleTopBox()}},F=function(){i.$parent.vm.updateState("topBoxOpened",!1)};break;case"addVer":H="standAlone",z=function(){s.updateProperty("versionSelector",!0),i.vm.active=!1};break;case"removeVer":z=function(){var e=i.$parent.vm.version;s.removeVersion(e)};break;case"cropText":H="toggler",z=function(){return i.$parent.vm};break;case"prevPage":case"nextPage":case"firstPage":case"lastPage":z=function(){this.active=!1,"prevPage"===N?s.goToPrevPage():"nextPage"===N?s.goToNextPage():"firstPage"===N?s.goToFirstPage():"lastPage"===N&&s.goToLastPage()},"prevPage"===N||"firstPage"===N?B=s.isCurrentPageFirst():"nextPage"!==N&&"lastPage"!==N||(B=s.isCurrentPageLast());break;case"hideBar":z=function(){var e=s.getState("isNavBarOpened");s.updateState("isNavBarOpened",!e),this.active=!this.active};break;case"thumbNails":H="toggler",z=function(){s.updateState("isVisCollOpened",!1);var e=y.getByType("visColl");e&&e.forEach((function(e){e.setActive(!1)}));var t=s.getState("isThumbNailsOpened");s.updateState("isThumbNailsOpened",!t)};break;case"visColl":H="toggler",z=function(){s.updateState("isThumbNailsOpened",!1);var e=y.getByType("thumbNails");e&&e.forEach((function(e){e.setActive(!1)}));var t=s.getState("isVisCollOpened");s.updateState("isVisCollOpened",!t)}}return L={uid:P,defaults:angular.copy(t),currentId:P,currentType:A,title:O,label:I,icon:D,iconPos:$,type:N,value:M,active:R,disabled:B,btnType:H,callback:z,onBtnClicked:i.onBtnClicked,doCallback:function(){var e=this;e.disabled&&"false"!==e.disabled||(y.unselectAllSkipByBtnType(e.uid,"standAlone"),c.closeAll(),e.toggleActive(),e.callback&&e.callback(),e.onBtnClicked&&e.onBtnClicked())},fakeCallback:F,toggleActive:w,setActive:S,disable:T,enable:E,destroy:C},b[P]=angular.extend(k,L),_.push({id:P,type:A}),b[P]},y.getById=function(e){if("undefined"!==b[e])return b[e]},y.getList=function(){return _},y.getByType=function(e){var t=[];for(var n in b)b[n].type===e&&t.push(b[n]);return t},y.unselectAll=function(){angular.forEach(b,(function(e){e.setActive(!1)}))},y.unselectAllSkipByBtnType=function(e,t){angular.forEach(b,(function(n){n.uid!==e&&t.indexOf(n.btnType)<0&&(n.active&&n.fakeCallback(),n.setActive(!1))}))},y.selectById=function(e){"undefined"!==b[e]&&b[e].setActive(!0)},y.destroy=function(e){delete b[e]},y}]}))}).call(this,n(0))},function(e,t,n){angular.module("evtviewer.buttonSwitch").directive("buttonSwitch",["$rootScope","evtButtonSwitch","evtInterface",function(e,t,i){return{restrict:"E",scope:{title:"@",label:"@",icon:"@",type:"@",value:"@",iconPos:"@",disabled:"@",onBtnClicked:"&"},template:n(186),link:function(n,r){n.vm={};var o,a=t.build(n,n.vm);n.$watch((function(){return n.disabled}),(function(e,t){e!==t&&(n.vm.disabled=e)})),"addWit"===n.type&&(0===i.getProperty("availableWitnesses").length&&(n.vm.disabled=!0,n.vm.title="BUTTONS.NO_WITNESSES_AVAILABLE"),n.$watch((function(){return i.getProperty("availableWitnesses")}),(function(e,t){e!==t&&(0===e.length?(n.vm.disabled=!0,n.vm.title="BUTTONS.NO_WITNESSES_AVAILABLE"):(n.vm.disabled=!1,n.vm.title="BUTTONS.ADD_WITNESS"))}),!0)),"addVer"===n.type&&(0===i.getProperty("availableVersions").length&&(n.vm.disabled=!0,n.vm.title="BUTTONS.NO_VERSION_AVAILABLE"),n.$watch((function(){return i.getProperty("availableVersions")}),(function(e,t){e!==t&&(0===e.length?(n.vm.disabled=!0,n.vm.title="BUTTONS.NO_VERSION_AVAILABLE"):(n.vm.disabled=!1,n.vm.title="BUTTONS.ADD_VERSION"))}),!0)),"changeViewMode"===n.type&&n.$watch((function(){return i.getState("currentViewMode")}),(function(e,t){e===n.vm.value?n.vm.active=!0:n.vm.active=!1}),!0),"search"===n.type&&(o=n.$parent.id,e.$broadcast("searchBtn",{parentId:o,btn:a})),"searchVirtualKeyboard"===n.type&&(o=n.$parent.id,e.$broadcast("keyboardBtn",{parentId:o,btn:a})),"prevPage"!==n.type&&"firstPage"!==n.type||n.$watch((function(){return i.isCurrentPageFirst()}),(function(e,t){e!==t&&(n.vm.disabled=e)}),!0),"nextPage"!==n.type&&"lastPage"!==n.type||n.$watch((function(){return i.isCurrentPageLast()}),(function(e,t){e!==t&&(n.vm.disabled=e)}),!0),n.$on("$destroy",(function(){a&&a.destroy()}))}}}])},function(e,t){e.exports="<span class=\"buttonSwitch\"\n    title=\"{{vm.title | translate}}\"\n    ng-click=\"vm.doCallback()\"\n    ng-class=\"{'buttonSwitch-active': vm.active,\n                'buttonSwitch-disabled': vm.disabled === true,\n                'only-icon': vm.label === undefined || vm.label === '',\n                'only-text': vm.icon === undefined || vm.icon === '',\n                'iconLeft': vm.iconPos && vm.iconPos === 'left' }\">\n    \n    <i ng-if=\":: vm.iconPos && vm.iconPos === 'left'\" class=\"icon {{ vm.icon }} buttonSwitch-icon\"></i>\n    \n    <span\n      class=\"buttonSwitch-label\"\n      ng-if=\"::vm.label !== undefined && vm.label !== ''\">{{ vm.label | translate}}</span>\n    \n    <i ng-if=\":: !vm.iconPos || vm.iconPos === 'right'\" class=\"icon {{ vm.icon }} buttonSwitch-icon\"></i>\n</span>"},function(e,t){angular.module("evtviewer.popover",[])},function(e,t){angular.module("evtviewer.popover").constant("POPOVERDEFAULTS",{expanded:!1,tooltipOver:!1,tooltipMaxHeight:170,tooltipMaxWidth:200,openTriggerEvent:"click"}).config(["evtPopoverProvider","configProvider","POPOVERDEFAULTS",function(e,t,n){var i=t.makeDefaults("popover",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.popover").provider("evtPopover",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=function(){var t={},n={},i=[],r=0;return t.build=function(t,o,a){var s,l=r++,c=t||"",u=o||"";if(void 0===n[l])return s={uid:l,trigger:c,tooltip:u,expanded:angular.copy(e.expanded),tooltipOver:angular.copy(e.tooltipOver),defaults:angular.copy(e)},n[l]=angular.extend(a,s),i.push({id:l}),n[l]},t.getById=function(e){if("undefined"!==n[e])return n[e]},t.getList=function(){return i},t.expandById=function(e,i){"undefined"!==n[e]&&(n[e].expand(),i&&t.closeAll(e))},t.closeAll=function(e){angular.forEach(n,(function(t,n){(void 0===e||n!==e.toString())&&t.collapse()}))},t.mouseOutAll=function(e){angular.forEach(n,(function(t,n){n!==e.toString()&&t.mouseOut()}))},t.getIdTooltipOvered=function(){var e=-1;return angular.forEach(n,(function(t){t.tooltipOver&&(e=t.uid)})),e},t.destroy=function(e){delete n[e]},t}}))},function(e,t){angular.module("evtviewer.popover").controller("PopoverCtrl",["$log","$scope","evtPopover",function(e,t,n){var i=this;i.parentRef=".box-body";e.getInstance("popover");this.expand=function(){i.expanded=!0},this.collapse=function(){i.expanded=!1},this.mouseOver=function(){i.over=!0},this.mouseOut=function(){i.over=!1},this.tooltipMouseOver=function(){i.tooltipOver=!0},this.tooltipMouseOut=function(){i.tooltipOver=!1},this.toggleExpand=function(e){e||n.closeAll(i.uid),i.expanded=!i.expanded},this.toggleOver=function(e){e||n.mouseOutAll(i.uid),i.over=!i.over},this.toggleTooltipOver=function(){i.tooltipOver=!i.tooltipOver},this.destroy=function(){var e=i.uid;n.destroy(e)},this.toggleMouseHover=function(){},this.toggleTooltipHover=function(){},this.triggerClick=function(){},this.resizeTooltip=function(){}}])},function(e,t,n){angular.module("evtviewer.popover").directive("evtPopover",["evtPopover",function(e){return{restrict:"E",scope:{trigger:"@",tooltip:"@",parentRef:"@"},transclude:!0,template:n(192),controllerAs:"vm",controller:"PopoverCtrl",link:function(t,n){t.vm.toggleTooltipHover=function(e,t){e.stopPropagation(),t.toggleTooltipOver()},t.vm.toggleMouseHover=function(n,i){n.stopPropagation(),"over"!==i.trigger||i.over||i.expanded||t.vm.resizeTooltip(n,i.defaults);var r=e.getIdTooltipOvered();(r<0||r===i.uid)&&i.toggleOver()},t.vm.triggerClick=function(t,n){t.stopPropagation(),"over"===n.trigger||n.expanded||n.resizeTooltip(t,n.defaults);var i=e.getIdTooltipOvered();(i<0||i===n.uid)&&n.toggleExpand()},t.vm.resizeTooltip=function(e,i){e.stopPropagation();var r=t.vm.parentRef;void 0!==t.parentRef&&(r=t.parentRef);var o=n,a=angular.element(n).find("span.popover_tooltip").last(),s=angular.element(a).find(".popover__tooltip__before"),l=e.clientX,c=e.clientY;a.removeAttr("style");var u=o.height(),d=1*o.css("font-size").substr(0,2)+1,h=(o.width(),o.position().top),p=(o.position().left,a.offset().top,a.outerWidth()),f=a.outerHeight();p>i.tooltipMaxWidth&&a.css({width:i.tooltipMaxWidth+"px","max-width":i.tooltipMaxWidth+"px"}),a.css({position:"absolute"}),p=a.outerWidth(),f=a.outerHeight(),0===n.parents(r).length&&void 0===t.parentRef&&(r=n.parent());var g,m,v=n.parents(r).offset().left,y=n.parents(r).innerWidth(),b=l-v-p/2;a.css({left:b+"px"}),b+p>y&&(b=b-(g=b+p-y)-20,a.css({left:b+"px"})),b<0&&(b=0,a.css({left:b+"px"})),h+u+f>n.parents(r).outerHeight()?(m=f+u+10,u>d&&(m=m-(c-o.offset().top)+10),a.css({"margin-top":-m+"px"}).addClass("open-up"),s.css({top:a.outerHeight()+2+"px"})):(a.removeClass("open-up"),u>d?(g=u-d-(c-o.offset().top),a.css({"margin-top":-g+"px"})):a.css({"margin-top":"5px"}));var _=l-b-v-20;_=_<0?0:_,s.css({left:_+"px"}),(p=a.width())>i.tooltipMaxWidth&&a.css({width:i.tooltipMaxWidth+"px","max-width":i.tooltipMaxWidth+"px"})};var i=e.build(t.trigger,t.tooltip,t.vm);t.$on("$destroy",(function(){i&&i.destroy()}))}}}])},function(e,t){e.exports='<span class="popover">\n   <span \n        class="popover_trigger" \n        ng-mouseover="vm.toggleMouseHover($event, vm)" \n        ng-mouseout="vm.toggleMouseHover($event, vm)"\n        ng-click="vm.triggerClick($event, vm);" \n        ng-class="{\'expanded\':vm.expanded, \n                   \'active\': vm.over,\n                   \'blurred\': $parent.vm.state.topBoxOpened}">\n        <span ng-transclude></span>\n   </span>\n   <span \n        class="popover_tooltip" \n        ng-class="{\'expanded\':vm.expanded || (vm.trigger===\'over\' && vm.over)}"\n        ng-mouseover="vm.toggleTooltipHover($event, vm)"\n        ng-mouseout="vm.toggleTooltipHover($event, vm)">\n        <span \n            class="popover__tooltip__before" \n            ng-mouseover="vm.toggleTooltipHover($event, vm)"\n            ng-mouseout="vm.toggleTooltipHover($event, vm)"></span>\n      <span compile="::vm.tooltip"></span>\n   </span>\n</span>'},function(e,t){angular.module("evtviewer.list",[])},function(e,t){angular.module("evtviewer.list").provider("evtList",(function(){this.defaults;this.setDefaults=function(e){e};this.$get=["parsedData","evtInterface",function(e,t){var n={},i=[],r=function(){var e=this.uid;delete n[e]},o=function(){for(var e=this,t=e.visibleElements.length,n=0;n<10&&n<e.elementsInListKey.length;){var i=e.elementsInListKey[t+n];i&&e.visibleElements.indexOf(i)<0&&e.visibleElements.push(i),n++}},a=function(t,n){var i=[];return n&&(i=(i=e.getNamedEntitiesCollectionByNameAndPos(t,n))?i._indexes:[]),i},s=function(e){var t=this;t.selectedLetter=e,t.elementsInListKey=a(t.uid,e),t.visibleElements=t.elementsInListKey?t.elementsInListKey.slice(0,40):[]};return i.build=function(l,c){var u,d=l,h=c.listType||"generic";if(void 0===n[d]){var p,f=t.getState("currentNamedEntity"),g=f?e.getNamedEntity(f):void 0,m=e.getNamedEntitiesCollectionByName(d);p=g&&h===e.getNamedEntityType(f)?g._listPos||void 0:m?m._listKeys[0]:void 0;var v=a(d,p),y=g&&h===e.getNamedEntityType(f)?v.indexOf(f):void 0,b=y?y+10:41,_=v?v.slice(0,b):[];return u={uid:d,listType:h,listKeys:m?m._listKeys:[],elements:m?m._indexes:[],elementsInListKey:v,visibleElements:_,selectedLetter:p,loadMoreElements:o,selectLetter:s,destroy:r},n[d]=angular.extend(c.vm,u),i.push({id:d}),n[d]}},i.destroy=function(e){delete n[e]},i.scrollToElemById=function(e,t){angular.forEach(i,(function(i){i.id===e&&n[e].scrollToElement(t)}))},i}]}))},function(e,t,n){angular.module("evtviewer.list").directive("evtList",["evtList","evtInterface",function(e,t){return{restrict:"E",scope:{listId:"@",listType:"@"},transclude:!0,template:n(196),link:function(n,i,r){n.vm={listId:n.listId,listType:n.listType};var o=e.build(n.listId,n);n.vm.scrollToElement=function(e){var t=angular.element(i).find(".scrollableDiv")[0],n=angular.element(t).find('[data-entity-id="'+e+'"]');n.length>0&&n[0]&&(t.scrollTop=n[0].offsetTop),console.log(t.scrollTop)},n.$watch((function(){return t.getState("currentNamedEntity")}),(function(e,t){e!==t&&o.selectLetter(e.charAt(0))})),n.$on("$destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<div class="evt-list">\n    <div ng-if="vm.elements.length > 0">\n        <div class="evt-list__listLetters">\n            <span class="evt-list__listLetters__letter" \n                ng-class="{\'active\': letter === vm.selectedLetter }"\n                ng-repeat="letter in ::vm.listKeys | orderBy track by $index" ng-click="vm.selectLetter(letter)">\n                {{ ::letter }}\n            </span>\n        </div>\n        <div class="evt-list__content">\n            <div class="scrollableDiv" infinite-scroll="vm.loadMoreElements()" infinite-scroll-distance="2" infinite-scroll-parent="true">\n                <evt-named-entity \n                    data-entity-id="{{::element}}" data-entity-type="{{::vm.listType}}"\n                    ng-repeat="element in vm.visibleElements | orderBy ">\n                </evt-named-entity>\n            </div>\n        </div>\n    </div>\n    <div ng-if="vm.elements.length <= 0">\n        {{ \'LISTS.NO_ELEMENTS\' | translate }} \n    </div>\n</div>'},function(e,t){angular.module("evtviewer.namedEntity",[])},function(e,t){angular.module("evtviewer.namedEntity").constant("NAMEDENTITYDEFAULTS",{allowedTabs:["moreInfo","occurrences","map"]}).config(["evtNamedEntityProvider","configProvider","NAMEDENTITYDEFAULTS",function(e,t,n){var i=t.makeDefaults("namedEntity",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.namedEntity").provider("evtNamedEntity",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["$timeout","config","parsedData","evtNamedEntitiesParser","evtInterface","evtNamedEntityRef","evtPinnedElements","evtDialog","evtList",function(t,n,i,r,o,a,s,l,c){var u={},d={},h=[],p=0,f=function(){return i.getNamedEntity(this.entityId).output},g=function(){var e=this;"mainText"!==e.location&&(e.toggleSubContent(e._firstSubContentOpened),e.opened=!e.opened,e.toggleState())},m=function(){var e=this;e.occurrences||(e.occurrences=u.getOccurrences(e.entityId)),e.occurrencesOpened=!e.occurrencesOpened,e.toggleSection("occurrencesOpened")},v=function(){this.moreInfoOpened=!this.moreInfoOpened,this.toggleSection("moreInfoOpened")},y=function(e){var n=this;o.updateState("currentPage",e.pageId),o.updateState("currentDoc",e.docId),o.updateUrl(),"entitiesList"===o.getState("secondaryContent")&&o.updateState("secondaryContent",""),t((function(){a.highlightByEntityId(n.entityId)}),500)},b=function(e){var t=this;"occurrences"!==e||t.occurrences||(t.occurrences=u.getOccurrences(t.entityId)),t._subContentOpened!==e?t._subContentOpened=e:t._subContentOpened="",t.toggleSubContentClass()},_=function(){return n.toolPinAppEntries},x=function(){return s.isPinned(this.entityId)},w=function(){return this.isPinned()?"pin-on":"pin-off"},S=function(){var e=this;if(e.isPinned())s.removeElement({id:e.entityId,type:"namedEntity_"+e.entityType});else{s.addElement({id:e.entityId,type:"namedEntity_"+e.entityType});var t=s.getPinned();t&&1===t.length&&o.updateState("isPinnedAppBoardOpened",!0)}},T=function(){var e=this;o.updateState("secondaryContent","toc"),l.openByType("toc");var t=i.getNamedEntities()[e.entityId].collectionId;o.updateProperty("tabsContainerOpenedContent","entitiesLists"),o.updateProperty("tabsContainerOpenedTab",t),o.updateState("currentNamedEntity",e.entityId),setTimeout((function(){c.scrollToElemById(t,e.entityId)}),1e3)},E=function(e){var t=o.getState("currentDoc"),n=o.getState("currentPage");return t===e.docId&&n===e.pageId};return u.build=function(t,n){var r,o=p++,a=t||void 0,s=n.entityType||i.getNamedEntityType(a)||"generic",l=n.location||"list";if(void 0===d[o]){var c,u=i.getNamedEntity(a),C=!0,k=i.getNamedEntityTypeIcon(s);switch(C=void 0!==u&&void 0!==u.notes&&u.notes.length>0,s){case"place":case"placeName":case"person":case"pers":case"persName":break;case"org":case"orgName":C=C||void 0!==u&&void 0!==u.desc;break;default:C=C||void 0!==u&&void 0!==u.details}u&&u.occurrences&&(c=u.occurrences);var L={_indexes:[]};e.allowedTabs.indexOf("moreInfo")>=0&&(L._indexes.push("moreInfo"),L.moreInfo={label:"NAMED_ENTITIES.MORE_INFO"}),"relation"!==s&&(L._indexes.push("occurrences"),L.occurrences={label:"NAMED_ENTITIES.OCCURRENCES"});var P={zoom:8},A={focus:!0,draggable:!1};if(e.allowedTabs.indexOf("map")>=0&&("place"===s||"placeName"===s)&&u.map){L._indexes.push("map"),L.map={label:"NAMED_ENTITIES.MAP"};var O=parseFloat(u.map.lat),I=parseFloat(u.map.lng);P.lat=O,P.lng=I,A.lat=O,A.lng=I}return e.allowedTabs.indexOf("xmlSource")>=0&&(L._indexes.push("xmlSource"),L.xmlSource={label:"NAMED_ENTITIES.XML"}),r={uid:o,entityId:a,entityType:s,entityTypeIcon:k,location:l,entity:u||{},occurrences:c,opened:!1,moreInfoOpened:C,occurrencesOpened:!1,noMoreInfo:!C,_firstSubContentOpened:L&&L._indexes&&L._indexes.length>0?L._indexes[0]:"",_subContentOpened:"",over:!1,tabs:L,defaults:angular.copy(e),getElementContent:f,toggle:g,toggleMoreInfo:v,toggleOccurrences:m,goToOccurrence:y,toggleSubContent:b,isCurrentPageDoc:E,isPinAvailable:_,isPinned:x,getPinnedState:w,togglePin:S,openEntity:T,lfCenter:P,lfDefaults:{tileLayer:"http://{s}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png",tileLayerOptions:{opacity:.9,detectRetina:!0,reuseTiles:!0}},lfMarkers:{mainMarker:A}},d[o]=angular.extend(n.vm,r),h.push({id:o,entityId:a}),d[o]}},u.getOccurrences=function(e){for(var t=i.getDocuments(),n=t._indexes||[],o=[],a=0;a<n.length;a++){var s=t[n[a]],l=r.parseEntitiesOccurrences(s,e);o=o.concat(l)}return o},u.getById=function(e){var t;return angular.forEach(d,(function(n){n.entityId===e&&(t=n)})),t},u.getList=function(){return h},u.getPinned=function(){return s.getPinnedByType("namedEntity")},u.destroy=function(e){delete d[e]},u}]}))},function(e,t,n){angular.module("evtviewer.namedEntity").directive("evtNamedEntity",["evtNamedEntity",function(e){return{restrict:"E",scope:{entityId:"@",entityType:"@",location:"@"},transclude:!0,template:n(201),link:function(t,n,i){t.vm={entityId:t.entityId,entityType:t.entityType,location:t.location};e.build(t.entityId,t);var r=n.find(".namedEntity"),o=n.find(".namedEntity__details");t.vm.toggleState=function(){t.vm.opened?r.addClass("opened"):r.removeClass("opened")},t.vm.toggleSection=function(e){t.vm[e]?o.addClass(e):o.removeClass(e)};var a=n.find(".namedEntity__details-headers"),s=n.find(".namedEntity__details-panels");t.vm.toggleSubContentClass=function(){var e=t.vm._subContentOpened;(n.find(".namedEntity__details-header.active").removeClass("active"),""!==e)?(n.find(".namedEntity__details-header-"+e).addClass("active"),a.removeClass("closed"),s.removeClass("closed")):(a.addClass("closed"),s.addClass("closed"))},t.$on("$destroy",(function(){t.vm.uid&&e.destroy(t.vm.uid)}))}}}])},function(e,t){e.exports='<span class="namedEntity namedEntity-{{ ::vm.entityType }} location-{{::vm.location}}"\n     ng-class="::{\'opened\': vm.location === \'mainText\'}">\n\t<span class="namedEntity__header">\n        \x3c!-- HEADER --\x3e\n        <div class="namedEntity_tools"\n          ng-if="::vm.isPinAvailable()">\n          <button-switch\n            ng-if="vm.location !== \'list\'"\n            title="BUTTONS.OPEN_LIST"\n            data-label=""\n            data-icon="list"\n            data-type="openEntity"\n            ng-click="vm.openEntity()"></button-switch>\n          <button-switch \n                title="BUTTONS.PIN_REMOVE"\n                ng-if="::vm.isPinAvailable() && vm.location === \'pinned\'"\n                data-label=""\n                data-icon="remove"\n                data-type="pin-off"\n                ng-click="vm.togglePin()"></button-switch>\n          <button-switch \n                title="BUTTONS.PIN_TOGGLE"\n                ng-if="::vm.isPinAvailable() && vm.location !== \'pinned\'"\n                data-label=""\n                data-icon="pin"\n                data-type="pin"\n                ng-class="{\'active\' : vm.isPinned()}"\n                ng-click="vm.togglePin()"></button-switch>\n        </div>\n        <div ng-click="vm.toggle()">\n            <i class="fa opener" ng-if="::vm.location !== \'mainText\'"></i>\n            \n            <i class="fa namedEntity__icon {{::vm.entityTypeIcon}}" ng-if="::vm.location === \'mainText\'"></i>\n\n            <span compile="::vm.entity.label"></span>\n        </div>\n    </span>\n\n    <span class="namedEntity__details">\n        <div class="namedEntity__details-headers closed">\n            <span ng-repeat="tab in ::vm.tabs._indexes track by $index"\n                    ng-click="vm.toggleSubContent(tab)"\n                    class="namedEntity__details-header namedEntity__details-header-{{::tab}}">\n                {{ vm.tabs[tab].label | translate }}\n            </span>\n          </div>\n\n          <div class="namedEntity__details-panels closed"\n               ng-class="{\'largeMap\': vm.location === \'list\' && (vm._subContentOpened === \'map\' || vm._subContentOpened === \'occurrences\')}">\n                  <div class="namedEntity__details-panel"\n                        ng-switch="vm._subContentOpened">\n                        <div ng-switch-when="moreInfo">\n                            \n                            <span ng-if="::vm.entity.content && vm.entity.content._indexes.length > 0" \n                                ng-repeat="contentName in ::vm.entity.content._indexes">\n                                <span class="namedEntity__detail" ng-if="::vm.entity.content[contentName].length > 0">\n                                    \x3c!-- SWITCH to get icon --\x3e\n                                    <span ng-switch="contentName">\n                                        <i ng-switch-when="idno"\n                                            class="fa fa-barcode namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="note"\n                                            class="fa fa-sticky-note namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="occupation"\n                                            class="fa fa-briefcase namedEntity__detail-icon"></i>                                        \n                                        <i ng-switch-when="persName"\n                                            class="fa fa-user namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="sex"\n                                            class="fa fa-venus-mars namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="birth"\n                                            class="fa fa-birthday-cake namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="death"\n                                            class="fa fa-times fa-rotate-45 namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="residence"\n                                            class="fa fa-home namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="orgName"\n                                            class="fa fa-users namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="geoName"\n                                            class="fa fa-map-marker namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="geogFeat"\n                                            class="fa fa-map-marker namedEntity__detail-icon"></i>\n\n                                        <i ng-switch-when="district"\n                                            class="fa fa-map-marker namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="settlement"\n                                            class="fa fa-location-arrow namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="region"\n                                            class="fa fa-map-marker namedEntity__detail-icon"></i>    \n                                        <i ng-switch-when="country"\n                                            class="fa fa-map-marker namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="bloc"\n                                            class="fa fa-map-marker namedEntity__detail-icon"></i>\n                                        \n                                        <i ng-switch-when="relations"\n                                            class="fa fa-share-alt namedEntity__detail-icon"></i>\n                                        <i ng-switch-when="actors"\n                                            class="fa fa-users namedEntity__detail-icon"></i>\n\n                                        <i ng-switch-default\n                                            class="fa fa-info-circle namedEntity__detail-icon"></i>\n                                    </span>\n\n                                    <span class="namedEntity__detail-text"\n                                        ng-repeat="contentObj in ::vm.entity.content[contentName] track by $index">\n                                            <span class="namedEntity__detail-text-attributes">\n                                                <span class="namedEntity__detail-text-attribute" \n                                                    ng-repeat="attribute in ::contentObj.attributes._indexes track by $index"\n                                                >{{::contentObj.attributes[attribute] | translate | camelToSpaces | underscoresToSpaces }}</span>\n                                            </span>\n                                            <span class="namedEntity__detail-text-content" compile="::contentObj.text"></span>\n                                        </span>\n                                </span>\n                            </span>\n\n                            <span ng-if="::vm.entity.content._indexes.length <= 0">\n                                {{ \'MESSAGES.NO_MORE_INFO_AVAILABLE\' | translate }}\n                            </span>\n                        </div>\n                        <div ng-switch-when="occurrences">\n                            <span ng-if="::vm.occurrences && vm.occurrences.length > 0"\n                                class="namedEntity__occurrences-occurrence"\n                                ng-class="{\'active\': vm.isCurrentPageDoc(occurrence) } "\n                                ng-repeat="occurrence in ::vm.occurrences track by $index"\n                                ng-click="vm.goToOccurrence(occurrence)">\n                                {{ \'LISTS.OCCURRENCE\' | translate:occurrence }}\n                            </span>\n                            <span class="italic" ng-if="::vm.occurrences && vm.occurrences.length <= 0">\n                                {{ \'MESSAGES.NO_RESULT_FOUND\' | translate }}\n                            </span>\n                            <span class="italic" ng-if="::!vm.occurrences">\n                                {{ \'MESSAGES.LOADING_OCCURRENCES\' | translate }}\n                            </span>\n                        </div>\n                        <div ng-switch-when="xmlSource">\n                            <pre ng-if="::vm.entity._xmlSource">{{ ::vm.entity._xmlSource | newLinesToSpaces | normalizeMultispaces | prettyXml}}</pre>\n                            <span ng-if="::!vm.entity._xmlSource">{{ \'MESSAGES.NO_XML_SOURCE\' | translate }}</span>\n                        </div>\n                        <div ng-switch-when="map">\n                            <leaflet\n                                width="100%"\n                                height="300px"\n                                lf-center="vm.lfCenter"\n                                defaults="vm.lfDefaults"\n                                markers="vm.lfMarkers"></leaflet>\n                        </div>\n                  </div>\n              </div>\n          </div>\n    </span>\n\n    \x3c!-- <span class="namedEntity__details">\n        <span class="namedEntity__moreInfo-toggler" ng-click="vm.toggleMoreInfo()">\n            <i class="fa opener"></i> About\n        </span>\n        <span class="namedEntity__moreInfo">\n            \n            <span ng-if="::vm.entity.notes && vm.entity.notes.length > 0" \n                class="{{ ::note.type }}"\n                ng-repeat="note in ::vm.entity.notes track by $index"\n                compile="::note.content">\n            </span>\n\n            <span ng-if="::vm.entity.desc" \n                ng-repeat="desc in ::vm.entity.desc track by $index"\n                compile="::desc.content">\n            </span>\n\n            <span ng-if="::vm.entity.details" \n                compile="::vm.entity.details">\n            </span>            \n\n            <span ng-if="::vm.noMoreInfo">\n                No more information available.\n            </span> --\x3e\n\n            \x3c!-- <span ng-switch="::vm.entityType">\n                <span ng-switch-when="place">\n                </span>\n\n                <span ng-switch-when="person">\n                </span>\n\n                <span ng-switch-when="org">\n                </span>\n\n                <span ng-switch-default>\n                </span>        \n            </span> --\x3e\n        \x3c!-- </span>\n\n        <span class="namedEntity__occurrences-toggler" ng-click="vm.toggleOccurrences()">\n            <i class="fa opener"></i> Occurrences\n        </span>\n        <span class="namedEntity__occurrences">\n            <span ng-if="::vm.occurrences && vm.occurrences.length > 0"\n                class="namedEntity__occurrences-occurrence"\n                ng-repeat="occurrence in ::vm.occurrences track by $index"\n                ng-click="vm.goToOccurrence(occurrence)">\n                {{ ::occurrence.docLabel }} - Fol. {{ ::occurrence.pageLabel }} \n            </span>\n            <span class="italic" ng-if="::vm.occurrences && vm.occurrences.length <= 0">\n                No result found.\n            </span>\n        </span>\n    </span> --\x3e\n</span>'},function(e,t){angular.module("evtviewer.namedEntity").provider("evtNamedEntityRef",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["$timeout","parsedData","Utils",function(t,n,i){var r,o,a={},s={},l={},c=[],u=0,d=[],h=function(e){e.stopPropagation();var n=e.target;if(n&&!i.DOMutils.isNestedInElem(n,"evt-named-entity")||i.DOMutils.isNestedInElem(n,"evt-list")){var r=this;r.realNamedEntity&&(a.getCurrentHighlighted()!==r.entityId&&a.highlightByEntityId(void 0),r.active=!r.active,r.active?a.setActiveEntity(r.uid):a.setActiveEntity(void 0),r.toggleActive(),r.detailsInPopup&&t((function(){r.updateDetailsPosition(e,r)}),20))}};return a.build=function(t,i){var r,o=u++,d=t||void 0,p=i.entityType?i.entityType:n.getNamedEntityType(d),f=void 0!==t;if(void 0===s[o]){switch(p){case"persName":p="person";break;case"placeName":case"orgName":p=p.replace("Name","");break;default:p=p}return r={uid:o,entityId:d,entityType:p,detailsInPopup:!1,realNamedEntity:f,initHighlight:f&&a.getCurrentHighlighted()===d,defaults:angular.copy(e),goToEntityInList:h},s[o]=angular.extend(i.vm,r),c.push({id:o,entityId:d}),l[d]||(l[d]=[]),l[d].push(o),s[o]}},a.getActiveEntityTypes=function(){return d},a.addActiveType=function(e){d.indexOf(e)<0&&d.push(e)},a.removeActiveType=function(e){var t=d.indexOf(e);d.splice(t,1)},a.getActiveEntity=function(){return r},a.setActiveEntity=function(e){a.deactivateEntity(r),r=e},a.deactivateEntity=function(e){void 0!==e&&void 0!==s[e]&&(s[e].active=!1,s[e].toggleActive())},a.highlightByEntityId=function(e){a.setCurrentHighlighted(e),angular.forEach(s,(function(t){t.toggleHighlight&&(t.realNamedEntity&&t.entityId===e?t.toggleHighlight(!0):t.toggleHighlight(!1))}))},a.getCurrentHighlighted=function(){return o},a.setCurrentHighlighted=function(e){o=e},a.getById=function(e){var t;return angular.forEach(s,(function(n){n.entityId===e&&(t=n)})),t},a.getList=function(){return c},a.destroy=function(e){delete s[e]},a}]}))},function(e,t,n){angular.module("evtviewer.namedEntity").directive("evtNamedEntityRef",["evtNamedEntityRef",function(e){return{restrict:"E",scope:{entityId:"@",entityType:"@"},transclude:!0,template:n(204),link:function(t,n,i){t.vm={entityId:t.entityId,entityType:t.entityType};e.build(t.entityId,t);var r=n.find(".namedEntityRef"),o=n.find(".namedEntityRef__details");t.vm.toggleActive=function(){t.vm.active?(r.addClass("active"),o.addClass("active")):(r.removeClass("active"),o.removeClass("active"))},t.vm.toggleHighlight=function(e){e?r.addClass("highlighted"):r.removeClass("highlighted")},t.vm.updateDetailsPosition=function(e,t){if(t.active){e.stopPropagation();var i=n,r=angular.element(n).find("span.namedEntityRef__details").last(),o=angular.element(r).find(".namedEntityRef__details-before"),a=e.clientX,s=e.clientY;r.removeAttr("style");var l=i.height(),c=1*i.css("font-size").substr(0,2)+1,u=(i.width(),i.position().top),d=(i.position().left,r.offset().top,r.outerWidth()),h=r.outerHeight();d>200&&r.css({width:"200px","max-width":"200px"}),r.css({position:"absolute"}),d=r.outerWidth(),h=r.outerHeight();var p,f,g=n.parent(),m=n.parents(g).offset().left,v=n.parents(g).innerWidth(),y=a-m-d/2;r.css({left:y+"px"}),y+d>v&&(y=y-(p=y+d-v)-10,r.css({left:y+"px"})),y<0&&(y=0,r.css({left:y+"px"})),u+l+h>n.parents(g).outerHeight()?(f=h+l+10,l>c&&(f=f-(s-i.offset().top)+10),r.css({"margin-top":-f+"px"}).addClass("open-up"),o.css({top:r.outerHeight()+2+"px"})):(r.removeClass("open-up"),l>c?(p=l-c-(s-i.offset().top),r.css({"margin-top":-p+"px"})):r.css({"margin-top":"5px"}));var b=a-y-m;o.css({left:b+"px"}),(d=r.width())>200&&r.css({width:"200px","max-width":"200px"})}},t.$on("$destroy",(function(){t.vm.uid&&e.destroy(t.vm.uid)}))}}}])},function(e,t){e.exports='<span class="namedEntityRef namedEntityRef-{{ ::vm.entityType }}"\n\tng-class="::{\'fakeEntity\': !vm.realNamedEntity,\n\t\t\t\t \'highlighted\': vm.initHighlight }" title="{{ \'LISTS.ENTITY_TYPE_\'+vm.entityType | uppercase | translate }}"\n\tng-click="vm.goToEntityInList($event)" ng-transclude></span>\n\n<evt-named-entity \n\tng-if="!vm.detailsInPopup && vm.active" \n\tdata-location=\'mainText\'\n\tdata-entity-id="{{::vm.entityId}}" data-entity-type="{{::vm.entityType}}"></evt-named-entity>\n\n\x3c!-- <span class="namedEntityRef__details" ng-if="vm.active">\n\t<span class="namedEntityRef__details-before"></span>\n\t<evt-named-entity data-entity-id="{{::vm.entityId}}" data-entity-type="{{::vm.entityType}}"></evt-named-entity>\n</span> --\x3e'},function(e,t){angular.module("evtviewer.namedEntity").service("evtGenericEntity",(function(){var e={},t={};e.addActiveType=function(n,i){void 0===t[n]&&(e.highlightElementsByType(n,i),t[n]={type:n,color:i})},e.removeActiveType=function(n,i){void 0!==t[n]&&(e.deEmphasizeElementsByType(n,i),t[n]=void 0)},e.highlightElementsByType=function(e,t){var i=document.getElementsByClassName(e);angular.forEach(i,(function(e){n(e,t,!0)}))},e.deEmphasizeElementsByType=function(e,t){var i=document.getElementsByClassName(e);angular.forEach(i,(function(e){n(e,t,!1)}))},e.highlightActiveTypes=function(){for(var n in t){var i=t[n];i&&e.highlightElementsByType(i.type,i.color)}};var n=function(e,t,n){n?(t?angular.element(e).css("background",t):angular.element(e).addClass("highlighted"),angular.element(e).addClass("entityHighlighted")):(t?angular.element(e).css("background",""):angular.element(e).removeClass("highlighted"),angular.element(e).removeClass("entityHighlighted"))};return e}))},function(e,t){angular.module("evtviewer.criticalApparatusEntry",[])},function(e,t){angular.module("evtviewer.criticalApparatusEntry").constant("APPENTRYDEFAULTS",{firstSubContentOpened:""}).config(["evtCriticalApparatusEntryProvider","configProvider","APPENTRYDEFAULTS",function(e,t,n){var i=t.makeDefaults("criticalApparatusEntry",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.criticalApparatusEntry").provider("evtCriticalApparatusEntry",(function(){var e=this.defaults;this.setDefaults=function(t){e=t};var t="";this.$get=["config","parsedData","baseData","evtCriticalApparatusParser","evtCriticalApparatus","evtPinnedElements",function(n,i,r,o,a,s){var l={},c={},u=[],d=0;return l.build=function(t,s){var l,h=d++,p=t||void 0,f=s.scopeWit||"",g=s.type||"default",m=n.showReadingExponent;if(void 0===c[h]){var v,y="",b="",_={_indexes:[]},x=i.getCriticalEntryById(t);if(void 0===x){var w=r.getXMLDocuments()[0];w=w.cloneNode(!0),o.findCriticalEntryById(w,t),x=i.getCriticalEntryById(t)}void 0!==x&&(y=(v=a.getContent(x,x._subApp,f)).witnessesGroups,""!==v.criticalNote&&(_._indexes.push("criticalNote"),_.criticalNote={label:"CRITICAL_APPARATUS.TABS.CRITICAL_NOTE"}),v.notSignificantReadings.length>0&&(_._indexes.push("notSignificantReadings"),_.notSignificantReadings={label:"CRITICAL_APPARATUS.TABS.ORTHOGRAPHIC_VARIANTS"}),_._indexes.push("moreInfo"),_.moreInfo={label:"CRITICAL_APPARATUS.TABS.MORE_INFO"},""!==x._xmlSource&&(_._indexes.push("xmlSource"),_.xmlSource={label:"CRITICAL_APPARATUS.TABS.XML"},v.xmlSource=x._xmlSource.replace(/ xmlns="http:\/\/www\.tei-c\.org\/ns\/1\.0"/g,"")),_._indexes.length>0&&""!==e.firstSubContentOpened&&(b=_._indexes.indexOf(e.firstSubContentOpened)<0?_._indexes[0]:e.firstSubContentOpened));var S=void 0===s.exponent?i.getCriticalEntryExponent(s.appId):s.exponent;return l={uid:h,scopeWit:f,appId:p,readingId:s.readingId,content:v,type:g,_subContentOpened:b,over:!1,selected:!1,tabs:_,exponent:S,showExponent:m,witnessesGroups:y,currentViewMode:s.scopeViewMode},c[h]=angular.extend(s.vm,l),u.push({id:h}),c[h]}},l.getById=function(e){if("undefined"!==c[e])return c[e]},l.getList=function(){return u},l.destroy=function(e){delete c[e]},l.getPinned=function(){return s.getPinnedByType("criticalApparatusEntry")},l.setCurrentAppEntry=function(e){t!==e&&(t=e)},l.getCurrentAppEntry=function(){return t},l.mouseOutAll=function(){angular.forEach(c,(function(e){e.mouseOut()}))},l.mouseOverByAppId=function(e){angular.forEach(c,(function(t){t.appId===e?t.mouseOver():t.mouseOut()}))},l.unselectAll=function(){angular.forEach(c,(function(e){e.unselect()})),l.setCurrentAppEntry("")},l.selectById=function(e){angular.forEach(c,(function(t){t.appId===e?t.setSelected():t.unselect()})),l.setCurrentAppEntry(e)},l}]}))},function(e,t){angular.module("evtviewer.criticalApparatusEntry").controller("CriticalApparatusEntryCtrl",["$scope","config","Utils","evtCriticalApparatusEntry","evtInterface","evtReading","evtBox","evtApparatuses","evtPinnedElements",function(e,t,n,i,r,o,a,s,l){e.content={};var c=this;this.toggleSubContent=function(e){c._subContentOpened!==e?c._subContentOpened=e:c._subContentOpened=""},this.toggleOverAppEntries=function(e){e.stopPropagation(),void 0===c.readingId&&(!1===c.over?(i.mouseOverByAppId(c.appId),o.mouseOverByAppId(c.appId)):(i.mouseOutAll(),o.mouseOutAll()))},this.isPinAvailable=function(){return t.toolPinAppEntries},this.isPinned=function(){return l.isPinned(c.appId)},this.getPinnedState=function(){return c.isPinned()?"pin-on":"pin-off"},this.togglePin=function(){if(c.isPinned())l.removeElement({id:c.appId,type:"criticalApparatusEntry"});else{l.addElement({id:c.appId,type:"criticalApparatusEntry"});var e=l.getPinned();e&&1===e.length&&r.updateState("isPinnedAppBoardOpened",!0)}},this.alignReadings=function(){a.alignScrollToApp(c.appId),s.alignScrollToApp(c.appId)},this.destroy=function(){var e=this.uid;i.destroy(e)},this.mouseOver=function(){c.over=!0},this.mouseOut=function(){c.over=!1},this.setSelected=function(){c.selected=!0},this.unselect=function(){c.selected=!1,c.closeSubContent()},this.isSelected=function(){return c.selected},this.isInline=function(){return r.isCriticalApparatusInline()},this.closeSubContent=function(){c._subContentOpened=""},this.callbackClick=function(e){e.stopPropagation();var t=e.target;"readingTxt"===c.currentViewMode&&(c.isSelected()?t&&t.className.indexOf("critical-apparatus-entry_other-content_headers")<0&&!n.DOMutils.isNestedInClassElem(t,"critical-apparatus-entry_other-content_headers")&&(i.unselectAll(),o.unselectAll(),r.updateState("currentAppEntry","")):(o.selectById(c.appId),r.updateState("currentAppEntry",c.appId),i.selectById(c.appId),c.isInline()||a.alignScrollToApp(c.appId)),r.updateUrl())},this.showInlineCriticalApparatus=function(){return t.showInlineCriticalApparatus}}])},function(e,t,n){angular.module("evtviewer.criticalApparatusEntry").directive("evtCriticalApparatusEntry",["evtCriticalApparatusEntry","evtInterface",function(e,t){return{restrict:"E",scope:{appId:"@",readingId:"@",scopeWit:"@",type:"@",exponent:"@"},transclude:!0,template:n(211),controllerAs:"vm",controller:"CriticalApparatusEntryCtrl",link:function(n,i,r){n.scopeViewMode=t.getState("currentViewMode");var o=e.build(n.appId,n);t.isCriticalApparatusInline()||(o.selected=t.getState("currentAppEntry")===n.appId),n.$on("$destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<div\n  class="critical-apparatus-entry"\n  ng-mouseover="vm.toggleOverAppEntries($event);"\n  ng-mouseout="vm.toggleOverAppEntries($event)"\n  ng-click="vm.callbackClick($event)"\n  ng-class="{\'noTools\': (scopeViewMode !== \'collation\' && scopeViewMode !== \'readingTxt\') && !vm.isPinAvailable(),\n             \'selected\': vm.isSelected() && !vm.isInline() && scopeViewMode === \'readingTxt\',\n             \'over\': vm.currentViewMode === \'readingTxt\' && vm.over}">\n  <div class="critical-apparatus-entry_main-content">\n\n\n    <div class="critical-apparatus-entry_tools"\n      ng-if="::(scopeViewMode === \'collation\' || scopeVieMode === \'readingTxt\') || vm.isPinAvailable()">\n      <button-switch\n            title="BUTTONS.PIN_REMOVE"\n            ng-if="::vm.isPinAvailable() && vm.type === \'pinned\'"\n            data-label=""\n            data-icon="remove"\n            data-type="pin-off"\n            ng-click="vm.togglePin()"></button-switch>\n      <button-switch\n            title="BUTTONS.PIN_TOGGLE"\n            ng-if="::vm.isPinAvailable() && vm.type === \'default\'"\n            data-label=""\n            data-icon="pin"\n            data-type="pin"\n            ng-class="{\'active\' : vm.isPinned()}"\n            ng-click="vm.togglePin()"></button-switch>\n      <button-switch\n            title="BUTTONS.ALIGN_READINGS"\n            ng-if="::vm.type === \'default\' && (scopeViewMode === \'collation\' || !vm.showInlineCriticalApparatus())"\n            data-label=""\n            data-icon="v-align"\n            data-type="alignReadings"\n            ng-click="vm.alignReadings()"></button-switch>\n    </div>\n    <span class="apparatus_exponent"\n            ng-if="::vm.showExponent"\n            compile="vm.exponent"></span>\n\n      <span\n        class="app_lemma"\n        ng-if="::vm.content.lemma.content !== \'\'"\n        compile="::vm.content.lemma.content"></span>\n    <div class="critical-apparatus-entry_main-content_list">\n            <span\n              class="app_reading"\n              ng-if="::vm.witnessesGroups.length === 0"\n              ng-repeat="reading in ::vm.content.significantReadings track by $index"\n              compile="reading.content">\n              </span>\n              <ul\n                class="app_reading_list"\n                ng-if="::vm.witnessesGroups.length > 0">\n                <li ng-repeat="group in ::vm.witnessesGroups"\n                  ng-if="::group.significantText !== undefined">\n                    <span\n                      class="witGrp_name"\n                      ng_if="::group.groupName !== \'\' && group.significantText !== undefined">{{group.groupName}}:</span>\n                    <span\n                      class="witGrp_content"\n                      compile="group.significantText"></span>\n                </li>\n             </ul>\n        </div>\n  </div>\n  <div class="critical-apparatus-entry_other-content"\n       ng-if="::vm.tabs._indexes.length > 0">\n\n      <div\n        class="critical-apparatus-entry_other-content_headers"\n        ng-class="{\'closed\': vm._subContentOpened === \'\'}">\n          <span ng-repeat="tab in ::vm.tabs._indexes track by $index"\n                ng-click="vm.toggleSubContent(tab)"\n                ng-class="{\'active\' : vm._subContentOpened == tab }">\n                {{ vm.tabs[tab].label | translate }}\n          </span>\n      </div>\n      <div\n        class="critical-apparatus-entry_other-content_panels"\n        ng-class="{\'closed\': vm._subContentOpened === \'\'}">\n          <div class="critical-apparatus-entry_other-content_panel"\n                ng-repeat="tab in ::vm.tabs._indexes track by $index"\n                ng-class="{\'active\' : vm._subContentOpened == tab}"\n                ng-switch="::tab">\n                <div ng-switch-when="notSignificantReadings">\n                  <ul ng-if="::vm.witnessesGroups.length <= 0">\n                      <li ng-repeat="reading in ::vm.content.notSignificantReadings track by $index"\n                          compile="::reading.content"></li>\n                  </ul>\n                  <div\n                    ng-if="::vm.witnessesGroups.length > 0"\n                    ng-repeat="group in ::vm.witnessesGroups">\n                    <span\n                      class="critical-apparatus-entry_other-content_panel_orthographic_title"\n                      ng-if="::group.notSignificantText !== undefined">\n                      {{ \'CRITICAL_APPARATUS.ORTHOGRAPHIC_VARIANTS_FOR\' | translate }} {{::group.groupName}}</span>\n                    <span\n                      class="critical-apparatus-entry_other-content_panel_orthographic_text"\n                      ng-if="::group.notSignificantText !== undefined"\n                      compile="group.notSignificantText"></span>\n                  </div>\n                </div>\n                <div ng-switch-when="moreInfo">\n                  <span class="app_lemma">\n                    {{ \'CRITICAL_APPARATUS.METADATA_FOR_LEMMA\' | translate }} "<em\n                        ng-if="::vm.content.lemma.content !== \'\'"\n                        compile="::vm.content.lemma.content"></em>"\n                  </span>\n                  <ul ng-if="::(vm.content.attributes._keys.length > 1 || vm.content.attributes._keys.length === 1 && vm.content.attributes._keys.indexOf(\'xml:id\') < 0)">\n                      <li ng-repeat="attr in ::vm.content.attributes._keys track by $index"\n                          ng-if="::attr !== \'xml:id\'">\n                          <span class="moreInfo-label">{{ ::attr }}</span> {{ ::vm.content.attributes.values[attr] }}\n                      </li>\n                  </ul>\n                  <ul ng-if="::(vm.content.attributes._keys.length <= 0 || vm.content.attributes._keys.length === 1 && vm.content.attributes._keys.indexOf(\'xml:id\') > 0)">\n                    <li><em>{{ \'CRITICAL_APPARATUS.NO_DATA\' | translate }}</em></li></ul>\n\n                  <span class="moreInfo-metadataTitle">{{ \'CRITICAL_APPARATUS.MORE_INFO\' | translate }}</span>\n                  <ul>\n                      <li\n                        class="app_lemma"\n                        class="app_reading_content"\n                        ng-if="::(vm.content.lemma.attributes._keys.length > 1 || vm.content.lemma.attributes._keys.length === 1 && vm.content.lemma.attributes._keys.indexOf(\'xml:id\') < 0)">\n                          <span>\n                            {{ \'CRITICAL_APPARATUS.METADATA_FOR\' | translate }}\n                            <em\n                                ng-if="::vm.content.lemma.content !== \'\'"\n                                compile="::vm.content.lemma.content"></em>\n                          </span>\n                          <ul>\n                            <li ng-repeat="attr in ::vm.content.lemma.attributes._keys track by $index"\n                                ng-if="::attr !== \'xml:id\'">\n                                <span class="moreInfo-label">{{ ::attr }}</span> {{ ::vm.content.lemma.attributes.values[attr] }}\n                            </li>\n                          </ul>\n                      </li>\n\n                      <li\n                        class="app_reading_content"\n                        ng-repeat="reading in ::vm.content.significantReadings track by $index"\n                        ng-if="::(reading.attributes._keys.length > 1 || reading.attributes._keys.length === 1 && reading.attributes._keys.indexOf(\'xml:id\') < 0)">\n                          <span>\n                           {{ \'CRITICAL_APPARATUS.METADATA_FOR\' | translate }}\n                            <em\n                                class="app_reading"\n                                compile="::reading.content"></em>\n                          </span>\n                          <ul>\n                            <li ng-repeat="attr in ::reading.attributes._keys track by $index"\n                                ng-if="::attr !== \'xml:id\'">\n                                <span class="moreInfo-label">{{ ::attr }}</span> {{ ::reading.attributes.values[attr] }}\n                            </li>\n                          </ul>\n                      </li>\n\n                      <li\n                        class="app_reading_content"\n                        ng-repeat="reading in ::vm.content.notSignificantReadings track by $index"\n                        ng-if="::(reading.attributes._keys.length > 1 || reading.attributes._keys.length === 1 && reading.attributes._keys.indexOf(\'xml:id\') < 0)">\n                          <span>\n                            {{ \'CRITICAL_APPARATUS.METADATA_FOR\' | translate }}\n                            <em\n                                class="app_reading"\n                                compile="::reading.content"></em>\n                          </span>\n                          <ul>\n                            <li ng-repeat="attr in reading.attributes._keys track by $index">\n                                <span class="moreInfo-label">{{ ::attr }}</span> {{ ::reading.attributes.values[attr] }}\n                            </li>\n                          </ul>\n                      </li>\n                  </ul>\n                </div>\n                <div ng-switch-when="xmlSource">\n                  <pre>{{ ::vm.content[tab] | newLinesToSpaces | normalizeMultispaces | prettyXml }}</pre>\n                </div>\n                <div ng-switch-default\n                     compile="::vm.content[tab]">\n                </div>\n          </div>\n      </div>\n  </div>\n</div>\n'},function(e,t,n){angular.module("evtviewer.criticalApparatusEntry").directive("evtWitnessRef",["evtCriticalApparatusEntry","evtBox","parsedData","evtInterface","config",function(e,t,i,r,o){return{restrict:"E",require:"^?evtCriticalApparatusEntry",scope:{witness:"@",scopeWit:"@"},transclude:!0,template:n(213),link:function(e,n,a){e.translationData={witness:e.witness},e.scopeWit===e.witness?e.title="CRITICAL_APPARATUS.WITNESS_REF_CURRENT":e.title="CRITICAL_APPARATUS.WITNESS_REF_OPEN",e.openWit=function(){var n=e.witness,a=e.scopeWit;if(n!==a){if(o.versions.length>0){var s,l=r.getState("currentVersion"),c=i.getVersionEntries()._indexes.versionWitMap;for(var u in c)c[u].indexOf(n)>=0&&(s=u);l!==s&&(r.updateCurrentVersion(s),r.updateState("currentWits",[]),r.updateAvailableWitnessesByVersion(s))}var d=r.getState("currentWits"),h=d.indexOf(a);d.indexOf(n)>=0&&r.removeWitness(n),void 0!==h&&r.addWitnessAtIndex(n,h+1),"collation"!==r.getCurrentView&&r.updateState("currentViewMode","collation"),r.updateUrl();var p=r.getState("currentAppEntry")||"";if(""!==p){var f=t.getElementByValueOfParameter("witness",n);void 0!==f&&f.scrollToAppEntry(p)}}}}}}])},function(e,t){e.exports='<span class="wit" \n      ng-class="::{\'selected\': witness === scopeWit}"\n      ng-click="openWit()"\n      title="{{ title | translate:translationData }}">{{ ::witness }}</span>'},function(e,t){angular.module("evtviewer.reading",[])},function(e,t){angular.module("evtviewer.reading").constant("READINGDEFAULTS",{tooltipMaxHeight:170,tooltipMaxWidth:200,openTriggerEvent:"click"}).config(["evtReadingProvider","configProvider","READINGDEFAULTS",function(e,t,n){var i=t.makeDefaults("reading",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.reading").provider("evtReading",(function(){var e=this.defaults;this.setDefaults=function(t){e=t};var t="";this.$get=["config","parsedData",function(n,i){var r={},o={},a=[],s=0;return r.build=function(t,l){var c,u,d=s++,h=t||void 0,p="",f=n.showReadingExponent;if(void 0===o[d]){var g=i.getCriticalEntryExponent(l.appId);if(void 0!==l.readingId){var m=i.getReadingAttributes(l.readingId,t)||[];for(var v in m)"wit"!==v&&"xml:id"!==v&&(p+=v.toUpperCase()+": "+m[v]+" - ");""!==p&&(p=p.slice(0,-3))}var y=i.getCriticalEntryById(h);y&&y._subApp&&(c=y._indexes._parentEntry||"");var b=h===r.getCurrentAppEntry();return u={uid:d,scopeWit:l.scopeWit||"",appId:h,parentAppId:c,readingId:l.readingId,readingType:l.readingType,variance:l.variance,type:l.type,overlap:l.overlap,noText:l.noText,range:void 0,attributes:p,exponent:g,showExponent:f,over:!1,apparatus:{opened:!1,content:{},_loaded:!1,_subContentOpened:"criticalNote",inline:l.inlineApparatus},selected:b,openTriggerEvent:angular.copy(e.openTriggerEvent),defaults:angular.copy(e)},o[d]=angular.extend(l.vm,u),a.push({id:d,entryId:h}),o[d]}},r.getById=function(e){var t;return angular.forEach(o,(function(n){n.appId===e&&(t=n)})),t},r.getList=function(){return a},r.setCurrentAppEntry=function(e){t=e},r.getCurrentAppEntry=function(){return t},r.mouseOutAll=function(){angular.forEach(o,(function(e){e.mouseOut()}))},r.mouseOverByAppId=function(e){angular.forEach(o,(function(t){t.appId===e?t.mouseOver():t.mouseOut()}))},r.unselectAll=function(){angular.forEach(o,(function(e){e.unselect()}))},r.closeAllApparatus=function(e){angular.forEach(o,(function(t){(void 0===e||t.uid!==e)&&t.closeApparatus()}))},r.selectById=function(e){angular.forEach(o,(function(t){t.appId===e?t.setSelected():t.unselect()})),r.setCurrentAppEntry(e)},r.destroy=function(e){delete o[e]},r}]}))},function(e,t){angular.module("evtviewer.reading").controller("ReadingCtrl",["config","$log","$scope","evtReading","parsedData","evtPopover","evtInterface","evtCriticalApparatusEntry","evtApparatuses",function(e,t,n,i,r,o,a,s,l){var c=this,u=(t.getInstance("reading"),function(e,t){angular.forEach(c.range,(function(n){e&&n.className.indexOf(t)<0?n.className+=" "+t:!e&&n.className.indexOf(t)>=0&&(n.className=n.className.replace(" "+t,""))}))});this.mouseOver=function(){c.over=!0,c.overlap&&c.range&&u(c.over,"over")},this.mouseOut=function(){c.over=!1,c.overlap&&c.range&&u(c.over,"over")},this.setSelected=function(){c.selected=!0,c.overlap&&c.range&&u(c.selected,"selected")},this.unselect=function(){c.selected=!1,c.overlap&&c.range&&u(c.selected,"selected")},this.isSelect=function(){return void 0!==c.parentAppId?c.selected||a.getState("currentAppEntry")===c.parentAppId:c.selected},this.isApparatusOpened=function(){return c.apparatus.opened&&!n.$parent.vm.state.topBoxOpened},this.closeApparatus=function(){c.apparatus.opened=!1},this.openApparatus=function(){c.apparatus.opened=!0,c.apparatus._loaded=!0},this.toggleOverAppEntries=function(e){e.stopPropagation(),c.hidden||(!1===c.over?(i.mouseOverByAppId(c.appId),s.mouseOverByAppId(c.appId)):(i.mouseOutAll(),s.mouseOutAll()))},this.toggleSelectAppEntries=function(e){c.hidden||(!1===c.selected?(i.selectById(c.appId),s.selectById(c.appId),c.apparatus.inline||(l.setCurrentApparatus("criticalApparatus"),l.alignScrollToApp(c.appId)),a.updateState("currentAppEntry",c.appId)):(a.updateState("currentAppEntry",""),i.unselectAll(),s.unselectAll())),a.updateUrl()},this.toggleApparatus=function(e){o.closeAll(),!c.hidden&&c.over&&(c.apparatus._loaded||(c.apparatus._loaded=!0),i.closeAllApparatus(c.uid),c.apparatus.opened=!c.apparatus.opened)},this.callbackClick=function(e){e&&e.stopPropagation(),c.over&&(c.toggleSelectAppEntries(e),(!c.isSelect()||c.apparatus.inline&&!c.apparatus.opened)&&c.toggleApparatus(e))},this.openApparatusSubContent=function(e){c.apparatus._subContentOpened=e},this.backgroundColor=function(){return"variant"===c.type?h():d()};var d=function(){var t;if(n.$parent.vm.state.heatmap){var i=r.getCriticalEntriesMaxVariance();return t=c.over&&!n.$parent.vm.state.topBoxOpened?"1":c.variance/i,"background: "+(e.heatmapColor.replace("rgb","rgba").slice(0,-1)+","+t+")")}return h()},h=function(){var t,o,a,s,l,u=e.possibleVariantFilters,d=e.possibleLemmaFilters,h=!1;if(c.parentAppId){var p=i.getById(c.parentAppId);h=!!p&&(p.over||p.isSelect())}if(void 0!==c.appId&&(s=r.getCriticalEntryById(c.appId),void 0!==(void 0!==c.readingId?s.content[c.readingId]:s.content[s.lemma])&&(l=r.getReadingAttributes(c.readingId,c.appId)||{},o=r.getCriticalEntriesFilters(),a="witness"===n.$parent.vm.type?u:d,Object.keys(l).length>0))){var f="",g=(c.over||c.isSelect()||h)&&!n.$parent.vm.state.topBoxOpened?"1":".4";for(var m in o){var v=o[m].name;if(a.indexOf(v)>=0&&void 0!==l&&void 0!==l[v])for(var y in o[m].values){var b=o[m].values[y].color,_=o[m].values[y].name;if(l[v]===_)if(b)f+=b.replace("rgb","rgba").slice(0,-1)+","+g+"),"}}""!==f&&((f=f.slice(0,-1)).match(/rgb/gi)&&f.match(/rgb/gi).length>1||f.match(/#/gi)&&f.match(/#/gi).length>1?(t="background: -moz-linear-gradient(left,"+f+");",t+="background: -webkit-linear-gradient(left,"+f+");",t+="background: ms-linear-gradient(left,"+f+");",t+="background: linear-gradient(left,"+f+");"):t="background: "+f)}return void 0===t&&(n.$parent.vm.state.topBoxOpened||(t=c.over||c.isSelect()||h?"background: "+e.variantColorDark:"background: "+e.variantColorLight)),t};this.fitFilters=function(){var e,t,i,o,a,s,l,u,d=r.getCriticalEntryById(c.appId),h=!1,p=0;if(e=r.getReadingAttributes(c.readingId,c.appId)||{},void 0!==d&&void 0!==(void 0!==c.readingId?d.content[c.readingId]:d.content[d.lemma])){var f=n.$parent.vm.state.filters||{},g=Object.keys(f);for(u in t=!1,g){if((i=f[o=g[u]]).totActive>0&&(p++,void 0!==e&&void 0!==e[o]))for(a=0,s=i.values;a<s.length&&!t;)s[s[a]].active&&(l=s[s[a]].name,t=t||e[o]===l),a++;if(t)break}h=t}return 0===p&&(h=!0),c.hidden=!h,h},this.destroy=function(){var e=this.uid;i.destroy(e)}}])},function(e,t,n){angular.module("evtviewer.reading").directive("evtReading",["evtReading","parsedData","evtInterface",function(e,t,i){return{restrict:"E",scope:{appId:"@",readingId:"@",readingType:"@",variance:"@",scopeWit:"@",type:"@",overlap:"@",noText:"@"},transclude:!0,template:n(219),controllerAs:"vm",controller:"ReadingCtrl",link:function(t,n,r){t.currentViewMode=i.getState("currentViewMode"),t.inlineApparatus=i.isCriticalApparatusInline();var o=e.build(t.appId,t);t.inlineApparatus&&i.getState("currentAppEntry")===t.appId&&o.openApparatus(),t.vm.overlap&&t.vm.range&&angular.forEach(t.vm.range,(function(e){e.onmouseover=function(){o.toggleOverAppEntries()},e.onmouseout=function(){o.toggleOverAppEntries()},e.onclick=function(){o.callbackClick()}})),t.$on("$destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<span \n    class="reading"\n    ng-mouseover="vm.toggleOverAppEntries($event);"\n    ng-mouseout="vm.toggleOverAppEntries($event)"\n    ng-click="vm.callbackClick($event);"\n    ng-class="{ \'selected\' : vm.isSelect() && !$parent.vm.state.topBoxOpened,\n                \'expansed\' : (!$parent.vm.state.topBoxOpened && vm.apparatus.opened && vm.apparatus.inline),\n                \'over\'     : vm.over, \n                \'invisible\': !vm.fitFilters(),\n                \'blurred\'  : $parent.vm.state.topBoxOpened}">\n    <span \n        ng-if="!vm.noText" \n        class="reading__text"\n        style="{{vm.backgroundColor()}}"\n        title="{{vm.attributes | translate}}"\n        ng-transclude></span>\n    \n    <span\n        ng-if="::vm.showExponent && vm.position !== \'start\'"\n        style="{{vm.backgroundColor()}}"\n        class="reading_exponent"\n        ng-click="vm.callbackClick($event);"\n        compile="::vm.exponent"></span>\n\n    <evt-critical-apparatus-entry \n      ng-class="{\'blurred\': $parent.vm.state.topBoxOpened}"\n      ng-if="vm.apparatus._loaded && vm.apparatus.inline && vm.isApparatusOpened() && vm.fitFilters()"\n      data-app-id="{{::vm.appId}}"\n      data-reading-id="{{::vm.readingId}}"\n      data-scope-wit="{{::vm.scopeWit}}"\n      data-exponent="{{::vm.exponent}}"></evt-critical-apparatus-entry>\n</span>'},function(e,t){angular.module("evtviewer.dialog",[])},function(e,t){angular.module("evtviewer.dialog").constant("DIALOGDEFAULTS",{}).config(["evtDialogProvider","configProvider","DIALOGDEFAULTS",function(e,t,n){var i=t.makeDefaults("dialog",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.dialog").provider("evtDialog",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["$log",function(t){var n={},i={},r=[],o=0,a=(t.getInstance("dialog"),function(){this.opened=!0}),s=function(){this.opened=!1},l=function(e){this.title=e},c=function(e){this.content=e},u=function(){var e=this.uid;delete i[e]};return n.build=function(t){var n,d=t.id||o++,h=t.type||"default",p=t.title||"",f=t.opened||!1;if(void 0===i[d])return n={uid:d,defaults:angular.copy(e),type:h,content:void 0,title:p,opened:f,open:a,close:s,setTitle:l,updateContent:c,destroy:u},i[d]=angular.extend(t.vm,n),r.push({id:d,type:h}),i[d]},n.getById=function(e){if("undefined"!==i[e])return i[e]},n.getList=function(){return r},n.getListByType=function(e){var t=[];for(var n in i)i[n].type===e&&t.push(i[n]);return t},n.openByType=function(e){for(var t in i)i[t].type===e&&i[t].open()},n.closeByType=function(e){for(var t in i)i[t].type===e&&i[t].close()},n.closeAll=function(){for(var e in i)void 0!==i[e].close()&&i[e].close()},n}]}))},function(e,t,n){angular.module("evtviewer.dialog").directive("evtDialog",["evtDialog",function(e){return{restrict:"E",scope:{id:"@",type:"@",title:"@",opened:"@"},replace:!1,transclude:!0,template:n(224),link:function(t,n,i){t.vm={id:t.id,type:t.type,title:t.title,opened:t.opened};var r=e.build(t);t.$on("$destroy",(function(){r&&r.destroy()}))}}}])},function(e,t){e.exports='<div class="evt-dialog"\n    ng-show="vm.opened"\n    ng-class="::{\'evt-dialog-error\': vm.type === \'error\',\n               \'evt-dialog-small\': vm.type === \'bookmark\' }">\n    <div class="evt-dialog-shadow" ng-click="vm.close()"></div>\n\n\n    <div class="evt-dialog-container">\n        <div class="evt-dialog-container-top">\n            <span class="evt-dialog-container-top-title">{{ vm.title | translate }}</span>\n            <button-switch \n                    class="noPadding"\n                    title="{{ \'DIALOGS.CLOSE\' | translate }}"\n                    data-icon="remove"\n                    data-type="closeDialog">\n            </button-switch>\n        </div>\n        <div ng-switch="vm.type">\n            <div \n                ng-switch-when="error"\n                class="evt-dialog-container-content"\n                compile="::vm.content"></div>\n            <div \n                ng-switch-default\n                class="evt-dialog-container-content" ng-transclude></div>\n        </div>\n    </div>\n</div>'},function(e,t){angular.module("evtviewer.tabsContainer",[])},function(e,t){angular.module("evtviewer.tabsContainer").provider("evtTabsContainer",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["$log","parsedData","evtInterface",function(t,n,i){var r={},o={},a=[],s=0,l=(t.getInstance("tabsContainer"),function(){var e=this.uid;delete o[e]}),c=function(e){this.subContentOpened=this.subContentOpened!==e?e:""},u=function(e,t){e.tabs[t].showSubTabs=!e.tabs[t].showSubTabs;var n=document.getElementById(t+"_subTabsIcon");n&&(n.className=e.tabs[t].showSubTabs?"fa fa-caret-down":"fa fa-caret-right")},d=function(e,t){var n=this;n.subContentOpened=e,t?n.subTabOpened=t:n.tabs[e].subTabs?(u(n,e),n.tabs[e].subTabs._indexes.indexOf(n.subTabOpened)<0&&(n.subTabOpened=n.tabs[e].subTabs._indexes[0]||"")):n.subTabOpened=""};return r.build=function(t){var r,h=t.id||s++,p=t.type||"",f=t.orientation||"vertical";if(void 0===o[h]){var g="<span>No content</span>",m={_indexes:[]};switch(p){case"projectInfo":if((S=n.getProjectInfo().fileDescription||"")&&""!==S&&(m.fileDescription={label:"PROJECT_INFO.FILE_DESCRIPTION",name:"fileDescription",content:S||g},m._indexes.push("fileDescription")),(T=n.getProjectInfo().encodingDescription||"")&&""!==T&&(m.encodingDescription={label:"PROJECT_INFO.ENCODING_DESCRIPTION",name:"encodingDescription",content:T||g},m._indexes.push("encodingDescription")),(E=n.getProjectInfo().textProfile||"")&&""!==E&&(m.textProfile={label:"PROJECT_INFO.TEXT_PROFILE",name:"textProfile",content:E||g},m._indexes.push("textProfile")),(C=n.getProjectInfo().outsideMetadata||"")&&""!==C&&(m.outsideMetadata={label:"PROJECT_INFO.OUTSIDE_METADATA",name:"outsideMetadata",content:C||g},m._indexes.push("outsideMetadata")),(k=n.getProjectInfo().revisionHistory||"")&&""!==k&&(m.revisionHistory={label:"PROJECT_INFO.REVISION_HISTORY",name:"revisionHistory",content:k||g},m._indexes.push("revisionHistory")),n.getBibliographicRefsCollection()._indexes.length>0){var v='<evt-bibliography data-id="mainBibliography"></evt-bibliography>';m.bibliography={label:"PROJECT_INFO.BIBLIOGRAPHY",name:"bibliography",content:v||g,scrollDisabled:!0},m._indexes.push("bibliography")}break;case"entitiesList":var y=n.getNamedEntitiesCollection();m._indexes=y._indexes;for(var b=0;b<y._indexes.length;b++){var _=y[L=y._indexes[b]]&&y[L]._icon?y[L]._icon:"fa-list-ul",x=y[L]&&y[L]._type?y[L]._type:L,w=y[L]&&y[L]._title?y[L]._title:L;m[L]={label:w,icon:_,name:L,content:'<evt-list data-list-id="'+L+'" data-list-type="'+x+'"></evt-list>',scrollDisabled:!0,noPadding:!0}}break;case"toc":var S,T,E,C,k;if(m.toc={label:"TOC.TITLE",name:"toc",content:"<evt-toc></evt-toc>"},m._indexes.push("toc"),(y=n.getNamedEntitiesCollection())&&y._indexes&&y._indexes.length>0){m.entitiesLists={label:"DIALOGS.NAMED_ENTITIES",name:"entitiesLists",content:"",subTabs:{_indexes:[]},showSubTabs:!1,noPadding:!0},m.entitiesLists.subTabs._indexes=y._indexes;for(b=0;b<y._indexes.length;b++){var L;_=y[L=y._indexes[b]]&&y[L]._icon?y[L]._icon:"fa-list-ul",x=y[L]&&y[L]._type?y[L]._type:L,w=y[L]&&y[L]._title?y[L]._title:L;m.entitiesLists.subTabs[L]={label:w,icon:_,name:L,content:'<evt-list data-list-id="'+L+'" data-list-type="'+x+'"></evt-list>',scrollDisabled:!0,noPadding:!0}}m._indexes.push("entitiesLists")}if(n.getBibliographicRefsCollection()._indexes.length>0){v='<evt-bibliography data-id="mainBibliography"></evt-bibliography>';m.bibliography={label:"PROJECT_INFO.BIBLIOGRAPHY",name:"bibliography",content:v||g,scrollDisabled:!0},m._indexes.push("bibliography")}m.projectInfo={label:"DIALOGS.PROJECT_INFO",name:"projectInfo",content:"",subTabs:{_indexes:[]},showSubTabs:!1},(S=n.getProjectInfo().fileDescription||"")&&""!==S&&(m.projectInfo.subTabs.fileDescription={label:"PROJECT_INFO.FILE_DESCRIPTION",name:"fileDescription",content:S||g},m.projectInfo.subTabs._indexes.push("fileDescription")),(T=n.getProjectInfo().encodingDescription||"")&&""!==T&&(m.projectInfo.subTabs.encodingDescription={label:"PROJECT_INFO.ENCODING_DESCRIPTION",name:"encodingDescription",content:T||g},m.projectInfo.subTabs._indexes.push("encodingDescription")),(E=n.getProjectInfo().textProfile||"")&&""!==E&&(m.projectInfo.subTabs.textProfile={label:"PROJECT_INFO.TEXT_PROFILE",name:"textProfile",content:E||g},m.projectInfo.subTabs._indexes.push("textProfile")),(C=n.getProjectInfo().outsideMetadata||"")&&""!==C&&(m.projectInfo.subTabs.outsideMetadata={label:"PROJECT_INFO.OUTSIDE_METADATA",name:"outsideMetadata",content:C||g},m.projectInfo.subTabs._indexes.push("outsideMetadata")),(k=n.getProjectInfo().revisionHistory||"")&&""!==k&&(m.projectInfo.subTabs.revisionHistory={label:"PROJECT_INFO.REVISION_HISTORY",name:"revisionHistory",content:k||g},m.projectInfo.subTabs._indexes.push("revisionHistory")),m._indexes.push("projectInfo")}var P,A,O=i.getProperty("tabsContainerOpenedContent"),I=i.getProperty("tabsContainerOpenedTab");return P=O||(m._indexes.length>0?m._indexes[0]:""),(A=I||(m[P].subTabs&&m[P].subTabs._indexes.length>0?m[P].subTabs._indexes[0]:""))&&(m[P].showSubTabs=!0),r={uid:h,type:p,orientation:f,defaults:angular.copy(e),tabs:m,subContentOpened:P,subTabOpened:A,toggleSubTabs:u,toggleSubContent:c,toggleSubTab:d,destroy:l},o[h]=angular.extend(t.vm,r),a.push({id:h,type:p}),o[h]}},r.setSubContentOpenedByType=function(e,t){angular.forEach(o,(function(n){n.type===e&&(n.subContentOpened=t)}))},r.setSubTabOpened=function(e,t,n){angular.forEach(o,(function(i){i.type===e&&(i.subContentOpened=t,i.subTabOpened=n)}))},r}]}))},function(e,t){angular.module("evtviewer.tabsContainer").controller("TabsContainerCtrl",["$log",function(e){e.getInstance("tabsContainer").log("TabsContainerCtrl running")}])},function(e,t,n){angular.module("evtviewer.tabsContainer").directive("evtTabsContainer",["evtTabsContainer","evtInterface",function(e,t){return{restrict:"E",scope:{type:"@",orientation:"@"},template:n(229),link:function(n,i,r){n.vm={id:n.id,type:n.type,orientation:n.orientation};var o=e.build(n);t.setTabContainerPanel(o.tabs),n.$watch((function(){return t.getHomePanel()}),(function(t,n){""!==n&&e.setSubContentOpenedByType("projectInfo",n)})),n.$on("$destroy",(function(){o&&("projectInfo"===o.type&&t.setHomePanel(""),o.destroy())}))}}}])},function(e,t){e.exports='<div class="evt-tabs-container {{ ::vm.orientation }}">\n    <div \n        class="evt-tabs-container_headers"\n        ng-class="{\'closed\': vm.subContentOpened === \'\'}">\n        \n        <span \n            class="evt-tabs-container_header"\n            ng-repeat-start="tab in ::vm.tabs._indexes"\n            ng-click="vm.toggleSubTab(tab)"\n            ng-class="{\'active\' : vm.subContentOpened === tab,\n                        \'hasSubTabs\': vm.tabs[tab].showSubTabs }">\n            <i ng-if="vm.tabs[tab].subTabs && vm.tabs[tab].subTabs._indexes.length > 0"\n               class="fa fa-caret-right"\n               id="{{tab + \'_subTabsIcon\'}}"></i>\n            <i ng-if="::vm.tabs[tab].icon" class="fa {{::vm.tabs[tab].icon}} evt-tabs-container_header-icon"></i>\n            {{ ::vm.tabs[tab].label | translate }}\n            {{DIALOGS._BOOKMARK | translate}}\n        </span>\n        <ul ng-repeat-end\n            class="evt-tabs-container_header_subTabs"\n            ng-class="{ \'hide\' : !vm.tabs[tab].subTabs || vm.tabs[tab].subTabs._indexes.length === 0 || !vm.tabs[tab].showSubTabs}">\n            <li class="evt-tabs-container_header_subTabs_tab"\n                ng-repeat="subTab in vm.tabs[tab].subTabs._indexes"\n                ng-click="vm.toggleSubTab(tab, subTab)"\n                ng-class="{\'active\' : vm.subTabOpened === subTab }">\n                <i ng-if="::vm.tabs[tab].subTabs[subTab].icon" class="fa {{::vm.tabs[tab].subTabs[subTab].icon}} evt-tabs-container_header-icon"></i>\n                {{ vm.tabs[tab].subTabs[subTab].label | translate }}\n            </li>\n        </ul>\n    </div>\n    <div \n        class="evt-tabs-container_panels"\n        ng-if="!vm.subTabOpened"\n        ng-class="{\'closed\': vm.subContentOpened === \'\', \'noPadding\' : vm.subContentOpened === \'toc\' || vm.subContentOpened === \'entitiesLists\'}">\n        \n        <div class="evt-tabs-container_panel"\n            id="{{\'subTab_\' + tab}}"\n            ng-repeat="tab in vm.tabs._indexes"\n            ng-class="{\'active\' : vm.subContentOpened === tab,\n                        \'addPadding\': tab === \'intro\',\n                        \'noscroll\': vm.tabs[tab].scrollDisabled,\n                        \'noPadding\': vm.tabs[tab].noPadding }"\n            compile="vm.tabs[tab].content">\n        </div>\n    </div>\n    <div \n        class="evt-tabs-container_panels"\n        ng-if="vm.subTabOpened">\n        <div class="evt-tabs-container_panel"\n            id="{{\'subTab_\' + subTab}}"\n            ng-repeat="subTab in vm.tabs[vm.subContentOpened].subTabs._indexes"\n            ng-class="{\'active\' : vm.subTabOpened === subTab,\n                       \'noscroll\': vm.tabs[vm.subContentOpened].scrollDisabled,\n                       \'noPadding\': vm.tabs[vm.subContentOpened].noPadding }"\n            compile="vm.tabs[vm.subContentOpened].subTabs[subTab].content"></div>\n    </div>\n</div>'},function(e,t){angular.module("evtviewer.toc",[])},function(e,t){angular.module("evtviewer.toc").provider("evtToc",(function(){this.defaults;this.setDefaults=function(e){e},this.$get=["$log","parsedData","evtInterface",function(e,t,n){var i={},r={},o=[],a=0;e.getInstance("toc");return i.build=function(e){var n,i=a++;if(!r[i]){var s=t.getDocuments()._indexes,l=t.getDivs(),c=t.getDivs()._indexes.main,u=t.getDivs()._indexes.subDivs,d=t.getPages(),h={};return n={currentId:i,docs:s.map((function(e){var n=t.getDocument(e),i={value:n.value,title:n.title,pages:n.pages,divs:{front:[],body:[],back:[],length:0}};return angular.forEach(c[e],(function(e){var n=t.getDiv(e);i.divs[n.section].push(e),i.divs.length++})),h[e]=!1,i})),docsId:s,divs:l,mainDivs:c,subDivs:u,pages:d,keys:["front","body","back"],open:h},r[i]=angular.extend(e.vm,n),o.push({id:i}),r[i]}},i.destroy=function(e){delete r[e]},i}]}))},function(e,t){angular.module("evtviewer.toc").controller("TocCtrl",["$log","evtInterface","parsedData","config",function(e,t,n,i){var r=e.getInstance("toc"),o=this,a=function(){for(var e=n.getEditions(),t=[],i=0;i<e.length;i++)e[i].visible&&t.push(e[i].value);return t};this.goToDiv=function(e,n){var i=a();"critical"!==t.getState("currentEdition")&&i.indexOf("critical")>-1&&t.updateState(currentEdition,"critical"),t.updateState("currentDoc",e),t.updateDiv(e,n),t.updateState("secondaryContent",""),t.updateUrl()},this.goToPage=function(e,n){var r=a();if("critical"===t.getState("currentEdition")&&r>0){var o=r.indexOf(i.defaultEdition)>-1?i.defaultEdition:r[0];t.updateState(currentEdition,o)}t.updateState("currentDoc",e),t.updateState("currentPage",n),t.updateState("secondaryContent",""),t.updateUrl()},this.openDetails=function(e){o.open[e]=!o.open[e]},r.log("TocCtrl running")}])},function(e,t,n){angular.module("evtviewer.toc").directive("evtToc",["evtToc","evtInterface",function(e,t){return{restrict:"E",scope:{},transclude:!0,template:n(234),controllerAs:"vm",controller:"TocCtrl",link:function(t,n,i){var r=e.build(t);t.$on("$destroy",(function(){r&&e.destroy(r.currentId)}))}}}])},function(e,t){e.exports='<div class="toc">\n    <div class="toc_doc" ng-repeat="doc in vm.docs" ng-class="{ \'open\' : vm.open[doc.value] }">\n        <span class="toc_doc_head"\n            ng-click="vm.openDetails(doc.value)"\n            ng-class="{ \'open\' : vm.open[doc.value] }">{{doc.title}}</span>\n        <div ng-class="{ \'open\' : vm.open[doc.value] }" class="toc_doc_details">\n            <div ng-if="doc.divs.length > 0">\n                <span class="list_head">{{ \'TOC.DIVS\' | translate }}</span>\n                <ul ng-repeat="key in vm.keys">\n                    <span class="list_head_sub"\n                            ng-if="doc.divs[key].length > 0">{{ \'TOC.\' + key.toUpperCase() | translate }}</span>\n                  <li ng-repeat="div in doc.divs[key]"\n                      ng-click="vm.goToDiv(doc.value, div)">\n                      <span class="indexLink">{{vm.divs[div].title}}</span>\n                      <ul ng-if="vm.subDivs[div].length > 0">\n                          <li ng-repeat="subDiv in vm.subDivs[div]"\n                              ng-click="vm.goToDiv(doc.value, subDiv)">\n                              <span class="indexLink">{{vm.divs[subDiv].title}}</span>\n                          </li>\n                      </ul>\n                  </li>\n                </ul>\n            </div>\n            <div ng-if="doc.pages.length > 0">\n                <span class="list_head">{{ \'TOC.PAGES\' | translate }}</span>\n                <ul>\n                    <li ng-repeat="page in doc.pages"\n                        ng-click="vm.goToPage(doc.value, page)">\n                        <span class="indexLink">{{page}}</span>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){angular.module("evtviewer.quote",[])},function(e,t){angular.module("evtviewer.quote").constant("QUOTEDEFAULTS",{openTriggerEvent:"click"}).config(["evtQuoteProvider","configProvider","QUOTEDEFAULTS",function(e,t,n){var i=t.makeDefaults("quote",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.quote").provider("evtQuote",(function(){var e=this.defaults;this.setDefaults=function(t){e=t};var t="";this.$get=["evtInterface",function(n){var i={},r={},o=[],a=0;return i.build=function(t){var s=a++,l=t.quoteId||void 0;if(void 0===r[s]){var c={uid:s,scopeWit:t.scopeWit||"",quoteId:l,scopeViewMode:n.getState("currentViewMode"),type:t.type||"",over:!1,apparatus:{opened:!1,content:{},_loaded:!1,inline:t.inlineApparatus},selected:l===i.getCurrentSourcesEntry(),openTriggerEvent:angular.copy(e.openTriggerEvent),defaults:angular.copy(e)};return r[s]=angular.extend(t.vm,c),o.push({id:s}),r[s]}},i.getById=function(e){if(void 0!==r[e])return r[e]},i.getList=function(){return o},i.setCurrentSourcesEntry=function(e){n.getState("currentQuote")!==e&&n.updateState("currentQuote",e),t=e},i.getCurrentSourcesEntry=function(){return t},i.mouseOutAll=function(){angular.forEach(r,(function(e){e.mouseOut()}))},i.mouseOverByQuoteId=function(e){angular.forEach(r,(function(t){t.quoteId===e?t.mouseOver():t.mouseOut()}))},i.unselectAll=function(){angular.forEach(r,(function(e){e.unselect()})),n.updateState("currentQuote","")},i.closeAllApparatus=function(e){angular.forEach(r,(function(t){(void 0===e||t.uid!==e)&&t.closeApparatus()}))},i.selectById=function(e){angular.forEach(r,(function(t){t.quoteId===e?t.setSelected():t.unselect()})),n.updateState("currentQuote",e),i.setCurrentSourcesEntry(e)},i.destroy=function(e){delete r[e]},i}]}))},function(e,t){angular.module("evtviewer.quote").controller("QuoteCtrl",["$log","$scope","evtQuote","evtPopover","evtInterface","evtApparatuses","evtSourcesApparatusEntry","parsedData",function(e,t,n,i,r,o,a,s){var l=this;e.getInstance("quote");this.mouseOver=function(){l.over=!0},this.mouseOut=function(){l.over=!1},this.setSelected=function(){l.selected=!0},this.unselect=function(){l.selected=!1},this.isSelected=function(){return l.selected},this.isApparatusOpened=function(){return l.apparatus.opened&&!t.$parent.vm.state.topBoxOpened},this.closeApparatus=function(){l.apparatus.opened=!1},this.openApparatus=function(){l.apparatus.opened=!0,l.apparatus._loaded=!0},this.toggleOverQuotes=function(e){e.stopPropagation(),!1===l.over?(n.mouseOverByQuoteId(l.quoteId),a.mouseOverByQuoteId(l.quoteId)):(n.mouseOutAll(),a.mouseOutAll())},this.toggleSelectQuotes=function(e){!1===l.selected?(n.selectById(l.quoteId),a.selectById(l.quoteId),l.apparatus.inline||(o.setCurrentApparatus("sources"),o.alignScrollToQuote(l.quoteId)),r.updateState("currentQuote",l.quoteId)):(n.unselectAll(),r.updateState("currentQuote",""),a.unselectAll()),r.updateUrl()},this.toggleApparatus=function(e){i.closeAll(),l.over&&(l.apparatus._loaded||(l.apparatus._loaded=!0),n.closeAllApparatus(l.uid),l.apparatus.opened=!l.apparatus.opened)},this.callbackClick=function(e){e.stopPropagation(),l.over&&(l.toggleSelectQuotes(e),(!l.isSelected()||l.apparatus.inline&&!l.apparatus.opened)&&l.toggleApparatus(e))},this.openApparatusSubContent=function(e){l.apparatus._subContentOpened=e},this.hasScopeSource=function(){var e=s.getSources()._indexes.quotesRef[l.quoteId]||void 0,t=r.getState("currentSourceText");return void 0!==e&&e.indexOf(t)>=0},this.destroy=function(){n.destroy(this.uid)}}])},function(e,t,n){angular.module("evtviewer.quote").directive("evtQuote",["evtQuote","evtInterface",function(e,t){return{restrict:"E",scope:{quoteId:"@",scopeWit:"@",type:"@"},transclude:!0,template:n(240),controllerAs:"vm",controller:"QuoteCtrl",link:function(n,i,r){n.inlineApparatus=t.isSourcesInline();var o=e.build(n);n.$on("$destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<span \n    class="quote"\n    ng-mouseover="vm.toggleOverQuotes($event)"\n    ng-mouseout="vm.toggleOverQuotes($event)"\n    ng-class="{ \'selected\' : vm.isSelected() && !$parent.vm.state.topBoxOpened,\n                \'expansed\' : (!$parent.vm.state.topBoxOpened && vm.apparatus.opened && vm.apparatus.inline),\n                \'over\'     : vm.over,\n                \'blurred\'  : $parent.vm.state.topBoxOpened,\n                \'subquote\' : vm.type === \'subquote\',\n                \'noquotes\' : $parent.vm.selected,\n                \'highlight\': vm.hasScopeSource() && vm.scopeViewMode === \'srcTxt\'}">\n    <sup\n        class="iconbis-evt_quote-left"\n        ng-click="vm.callbackClick($event);"\n        title="{{ \'QUOTES.QUOTE_START\' | translate}}"\n        ng-if="(vm.type !== \'subquote\' && !$parent.vm.selected) || (vm.over && vm.type === \'subquote\' && !$parent.vm.selected)">\n    </sup>\n    <span \n        class="quote__text"\n        ng-click="vm.callbackClick($event);"\n        ng-transclude></span>\n    <sup\n        class="iconbis-evt_quote-right"\n        ng-click="vm.callbackClick($event);"\n        title="{{ \'QUOTES.QUOTE_END\' | translate}}"\n        ng-if="(vm.type !== \'subquote\' && !$parent.vm.selected) || (vm.over && vm.type === \'subquote\' && !$parent.vm.selected)">\n    </sup>\n\n    <evt-sources-apparatus-entry\n        ng-class="{\'blurred\': $parent.vm.state.topBoxOpened}"\n        ng-if="vm.apparatus._loaded && vm.apparatus.inline"\n        ng-show="vm.isApparatusOpened()"\n        data-quote-id="{{::vm.quoteId}}"\n        data-scope-wit="{{::vm.scopeWit}}">\n    </evt-sources-apparatus-entry>\n</span>'},function(e,t){angular.module("evtviewer.sourcesApparatusEntry",[])},function(e,t){angular.module("evtviewer.sourcesApparatusEntry").constant("SOURCESAPPENTRY",{firstSubContentOpened:""}).config(["evtSourcesApparatusEntryProvider","configProvider","SOURCESAPPENTRY",function(e,t,n){var i=t.makeDefaults("sourcesApparatusEntry",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.sourcesApparatusEntry").provider("evtSourcesApparatusEntry",(function(){var e=this.defaults;this.setDefaults=function(t){e=t};var t="";this.$get=["parsedData","evtSourcesApparatus","evtInterface",function(n,i,r){var o={},a={},s=[],l=0;return o.build=function(t){var o=l++,c=(t.quoteId,t.scopeWit||"");if(void 0===a[o]){var u,d,h,p,f="",g={_indexes:[]},m={_indexes:[]},v=n.getQuote(t.quoteId);if(void 0!==v){for(var y in d=(u=i.getContent(v,c)).quote,(h=u.sources).length=u.sources.length,h)g._indexes.push(h[y].id),g[h[y].id]=h[y],g[h[y].id].tabs={_indexes:[]},""===g[h[y].id].text&&""===g[h[y].id].url||(g[h[y].id].tabs._indexes.push("text"),g[h[y].id].tabs.text={label:"SOURCES.TEXT"}),""!==g[h[y].id].bibl&&(g[h[y].id].tabs._indexes.push("biblRef"),g[h[y].id].tabs.biblRef={label:"SOURCES.BIBLIOGRAPHIC_REFERENCE"}),""!==g[h[y].id]._xmlSource&&(g[h[y].id].tabs._indexes.push("xmlSource"),g[h[y].id].tabs.xmlSource={label:"SOURCES.XML"});for(var b=h&&h[0]&&g[h[0].id]?g[h[0].id].tabs:{_indexes:[]},_=0;_<b._indexes.length;_++){var x=b._indexes[_];m._indexes.push(b._indexes[_]),m[x]=b[x]}""!==v._xmlSource&&(p=u._xmlSource),m._indexes.length>0&&""!==e.firstSubContentOpened&&(f=m._indexes.indexOf(e.firstSubContentOpened)<0?m._indexes[0]:e.firstSubContentOpened)}var w={uid:o,quoteId:t.quoteId,head:d,xml:p,sources:h,srcList:g,_activeSource:h[0]?h[0].id:void 0,_overSource:"",tabs:m,_subContentOpened:f,over:!1,selected:!1,currentViewMode:r.getState("currentViewMode")};return a[o]=angular.extend(t.vm,w),s.push({id:o}),a[o]}},o.getById=function(e){if(void 0!==a[e])return a[e]},o.getList=function(){return s},o.setCurrentSourcesEntry=function(e){r.getCurrentQuote!==e&&r.updateState("currentQuote",e),t=e},o.getCurrentSourcesEntry=function(){return t},o.mouseOutAll=function(){angular.forEach(a,(function(e){e.mouseOut()}))},o.mouseOverByQuoteId=function(e){angular.forEach(a,(function(t){t.quoteId===e?t.mouseOver():t.mouseOut()}))},o.unselectAll=function(){angular.forEach(a,(function(e){e.unselect()}))},o.selectById=function(e){angular.forEach(a,(function(t){t.quoteId===e?t.setSelected():(t.unselect(),t.closeSubContent())})),o.setCurrentSourcesEntry(e)},o.destroy=function(e){delete a[e]},o}]}))},function(e,t){angular.module("evtviewer.sourcesApparatusEntry").controller("sourcesApparatusEntryCtrl",["$scope","evtSourcesApparatusEntry","evtQuote","evtBox","evtApparatuses","evtInterface","parsedData",function(e,t,n,i,r,o,a){e.content={};var s=this;this.toggleSource=function(e){if(s._activeSource!==e){s._activeSource=e,s.tabs={_indexes:[]};for(var t=s.srcList[s._activeSource].tabs,n=0;n<t._indexes.length;n++){var i=t._indexes[n];s.tabs._indexes.push(t._indexes[n]),s.tabs[i]=t[i]}}},this.toggleOverSource=function(e,t){s._overSource!==t?s._overSource=t:s._overSource=""},this.getActiveSourceAbbr=function(e){for(var t=0;t<s.sources.length;t++)if(s.sources[t].id===e)return s.sources[t].abbr},this.mouseOver=function(){s.over=!0},this.mouseOut=function(){s.over=!1},this.setSelected=function(){s.selected=!0},this.unselect=function(){s.selected=!1,s.closeSubContent()},this.isSelect=function(){return o.getState("currentQuote")===s.quoteId||s.selected},this.closeSubContent=function(){s._subContentOpened=""},this.toggleSubContent=function(e){s._subContentOpened!==e?s._subContentOpened=e:s._subContentOpened=""},this.toggleOverSourcesEntries=function(e){e.stopPropagation(),s.over?(t.mouseOutAll(),"readingTxt"===s.currentViewMode&&n.mouseOutAll()):(t.mouseOverByQuoteId(s.quoteId),"readingTxt"===s.currentViewMode&&n.mouseOverByQuoteId(s.quoteId))},this.callbackClick=function(e){e.stopPropagation(),"readingTxt"===s.currentViewMode&&(t.selectById(s.quoteId),n.selectById(s.quoteId))},this.alignQuotes=function(){i.alignScrollToQuote(s.quoteId),r.alignScrollToQuote(s.quoteId),n.selectById(s.quoteId)},this.isSourceTextAvailable=function(e){for(var t=a.getSources()._indexes.availableTexts,n=!1,i=0;i<t.length;i++)t[i].id===e&&(n=!0);return n},this.destroy=function(){t.destroy(this.uid)}}])},function(e,t,n){angular.module("evtviewer.sourcesApparatusEntry").directive("evtSourcesApparatusEntry",["evtSourcesApparatusEntry","evtInterface",function(e,t){return{restrict:"E",scope:{quoteId:"@",scopeWit:"@"},transclude:!0,template:n(246),controllerAs:"vm",controller:"sourcesApparatusEntryCtrl",link:function(n,i,r){n.scopeViewMode=t.getState("currentViewMode");var o=e.build(n);n.$on("$destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<div\n    class="sources-apparatus-entry"\n    ng-class="{ \'selected\' : vm.isSelect() && vm.currentViewMode == \'readingTxt\',\n                \'over\' : vm.currentViewMode === \'readingTxt\' && vm.over,\n                \'srctxt\' : vm.currentViewMode === \'srcTxt\'}"\n    ng-mouseover="vm.toggleOverSourcesEntries($event)"\n    ng-mouseout="vm.toggleOverSourcesEntries($event)"\n    ng-click="vm.callbackClick($event)">\n\n    <div class="sources-apparatus-entry_main-content"\n        ng-if="vm.currentViewMode !== \'srcTxt\'">\n        <div class="sources-apparatus-entry_tools">\n            <button-switch\n                title=" {{ \'BUTTONS.ALIGN_QUOTES\' | translate }}"\n                ng-if="vm.currentViewMode !== \'imgTxt\' && vm.currentViewMode !== \'srcTxt\'"\n                data-label=""\n                data-icon="v-align"\n                data-type="alignReadings"\n                ng-click="vm.alignQuotes()"></button-switch>\n        </div>\n        <sup\n            class="iconbis-evt_quote-left">\n        </sup>\n        <span class="sources-apparatus-entry_main-content_header" compile="vm.head"></span>\n\n    </div>\n\n    <div class="sources-apparatus-entry_main-content_list"\n        ng-class="{ \'srctxt\' : vm.currentViewMode === \'srcTxt\' }">\n        <span class="sources-apparatus-entry_main-content_list-label"\n          ng-if="vm.sources.length > 1"> {{ \'SOURCES.QUOTED_SOURCES\' | translate }} </span>\n        <ul\n            ng-class="{ \'pointer\' : (vm.over || vm.selected) && vm.sources.length > 1 && vm.currentViewMode !== \'srcTxt\'}">\n            <li\n                ng-repeat-start="source in ::vm.sources"\n                class="source-id"\n                ng-class="{ \'selected\' : vm.selected && vm.sources.length > 1 && source.id == vm._activeSource,\n                            \'over\'   : (vm.over || vm.selected) && vm.sources.length > 1 && source.id == vm._overSource && vm.currentViewMode !== \'srcTxt\'}"\n                ng-mouseover="vm.toggleOverSource($event, source.id)"\n                ng-mouseout="vm.toggleOverSource($event, source.id)"\n                ng-click="vm.toggleSource(source.id)"\n                compile="source.abbr">\n            </li>\n            <span class="compareLabel"\n                ng-if="vm.currentViewMode === \'srcTxt\' && vm.isSourceTextAvailable(source.id)"\n                ng-repeat-end>\n                <evt-source-ref\n                    data-source-id="{{::source.id}}">\n                    {{ \'SOURCES.COMPARE_TEXT\' | translate }}\n                </evt-source-ref>\n            </span>\n        </ul>\n    </div>\n    <div class="sources-apparatus-entry_other-content"\n         ng-if="vm.tabs._indexes.length > 0 && vm.currentViewMode !== \'srcTxt\'">\n        <div\n            class="sources-apparatus-entry_other-content_headers"\n            ng-class="{\'closed\' : vm._subContentOpened === \'\'}">\n            <span ng-repeat="tab in ::vm.tabs._indexes"\n                  ng-click="vm.toggleSubContent(tab)"\n                  ng-class="{\'active\' : vm._subContentOpened == tab }">\n                {{ vm.tabs[tab].label | translate}}\n            </span>\n        </div>\n        <div class="sources-apparatus-entry_other-content_panels"\n             ng-class="{\'closed\': vm._subContentOpened === \'\'}">\n            <div class="sources-apparatus-entry_other-content_panel"\n                 ng-repeat="tab in ::vm.tabs._indexes"\n                 ng-class="{\'active\' : vm._subContentOpened == tab}"\n                 ng-switch="::tab">\n                 <div ng-switch-when="text">\n                      <span\n                        ng-if="::vm.srcList[vm._activeSource].text != \'\'"\n                        compile="vm.srcList[vm._activeSource].text"></span>\n                      <span\n                        ng-if="::vm.srcList[vm._activeSource].url != \'\'"\n                        compile="vm.srcList[vm._activeSource].url"></span>\n                 </div>\n                 <div ng-switch-when="biblRef"\n                      ng-if="::vm.srcList[vm._activeSource].bibl !== \'\'"\n                      compile="vm.srcList[vm._activeSource].bibl">\n                </div>\n                <div ng-switch-when="moreInfo">\n\n                </div>\n                <div ng-switch-when="xmlSource">\n                    {{ \'SOURCES.XML_SOURCE_QUOTE\' | translate }}\n                    <pre>{{ ::vm.xml | newLinesToSpaces | normalizeMultispaces | prettyXml }}</pre>\n                    {{ \'SOURCES.XML_SOURCE_FOR\' | translate }} <span compile="vm.getActiveSourceAbbr(vm._activeSource)"></span>\n                     <pre>{{ ::vm.srcList[vm._activeSource]._xmlSource | newLinesToSpaces | normalizeMultispaces | prettyXml }}</pre>\n                </div>\n                <div\n                    ng-switch-default\n                    ng-if="::vm.srcList[vm._activeSource].bibl !== \'\'"\n                    compile="vm.srcList[vm._activeSource].bibl"></div>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){angular.module("evtviewer.sourcesApparatusEntry").directive("evtSourceRef",["evtBox","evtInterface","parsedData","evtSourceSeg","evtApparatuses",function(e,t,i,r,o){return{restrict:"E",scope:{sourceId:"@",sourceAbbr:"@"},transclude:!0,template:n(248),link:function(n,r,a){n.openSource=function(){var r=n.sourceId;t.getState("currentSourceText")!==r&&(t.updateCurrentSourceText(r),t.updateState("currentSource",r)),"srcTxt"!==t.getState("currentViewMode")&&t.updateState("currentViewMode","srcTxt");var a="",s="",l=t.getState("currentQuote")||"",c=i.getSources()._indexes.correspId[n.sourceId]||[];for(var u in Object.keys(c))for(var d=0;d<c[Object.keys(c)[u]].length;d++)c[Object.keys(c)[u]][d]===l&&(a=c[Object.keys(c)[u]][d],s=Object.keys(c)[u]);""!==a&&""!==s&&(e.alignScrollToQuote(a,s),o.alignScrollToQuote(a,s))}}}}])},function(e,t){e.exports='<span class="source-ref"\n      ng-click="openSource()">\n      <span class="source-ref_text"\n            ng-transclude></span>\n</span>'},function(e,t){angular.module("evtviewer.sourcesApparatusEntry").provider("evtSourceSeg",(function(){var e="";this.$get=["parsedData","evtSourcesApparatus","evtInterface",function(t,n,i){var r={},o={},a=[],s=0;return r.build=function(e){var r,l=s++,c=e.segId||void 0,u=e.sourceId||void 0;if(void 0===o[l]){for(var d,h=i.getState("currentQuote")||"",p=[],f=t.getSources()._indexes.correspId[u][c],g=0;g<f.length;g++)d=n.getContent(t.getQuote(f[g]),"").quote,p.push({id:f[g],text:d});f.indexOf(h)>=0&&(r=h);var m={uid:l,segId:c,quoteId:r,sourceId:u,over:!1,selected:!1,panel:{quotes:p,_quoteOver:"",_quoteSelected:r||""}};return o[l]=angular.extend(e.vm,m),a.push({id:l}),o[l]}},r.getById=function(e){if(void 0!==o[e])return o[e]},r.getList=function(){return a},r.mouseOutAll=function(){angular.forEach(o,(function(e){e.mouseOut()}))},r.mouseOverBySegId=function(e){angular.forEach(o,(function(t){t.segId===e?t.mouseOver():t.mouseOut()}))},r.selectBySegId=function(e){angular.forEach(o,(function(t){t.segId===e?t.setSelected():(t.unselect(),t.unselectQuote())}))},r.unselectAll=function(){angular.forEach(o,(function(e){e.unselect(),e.unselectQuote()}))},r.updateCurrentQuote=function(t){e!==t&&angular.forEach(o,(function(n){for(var i=n.panel.quotes,r=0;r<i.length;r++)i[r].id===t&&n.getQuoteId()!==t&&(n.setQuoteId(t),e=t)}))},r.getCurrentQuote=function(){return e},r.destroy=function(e){delete o[e]},r}]}))},function(e,t){angular.module("evtviewer.sourcesApparatusEntry").controller("sourceSegCtrl",["evtSourceSeg","evtBox","evtQuote","evtApparatuses",function(e,t,n,i){var r=this;this.mouseOver=function(){r.over=!0},this.mouseOut=function(){r.over=!1},this.setSelected=function(){r.selected=!0},this.unselect=function(){r.selected=!1},this.getQuoteId=function(){return r.quoteId},this.setQuoteId=function(e){r.quoteId!==e&&(r.quoteId=e)},this.unselectQuote=function(){r.panel._quoteOver="",r.panel._quoteSelected=""},this.toggleOverSeg=function(t,n){t.stopPropagation(),!1===r.over?e.mouseOverBySegId(n):e.mouseOutAll()},this.callbackClick=function(t,n){t.stopPropagation(),r.selected?e.unselectAll():e.selectBySegId(n)},this.toggleQuoteOver=function(t,n){t.stopPropagation(),r.panel._quoteOver!==n?(e.mouseOutAll(),r.panel._quoteOver=n):r.panel._quoteOver=""},this.selectQuote=function(o,a){o.stopPropagation(),r.quoteId=a,r.panel._quoteSelected=a,e.updateCurrentQuote(a),n.selectById(a),t.alignScrollToQuote(a,r.segId),i.alignScrollToQuote(a,r.segId)},this.destroy=function(){e.destroy(this.uid)}}])},function(e,t,n){angular.module("evtviewer.sourcesApparatusEntry").directive("evtSourceSeg",["evtSourceSeg",function(e){return{restrict:"E",scope:{segId:"@",sourceId:"@"},transclude:!0,template:n(252),controllerAs:"vm",controller:"sourceSegCtrl",link:function(t,n,i){var r=e.build(t);t.$on("$destroy",(function(){r&&r.destroy()}))}}}])},function(e,t){e.exports='<span class="source-seg">\n    <sup\n        class="iconbis-evt_quote-left"\n        title="Quoted in the main text">\n    </sup>\n    <span\n        class="source-seg_text"\n        data-quote-id="{{vm.quoteId}}"\n        ng-mouseover="vm.toggleOverSeg($event, vm.segId)"\n        ng-mouseout="vm.toggleOverSeg($event, vm.segId)"\n        ng-click="vm.callbackClick($event, vm.segId)"\n        ng-class="{ \'over\': vm.over,\n                    \'selected\': vm.selected }"\n        ng-transclude></span>\n    <sup\n        class="iconbis-evt_quote-right"\n        title="Quoted in the main text">\n    </sup>\n    <div\n        class="source-seg_panel"\n        ng-if="vm.selected">\n        <span\n            class="source-seg_panel_label">\n            Related quotes:\n        </span>\n        <ul>\n            <li\n                ng-repeat="quote in ::vm.panel.quotes"\n                class="quoteText inSourceSeg"\n                ng-class="{ \'over\' : vm.panel._quoteOver == quote.id,\n                            \'selected\' : vm.panel._quoteSelected == quote.id}"\n                ng-mouseover="vm.toggleQuoteOver($event, quote.id)"\n                ng-mouseout="vm.toggleQuoteOver($event, quote.id)"\n                ng-click="vm.selectQuote($event, quote.id)"\n                title="Compare texts"\n                compile="quote.text">\n                \x3c!--button-switch\n                    title="Expand text"\n                    data-label="..."\n                    data-type="cropText"\n                    class="cropText_btn"></button-switch--\x3e\n            </li>\n        </ul>\n    </div>\n</span>'},function(e,t){angular.module("evtviewer.analogue",[])},function(e,t){angular.module("evtviewer.analogue").constant("ANALOGUEDEFAULTS",{}).config(["evtAnalogueProvider","configProvider","ANALOGUEDEFAULTS",function(e,t,n){var i=t.makeDefaults("analogue",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.analogue").provider("evtAnalogue",(function(){var e=this.defaults;this.setDefaults=function(t){e=t};var t="";this.$get=["evtInterface",function(n){var i={},r={},o=[],a=0;return i.build=function(t){var s=a++,l=t.analogueId||void 0;if(void 0===r[s]){var c={uid:s,scopeWit:t.scopeWit||"",analogueId:l,scopeViewMode:n.getState("currentViewMode"),over:!1,selected:l===i.getCurrentAnaloguesEntry(),apparatus:{opened:!1,content:{},_loaded:!1,inline:t.inlineApparatus},openTriggerEvent:angular.copy(e.openTriggerEvent),defaults:angular.copy(e)};return r[s]=angular.extend(t.vm,c),o.push({id:s}),r[s]}},i.getById=function(e){if(void 0!==r[e])return r[e]},i.getList=function(){return o},i.setCurrentAnaloguesEntry=function(e){n.getState("currentAnalogue")!==e&&n.updateState("currentAnalogue",e),t=e},i.getCurrentAnaloguesEntry=function(){return t},i.mouseOutAll=function(){angular.forEach(r,(function(e){e.mouseOut()}))},i.mouseOverByAnalogueId=function(e){angular.forEach(r,(function(t){t.analogueId===e?t.mouseOver():t.mouseOut()}))},i.unselectAll=function(){angular.forEach(r,(function(e){e.unselect()})),n.updateState("currentAnalogue","")},i.closeAllApparatus=function(e){angular.forEach(r,(function(t){(void 0===e||t.uid!==e)&&t.closeApparatus()}))},i.selectById=function(e){angular.forEach(r,(function(t){t.analogueId===e?t.setSelected():t.unselect()})),n.updateState("currentAnalogue",e),i.setCurrentAnaloguesEntry(e)},i.destroy=function(e){delete r[e]},i}]}))},function(e,t){angular.module("evtviewer.analogue").controller("AnalogueCtrl",["$log","$scope","evtAnalogue","evtPopover","evtInterface","evtApparatuses","evtAnaloguesApparatusEntry",function(e,t,n,i,r,o,a){var s=this;e.getInstance("analogue");this.mouseOver=function(){s.over=!0},this.mouseOut=function(){s.over=!1},this.setSelected=function(){s.selected=!0},this.unselect=function(){s.selected=!1},this.isSelect=function(){return s.selected},this.isApparatusOpened=function(){return s.apparatus.opened&&!t.$parent.vm.state.topBoxOpened},this.closeApparatus=function(){s.apparatus.opened=!1},this.openApparatus=function(){s.apparatus.opened=!0},this.toggleOverAnalogues=function(e){e.stopPropagation(),!1===s.over?(n.mouseOverByAnalogueId(s.analogueId),a.mouseOverByAnalogueId(s.analogueId)):(n.mouseOutAll(),a.mouseOutAll())},this.toggleSelectAnalogues=function(e){!1===s.selected?s.apparatus.opened||n.selectById(s.analogueId):s.apparatus.opened&&(n.unselectAll(),n.closeAllApparatus()),r.updateUrl()},this.toggleApparatus=function(e){i.closeAll(),s.over&&(s.apparatus.inline?s.apparatus._loaded||(s.apparatus._loaded=!0):("analogues"!==o.getCurrentApparatus()&&o.setCurrentApparatus("analogues"),a.selectById(s.analogueId),o.alignScrollToAnalogue(s.analogueId)),n.closeAllApparatus(s.uid),s.apparatus.opened=!s.apparatus.opened)},this.callbackClick=function(e){e.stopPropagation(),s.over&&(s.toggleSelectAnalogues(e),s.isSelect()&&!s.apparatus.opened?s.toggleApparatus(e):a.unselectAll())},this.destroy=function(){n.destroy(this.uid)}}])},function(e,t,n){angular.module("evtviewer.analogue").directive("evtAnalogue",["evtAnalogue","evtInterface",function(e,t){return{restrict:"E",scope:{analogueId:"@",scopeWit:"@"},transclude:!0,template:n(258),controllerAs:"vm",controller:"AnalogueCtrl",link:function(n,i,r){n.inlineApparatus=t.isAnaloguesInline();var o=e.build(n);n.$on("$destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<span\n    class="analogue"\n    ng-mouseover="vm.toggleOverAnalogues($event)"\n    ng-mouseout="vm.toggleOverAnalogues($event)"\n    ng-class="{ \'selected\' : vm.isSelect() && !$parent.vm.state.topBoxOpened,\n                \'expansed\' : (!$parent.vm.state.topBoxOpened && vm.apparatus.opened && vm.apparatus.inline),\n                \'over\'     : vm.over,\n                \'blurred\'  : $parent.vm.state.topBoxOpened}">\n    <i\n        class="iconbis-evt_analogue"\n        title="{{ \'ANALOGUES.ANALOGUE\' | translate}}"\n        ng-click="vm.callbackClick($event)"\n        ng-if="(vm.type !== \'subquote\' && !$parent.vm.selected) || (vm.over && vm.type === \'subquote\' && !$parent.vm.selected)">\n    </i>\n    <span\n        class="analogue__text"\n        ng-click="vm.callbackClick($event)"\n        ng-transclude></span>\n        \n    <evt-analogues-apparatus-entry\n        ng-class="{\'blurred\': $parent.vm.state.topBoxOpened}"\n        ng-if="vm.apparatus._loaded && vm.apparatus.inline"\n        ng-show="vm.isApparatusOpened()"\n        data-analogue-id="{{::vm.analogueId}}"\n        data-scope-wit="{{::vm.scopeWit}}">\n    </evt-analogues-apparatus-entry>\n</span>'},function(e,t){angular.module("evtviewer.analoguesApparatusEntry",[])},function(e,t){angular.module("evtviewer.analoguesApparatusEntry").constant("ANALOGUESAPPENTRY",{firstSubContentOpened:""}).config(["evtAnaloguesApparatusEntryProvider","configProvider","ANALOGUESAPPENTRY",function(e,t,n){var i=t.makeDefaults("analoguesApparatusEntry",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.analoguesApparatusEntry").provider("evtAnaloguesApparatusEntry",(function(){var e=this.defaults;this.setDefaults=function(t){e=t};var t="";this.$get=["parsedData","evtAnaloguesApparatus","evtInterface",function(n,i,r){var o={},a={},s=[],l=0;return o.build=function(t){var o=l++,c=(t.analogueId,t.scopeWit||"");if(void 0===a[o]){var u,d,h,p,f,g="",m={_indexes:[]},v={_indexes:[]},y=n.getAnalogue(t.analogueId);if(void 0!==y){for(var b in d=(u=i.getContent(y,c)).header,(h=u.sources).length=u.sources.length,h)m._indexes.push(h[b].id),m[h[b].id]=h[b],m[h[b].id].tabs={_indexes:[]},""!==m[h[b].id].text&&(m[h[b].id].tabs._indexes.push("text"),m[h[b].id].tabs.text={label:"ANALOGUES.TEXT"}),""!==m[h[b].id].bibl&&(m[h[b].id].tabs._indexes.push("biblRef"),m[h[b].id].tabs.biblRef={label:"ANALOGUES.BIBLIOGRAPHIC_REFERENCE"}),""!==m[h[b].id]._xmlSource&&(m[h[b].id].tabs._indexes.push("xmlSource"),m[h[b].id].tabs.xmlSource={label:"ANALOGUES.XML"});for(var _=m[h[0].id].tabs,x=0;x<_._indexes.length;x++){var w=_._indexes[x];v._indexes.push(_._indexes[x]),v[w]=_[w]}""!==y._xmlSource&&(f=u._xmlSource),v._indexes.length>0&&""!==e.firstSubContentOpened&&(g=v._indexes.indexOf(e.firstSubContentOpened)<0?v._indexes[0]:e.firstSubContentOpened)}p=void 0!==h&&void 0!==h[0].id?h[0].id:void 0;var S={uid:o,analogueId:t.analogueId,header:d,xml:f,sources:h,srcList:m,_activeSource:p,_overSource:"",tabs:v,_subContentOpened:g,over:!1,selected:!1,currentViewMode:r.getState("currentViewMode")};return a[o]=angular.extend(t.vm,S),s.push({id:o}),a[o]}},o.getById=function(e){if(void 0!==a[e])return a[e]},o.getList=function(){return s},o.setCurrentAnaloguesEntry=function(e){r.getCurrentAnalogue!==e&&r.updateState("currentAnalogue",e),t=e},o.getCurrentAnaloguesEntry=function(){return t},o.mouseOutAll=function(){angular.forEach(a,(function(e){e.mouseOut()}))},o.mouseOverByAnalogueId=function(e){angular.forEach(a,(function(t){t.analogueId===e?t.mouseOver():t.mouseOut()}))},o.unselectAll=function(){angular.forEach(a,(function(e){e.unselect()}))},o.selectById=function(e){angular.forEach(a,(function(t){t.analogueId===e?t.setSelected():(t.unselect(),t.closeSubContent())})),o.setCurrentAnaloguesEntry(e)},o.destroy=function(e){delete a[e]},o}]}))},function(e,t){angular.module("evtviewer.analoguesApparatusEntry").controller("analoguesApparatusEntryCtrl",["evtAnaloguesApparatusEntry","evtInterface","evtAnalogue","evtBox","evtApparatuses",function(e,t,n,i,r){var o=this;this.toggleSource=function(e){if(o._activeSource!==e){o._activeSource=e,o.tabs={_indexes:[]};for(var t=o.srcList[o._activeSource].tabs,n=0;n<t._indexes.length;n++){var i=t._indexes[n];o.tabs._indexes.push(t._indexes[n]),o.tabs[i]=t[i]}}},this.toggleOverSource=function(e,t){o._overSource!==t?o._overSource=t:o._overSource=""},this.getActiveSourceAbbr=function(e){for(var t=0;t<o.sources.length;t++)if(o.sources[t].id===e)return o.sources[t].abbr},this.toggleSubContent=function(e){o._subContentOpened!==e?o._subContentOpened=e:o._subContentOpened=""},this.mouseOver=function(){o.over=!0},this.mouseOut=function(){o.over=!1},this.setSelected=function(){o.selected=!0},this.unselect=function(){o.selected=!1,o.closeSubContent()},this.isSelect=function(){return t.getState("currentAnalogue")===o.analogueId||o.selected},this.closeSubContent=function(){o._subContentOpened=""},this.toggleOverAnaloguesEntries=function(t){t.stopPropagation(),o.over?(e.mouseOutAll(),"readingTxt"===o.currentViewMode&&n.mouseOutAll()):(e.mouseOverByAnalogueId(o.analogueId),"readingTxt"===o.currentViewMode&&n.mouseOverByAnalogueId(o.analogueId))},this.callbackClick=function(t){t.stopPropagation(),"readingTxt"===o.currentViewMode&&(e.selectById(o.analogueId),n.selectById(o.analogueId))},this.alignAnalogues=function(){i.alignScrollToAnalogue(o.analogueId),r.alignScrollToAnalogue(o.analogueId),n.selectById(o.analogueId)},this.destroy=function(){e.destroy(this.uid)}}])},function(e,t,n){angular.module("evtviewer.analoguesApparatusEntry").directive("evtAnaloguesApparatusEntry",["evtAnaloguesApparatusEntry","evtInterface",function(e,t){return{restrict:"E",scope:{analogueId:"@",scopeWit:"@"},transclude:!0,template:n(264),controllerAs:"vm",controller:"analoguesApparatusEntryCtrl",link:function(n,i,r){n.scopeViewMode=t.getState("currentViewMode");var o=e.build(n);n.$on("$destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<div class="analogues-apparatus-entry"\n     ng-class="{ \'selected\' : vm.isSelect() && vm.currentViewMode == \'readingTxt\',\n                 \'over\' : vm.currentViewMode === \'readingTxt\' && vm.over}"\n     ng-mouseover="vm.toggleOverAnaloguesEntries($event)"\n     ng-mouseout="vm.toggleOverAnaloguesEntries($event)"\n     ng-click="vm.callbackClick($event)">\n    \n    <div class="analogues-apparatus-entry_main-content">\n        <div\n            class="analogues-apparatus-entry_tools">\n            <button-switch \n                title="{{ \'BUTTONS.ALIGN_ANALOGUES\' | translate }} "\n                ng-if="vm.currentViewMode !== \'imgTxt\' && vm.currentViewMode !== \'srcTxt\'"\n                data-label=""\n                data-icon="v-align"\n                data-type="alignReadings"\n                ng-click="vm.alignAnalogues()"></button-switch>\n        </div>\n        <sup\n            class="iconbis-evt_analogue">\n        </sup>\n        <span class="analogues-apparatus-entry_main-content_header" compile="vm.header"></span>\n        \n    </div>\n    \n    <div class="analogues-apparatus-entry_main-content_list">\n        <span class="analogues-apparatus-entry_main-content_list-label"> {{\'ANALOGUES.PARALLEL_PASSAGES_IN\' | translate}} </span>\n        <ul ng-class="{ \'pointer\' : (vm.over || vm.selected) && vm.sources.length > 1}">\n            <li\n                ng-repeat="source in ::vm.sources"\n                class="source-id"\n                ng-class="{ \'selected\' : vm.selected && vm.sources.length > 1 && source.id == vm._activeSource,\n                            \'over\'   : (vm.over || vm.selected) && vm.sources.length > 1 && source.id == vm._overSource}"\n                ng-mouseover="vm.toggleOverSource($event, source.id)"\n                ng-mouseout="vm.toggleOverSource($event, source.id)"\n                ng-click="vm.toggleSource(source.id)"\n                compile="source.abbr">\n            </li>\n        </ul>\n    </div>\n\n    <div class="analogues-apparatus-entry_other-content"\n         ng-if="vm.tabs._indexes.length > 0">\n        <div class="analogues-apparatus-entry_other-content_headers">\n            <span class="analogues-apparatus-entry_tabLabel" ng-repeat="tab in ::vm.tabs._indexes"\n                  ng-click="vm.toggleSubContent(tab)"\n                  ng-class="{\'active\' : vm._subContentOpened == tab }">\n                {{ vm.tabs[tab].label | translate }}\n            </span>\n        </div>\n        <div class="analogues-apparatus-entry_other-content_panels"\n             ng-class="{\'closed\': vm._subContentOpened === \'\'}">\n            <div class="analogues-apparatus-entry_other-content_panel"\n                 ng-repeat="tab in ::vm.tabs._indexes"\n                 ng-class="{\'active\' : vm._subContentOpened == tab}"\n                 ng-switch="::tab">\n                 <div ng-switch-when="text"\n                      compile="vm.srcList[vm._activeSource].text">\n\n                 </div>\n                 <div ng-switch-when="biblRef"\n                      ng-if="::vm.srcList[vm._activeSource].bibl !== \'\'"\n                      compile="vm.srcList[vm._activeSource].bibl">\n                </div>\n                \x3c!--div ng-switch-when="moreInfo">\n                    TODO\n                </div--\x3e\n                <div ng-switch-when="xmlSource">\n                     <span class="xml-title"> {{ \'ANALOGUES.XML_SOURCE_FOR\' | translate}} {{ \'ANALOGUES.ANALOGUE\' | translate}} </span>\n                     <pre>{{ ::vm.xml | newLinesToSpaces | normalizeMultispaces | prettyXml}}</pre>\n                     <span class="xml-title">\n                         {{ \'ANALOGUES.XML_SOURCE_FOR\' | translate}} \n                         <span compile="vm.getActiveSourceAbbr(vm._activeSource)">\n                     </span>\n                     <pre>{{ ::vm.srcList[vm._activeSource]._xmlSource }}</pre>\n                </div>\n                <div\n                    ng-switch-default\n                    ng-if="::vm.srcList[vm._activeSource].bibl !== \'\'"\n                    compile="vm.srcList[vm._activeSource].bibl"></div>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){angular.module("evtviewer.apparatuses",[])},function(e,t){angular.module("evtviewer.apparatuses").constant("APPARATUSESDEFAULTS",{currentApparatus:"Critical Apparatus",apparatusesOrder:["Sources","Critical Apparatus","Analogues"],appStructure:"tabs"}).config(["evtApparatusesProvider","configProvider","APPARATUSESDEFAULTS",function(e,t,n){var i=t.makeDefaults("apparatuses",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.apparatuses").provider("evtApparatuses",(function(){var e=this.defaults;this.setDefaults=function(t){e=t};this.$get=["parsedData","evtInterface",function(t,n){var i={},r={},o=[],a=0;return i.build=function(i){var s=a++;if(void 0===r[s]){i.currentApparatus;var l={_indexes:[]},c=e.appStructure,u=[],d=[],h=[],p=t.getCriticalEntries(),f=t.getQuotes(),g=t.getAnalogues();if(p._indexes.appEntries)for(var m=0;m<p._indexes.appEntries.length;m++){var v=p._indexes.appEntries[m];!p[v]||void 0!==p[v]._isInMainVersion&&!0!==p[v]._isInMainVersion||u.push(v)}if(f._indexes.encodingStructure)for(var y=0;y<f._indexes.encodingStructure.length;y++){var b=f._indexes.encodingStructure[y];!f[b]||void 0!==f[b]._isInMainVersion&&!0!==f[b]._isInMainVersion||d.push(b)}if(g._indexes.encodingStructure)for(var _=0;_<g._indexes.encodingStructure.length;_++){var x=g._indexes.encodingStructure[_];!g[x]||void 0!==g[x]._isInMainVersion&&!0!==g[x]._isInMainVersion||h.push(x)}!n.isCriticalApparatusInline()&&u.length>0&&(l.criticalApparatus={label:"APPARATUSES.CRITICAL_APPARATUS",visibleList:u.slice(0,10),list:u},l._indexes.push("criticalApparatus")),!n.isSourcesInline()&&d.length>0&&(l.sources={label:"APPARATUSES.SOURCES",visibleList:d.slice(0,10),list:d},l._indexes.push("sources")),!n.isAnaloguesInline()&&h.length>0&&(l.analogues={label:"APPARATUSES.ANALOGUES",visibleList:h.slice(0,10),list:h},l._indexes.push("analogues")),l._indexes.length>0&&n.updateState("currentApparatus",l._indexes[0]);var w={isLoading:!0,uid:s,currentApparatus:l._indexes.length>0?l._indexes[0]:"",apparatuses:l,appStructure:c};return r[s]=angular.extend(i.vm,w),o.push({id:s}),r[s]}},i.setCurrentApparatus=function(e){n.updateState("currentApparatus",e),angular.forEach(r,(function(t){t.setCurrentApparatus(e)}))},i.getCurrentApparatus=function(){return"".currentApparatus},i.alignScrollToApp=function(e){for(var t in r)void 0!==r[t].scrollToAppEntry&&r[t].scrollToAppEntry(e)},i.alignScrollToQuote=function(e,t){for(var n in r)void 0!==r[n].scrollToQuotesEntry&&("source"===r[n].type?r[n].scrollToQuotesEntry(t):r[n].scrollToQuotesEntry(e))},i.alignScrollToAnalogue=function(e){for(var t in r)void 0!==r[t].scrollToAnaloguesEntry&&r[t].scrollToAnaloguesEntry(e)},i.destroy=function(e){delete r[e]},i}]}))},function(e,t){angular.module("evtviewer.apparatuses").controller("apparatusesCtrl",["$timeout","evtApparatuses",function(e,t){var n=this;this.setCurrentApparatus=function(t){t!==n.currentApparatus&&n.apparatuses[t]&&(n.loading=!0,n.currentApparatus=t,n.apparatuses[t].visibleList=n.apparatuses[t].list.slice(0,10),e((function(){n.loading=!1})))},this.getCurrentApparatus=function(){return n.currentApparatus},this.toggleAppStructure=function(e){n.appStructure!==e&&(n.appStructure=e)},this.toggleOpenApparatus=function(e){n.openApparatus!==e&&(n.openApparatus=e)},this.getVisibleList=function(e){return n.apparatuses[e]?n.apparatuses[e].visibleList:[]},this.getAppList=function(e){return n.apparatuses[e]?n.apparatuses[e].list:[]},this.loadMoreElements=function(){for(var e=n.currentApparatus,t=n.apparatuses[e].visibleList.length,i=0;i<5&&i<n.apparatuses[e].list.length;){var r=n.apparatuses[e].list[t+i];r&&n.apparatuses[e].visibleList.indexOf(r)<=0&&n.apparatuses[e].visibleList.push(r),i++}},this.destroy=function(){t.destroy(this.uid)}}])},function(e,t,n){(function(e){angular.module("evtviewer.apparatuses").directive("evtApparatuses",["$timeout","evtApparatuses","evtInterface","evtCriticalApparatusEntry",function(t,i,r,o){return{restrict:"E",scope:{currentApparatus:"@"},transclude:!0,template:n(270),controllerAs:"vm",controller:"apparatusesCtrl",link:function(n,a,s){var l=i.build(n);if(n.$on("$destroy",(function(){l&&l.destroy()})),n.vm.scrollToAppEntry=function(n){var i="criticalApparatus";if(l.apparatuses[i]){var r=e("#apparatuses_"+l.uid).find("[data-app-id='"+n+"']");r.length<=0&&(l.isLoading=!0),t((function(){var e=angular.element(a).find(".apparatuses_content_body")[0],t=1*window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");r.length<=0?(l.isLoading=!0,l.apparatuses[i].list.indexOf(n)>=0&&(i===l.currentApparatus?(l.loadMoreElements("criticalApparatus"),l.scrollToAppEntry(n)):l.isLoading=!1)):void 0!==r[0]&&(e.scrollTop=r[0].offsetTop-3*t,l.isLoading=!1)}))}},n.vm.scrollToQuotesEntry=function(n){if(l.apparatuses.sources){var i=e("#apparatuses_"+l.uid).find("[data-quote-id='"+n+"']");i.length<=0&&(l.isLoading=!0),t((function(){var e=angular.element(a).find(".apparatuses_content_body")[0],t=1*window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");i.length<=0?(l.isLoading=!0,l.apparatuses.sources.list.indexOf(n)>=0&&("sources"===l.currentApparatus?(l.loadMoreElements("sources"),l.scrollToQuotesEntry(n)):l.isLoading=!1)):void 0!==i[0]&&(e.scrollTop=i[0].offsetTop-3*t,l.isLoading=!1)}))}},n.vm.scrollToAnaloguesEntry=function(i){if(n.vm.apparatuses.analogues){var r=e("#apparatuses_"+l.uid).find("[data-analogue-id='"+i+"']");r.length<=0&&(l.isLoading=!0),t((function(){var e=angular.element(a).find(".apparatuses_content_body")[0],t=1*window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");r.length<=0?(l.isLoading=!0,l.apparatuses.analogues.list.indexOf(i)>=0&&("analogues"===l.currentApparatus?(l.loadMoreElements("analogues"),l.scrollToAnaloguesEntry(i)):l.isLoading=!1)):void 0!==r[0]&&(e.scrollTop=r[0].offsetTop-3*t,l.isLoading=!1)}))}},"criticalApparatus"===l.currentApparatus){var c=r.getState("currentAppEntry");c?(n.vm.scrollToAppEntry(c),t((function(){o.selectById(c)}),200)):l.isLoading=!1}else t((function(){l.isLoading=!1}),200)}}}])}).call(this,n(0))},function(e,t){e.exports='\x3c!--BUTTONS TO SWITCH THE VIEW MODE OF THE APPARATUSES--\x3e\n\x3c!--div\n    class="apparatuses_switch-mode-buttons">\n    <button\n        type="button"\n        ng-click="vm.toggleAppStructure(\'tabs\')"\n        class="tabs-button">\n        Switch to tab mode\n    </button>\n    <button\n        type="button"\n        ng-click="vm.toggleAppStructure(\'subBoxes\')"\n        class="subBoxes-button">\n        Switch to boxes mode\n    </button>\n</div--\x3e\n\n<div\n    class="apparatuses_main"\n    id="apparatuses_{{::vm.uid}}"\n    ng-switch="vm.appStructure">\n\n    <div\n        class="apparatuses_tabs"\n        ng-switch-when="tabs">\n        <div class="apparatuses_tabs_header">\n            <span class="appLabel" \n                ng-repeat="apparatusId in vm.apparatuses._indexes" \n                ng-click="vm.setCurrentApparatus(apparatusId)" \n                ng-class="{\'selected\': apparatusId === vm.getCurrentApparatus()}" \n                >{{ vm.apparatuses[apparatusId].label | translate }}</span> \n        </div>\n        <div class="loading" ng-if="vm.isLoading"><i class="fa fa-spinner fa-pulse loader"></i></div>\n        <div class="apparatuses_tabs_fakeTopSpace"></div>\n        <div class="apparatuses_tabs_body apparatuses_content_body">\n            <div infinite-scroll="vm.loadMoreElements()" infinite-scroll-distance="2" infinite-scroll-parent=\'true\' infinite-scroll-immediate-check="false" ng-switch="vm.currentApparatus">\n                <div\n                    class="active-apparatus"\n                    ng-switch-when="criticalApparatus">\n                    <evt-critical-apparatus-entry\n                        ng-repeat="app in vm.getVisibleList(vm.currentApparatus)"\n                        data-app-id="{{::app}}">\n                    </evt-critical-apparatus-entry>\n                </div>\n                <div\n                    class="active-apparatus"\n                    ng-switch-when="sources">\n                    <evt-sources-apparatus-entry\n                        ng-repeat="quote in vm.getVisibleList(vm.currentApparatus)"\n                        data-quote-id="{{::quote}}">\n                    </evt-sources-apparatus-entry>\n                </div>\n                <div\n                    class="active-apparatus"\n                    ng-switch-when="analogues">\n                    <evt-analogues-apparatus-entry\n                        ng-repeat="analogue in vm.getVisibleList(vm.currentApparatus)"\n                        data-analogue-id="{{::analogue}}">\n                    </evt-analogues-apparatus-entry>\n                </div>\n                <div\n                    ng-show="!vm.currentApparatus || vm.currentApparatus === \'\'"\n                    ng-switch-default>\n                    <span> {{ \'MESSAGES.SELECT_AN_APPARATUS\' | translate }} </span>\n                </div>\n                \x3c!--div\n                    ng-switch-when="Commentary Notes">\n                </div--\x3e\n            </div>\n        </div>\n    </div>\n    \n    <div\n        class="apparatuses_sub-boxes"\n        ng-switch-when="subBoxes">\n        <div class="apparatuses_sub-boxes_body">\n            <span>BOXES :)</span>\n        </div>\n    </div>\n    \n</div>'},function(e,t){angular.module("evtviewer.versionReading",[])},function(e,t){angular.module("evtviewer.versionReading").provider("evtVersionReading",(function(){var e="";this.$get=function(){var t={},n={},i=[],r=0;return t.build=function(e){var o=r++,a=e.appId||void 0;if(void 0===n[o]){var s={uid:o,appId:a,readingId:e.readingId,type:e.type,scopeWit:e.scopeWit,scopeVersion:e.scopeVersion,over:!1,selected:a===t.getCurrentVersionEntry(),apparatus:{opened:!1,_subContentOpened:""},highlightedText:!1};return n[o]=angular.extend(e.vm,s),i.push({id:o}),n[o]}},t.getCurrentVersionEntry=function(){return e},t.setCurrentVersionEntry=function(t){void 0!==t&&t!==e&&(e=t)},t.mouseOutAll=function(){angular.forEach(n,(function(e){e.mouseOut()}))},t.mouseOverByAppId=function(e){angular.forEach(n,(function(t){t.appId===e?t.mouseOver():t.mouseOut()}))},t.selectById=function(e){angular.forEach(n,(function(t){t.appId===e?t.setSelected():t.unselect()})),t.setCurrentVersionEntry(e)},t.unselectAll=function(){angular.forEach(n,(function(e){e.unselect()}))},t.closeAllApparatus=function(e){angular.forEach(n,(function(t){(void 0===e||t.uid!==e)&&t.closeApparatus()}))},t.destroy=function(e){delete n[e]},t}}))},function(e,t){angular.module("evtviewer.versionReading").controller("versionReadingCtrl",["$scope","parsedData","config","evtPopover","evtVersionReading","evtInterface",function(e,t,n,i,r,o){var a=this;this.mouseOver=function(){a.over=!0},this.mouseOut=function(){a.over=!1},this.highlightOn=function(){a.highlightedText=!0},this.highlightOff=function(){a.highlightedText=!1},this.setSelected=function(){a.selected=!0},this.unselect=function(){a.selected=!1},this.closeApparatus=function(){a.apparatus.opened=!1},this.isSelect=function(){return a.selected},this.toggleOverAppEntries=function(e){e.stopPropagation(),!1===a.over?r.mouseOverByAppId(a.appId):r.mouseOutAll()},this.toggleSelectAppEntries=function(e){!1===a.selected?a.apparatus.opened||(r.selectById(a.appId),o.updateCurrentVersionEntry(a.appId)):a.apparatus.opened&&(r.unselectAll(),o.updateCurrentVersionEntry("")),o.updateUrl()},this.toggleApparatus=function(t){i.closeAll(),a.over&&(r.closeAllApparatus(a.uid),a.apparatus.opened=!a.apparatus.opened,a.apparatus.opened&&e.$parent.vm.scrollToVersionApparatus(a.appId))},this.callbackClick=function(e){e.stopPropagation(),a.over&&(a.toggleSelectAppEntries(e),a.isSelect()&&a.apparatus.opened||a.toggleApparatus(e))},this.isScopeRecensioAvailable=function(){var i=e.$parent.vm.version||"",r=t.getVersionEntries()[a.appId].content,o=n.versions[0],s=!0;if(""!==i&&i!==o)void 0===r[i]&&(s=!1);else if(""===i&&"witness"===e.$parent.vm.type){var l=e.$parent.vm.witness,c=t.getVersionEntries()._indexes.versionWitMap,u="";for(var d in c)c[d].indexOf(l)>=0&&(u=d);""!==u&&void 0!==r[u]||(s=!1)}else void 0===r[o]&&(s=!1);return s},this.destroy=function(){var e=this.uid;r.destroy(e)}}])},function(e,t,n){angular.module("evtviewer.versionReading").directive("evtVersionReading",["evtVersionReading","evtInterface",function(e,t){return{restrict:"E",scope:{type:"@",appId:"@",readingId:"@",scopeWit:"@",scopeVersion:"@"},transclude:!0,template:n(275),controllerAs:"vm",controller:"versionReadingCtrl",link:function(n,i,r){n.currentViewMode=t.getState("currentViewMode");var o=e.build(n);n.$on("destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<span\n    class="version-reading"\n    ng-mouseover="vm.toggleOverAppEntries($event)"\n    ng-mouseout="vm.toggleOverAppEntries($event)"\n    ng-class="{ \'blurred\'  : $parent.vm.state.topBoxOpened,\n                \'over\'     : vm.over,\n                \'selected\' : vm.isSelect() && !$parent.vm.state.topBoxOpened}">\n    <span\n        class="version-reading_text"\n        ng-click="vm.callbackClick($event);"\n        ng-mouseover="vm.highlightOn()"\n        ng-mouseout="vm.highlightOff()"\n        ng-class="{ \'over\'     : vm.over && !vm.isSelect(),\n                    \'selected\' : vm.isSelect() && !$parent.vm.state.topBoxOpened}"\n        ng-transclude>\n    </span>\n    <evt-version-apparatus-entry\n        ng-if="vm.isScopeRecensioAvailable() && vm.apparatus.opened"\n        ng-class="{\'blurred\': $parent.vm.state.topBoxOpened}"\n        data-app-id="{{::vm.appId}}"\n        data-reading-id="{{::vm.readingId}}"\n        data-scope-wit="{{::vm.scopeWit}}"\n        data-scope-ver="{{::vm.scopeVer}}"></evt-version-apparatus-entry>\n</span>'},function(e,t){angular.module("evtviewer.versionApparatusEntry",[])},function(e,t){angular.module("evtviewer.versionApparatusEntry").provider("evtVersionApparatusEntry",(function(){this.$get=["parsedData","evtVersionApparatus","config",function(e,t,n){var i={},r={},o=[],a=0;return i.build=function(i){var s=a++,l=i.appId||void 0,c=i.scopeWit||"",u=i.scopeVer||"",d=i.$parent.$parent.$parent.vm.version||"";if(""===d&&"text"===i.$parent.$parent.$parent.type&&(d=n.versions[0]),void 0===r[s]){var h,p=e.getVersionEntries()[l],f={_indexes:[]};void 0!==p&&(""!==(h=t.getContent(p,c,u)).note&&(f._indexes.push("criticalNote"),f.criticalNote={label:"VERSIONS.CRITICAL_NOTE"}),h._readings&&(f._indexes.push("readings"),f.readings={label:"VERSIONS.VERSION_READING"}),h.attributes._keys.length>0&&(f._indexes.push("moreInfo"),f.moreInfo={label:"VERSIONS.MORE_INFO"}),""!==h._xmlSource&&(f._indexes.push("xmlSource"),f.xmlSource={label:"VERSIONS.XML"}));var g={uid:s,scopeWit:c,scopeVer:u,appId:l,readingId:i.readingId,content:h,_subContentOpened:"",tabs:f,currentViewMode:i.scopeViewMode,currentVer:d};return r[s]=angular.extend(i.vm,g),o.push({id:s}),r[s]}},i.destroy=function(e){delete r[e]},i}]}))},function(e,t){angular.module("evtviewer.versionApparatusEntry").controller("versionApparatusEntryCtrl",["config","evtBox","evtApparatuses","evtVersionApparatusEntry","$scope",function(e,t,n,i,r){var o=this;this.toggleSubContent=function(e){o._subContentOpened!==e?o._subContentOpened=e:o._subContentOpened=""},this.isPinAvailable=function(){return e.toolPinAppEntries},this.alignReadings=function(){t.alignScrollToApp(o.appId),n.alignScrollToApp(o.appId)},this.destroy=function(){var e=this.uid;i.destroy(e)}}])},function(e,t,n){angular.module("evtviewer.versionApparatusEntry").directive("evtVersionApparatusEntry",["evtVersionApparatusEntry","evtInterface",function(e,t){return{restrict:"E",scope:{appId:"@",readingId:"@",scopeWit:"@",scopeVer:"@"},transclude:!0,template:n(280),controllerAs:"vm",controller:"versionApparatusEntryCtrl",link:function(n,i,r){n.scopeViewMode=t.getState("currentViewMode");var o=e.build(n);n.$on("destroy",(function(){o&&o.destroy()}))}}}])},function(e,t){e.exports='<div\n    class="version-apparatus-entry"\n    ng-class="{ \'noTools\' : (scopeViewMode !== \'collation\' && scopeViewMode !== \'readingTxt\' && scopeViewMode !== \'versions\') && !vm.isPinAvailable()}">\n    <div\n        class="version-apparatus-entry_main-content">\n        \n        <div\n            class="version-apparatus-entry_tools"\n            ng-if="(scopeViewMode === \'collation\' || scopeViewMode === \'readingTxt\' || scopeViewMode === \'versions\')">\n            \x3c!--|| vm.isPinAvailable() ADD HERE--\x3e\n            \x3c!--button-switch \n                title="Remove Pin"\n                ng-if="vm.isPinAvailable() && vm.type === \'pinned\'"\n                data-label=""\n                data-icon="remove"\n                data-type="pinReading"\n                ng-click="vm.togglePin()"></button-switch>\n            <button-switch \n                title="Toggle Pin"\n                ng-if="vm.isPinAvailable() && vm.type === \'default\'"\n                data-label=""\n                data-icon="pin"\n                data-type="pinReading"\n                ng-class="{\'active\' : vm.isPinned()}"\n                ng-click="vm.togglePin()"></button-switch--\x3e\n            <button-switch \n                title="{{ \'BUTTONS.ALIGN_VERSION_READINGS\' | translate }}"\n                ng-if="scopeViewMode === \'collation\' || scopeViewMode === \'versions\'"\n                data-label=""\n                data-icon="v-align"\n                data-type="alignReadings"\n                ng-click="vm.alignReadings()"></button-switch>\n        </div>\n        <div\n            class="versions-lemmas">\n            <span\n                ng-repeat="version in ::vm.content.versions">\n                \x3c!--TODO: change to evt-ref--\x3e\n                <evt-version-ref\n                    data-target="{{::version.value}}"\n                    data-type="version"\n                    data-el-id="{{vm.currentVer}}"\n                    class="version-label"></evt-version-ref>\n                <span\n                    class="version-lem"\n                    compile="version.lem"></span>\n            </span>\n        </div>\n    </div>\n    <div\n        class="version-apparatus-entry_other-content"\n        ng-if="vm.tabs._indexes.length > 0">\n        <div\n            class="version-apparatus-entry_other-content_headers"\n            ng-class="{ \'closed\' : vm._subContentOpened === \'\'}">\n            <span ng-repeat="tab in ::vm.tabs._indexes"\n                ng-click="vm.toggleSubContent(tab)"\n                ng-class="{ \'active\' : vm._subContentOpened == tab }">\n                {{ vm.tabs[tab].label | translate }}\n            </span>\n        </div>\n        <div\n            class="version-apparatus-entry_other-content_panels"\n            ng-class="{ \'closed\' : vm._subContentOpened === \'\'}">\n            <div\n                class="version-apparatus-entry_other-content_panel"\n                ng-repeat="tab in ::vm.tabs._indexes"\n                ng-class="{ \'active\' : vm._subContentOpened == tab}"\n                ng-switch="::tab">\n                <div ng-switch-when="criticalNote"\n                    compile="vm.content.note">\n                </div>\n                <div ng-switch-when="readings">\n                    <div\n                        ng-repeat="version in ::vm.content.versions"\n                        ng-if="::vm.content._readings">\n                        <span compile="version.id"></span>\n                        <span\n                            ng-if="::version.significantReadings.length > 0"\n                            class="significant-readings_label"> {{ \'VERSIONS.SIGNIFICANT_VARIANTS\' | translate}} </span>\n                        <ul ng-if="::version.significantReadings.length > 0">\n                            <li ng-repeat="reading in ::version.significantReadings"\n                                compile="reading.content"></li>\n                        </ul>\n                        <span\n                            ng-if="::version.notSignificantReadings.length > 0"\n                            class="not-significant-readings_label"> {{ \'VERSIONS.ORTHOGRAPHIC_VARIANTS\' | translate}} </span>\n                        <ul ng-if="::version.notSignificantReadings.length > 0">\n                            <li ng-repeat="reading in ::version.notSignificantReadings"\n                                compile="reading.content"></li>\n                        </ul>\n                    </div>\n                </div>\n                <div ng-switch-when="moreInfo">\n                    \x3c!--BEGIN MORE INFO--\x3e\n                    <span\n                        class="app_generic-info"\n                        ng-if="(vm.content.attributes._keys.length > 1 || vm.content.attributes._keys.length === 1 && vm.content.attributes._keys.indexOf(\'xml:id\') < 0)">\n                        {{ \'VERSIONS.METADATA_FOR_APP_ENTRY\' | translate}}\n                    </span>\n                    <ul ng-if="(vm.content.attributes._keys.length > 1 || vm.content.attributes._keys.length === 1 && vm.content.attributes._keys.indexOf(\'xml:id\') < 0)">\n                        <li ng-repeat="attr in ::vm.content.attributes._keys"\n                            ng-if="::attr !== \'xml:id\'">\n                            <span class="moreInfo-label">{{::attr}}</span> {{::vm.content.attributes.values[attr]}}\n                        </li>\n                    </ul>\n                    <span class="moreInfo-metadataTitle">{{ \'VERSIONS.MORE_INFO_ABOUT_READING\' | translate}}</span>\n                    <ul>\n                        <li \n                            class="app_version"\n                            ng-repeat="version in ::vm.content.versions"\n                            ng-if="::version.attributes._keys.length > 0  && version.attributes._keys.indexOf(\'xml:id\') < 0">\n                            <span>\n                                {{ \'VERSIONS.METADATA_FOR\' | translate}} \n                                <em \n                                    compile="version.id"></em> \n                            </span>\n                            <ul>\n                                <li ng-repeat="attr in ::version.attributes._keys"\n                                    ng-if="::attr !== \'xml:id\'">\n                                    <span class="moreInfo-label">{{::attr}}</span> {{::version.attributes.values[attr]}}\n                                </li>\n                            </ul>\n                            <span\n                                ng-if="::version.significantReadings.length > 0"\n                                ng-repeat-start="reading in ::version.significantReadings">{{ \'VERSIONS.METADATA_FOR_SIGNIFICANT_READING\' | translate}}:\n                                <em compile="reading.content"></em>\n                            </span>\n                            <ul ng-repeat-end\n                                ng-if="::version.significantReadings.length > 0">\n                                <li ng-repeat="attr in ::reading.attributes._keys"\n                                    ng-if="::attr !== \'xml:id\'">\n                                    <span class="moreInfo-label">{{::attr}}</span> {{::reading.attributes.values[attr]}}\n                                </li>\n                            </ul>\n                            <span\n                                ng-if="::version.notSignificantReadings.length > 0"\n                                ng-repeat-start="reading in ::version.notSignificantReadings">{{ \'VERSIONS.METADATA_FOR_ORTHOGRAPHIC_READING\' | translate}}:\n                                <em compile="reading.content"></em>\n                            </span>\n                            <ul ng-repeat-end\n                                ng-if="::version.notSignificantReadings.length > 0">\n                                <li ng-repeat="attr in ::reading.attributes._keys"\n                                    ng-if="::attr !== \'xml:id\'">\n                                    <span class="moreInfo-label">{{::attr}}</span> {{::reading.attributes.values[attr]}}\n                                </li>\n                            </ul>\n                      </li>\n                  </ul>\n                  \x3c!--END MORE INFO--\x3e\n                </div>\n                <div ng-switch-when="xmlSource">\n                    <pre>{{ ::vm.content._xmlSource }}</pre>\n                </div>\n                <div ng-switch-default\n                    compile="vm.content[tab]">\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){angular.module("evtviewer.versionApparatusEntry").provider("evtVersionRef",(function(){this.$get=["evtInterface","evtBox","parsedData","config",function(e,t,n,i){var r={},o={},a=[],s=0;return r.build=function(r){var l=r.id||s++,c=r.elId||"",u=r.type||"default",d=r.target||"",h=r.title||"",p=function(){console.log("TODO "+u)},f=e.getState("currentViewMode"),g="";switch(u){case"version":c!==d&&d!==i.versions[0]&&(h="VERSIONS.OPEN_TEXT"),g=n.getVersionEntries()._indexes.versionId[d],p=function(){var r;if(c!==d&&d!==i.versions[0]){r=e.getState("currentVersions"),scopeVersionIndex=r.indexOf(c),r.indexOf(d)>=0&&r.length>1&&e.removeVersion(d),e.addVersion(d,scopeVersionIndex+1),"versions"!==f&&e.updateState("currentViewMode","versions"),e.updateUrl();var o=e.getState("currentVersionEntry")||"";if(""!==o){var a=t.getElementByValueOfParameter("version",d);void 0!==a&&a.scrollToAppEntry(o)}}else if(d===i.versions[0]){"versions"!==f&&e.updateState("currentViewMode","versions"),e.updateCurrentVersion(d);var s=n.getVersionEntries()[e.getCurrentVersionEntry()].content,l=Object.keys(s);r=e.getState("currentVersions");for(var u=0;u<l.length;u++)r.indexOf(l[u])<0&&l[u]!==i.versions[0]&&e.addVersion(l[u]);e.updateUrl()}}}var m={uid:l,id:g,elId:c,type:u,target:d,title:h,callback:p,currentViewMode:f,ver:e.getCurrentVersion()||""};return o[l]=angular.extend(r.vm,m),a.push({id:l,type:u}),o[l]},r.destroy=function(e){delete o[e]},r}]}))},function(e,t,n){angular.module("evtviewer.versionApparatusEntry").directive("evtVersionRef",["evtVersionRef",function(e){return{restrict:"E",scope:{type:"@",target:"@",elId:"@"},transclude:!0,template:n(283),link:function(t,n,i){t.vm={};var r=e.build(t);t.$on("$destroy",(function(){r&&e.destroy(r.uid)}))}}}])},function(e,t){e.exports='<span\n    class="evt-version-ref"\n    title="{{vm.title | translate}}"\n    ng-click="vm.callback()"\n    ng-class="{ \'selected\' : vm.elId === vm.target, \'not-select\': vm.elId === vm.ver }">\n    <span\n        class="evt-version-ref_text"\n        compile="vm.id"\n        ng-class="{ \'selected\' : vm.elId === vm.target, \'not-select\': vm.target === vm.ver }">\n    </span>\n</span>'},function(e,t,n){"use strict";angular.module("evtviewer.imageViewer",["evtviewer.openseadragon","evtviewer.imageViewerService"]),angular.module("evtviewer.imageViewer",["evtviewer.openseadragon","evtviewer.imageViewerService"]).controller("imageViewerCtrl",["$scope","imageViewerModel",function(e,t){e.options=t.getOptions()}])},function(e,t,n){"use strict";var i=n(26);angular.module("evtviewer.openseadragon",["evtviewer.imageViewer","evtviewer.openseadragonService","evtviewer.interface"]).directive("osd",["$timeout","imageViewerHandler","evtInterface","osd",function(e,t,n,r){return{restrict:"E",scope:{options:"=",name:"=",tilesource:"=",prefixUrl:"="},controller:"imageViewerCtrl",template:"<div id='osd-img' class='box-image Edition'></div>",transclude:!0,link:function(o,a,s){e((function(){var e=r.build(s.name),a=null;try{a=new i.Viewer(e)}catch(e){console.error("viewer in timeout osd directive errore",e)}o.osd=a,o.$parent[s.name]=a;var l=r.imgCoeff();null!=l&&null!=l&&t.setImgCoeff(l),t.setViewer(a),t.setScope(o),o.osd.addHandler("home",t.home),o.osd.addOnceHandler("open",t.openPage,n.getState("currentPage")),o.$watch((function(){return n.getState("currentPage")}),(function(e,n){if(n!==e){t.updateViewerPage(e)}}),!1)}),10),a.on("$destroy",(function(){s.name&&(o.$parent[s.name]=null),o.osd.removeHandler("open",t.open),o.osd.removeHandler("home",t.home),o.osd.removeHandler("navigator-scroll",t.navigatorScroll),o.osd.removeHandler("pan",t.pan),o.osd.destroy()}))}}}])},function(e,t){angular.module("evtviewer.imageViewer")},function(e,t){angular.module("evtviewer.imageViewer").controller("imageViewerCtrl",["$scope",function(e){}])},function(e,t){angular.module("evtviewer.imageViewerService",["evtviewer.dataHandler"]).service("imageViewerModel",["parsedData",function(e){var t={id:"osd-img",prefixUrl:"/openseadragon/images/",tileSources:[],showRotationControl:!0,showNavigator:!0,visibilityRatio:1,defaultZoomLevel:1,panHorizontal:!0,constrainDuringPan:!0,minZoomLevel:.8,maxZoomLevel:2,wrapVertical:!1,navigatorLeft:"94%",navigatorHeight:"100%",navigatorWidth:"50%",navigatorTop:"1%"};this.getOptions=function(){for(var n,i=e.getPages(),r=i.length,o="",a=0;a<r;a++){var s={type:"image",url:""};n=i[a],void 0!==(o=e.getPage(n).source)&&""!==o&&" "!==o&&null!==o&&(s.url=o,t.tileSources.push(s))}return t}}])},function(e,t){angular.module("evtviewer.openseadragon").provider("osd",(function(){this.$get=["parsedData","config",function(e,t){var n={test:function(e){return!0},imgCoeff:function(){return t.imageNormalizationCoefficient},build:function(n){var i,r=t.imageViewerOptions,o=e.getPages(),a=o.length,s="";r.tileSources=[];for(var l=0;l<a;l++){var c={type:"image",url:""};i=o[l],void 0!==(s=e.getPage(i).source)&&""!==s&&" "!==s&&null!==s&&(c.url=s,r.tileSources.push(c))}return r.id="osd-img",r}};return n}]}))},function(e,t,n){(function(e){!function(){var t=n(26);angular.module("evtviewer.openseadragonService",["evtviewer.interface"]).service("imageViewerHandler",["evtInterface","imageScrollMap","parsedData",function(n,i,r){var o=void 0,a=!1,s=this;function l(e){var n={};return n.x=e.ulx,n.y=e.uly,n.width=e.lrx-e.ulx,n.hight=e.lry-e.uly,new t.Rect(n.x/o,n.y/o,n.width/o,n.hight/o)}s.viewer=void 0,s.scope=void 0,s.setImgCoeff=function(e){o=e},s.setViewer=function(e){s.viewer=e},s.setScope=function(e){s.scope=e},s.open=function(){viewer.viewport.getBounds();var e=s.viewer.viewport.getBounds(),n=e.height/e.width,i=new t.Rect(0,0,0,n);s.viewer.viewport.fitBounds(i,!1)},s.openPage=function(e){for(var t=e.userData,i=0;r.getPages()[i]!==t;)if((i+=1)>r.getPages().length){console.error("error in open page");break}var o=i;s.viewer.goToPage(o);var a=n.getState("currentPage");t!==a&&s.scope.$apply((function(){n.updateState("currentPage",""!==t?t:a)}))},s.home=function(){var e=s.viewer.viewport.getBounds(),n=e.height/e.width,i=new t.Rect(0,.1,1,n);s.viewer.viewport.fitBounds(i,!0)},s.navigatorScroll=function(e){e.scroll},s.pan=function(e){try{if(void 0===e.immediately){var t=e.center.y,r=e.eventSource.viewport._oldCenterY;if(1===s.viewer.viewport.getZoom()){var o,a;s.viewer.viewport.getBounds();t>r?(o=i.mapDown(e.eventSource.viewport.getBounds()),a=n.getState("currentPage"),o!==a&&s.scope.$apply((function(){n.updateState("currentPage",o)}))):t<r&&(o=i.mapUP(e.eventSource.viewport.getBounds()),a=n.getState("currentPage"),o!==a&&s.scope.$apply((function(){n.updateState("currentPage",""!==o?o:a)})))}}}catch(e){console.error("error in pan",e)}},s.updateViewerBounds=function(e){var t=s.viewer.viewport.getBounds();i.isInBounds(t.y,e)||i.updateBounds(s.viewer,e)},s.updateViewerPage=function(e){for(var t=e,i=0;r.getPages()[i]!==t&&!((i+=1)>r.getPages().length););var o=i;s.viewer.goToPage(o);var a=n.getState("currentPage");t!==a&&s.scope.$apply((function(){n.updateState("currentPage",""!==t?t:a)}))},s.highlightOverlay=function(e){if(!e)throw"problem in zone data extraction";try{s.viewer.removeOverlay("line-overlay")}catch(e){}var t=l(e),n=document.createElement("div");n.id="line-overlay",n.className="highlight",s.viewer.addOverlay({element:n,location:t})},s.highlightSelectedOverlay=function(e,t){if(!e)throw"problem in zone data extraction";try{s.viewer.removeOverlay("line-overlay")}catch(e){console.error("no line overlay",e)}var n=l(e),i=document.createElement("div");i.id="line-overlay_selected",i.className="selectedHighlight",s.viewer.addOverlay({element:i,location:n})},s.turnOffOverlay=function(){try{s.viewer.removeOverlay("line-overlay")}catch(e){console.error("no line overlay",e)}},s.turnOffOverlaySelected=function(){try{s.viewer.removeOverlay("line-overlay_selected")}catch(e){console.error("no line overlay",e)}},s.moveToZone=function(e){var n=s.viewer.viewport.getCenter(),i=(s.viewer.viewport.getBounds(!0),e.uly,e.uly/o<n.y?n.y:e.uly/o),r=new t.Point(n.x,i);s.viewer.viewport.panTo(r)},s.showHotSpot=function(e){for(var n=[],i=0;i<e.length;i++){var r=new t.Rect(e[i].ulx/o,e[i].uly/o,(e[i].lrx-e[i].ulx)/o,(e[i].lry-e[i].uly)/o);n.push(r)}for(var a=[],l=0;l<e.length;l++){var u=e[l].content,d=e[l].id,h=(e[l],document.createElement("div"));h.id="hotspot-overlay_selected-"+d,h.className="hotspot",h.dataset.id=d,h.dataset.content=u,h.onmouseover=function(){s.viewer.zoomPerClick=1},h.onmouseout=function(){s.viewer.zoomPerClick=1.5},h.onclick=function(){c(this)},a.push(h)}s.viewer.zoomPerClick=1;for(var p=0;p<e.length;p++)s.viewer.addOverlay({element:a[p],location:n[p]})};var c=function(n){if(!a){var i=e(n),r=i.position().left,o=i.position().top,l=i.width(),c=i.height(),d=new t.Point(r,o),h=new t.Point(r+l,o+c),p=s.viewer.viewport.pointFromPixel(d),f=s.viewer.viewport.pointFromPixel(h),g=0;g=p.x<=.4?p.x+(f.x-p.x)+.05:p.x-(f.x-p.x+.1);var m=new t.Rect(g,p.y,.3,.35),v=document.createElement("div");v.id="div-hotspot-overlay_selected-"+n.dataset.id,v.className="hotspot-dida";var y=document.createElement("div");y.id="div-title-hotspot-overlay_selected-"+n.dataset.id,y.className="hotspot-dida-title",y.innerHTML="";var b=document.createElement("div");b.className="PopupCloser",b.dataset.id=n.dataset.id,b.onclick=function(){s.viewer.zoomPerClick=1.5,u(this)};var _=document.createElement("i");_.className="fa fa-times",_.onmouseover=function(){s.viewer.zoomPerClick=1},_.onmouseout=function(){s.viewer.zoomPerClick=1.5},b.appendChild(_),y.appendChild(b);var x=document.createElement("div");x.id="div-body-hotspot-overlay_selected-"+n.dataset.id,x.className="hotspot-dida-body",x.innerHTML=n.dataset.content,v.appendChild(y),v.appendChild(x);var w={element:v,location:m,rotationMode:t.OverlayRotationMode.NO_ROTATION};a=!a,s.viewer.addOverlay(w),e(w.element).draggable()}return a},u=function(e){try{var t=e.dataset.id;s.viewer.removeOverlay("div-hotspot-overlay_selected-"+t)}catch(e){console.error("no hotspot overlay",e)}return a=!1};s.hiddenHotSpot=function(e){try{for(var t=0;t<e.length;t++)s.viewer.removeOverlay("hotspot-overlay_selected-"+e[t].id)}catch(e){console.error("no hotspot overlay",e)}},s.lineZone=function(e){var t=l(e),i=document.createElement("div");return i.id="line-div-overlay_"+e.id,i.dataset.lb=e.id.replace("line","lb"),i.className="line-overlay",i.onmouseover=function(){var e="active"===n.getToolState("ITL"),t=n.getState("currentViewMode");if(e&&"imgTxt"===t){this.className+=" selectedHighlight";var i=document.querySelectorAll("[data-line='"+this.dataset.lb+"']");if(0==i.length){var r=this.dataset.lb.replace("reg","orig");i=document.querySelectorAll("[data-line='"+r+"']")}for(var o=0;o<i.length;o++)i[o].className+=" lineHover"}},i.onmouseout=function(){var e="active"===n.getToolState("ITL"),t=n.getState("currentViewMode");if(e&&"imgTxt"===t){this.className=this.className.replace(" selectedHighlight","")||"";var i=document.querySelectorAll("[data-line='"+this.dataset.lb+"']");if(0==i.length){var r=this.dataset.lb.replace("reg","orig");i=document.querySelectorAll("[data-line='"+r+"']")}for(var o=0;o<i.length;o++)i[o].className=i[o].className.replace(" lineHover","")||""}},i.onclick=function(){},s.viewer.addOverlay({element:i,location:t}),i},s.testFun=function(){return"ok"}}])}()}).call(this,n(0))},function(e,t){angular.module("evtviewer.openseadragonService").service("imageScrollMap",(function(){var e="yPage";this.mapDown=function(e){return t(e,"down")},this.mapUP=function(e){return t(e,"up")};var t=function(e,t){var n,i,r=e.getBoundingBox();switch(t){case"down":if(r.y<n[i+"1"].to)return(i+"1").substr(1).toLowerCase();for(var o=1;o<=n.size;o++)if(r.y<n[i+o].to&&r.y>n[i+o].from)return(i+o).substr(1).toLowerCase();break;case"up":for(o=1;o<=n.size;o++)if(r.y<(n[i+o].from+n[i+o].to)/2&&r.y>n[i+o].from)return(i+o).substr(1).toLowerCase();return"";default:return""}};this.isInBounds=function(t,n){var i=void 0;return t>=(void 0)[i=10==n.length?e+n.substr(n.length-1):e+n.substr(n.length-2)].from&&t<(void 0)[i].to},this.updateBounds=function(t,n){var i=t.viewport.getBounds(),r=void 0;r=10==n.length?e+n.substr(n.length-1):e+n.substr(n.length-2);var o=i.height/i.width,a=new OpenSeadragon.Rect(0,(void 0)[r].from,1,o);t.viewport.fitBounds(a,!1)}}))},function(e,t){angular.module("evtviewer.openseadragonService").service("overlayHandler",(function(){this.test=function(e){console.log(e)}}))},function(e,t){angular.module("evtviewer.search",[])},function(e,t){angular.module("evtviewer.search").constant("SEARCHBOXDEFAULTS",{diplomaticSearchBoxBtn:{showResults:{title:"Show results",label:"",icon:"search-results-show",type:"searchResultsShow"},hideResults:{title:"Hide results",label:"",icon:"search-results-hide",type:"searchResultsHide",hide:!0},virtualKeyboard:{title:"Virtual keyboard",label:"",icon:"keyboard",type:"searchVirtualKeyboard"},caseSensitive:{title:"Case sensitive",label:"",icon:"case-sensitive",type:"searchCaseSensitive"},exactWord:{title:"Exact word",label:"",icon:"exact-word",type:"searchExactWord"},searchClear:{title:"Clear search",label:"",icon:"close",type:"searchClear"},previous:{title:"Previous",label:"",icon:"previous",type:"searchPrevResult"},next:{title:"Next",label:"",icon:"next",type:"searchNextResult"},search:{title:"Search",label:"",icon:"search",type:"search"}},interpretativeSearchBoxBtn:{showResults:{title:"Show results",label:"",icon:"search-results-show",type:"searchResultsShow"},hideResults:{title:"Hide results",label:"",icon:"search-results-hide",type:"searchResultsHide",hide:!0},virtualKeyboard:{title:"Virtual keyboard",label:"",icon:"keyboard",type:"searchVirtualKeyboard"},caseSensitive:{title:"Case sensitive",label:"",icon:"case-sensitive",type:"searchCaseSensitive"},exactWord:{title:"Exact word",label:"",icon:"exact-word",type:"searchExactWord"},searchClear:{title:"Clear search",label:"",icon:"close",type:"searchClear"},previous:{title:"Previous",label:"",icon:"previous",type:"searchPrevResult"},next:{title:"Next",label:"",icon:"next",type:"searchNextResult"},search:{title:"Search",label:"",icon:"search",type:"search"}}}).config(["evtSearchBoxProvider","configProvider","SEARCHBOXDEFAULTS",function(e,t,n){var i=t.makeDefaults("search",n);e.setDefaults(i)}])},function(e,t,n){angular.module("evtviewer.search").directive("evtSearchBox",["evtSearchBox","evtInterface",function(e,t){return{restrict:"E",template:n(296),replace:!0,controllerAs:"vm",controller:"SearchBoxCtrl",link:function(n){e.build(n,n.vm),n.$watch((function(){return t.getState("currentEdition")}),(function(t,i){i!==t&&e.build(n,n.vm)}),!0)}}}])},function(e,t){e.exports='<div class="search-box internal"\n     ng-class="{\'open\' : $parent.vm.getState(\'searchBox\'), \'results-open\' : vm.getState(\'searchResultBox\')} ">\n\n   \x3c!-- search form --\x3e\n   <form ng-submit="vm.doSearchCallback()">\n      <div class="searchBtnGroup">\n         <div class="btn-left">\n\n            <button-switch\n               ng-repeat="button in vm.searchBoxBtn|limitTo: vm.getBtnLimit()"\n               class="no-background"\n               title="{{::button.title}}"\n               data-label="{{::button.label}}"\n               data-icon="{{::button.icon}}"\n               data-type="{{::button.type}}"\n               ng-hide="button.hide">\n            </button-switch>\n         </div>\n         <div class="btn-right">\n            <button-switch\n               ng-repeat="button in vm.searchBoxBtn|limitTo: -4"\n               class="no-background"\n               title="{{::button.title}}"\n               data-label="{{::button.label}}"\n               data-icon="{{::button.icon}}"\n               data-type="{{::button.type}}">\n            </button-switch>\n         </div>\n      </div>\n\n      <input type="text" id="{{::vm.keyboardId}}" ng-model="vm.searchInput" ng-change="vm.highlightSearchResults(vm.parentBoxId, vm.searchInput)" autocomplete="off" autofocus>\n   </form>\n   <evt-virtual-keyboard></evt-virtual-keyboard>\n   <evt-search-results ng-controller="SearchResultsCtrl as searchResults"></evt-search-results>\n</div>\n'},function(e,t){angular.module("evtviewer.search").controller("SearchBoxCtrl",["$rootScope","config","evtInterface","evtSearchBox","evtSearchResults","evtBox",function(e,t,n,i,r,o){var a=this,s=[];a.searchInput="",a.searchedTerm="",a.resList=[],a.visibleRes=[],a.getState=function(e){if(a.status)return a.status[e]},a.updateState=function(e){return a.status[e]=!a.status[e],a.status[e]},a.getBoxEdition=function(e){return o.getEditionById(e)},a.getInputValue=function(){return a.searchInput},a.getSearchedTerm=function(){return a.searchedTerm},a.closeBox=function(e){return a.status[e]=!1,a.status[e]},a.loadMoreElements=function(){for(var e=0;e<10&&e<a.resList.length;){var t=a.visibleRes.length-1,n=a.resList[t+1];n&&(a.visibleRes.push(n),a.searchResults+=n),e++}},a.highlightSearchResults=function(e,t){return r.highlightSearchResults(e,t)},a.doSearchCallback=function(){for(var e in s)s[e].parentId===a.parentBoxId&&s[e].btn.doCallback()},a.getBtnLimit=function(){for(var e in this.searchBoxBtn)if("searchVirtualKeyboard"===this.searchBoxBtn[e].type)return 5;return 4},e.$on("searchBtn",(function(e,t){s.push(t)}))}])},function(e,t){angular.module("evtviewer.search").provider("evtSearchBox",(function(){var e=this.defaults;this.setDefaults=function(t){e=t},this.$get=["SEARCHBOXDEFAULTS","parsedData",function(t,n){var i,r=[],o={},a=n.getGlyphs();return r.build=function(e,n){var r,s=[],l=e.$parent.edition;for(var c in r="diplomatic"===l?t.diplomaticSearchBoxBtn:t.interpretativeSearchBoxBtn)0===a._indexes.length?"virtualKeyboard"!==c.toString()&&s.push(r[c]):s.push(r[c]);var u={status:{searchResultBox:!1,searchCaseSensitive:!1,searchExactWord:!1,virtualKeyboard:!1,progressBar:!1},searchBoxBtn:s,parentBoxId:i=e.$parent.id,searchBoxId:i+"SearchBox"};return o[i]=angular.extend(n,u),o[i]},r.getDefaults=function(t){return e[t]},r.getCurrentBoxEdition=function(e){return o[e].getBoxEdition(e)},r.getSearchResults=function(e){return o[e].searchResults},r.getInputValue=function(e){return o[e].searchInput},r.clearInputValue=function(e){o[e].searchInput=""},r.getStatus=function(e,t){if(o[e].status)return o[e].status[t]},r.setStatus=function(e,t,n){o[e].status[t]=n},r.updateStatus=function(e,t){o[e].status[t]=!o[e].status[t]},r.setSearchedTerm=function(e,t){o[e].searchedTerm=t},r.closeBox=function(e,t){var n;for(var i in o)if((n=o[i]).parentBoxId===e)return n.status[t]=!1,n.status[t]},r.showBtn=function(e,t){var n=o[e].searchBoxBtn;for(var i in n)n[i].type===t&&(n[i].hide=!1)},r.hideBtn=function(e,t){var n=o[e].searchBoxBtn;for(var i in n)n[i].type===t&&(n[i].hide=!0)},r}]}))},function(e,t,n){angular.module("evtviewer.search").directive("evtSearchResults",["$timeout","evtSearchResult","evtSearchBox","evtInterface",function(e,t,i,r){return{restrict:"E",template:n(300),replace:!0,controllerAs:"vm",controller:"SearchResultsCtrl",link:function(n){t.build(n,n.vm),n.$watch((function(){return r.getState("currentEdition")}),(function(){n.vm.currentEdition=r.getState("currentEdition"),""!==n.$parent.vm.searchInput&&void 0!==n.$parent.vm.searchInput&&(n.$parent.vm.doSearchCallback(),e((function(){i.setStatus(n.vm.parentBoxId,"searchResultBox",!1),i.hideBtn(n.vm.parentBoxId,"searchResultsHide"),i.showBtn(n.vm.parentBoxId,"searchResultsShow")})))}),!0)}}}])},function(e,t){e.exports='<div class="search-results" ng-show="$parent.vm.getState(\'searchResultBox\')">\n\n   <div ng-show="$parent.vm.getSearchedTerm() !== \'\'" infinite-scroll="vm.loadMoreElements()" infinite-scroll-parent="true">\n\n      <div class="search-info">\n         <p>Search for <strong>{{$parent.vm.getSearchedTerm()}}</strong></p>\n         <p>We have found <span>{{vm.getResultsNumber()}}</span> results in the selected edition</p>\n      </div>\n\n      <div class="token-results">\n         <div class="token" ng-repeat="result in vm.visibleRes track by $index">\n            <div ng-click="vm.toggle($event)" class="icon">\n               Results for <span class="result-token">{{result.token}}</span>\n               in <span class="result-doc">{{result.metadata.xmlDocTitle[0]}}</span>\n               <span class="results-number">({{result.resultsNumber}})</span>\n            </div>\n\n            <ul class="search-result">\n               <li ng-repeat="i in vm.range(result.resultsNumber) track by $index">\n                  <span class="original-text" id="{{result.metadata.docId[$index]}}"\n                        ng-bind-html="vm.getHighlightedOriginalText(result.metadata.docId[$index], vm.getCurrentBoxEdition($parent.vm.parentBoxId), result.token, result.metadata.position[$index])">\n                  </span>\n                  <a class="resultInfo" href="#" ng-click="vm.scrollToCurrentResult($event)">\n                     Found in <span class="resultDoc" id="{{result.metadata.xmlDocId[$index]}}">{{result.metadata.xmlDocTitle[$index]}}</span>\n                     <span class="resultSection" ng-if="result.metadata.sectionTitle">({{result.metadata.sectionTitle[$index]}})</span>\n                     <span class="resultPage" id="{{result.metadata.pageId[$index]}}" ng-if="result.metadata.page">page {{result.metadata.page[$index]}}</span>\n                     <span class="resultPar" ng-if="result.metadata.paragraph">paragraph {{result.metadata.paragraph[$index]}}</span>\n                     <span class="resultLine" id="{{result.metadata.lbId[$index]}}" ng-if="result.metadata.line">(line {{result.metadata.line[$index]}})</span>\n                  </a>\n               </li>\n            </ul>\n\n         </div>\n      </div>\n\n   </div>\n\n   <div class="search-info" ng-show="$parent.vm.getInputValue() === \'\'">{{vm.placeholder}}</div>\n\n</div>\n'},function(e,t,n){(function(e){angular.module("evtviewer.search").controller("SearchResultsCtrl",["$q","$scope","$location","$anchorScroll","evtSearchResults","evtSearchBox","evtInterface","Utils",function(t,n,i,r,o,a,s,l){var c=this;c.currentEdition=s.getState("currentEdition"),c.currentEditionResults=[],c.visibleRes=[],c.placeholder="",c.currentLineId="",c.getResultsNumber=function(){var e=c.currentEditionResults,t=0;return e&&e.forEach((function(e){t+=e.resultsNumber})),t},c.getCurrentEditionResults=function(){return c.currentEditionResults},c.getCurrentBoxEdition=function(e){return a.getCurrentBoxEdition(e)},c.getHighlightedOriginalText=function(e,t,n,i){var r=o.getOriginalText(e,t),a="<strong>"+n+"</strong>",s=i[0],c=i[0]+i[1],u=l.replaceStringAt(r,n,a,s,c);return o.getTextPreview(u,a)},c.loadMoreElements=function(){for(var e,t,n=0;n<5&&n<c.currentEditionResults.length;)e=c.visibleRes.length-1,(t=c.currentEditionResults[e+1])&&c.visibleRes.push(t),n++},c.range=function(e){return new Array(e)},c.toggle=function(t){var n=e(t.currentTarget);n.toggleClass("active"),n.siblings(".search-result").toggleClass("open")},c.scrollToCurrentResult=function(i){(function(i){var r=t.defer(),o=n.$parent.vm.parentBoxId;return a.closeBox(o,"searchResultBox"),a.showBtn(o,"searchResultsShow"),a.hideBtn(o,"searchResultsHide"),i.preventDefault(),e(i.currentTarget).addClass("selected"),c.currentLineId=document.getElementsByClassName("resultInfo selected")[0].getElementsByClassName("resultLine")[0].getAttribute("id"),function(){var e=document.getElementsByClassName("resultInfo selected")[0].getElementsByClassName("resultPage")[0].getAttribute("id"),t=document.getElementsByClassName("resultInfo selected")[0].getElementsByClassName("resultDoc")[0].getAttribute("id");s.updateState("currentPage",e),s.updateState("currentDoc",t),s.updateUrl()}(),e(i.currentTarget).removeClass("selected"),setTimeout((function(){r.resolve()}),100),r.promise})(i).then((function(){c.scrollTo(c.currentLineId)}))},c.scrollTo=function(e){i.hash(e),r()}}])}).call(this,n(0))},function(e,t){angular.module("evtviewer.search").provider("evtSearchResult",(function(){this.$get=function(){var e=[],t={};return e.build=function(e,n){var i=e.$parent.id,r={parentBoxId:i};return t[i]=angular.extend(n,r),t[i]},e.setPlaceholder=function(e,n){t[e].placeholder=n},e.setVisibleRes=function(e,n){t[e].visibleRes=n},e.setCurrentEditionResults=function(e,n){t[e].currentEditionResults=n},e}}))},function(e,t,n){var i=n(27);angular.module("evtviewer.dataHandler").service("evtSearchIndex",["evtSearchDocument",function e(t){function n(e){return{xmlDocId:e.xmlDocId,diplomaticText:e.content.diplomatic,interpretativeText:e.content.interpretative,content:e.content}}function r(e,t){var n=function(n){var i=e.documentCount-1,r=t[Object.keys(t)[i]];return n.metadata.xmlDocTitle=r?r.xmlDocTitle:void 0,n};i.Pipeline.registerFunction(n,"xmlDocTitle"),e.pipeline.add(n),e.metadataWhitelist.push("xmlDocTitle")}function o(e,t){var n=function(n){var i=e.documentCount-1,r=t[Object.keys(t)[i]];return n.metadata.xmlDocId=r?r.xmlDocId:void 0,n};i.Pipeline.registerFunction(n,"xmlDocId"),e.pipeline.add(n),e.metadataWhitelist.push("xmlDocId")}function a(e,t){var n=0,r=t[Object.keys(t)[n]],o=function(i){return n=e.documentCount-1,r=t[Object.keys(t)[n]],i.metadata.sectionTitle=r?r.sectionTitle:void 0,i};r&&void 0!==r.sectionTitle&&(i.Pipeline.registerFunction(o,"sectionTitle"),e.pipeline.add(o),e.metadataWhitelist.push("sectionTitle"))}function s(e,t){var n=0,r=t[Object.keys(t)[n]],o=function(i){return n=e.documentCount-1,r=t[Object.keys(t)[n]],i.metadata.paragraph=r?r.paragraph:void 0,i};r&&void 0!==r.paragraph&&(i.Pipeline.registerFunction(o,"paragraph"),e.pipeline.add(o),e.metadataWhitelist.push("paragraph"))}function l(e,t){var n=0,r=t[Object.keys(t)[n]],o=function(i){return n=e.documentCount-1,r=t[Object.keys(t)[n]],i.metadata.page=r?r.page:void 0,i};r&&void 0!==r.page&&(i.Pipeline.registerFunction(o,"page"),e.pipeline.add(o),e.metadataWhitelist.push("page"))}function c(e,t){var n=0,r=t[Object.keys(t)[n]],o=function(i){return n=e.documentCount-1,r=t[Object.keys(t)[n]],i.metadata.pageId=r?r.pageId:void 0,i};r&&void 0!==r.page&&(i.Pipeline.registerFunction(o,"pageId"),e.pipeline.add(o),e.metadataWhitelist.push("pageId"))}function u(e,t){var n=0,r=t[Object.keys(t)[n]],o=function(i){return n=e.documentCount-1,r=t[Object.keys(t)[n]],i.metadata.line=r?r.line:void 0,i};r&&void 0!==r.line&&(i.Pipeline.registerFunction(o,"line"),e.pipeline.add(o),e.metadataWhitelist.push("line"))}function d(e,t){var n=0,r=t[Object.keys(t)[n]],o=function(i){return n=e.documentCount-1,r=t[Object.keys(t)[n]],i.metadata.lbId=r?r.lbId:void 0,i};r&&void 0!==r.lbId&&(i.Pipeline.registerFunction(o,"lbId"),e.pipeline.add(o),e.metadataWhitelist.push("lbId"))}function h(e,t){var n=function(n){var i=e.documentCount-1,r=t[Object.keys(t)[i]];return n.metadata.docId=r?r.docId:void 0,n};i.Pipeline.registerFunction(n,"docId"),e.pipeline.add(n),e.metadataWhitelist.push("docId")}function p(e){e.metadataWhitelist.push("position")}function f(e){e.metadataWhitelist.push("originalToken")}this.index={},e.prototype.createIndex=function(e){var m;return console.time("INDEX TIME"),this.index=i((function(){for(var v in this.pipeline.remove(i.trimmer),this.pipeline.remove(i.stemmer),this.pipeline.remove(i.stopWordFilter),this.tokenizer=g,this.tokenizer.separator=/[\s,.;:/?!()\'\"]+/,this.ref("xmlDocId"),t.isDiplEdition()&&void 0!==e[Object.keys(e)[0]].content.diplomatic?(this.field("diplomaticText"),t.isInterpEdition()&&this.field("interpretativeText")):t.isInterpEdition()?this.field("interpretativeText"):this.field("content"),this.use(r,e),this.use(o,e),this.use(a,e),this.use(s,e),this.use(l,e),this.use(c,e),this.use(u,e),this.use(d,e),this.use(h,e),this.use(p,e),this.use(f,e),e)"countAllLines"!==v&&(m=n(e[v])||void 0,this.add(m))})),console.timeEnd("INDEX TIME"),this.index},e.prototype.getIndex=function(){return this.index};var g=function(e){for(var t,n,r,o,a,s=e.toString().trim(),l=s.length,c=[],u=0,d=0;u<=l;u++)if(o=u-d,"-"===(t=s.charAt(u))&&(n=s.slice(d,u),a=u,c.push(new i.Token(n,{position:[d,o],index:c.length,originalToken:n}))),t.match(this.tokenizer.separator)||u===l){if(r=n=s.slice(d,u),-1!==(n=n.toLowerCase()).indexOf("-")){var h=s.slice(a+1,u);c.push(new i.Token(h,{position:[a+1,o],index:c.length,originalToken:h}))}o>0&&c.push(new i.Token(n,{position:[d,o],index:c.length,originalToken:r})),d=u+1}return c}}])},function(e,t,n){var i=n(27);angular.module("evtviewer.dataHandler").service("evtSearchQuery",(function e(){var t;e.prototype.query=function(e,n){return t=i.tokenizer(n),e.query((function(e){e.term(t,{usePipeline:!1,wildcard:i.Query.wildcard.LEADING|i.Query.wildcard.TRAILING})}))},e.prototype.exactMatchQuery=function(e,n){return t=n.match("-")?n:i.tokenizer(n),e.query((function(e){e.term(t,{usePipeline:!1})}))}}))},function(e,t,n){var i=n(306);angular.module("evtviewer.dataHandler").service("evtSearchResults",["evtSearchQuery","evtSearchIndex","evtSearch","evtSearchBox","Utils",function e(t,n,r,o,a){var s=/[.,\/#!$%\^&;:{}=_`~()]/;function l(e,t){var n=[],i=e.match(/[*]/);for(var r in t){if(i){e.toLowerCase();var o=c(e,r,t,i);o&&n.push(o)}(e===r.toString()||r.toString().includes(e)||e.includes(r.toString()))&&n.push({token:r.toString(),metadata:t[r],resultsNumber:t[r].xmlDocId.length})}return n}function c(e,t,n,i){var r,o=e.length,a=i.index,s=t.toString().slice(0,a),l=e.slice(0,a),c={token:t.toString(),metadata:n[t],resultsNumber:n[t].xmlDocId.length};return o===a+1&&s===l||0===a&&t.toString().slice(1-o)===(r=e.slice(1,o))||s===l&&(r=e.slice(a+1,e.length),t.toString().slice(-r.length)===r)?c:void 0}function u(e){var t=[];for(var n in e)t.push({token:n.toString(),metadata:e[n],resultsNumber:e[n].xmlDocId.length});return t}function d(e){var t,n;return e.content?(n={content:(t={content:e.content.originalToken}).content.map(h)},{content:p(e.content,n.content)}):(n={diplomatic:(t={diplomatic:e.diplomatic.originalToken||[],interpretative:e.interpretative.originalToken||[]}).diplomatic.map(h),interpretative:t.interpretative.map(h)},{diplomatic:p(e.diplomatic,n.diplomatic),interpretative:p(e.interpretative,n.interpretative)})}function h(e,t){return{token:e,position:t}}function p(e,t){for(var n,i,r={},o={},a=0;a<t.length;a++){for(var s in n=t[a].token,i=!r[t[a].token],e)o[s.toString()]=e[s].filter(f,t[a]);if(i)r[n]=o,o={};else for(var l in o)r[n][l].push(o[l][0])}return r}function f(e,t){return this.position===t}e.prototype.getSearchResults=function(e,i,r){var o,a={"":function(){o="Enter your query into the search box above"},default:function(){o=function(e,i,r){var o={};return function(e,i){var r=n.getIndex();return i?t.exactMatchQuery(r,e):t.query(r,e)}(e.toLowerCase(),r).forEach((function(t){var n,r,a=t.matchData.metadata,s={};for(var c in a)a[c].diplomaticText||a[c].interpretativeText?(s.diplomatic={},s.interpretative={},s.diplomatic=a[c].diplomaticText||{},s.interpretative=a[c].interpretativeText||{},r=d(s),(n=i?{diplomatic:l(e,r.diplomatic),interpretative:l(e,r.interpretative)}:{diplomatic:u(r.diplomatic),interpretative:u(r.interpretative)}).diplomatic&&(o.diplomatic||(o.diplomatic=[]),o.diplomatic=o.diplomatic.concat(n.diplomatic)),n.interpretative&&(o.interpretative||(o.interpretative=[]),o.interpretative=o.interpretative.concat(n.interpretative))):(r=d(a[c]),n=i?{content:l(e,r.content)}:{content:u(r.content)},o.diplomatic=[],o.diplomatic=o.diplomatic.concat(n.content))})),o}(e,i,r)}};return(a[e]||a.default)(),o},e.prototype.getVisibleResults=function(e){for(var t=[],n=0;n<20&&n<e.length;)t.push(e[n]),n++;return t},e.prototype.getCurrentEditionResults=function(e,t){var n=[],i={diplomatic:function(){e.diplomatic.forEach((function(e){n.push(e)}))},interpretative:function(){e.interpretative.forEach((function(e){n.push(e)}))}};return 0!==Object.keys(e).length&&(i[t]?i[t]():alert("Error: search not available for current edition level")),n},e.prototype.getOriginalText=function(e,t){var n=r.getParsedElementsForIndexing();return{diplomatic:function(){return n[e].content.diplomatic||n[e].content},interpretative:function(){return n[e].content.interpretative}}[t]()},e.prototype.getTextPreview=function(e,t){for(var n,i,r,o,s=e.split(/[\s]+/),l=0;a.cleanPunctuation(s[l])!==t&&l<s.length-1;)n=l,l++;return r=s.slice(n,n+10),o=(i=n<10?s.slice(0,n):s.slice(n-10,n)).length<10?i.join(" ")+" "+r.join(" ")+"...":"..."+i.join(" ")+" "+r.join(" ")+"...",s.length<15&&(o=i.join(" ")+" "+r.join(" ")),o},e.prototype.highlightSearchResults=function(e,t){var n=new i(document.querySelector("#"+e+" #mainContentToTranform")),r=o.getStatus(e,"searchCaseSensitive"),a=o.getStatus(e,"searchExactWord");n.unmark(t),a?function(e,t,n){e.mark(t,{wildcards:"enable",acrossElements:!0,caseSensitive:n,accuracy:{value:"exactly",limiters:[".",",",";",":","\\","/","!","?","#","$","%","^","&","*","{","}","=","-","_","`","~","(",")"]},filter:function(){return!t.match(s)},exclude:[".lineN"]})}(n,t,r):function(e,t,n){e.mark(t,{wildcards:"enable",acrossElements:!0,caseSensitive:n,accuracy:{value:"partially",limiters:[".",",",";",":","\\","/","!","?","#","$","%","^","&","*","{","}","=","-","_","`","~","(",")"]},filter:function(e){return!t.match(s)},exclude:[".lineN"]})}(n,t,r)}}])},function(e,t,n){
/*!***************************************************
* mark.js v8.11.1
* https://markjs.io/
* Copyright (c) 2014â2018, Julian KÃ¼hnel
* Released under the MIT license https://git.io/vwTVl
*****************************************************/
e.exports=function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=function(){function e(n){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;t(this,e),this.ctx=n,this.iframes=i,this.exclude=r,this.iframesTimeout=o}return n(e,[{key:"getContexts",value:function(){var e=[];return(void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach((function(t){var n=e.filter((function(e){return e.contains(t)})).length>0;-1!==e.indexOf(t)||n||e.push(t)})),e}},{key:"getIframeContents",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=void 0;try{var r=e.contentWindow;if(i=r.document,!r||!i)throw new Error("iframe inaccessible")}catch(e){n()}i&&t(i)}},{key:"isIframeBlank",value:function(e){var t="about:blank",n=e.getAttribute("src").trim();return e.contentWindow.location.href===t&&n!==t&&n}},{key:"observeIframeLoad",value:function(e,t,n){var i=this,r=!1,o=null,a=function a(){if(!r){r=!0,clearTimeout(o);try{i.isIframeBlank(e)||(e.removeEventListener("load",a),i.getIframeContents(e,t,n))}catch(e){n()}}};e.addEventListener("load",a),o=setTimeout(a,this.iframesTimeout)}},{key:"onIframeReady",value:function(e,t,n){try{"complete"===e.contentWindow.document.readyState?this.isIframeBlank(e)?this.observeIframeLoad(e,t,n):this.getIframeContents(e,t,n):this.observeIframeLoad(e,t,n)}catch(e){n()}}},{key:"waitForIframes",value:function(e,t){var n=this,i=0;this.forEachIframe(e,(function(){return!0}),(function(e){i++,n.waitForIframes(e.querySelector("html"),(function(){--i||t()}))}),(function(e){e||t()}))}},{key:"forEachIframe",value:function(t,n,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=t.querySelectorAll("iframe"),s=a.length,l=0;a=Array.prototype.slice.call(a);var c=function(){--s<=0&&o(l)};s||c(),a.forEach((function(t){e.matches(t,r.exclude)?c():r.onIframeReady(t,(function(e){n(t)&&(l++,i(e)),c()}),c)}))}},{key:"createIterator",value:function(e,t,n){return document.createNodeIterator(e,t,n,!1)}},{key:"createInstanceOnIframe",value:function(t){return new e(t.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(e,t,n){if(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_PRECEDING){if(null===t)return!0;if(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}},{key:"getIteratorNode",value:function(e){var t=e.previousNode();return{prevNode:t,node:(null===t||e.nextNode())&&e.nextNode()}}},{key:"checkIframeFilter",value:function(e,t,n,i){var r=!1,o=!1;return i.forEach((function(e,t){e.val===n&&(r=t,o=e.handled)})),this.compareNodeIframe(e,t,n)?(!1!==r||o?!1===r||o||(i[r].handled=!0):i.push({val:n,handled:!0}),!0):(!1===r&&i.push({val:n,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(e,t,n,i){var r=this;e.forEach((function(e){e.handled||r.getIframeContents(e.val,(function(e){r.createInstanceOnIframe(e).forEachNode(t,n,i)}))}))}},{key:"iterateThroughNodes",value:function(e,t,n,i,r){for(var o,a=this,s=this.createIterator(t,e,i),l=[],c=[],u=void 0,d=void 0;o=void 0,o=a.getIteratorNode(s),d=o.prevNode,u=o.node;)this.iframes&&this.forEachIframe(t,(function(e){return a.checkIframeFilter(u,d,e,l)}),(function(t){a.createInstanceOnIframe(t).forEachNode(e,(function(e){return c.push(e)}),i)})),c.push(u);c.forEach((function(e){n(e)})),this.iframes&&this.handleOpenIframes(l,e,n,i),r()}},{key:"forEachNode",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=this.getContexts(),a=o.length;a||r(),o.forEach((function(o){var s=function(){i.iterateThroughNodes(e,o,t,n,(function(){--a<=0&&r()}))};i.iframes?i.waitForIframes(o,s):s()}))}}],[{key:"matches",value:function(e,t){var n="string"==typeof t?[t]:t,i=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;if(i){var r=!1;return n.every((function(t){return!i.call(e,t)||(r=!0,!1)})),r}return!1}}]),e}(),o=function(){function o(e){t(this,o),this.ctx=e,this.ie=!1;var n=window.navigator.userAgent;(n.indexOf("MSIE")>-1||n.indexOf("Trident")>-1)&&(this.ie=!0)}return n(o,[{key:"log",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug",i=this.opt.log;this.opt.debug&&"object"===(void 0===i?"undefined":e(i))&&"function"==typeof i[n]&&i[n]("mark.js: "+t)}},{key:"escapeStr",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(e){return"disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),"disabled"!==this.opt.wildcards&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e)}},{key:"createSynonymsRegExp",value:function(e){var t=this.opt.synonyms,n=this.opt.caseSensitive?"":"i",i=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],a="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(r):this.escapeStr(r),s="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(o):this.escapeStr(o);""!==a&&""!==s&&(e=e.replace(new RegExp("("+this.escapeStr(a)+"|"+this.escapeStr(s)+")","gm"+n),i+"("+this.processSynomyms(a)+"|"+this.processSynomyms(s)+")"+i))}return e}},{key:"processSynomyms",value:function(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}},{key:"setupWildcardsRegExp",value:function(e){return(e=e.replace(/(?:\\)*\?/g,(function(e){return"\\"===e.charAt(0)?"?":""}))).replace(/(?:\\)*\*/g,(function(e){return"\\"===e.charAt(0)?"*":""}))}},{key:"createWildcardsRegExp",value:function(e){var t="withSpaces"===this.opt.wildcards;return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(e){return e.replace(/[^(|)\\]/g,(function(e,t,n){var i=n.charAt(t+1);return/[(|)\\]/.test(i)||""===i?e:e+"\0"}))}},{key:"createJoinersRegExp",value:function(e){var t=[],n=this.opt.ignorePunctuation;return Array.isArray(n)&&n.length&&t.push(this.escapeStr(n.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join("["+t.join("")+"]*"):e}},{key:"createDiacriticsRegExp",value:function(e){var t=this.opt.caseSensitive?"":"i",n=this.opt.caseSensitive?["aÃ Ã¡áº£Ã£áº¡Äáº±áº¯áº³áºµáº·Ã¢áº§áº¥áº©áº«áº­Ã¤Ã¥ÄÄ","AÃÃáº¢Ãáº Äáº°áº®áº²áº´áº¶Ãáº¦áº¤áº¨áºªáº¬ÃÃÄÄ","cÃ§ÄÄ","CÃÄÄ","dÄÄ","DÄÄ","eÃ¨Ã©áº»áº½áº¹Ãªá»áº¿á»á»á»Ã«ÄÄÄ","EÃÃáººáº¼áº¸Ãá»áº¾á»á»á»ÃÄÄÄ","iÃ¬Ã­á»Ä©á»Ã®Ã¯Ä«","IÃÃá»Ä¨á»ÃÃÄª","lÅ","LÅ","nÃ±ÅÅ","NÃÅÅ","oÃ²Ã³á»Ãµá»Ã´á»á»á»á»á»Æ¡á»á»¡á»á»á»£Ã¶Ã¸Å","OÃÃá»Ãá»Ãá»á»á»á»á»Æ á»á» á»á»á»¢ÃÃÅ","rÅ","RÅ","sÅ¡ÅÈÅ","SÅ ÅÈÅ","tÅ¥ÈÅ£","TÅ¤ÈÅ¢","uÃ¹Ãºá»§Å©á»¥Æ°á»«á»©á»­á»¯á»±Ã»Ã¼Å¯Å«","UÃÃá»¦Å¨á»¤Æ¯á»ªá»¨á»¬á»®á»°ÃÃÅ®Åª","yÃ½á»³á»·á»¹á»µÃ¿","YÃá»²á»¶á»¸á»´Å¸","zÅ¾Å¼Åº","ZÅ½Å»Å¹"]:["aÃ Ã¡áº£Ã£áº¡Äáº±áº¯áº³áºµáº·Ã¢áº§áº¥áº©áº«áº­Ã¤Ã¥ÄÄAÃÃáº¢Ãáº Äáº°áº®áº²áº´áº¶Ãáº¦áº¤áº¨áºªáº¬ÃÃÄÄ","cÃ§ÄÄCÃÄÄ","dÄÄDÄÄ","eÃ¨Ã©áº»áº½áº¹Ãªá»áº¿á»á»á»Ã«ÄÄÄEÃÃáººáº¼áº¸Ãá»áº¾á»á»á»ÃÄÄÄ","iÃ¬Ã­á»Ä©á»Ã®Ã¯Ä«IÃÃá»Ä¨á»ÃÃÄª","lÅLÅ","nÃ±ÅÅNÃÅÅ","oÃ²Ã³á»Ãµá»Ã´á»á»á»á»á»Æ¡á»á»¡á»á»á»£Ã¶Ã¸ÅOÃÃá»Ãá»Ãá»á»á»á»á»Æ á»á» á»á»á»¢ÃÃÅ","rÅRÅ","sÅ¡ÅÈÅSÅ ÅÈÅ","tÅ¥ÈÅ£TÅ¤ÈÅ¢","uÃ¹Ãºá»§Å©á»¥Æ°á»«á»©á»­á»¯á»±Ã»Ã¼Å¯Å«UÃÃá»¦Å¨á»¤Æ¯á»ªá»¨á»¬á»®á»°ÃÃÅ®Åª","yÃ½á»³á»·á»¹á»µÃ¿YÃá»²á»¶á»¸á»´Å¸","zÅ¾Å¼ÅºZÅ½Å»Å¹"],i=[];return e.split("").forEach((function(r){n.every((function(n){if(-1!==n.indexOf(r)){if(i.indexOf(n)>-1)return!1;e=e.replace(new RegExp("["+n+"]","gm"+t),"["+n+"]"),i.push(n)}return!0}))})),e}},{key:"createMergedBlanksRegExp",value:function(e){return e.replace(/[\s]+/gim,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(e){var t=this,n=this.opt.accuracy,i="string"==typeof n?n:n.value,r="string"==typeof n?[]:n.limiters,o="";switch(r.forEach((function(e){o+="|"+t.escapeStr(e)})),i){case"partially":default:return"()("+e+")";case"complementary":return"()([^"+(o="\\s"+(o||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~Â¡Â¿")))+"]*"+e+"[^"+o+"]*)";case"exactly":return"(^|\\s"+o+")("+e+")(?=$|\\s"+o+")"}}},{key:"getSeparatedKeywords",value:function(e){var t=this,n=[];return e.forEach((function(e){t.opt.separateWordSearch?e.split(" ").forEach((function(e){e.trim()&&-1===n.indexOf(e)&&n.push(e)})):e.trim()&&-1===n.indexOf(e)&&n.push(e)})),{keywords:n.sort((function(e,t){return t.length-e.length})),length:n.length}}},{key:"isNumeric",value:function(e){return Number(parseFloat(e))==e}},{key:"checkRanges",value:function(e){var t=this;if(!Array.isArray(e)||"[object Object]"!==Object.prototype.toString.call(e[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];var n=[],i=0;return e.sort((function(e,t){return e.start-t.start})).forEach((function(e){var r=t.callNoMatchOnInvalidRanges(e,i),o=r.start,a=r.end;r.valid&&(e.start=o,e.length=a-o,n.push(e),i=a)})),n}},{key:"callNoMatchOnInvalidRanges",value:function(e,t){var n=void 0,i=void 0,r=!1;return e&&void 0!==e.start?(i=(n=parseInt(e.start,10))+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&i-t>0&&i-n>0?r=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(e)),this.opt.noMatch(e))):(this.log("Ignoring invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:n,end:i,valid:r}}},{key:"checkWhitespaceRanges",value:function(e,t,n){var i=void 0,r=!0,o=n.length,a=t-o,s=parseInt(e.start,10)-a;return(i=(s=s>o?o:s)+parseInt(e.length,10))>o&&(i=o,this.log("End range automatically set to the max value of "+o)),s<0||i-s<0||s>o||i>o?(r=!1,this.log("Invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)):""===n.substring(s,i).replace(/\s+/g,"")&&(r=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:s,end:i,valid:r}}},{key:"getTextNodes",value:function(e){var t=this,n="",i=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,(function(e){i.push({start:n.length,end:(n+=e.textContent).length,node:e})}),(function(e){return t.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),(function(){e({value:n,nodes:i})}))}},{key:"matchesExclude",value:function(e){return r.matches(e,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(e,t,n){var i=this.opt.element?this.opt.element:"mark",r=e.splitText(t),o=r.splitText(n-t),a=document.createElement(i);return a.setAttribute("data-markjs","true"),this.opt.className&&a.setAttribute("class",this.opt.className),a.textContent=r.textContent,r.parentNode.replaceChild(a,r),o}},{key:"wrapRangeInMappedTextNode",value:function(e,t,n,i,r){var o=this;e.nodes.every((function(a,s){var l=e.nodes[s+1];if(void 0===l||l.start>t){if(!i(a.node))return!1;var c=t-a.start,u=(n>a.end?a.end:n)-a.start,d=e.value.substr(0,a.start),h=e.value.substr(u+a.start);if(a.node=o.wrapRangeInTextNode(a.node,c,u),e.value=d+h,e.nodes.forEach((function(t,n){n>=s&&(e.nodes[n].start>0&&n!==s&&(e.nodes[n].start-=u),e.nodes[n].end-=u)})),n-=u,r(a.node.previousSibling,a.start),!(n>a.end))return!1;t=a.end}return!0}))}},{key:"wrapMatches",value:function(e,t,n,i,r){var o=this,a=0===t?0:t+1;this.getTextNodes((function(t){t.nodes.forEach((function(t){t=t.node;for(var r=void 0;null!==(r=e.exec(t.textContent))&&""!==r[a];)if(n(r[a],t)){var s=r.index;if(0!==a)for(var l=1;l<a;l++)s+=r[l].length;t=o.wrapRangeInTextNode(t,s,s+r[a].length),i(t.previousSibling),e.lastIndex=0}})),r()}))}},{key:"wrapMatchesAcrossElements",value:function(e,t,n,i,r){var o=this,a=0===t?0:t+1;this.getTextNodes((function(t){for(var s=void 0;null!==(s=e.exec(t.value))&&""!==s[a];){var l=s.index;if(0!==a)for(var c=1;c<a;c++)l+=s[c].length;var u=l+s[a].length;o.wrapRangeInMappedTextNode(t,l,u,(function(e){return n(s[a],e)}),(function(t,n){e.lastIndex=n,i(t)}))}r()}))}},{key:"wrapRangeFromIndex",value:function(e,t,n,i){var r=this;this.getTextNodes((function(o){var a=o.value.length;e.forEach((function(e,i){var s=r.checkWhitespaceRanges(e,a,o.value),l=s.start,c=s.end;s.valid&&r.wrapRangeInMappedTextNode(o,l,c,(function(n){return t(n,e,o.value.substring(l,c),i)}),(function(t){n(t,e)}))})),i()}))}},{key:"unwrapMatches",value:function(e){for(var t=e.parentNode,n=document.createDocumentFragment();e.firstChild;)n.appendChild(e.removeChild(e.firstChild));t.replaceChild(n,e),this.ie?this.normalizeTextNode(t):t.normalize()}},{key:"normalizeTextNode",value:function(e){if(e){if(3===e.nodeType)for(;e.nextSibling&&3===e.nextSibling.nodeType;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}},{key:"markRegExp",value:function(e,t){var n=this;this.opt=t,this.log('Searching with expression "'+e+'"');var i=0,r="wrapMatches";this.opt.acrossElements&&(r="wrapMatchesAcrossElements"),this[r](e,this.opt.ignoreGroups,(function(e,t){return n.opt.filter(t,e,i)}),(function(e){i++,n.opt.each(e)}),(function(){0===i&&n.opt.noMatch(e),n.opt.done(i)}))}},{key:"mark",value:function(e,t){var n=this;this.opt=t;var i=0,r="wrapMatches",o=this.getSeparatedKeywords("string"==typeof e?[e]:e),a=o.keywords,s=o.length,l=this.opt.caseSensitive?"":"i";this.opt.acrossElements&&(r="wrapMatchesAcrossElements"),0===s?this.opt.done(i):function e(t){var o=new RegExp(n.createRegExp(t),"gm"+l),c=0;n.log('Searching with expression "'+o+'"'),n[r](o,1,(function(e,r){return n.opt.filter(r,t,i,c)}),(function(e){c++,i++,n.opt.each(e)}),(function(){0===c&&n.opt.noMatch(t),a[s-1]===t?n.opt.done(i):e(a[a.indexOf(t)+1])}))}(a[0])}},{key:"markRanges",value:function(e,t){var n=this;this.opt=t;var i=0,r=this.checkRanges(e);r&&r.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(r)),this.wrapRangeFromIndex(r,(function(e,t,i,r){return n.opt.filter(e,t,i,r)}),(function(e,t){i++,n.opt.each(e,t)}),(function(){n.opt.done(i)}))):this.opt.done(i)}},{key:"unmark",value:function(e){var t=this;this.opt=e;var n=this.opt.element?this.opt.element:"*";n+="[data-markjs]",this.opt.className&&(n+="."+this.opt.className),this.log('Removal selector "'+n+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,(function(e){t.unwrapMatches(e)}),(function(e){var i=r.matches(e,n),o=t.matchesExclude(e);return!i||o?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),this.opt.done)}},{key:"opt",set:function(e){this._opt=i({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},e)},get:function(){return this._opt}},{key:"iterator",get:function(){return new r(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),o}();return function(e){var t=this,n=new o(e);return this.mark=function(e,i){return n.mark(e,i),t},this.markRegExp=function(e,i){return n.markRegExp(e,i),t},this.markRanges=function(e,i){return n.markRanges(e,i),t},this.unmark=function(e){return n.unmark(e),t},this}}()},function(e,t,n){angular.module("evtviewer.search").directive("evtVirtualKeyboard",["evtVirtualKeyboard","parsedData",function(e,t){return{restrict:"E",tempalte:n(308),replace:!0,link:function(n){0!==t.getGlyphs()._indexes.length&&e.build(n,n.vm)}}}])},function(e,t){e.exports='<div class="keyboard-container" id="{{::vm.keyboardId}}"></div>\n'},function(e,t,n){(function(e){n(310),angular.module("evtviewer.search").provider("evtVirtualKeyboard",(function(){this.$get=["evtKeyboard","config","$rootScope",function(t,n,i){var r,o,a,s,l,c,u,d=[],h={},p=[];return d.build=function(i,d){if(r=i.$parent.id,o=r+"Keyboard",l="",s=n.virtualKeyboardKeys,u=t.getGlyphInXmlDoc(),0!==s.length)for(var f in c=function(e){return t.getConfigKeyboardKeys(e)}(s))u.includes(f)&&(l+=c[f]+":"+f+" ");else for(var g in a=t.getDefaultKeyboardKeys())l+=a[g]+":"+g+" ";e("#"+r+" .search-box input").keyboard({layout:"custom",customLayout:{normal:[l]},usePreview:!1,openOn:null,stayOpen:!0,autoAccept:!0,appendTo:"#"+r+" .search-box .keyboard-container",change:function(e,t){r=i.$parent.id,t.originalContent=t.$preview.val(),i.vm.searchInput=t.originalContent,i.vm.highlightSearchResults(r,i.vm.searchInput)}});var m={keyboardId:o,keyboardBtns:p};return h[r]=angular.extend(d,m),h[r]},d.getKeyboardId=function(e){return h[e].keyboardId},d.unselectCurrentKeyboard=function(t,n){var i,r=e("#"+n+"Keyboard").getkeyboard();if(void 0!==r){for(var o in p)p[o].parentId===n&&(i=p[o].btn);r.close(),i.setActive(!1)}},i.$on("keyboardBtn",(function(e,t){p.push(t)})),d}]}))}).call(this,n(0))},function(e,t,n){var i,r,o;/*! jQuery UI Virtual Keyboard v1.30.4 */r=[n(0)],void 0===(o="function"==typeof(i=function(e){"use strict";var t=e.keyboard=function(n,i){var r,o=this;o.version="1.30.4",o.$el=e(n),o.el=n,o.$el.data("keyboard",o),o.init=function(){o.initialized=!1,o.isTextArea="textarea"===o.el.nodeName.toLowerCase(),o.isInput="input"===o.el.nodeName.toLowerCase(),o.isContentEditable=!o.isTextArea&&!o.isInput&&o.el.isContentEditable;var n,a,s,l=t.css,c=t.events;if(o.isInput&&e.inArray((o.el.type||"").toLowerCase(),t.supportedInputTypes)<0)throw new TypeError('Input of type "'+o.el.type+'" is not supported; use type text, search, URL, tel or password');o.settings=i||{},i&&i.position&&(a=e.extend({},i.position),i.position=null),o.options=r=e.extend(!0,{},t.defaultOptions,i),a&&(r.position=a,i.position=a),o.el.active=!0,o.namespace=".keyboard"+Math.random().toString(16).slice(2),o.extensionNamespace=[],o.shiftActive=o.altActive=o.metaActive=o.sets=o.capsLock=!1,o.rows=["","-shift","-alt","-alt-shift"],o.inPlaceholder=o.$el.attr("placeholder")||"",o.watermark=t.watermark&&""!==o.inPlaceholder,o.repeatTime=1e3/(r.repeatRate||20),r.preventDoubleEventTime=r.preventDoubleEventTime||100,o.isOpen=!1,o.wheel="function"==typeof e.fn.mousewheel,o.escapeRegex=/[-\/\\^$*+?.()|[\]{}]/g,n=t.keyCodes,o.alwaysAllowed=[n.capsLock,n.pageUp,n.pageDown,n.end,n.home,n.left,n.up,n.right,n.down,n.insert,n.delete],o.$keyboard=[],o.enabled=!0,o.checkCaret=r.lockInput||t.checkCaretSupport(),o.isContentEditable&&(r.usePreview=!1),o.last={start:0,end:0,key:"",val:"",preVal:"",layout:"",virtual:!0,keyset:[!1,!1,!1],wheel_$Keys:[],wheelIndex:0,wheelLayers:[]},o.temp=["",0,0],e.each([c.kbInit,c.kbBeforeVisible,c.kbVisible,c.kbHidden,c.inputCanceled,c.inputAccepted,c.kbBeforeClose,c.inputRestricted],(function(e,t){"function"==typeof r[t]&&o.$el.bind(t+o.namespace+"callbacks",r[t])})),r.alwaysOpen&&(r.stayOpen=!0),s=e(document),o.el.ownerDocument!==document&&(s=s.add(o.el.ownerDocument));var u="keyup checkkeyboard mousedown touchstart ";r.closeByClickEvent&&(u+="click "),s.bind(u.split(" ").join(o.namespace+" "),(function(e){clearTimeout(o.timer3),o.timer3=setTimeout((function(){o.checkClose(e)}),1)})),o.$el.addClass(l.input+" "+r.css.input).attr({"aria-haspopup":"true",role:"textbox"}),(r.lockInput||o.el.readOnly)&&(r.lockInput=!0,o.$el.addClass(l.locked).attr({readonly:"readonly"})),o.isUnavailable()&&o.$el.addClass(l.noKeyboard),r.openOn&&o.bindFocus(),o.watermark||""!==o.getValue(o.$el)||""===o.inPlaceholder||""===o.$el.attr("placeholder")||(o.$el.addClass(l.placeholder),o.setValue(o.inPlaceholder,o.$el)),o.$el.trigger(c.kbInit,[o,o.el]),r.alwaysOpen&&o.reveal(),o.initialized=!0},o.toggle=function(){if(o.hasKeyboard()){var e=o.$keyboard.find("."+t.css.keyToggle),n=!o.enabled;return o.preview.readonly=n||o.options.lockInput,o.$keyboard.toggleClass(t.css.keyDisabled,n).find("."+t.css.keyButton).not(e).attr("aria-disabled",n).each((function(){this.disabled=n})),e.toggleClass(t.css.keyDisabled,n),n&&o.typing_options&&(o.typing_options.text=""),o}},o.setCurrent=function(){var n=t.css,i=e("."+n.isCurrent),r=i.data("keyboard");e.isEmptyObject(r)||r.el===o.el||r.close(!!r.options.autoAccept&&"true"),i.removeClass(n.isCurrent),e("."+n.hasFocus).removeClass(n.hasFocus),o.$el.addClass(n.isCurrent),o.$preview.focus(),o.$keyboard.addClass(n.hasFocus),o.isCurrent(!0),o.isOpen=!0},o.isUnavailable=function(){return o.$el.is(":disabled")||!o.options.activeOnReadonly&&o.$el.attr("readonly")&&!o.$el.hasClass(t.css.locked)},o.isCurrent=function(e){var n=t.currentKeyboard||!1;return e?n=t.currentKeyboard=o.el:!1===e&&n===o.el&&(n=t.currentKeyboard=""),n===o.el},o.hasKeyboard=function(){return o.$keyboard&&o.$keyboard.length>0},o.isVisible=function(){return!!o.hasKeyboard()&&o.$keyboard.is(":visible")},o.setFocus=function(){var e=o.$preview||o.$el;r.noFocus||e.focus(),o.isContentEditable?t.setEditableCaret(e,o.last.start,o.last.end):t.caret(e,o.last)},o.focusOn=function(){o&&o.el.active&&(o.isVisible()?o.setCurrent():(clearTimeout(o.timer),o.reveal()))},o.redraw=function(e){return e&&(o.options.layout=e),o.$keyboard.length&&(o.last.preVal=""+o.last.val,o.saveLastChange(),o.setValue(o.last.val,o.$el),o.removeKeyboard(),o.shiftActive=o.altActive=o.metaActive=!1),o.isOpen=r.alwaysOpen,o.reveal(!0),o},o.reveal=function(n){var i,a=o.isOpen,s=t.css;if(o.opening=!a,e("."+s.keyboard).not("."+s.alwaysOpen).each((function(){var t=e(this).data("keyboard");e.isEmptyObject(t)||t.close(!!t.options.autoAccept&&"true")})),!o.isUnavailable())return o.$el.removeClass(s.noKeyboard),r.openOn&&o.$el.unbind(e.trim((r.openOn+" ").split(/\s+/).join(o.namespace+" "))),o.$keyboard&&(!o.$keyboard||o.$keyboard.length&&!e.contains(o.el.ownerDocument.body,o.$keyboard[0]))||o.startup(),o.watermark||o.getValue()!==o.inPlaceholder||(o.$el.removeClass(s.placeholder),o.setValue("",o.$el)),o.originalContent=o.isContentEditable?o.$el.html():o.getValue(o.$el),o.el===o.preview||o.isContentEditable||o.setValue(o.originalContent),r.acceptValid&&r.checkValidOnInit&&o.checkValid(),r.resetDefault&&(o.shiftActive=o.altActive=o.metaActive=!1),o.showSet(),o.isVisible()||o.$el.trigger(t.events.kbBeforeVisible,[o,o.el]),(o.initialized||r.initialFocus||!r.initialFocus&&o.$el.hasClass(t.css.initialFocus))&&o.setCurrent(),o.toggle(),o.$keyboard.show(),r.usePreview&&t.msie&&(void 0===o.width&&(o.$preview.hide(),o.width=Math.ceil(o.$keyboard.width()),o.$preview.show()),o.$preview.width(o.width)),o.reposition(),o.checkDecimal(),o.lineHeight=parseInt(o.$preview.css("lineHeight"),10)||parseInt(o.$preview.css("font-size"),10)+4,r.caretToEnd&&(i=o.isContentEditable?t.getEditableLength(o.el):o.originalContent.length,o.saveCaret(i,i)),t.allie&&(0===o.last.end&&o.last.start>0&&(o.last.end=o.last.start),o.last.start<0&&(o.last.start=o.last.end=o.originalContent.length)),a||n?(t.caret(o.$preview,o.last),o.opening=!1,o):(o.timer2=setTimeout((function(){o.opening=!1,/(number|email)/i.test(o.el.type)||r.caretToEnd||o.saveCaret(void 0,void 0,o.$el),(r.initialFocus||o.$el.hasClass(t.css.initialFocus))&&t.caret(o.$preview,o.last),o.last.eventTime=(new Date).getTime(),o.$el.trigger(t.events.kbVisible,[o,o.el]),o.timer=setTimeout((function(){o&&o.saveCaret()}),200)}),10),o)},o.updateLanguage=function(){var n=t.layouts,i=r.language||n[r.layout]&&n[r.layout].lang&&n[r.layout].lang||[r.language||"en"],a=t.language;i="[object Array]"===Object.prototype.toString.call(i)?i[0]:i,o.language=i,i=i.split("-")[0],r.display=e.extend(!0,{},a.en.display,a[i]&&a[i].display||{},o.settings.display),r.combos=e.extend(!0,{},a.en.combos,a[i]&&a[i].combos||{},o.settings.combos),r.wheelMessage=a[i]&&a[i].wheelMessage||a.en.wheelMessage,r.rtl=n[r.layout]&&n[r.layout].rtl||a[i]&&a[i].rtl||!1,a[i]&&a[i].comboRegex&&(o.regex=a[i].comboRegex),o.decimal=/^\./.test(r.display.dec),o.$el.toggleClass("rtl",r.rtl).css("direction",r.rtl?"rtl":"")},o.startup=function(){var n=t.css;(r.alwaysOpen||r.userClosed)&&o.$preview||o.makePreview(),o.hasKeyboard()||("custom"===r.layout&&(r.layoutHash="custom"+o.customHash()),o.layout="custom"===r.layout?r.layoutHash:r.layout,o.last.layout=o.layout,o.updateLanguage(),void 0===t.builtLayouts[o.layout]&&("function"==typeof r.create?o.$keyboard=r.create(o):o.$keyboard.length||o.buildKeyboard(o.layout,!0)),o.$keyboard=t.builtLayouts[o.layout].$keyboard.clone(),o.$keyboard.data("keyboard",o),""!==(o.el.id||"")&&o.$keyboard.attr("id",o.el.id+t.css.idSuffix),o.makePreview()),o.$keyboard.attr("data-"+n.keyboard+"-layout",r.layout).attr("data-"+n.keyboard+"-language",o.language),o.$decBtn=o.$keyboard.find("."+n.keyPrefix+"dec"),(r.enterNavigation||o.isTextArea)&&o.alwaysAllowed.push(t.keyCodes.enter),o.bindKeyboard(),o.$keyboard.appendTo(r.appendLocally?o.$el.parent():r.appendTo||"body"),o.bindKeys(),r.reposition&&e.ui&&e.ui.position&&"body"===r.appendTo&&e(window).bind("resize"+o.namespace,(function(){o.reposition()}))},o.reposition=function(){return o.position=!e.isEmptyObject(r.position)&&r.position,e.ui&&e.ui.position&&o.position&&(o.position.of=o.position.of||o.$el.data("keyboardPosition")||o.$el,o.position.collision=o.position.collision||"flipfit flipfit",o.position.at=r.usePreview?r.position.at:r.position.at2,o.isVisible()&&o.$keyboard.position(o.position)),o},o.makePreview=function(){if(r.usePreview){var n,i,a,s,l=t.css;for(o.$preview=o.$el.clone(!1).data("keyboard",o).removeClass(l.placeholder+" "+l.input).addClass(l.preview+" "+r.css.input).attr("tabindex","-1").show(),o.preview=o.$preview[0],s=/^(data-|id|aria-haspopup)/i,n=(i=o.$preview.get(0).attributes).length-1;n>=0;n--)a=i[n]&&i[n].name,s.test(a)&&o.preview.removeAttribute(a);e("<div />").addClass(l.wrapper).append(o.$preview).prependTo(o.$keyboard)}else o.$preview=o.$el,o.preview=o.el},o.caret=function(n,i){var r=t.caret(o.$preview,n,i);return r instanceof e?(o.saveCaret(r.start,r.end),o):r},o.saveCaret=function(e,n,i){var r;o.isCurrent()&&(r=void 0===e?t.caret(i||o.$preview):t.caret(i||o.$preview,e,n),o.last.start=void 0===e?r.start:e,o.last.end=void 0===n?r.end:n)},o.saveLastChange=function(e){o.last.val=e||o.getValue(o.$preview||o.$el),o.isContentEditable&&(o.last.elms=o.el.cloneNode(!0))},o.setScroll=function(){if(!o.isContentEditable&&o.last.virtual){var e,n,i,a,s=o.last.val.substring(0,Math.max(o.last.start,o.last.end));o.$previewCopy||(o.$previewCopy=o.$preview.clone().removeAttr("id").css({position:"absolute",left:0,zIndex:-10,visibility:"hidden"}).addClass(t.css.inputClone),o.$previewCopy[0].disabled=!0,o.isTextArea||o.$previewCopy.css({"white-space":"pre",width:0}),r.usePreview?o.$preview.after(o.$previewCopy):o.$keyboard.prepend(o.$previewCopy)),o.isTextArea?(o.$previewCopy.height(o.lineHeight).val(s),o.preview.scrollTop=o.lineHeight*(Math.floor(o.$previewCopy[0].scrollHeight/o.lineHeight)-1)):(o.$previewCopy.val(s.replace(/\s/g,"Â ")),i=/c/i.test(r.scrollAdjustment)?o.preview.clientWidth/2:r.scrollAdjustment,e=o.$previewCopy[0].scrollWidth-1,void 0===o.last.scrollWidth&&(o.last.scrollWidth=e,o.last.direction=!0),a=o.last.scrollWidth===e?o.last.direction:o.last.scrollWidth<e,n=o.preview.clientWidth-i,a?o.preview.scrollLeft=e<n?0:e-n:e>=o.preview.scrollWidth-n?o.preview.scrollLeft=o.preview.scrollWidth-i:o.preview.scrollLeft=e-i>0?e-i:0,o.last.scrollWidth=e,o.last.direction=a)}},o.bindFocus=function(){r.openOn&&o&&o.el.active&&(o.$el.bind(r.openOn+o.namespace,(function(){o.focusOn()})),e(":focus")[0]===o.el&&o.$el.blur())},o.bindKeyboard=function(){var n,i=t.keyCodes,a=t.builtLayouts[o.layout],s=o.namespace+"keybindings";o.$preview.unbind(o.namespace).bind("click"+s+" touchstart"+s,(function(){r.alwaysOpen&&!o.isCurrent()&&o.reveal(),o.timer2=setTimeout((function(){o&&o.saveCaret()}),150)})).bind("keypress"+s,(function(s){if(r.lockInput)return!1;if(o.isCurrent()){var l=s.charCode||s.which,c=l>=i.A&&l<=i.Z,u=l>=i.a&&l<=i.z,d=o.last.key=String.fromCharCode(l);if(!(l<i.space)){if(o.last.virtual=!1,o.last.event=s,o.last.$key=[],o.checkCaret&&o.saveCaret(),l!==i.capsLock&&(c||u)&&(o.capsLock=c&&!s.shiftKey||u&&s.shiftKey,o.capsLock&&!o.shiftActive&&(o.shiftActive=!0,o.showSet())),r.restrictInput){if((s.which===i.backSpace||0===s.which)&&e.inArray(s.keyCode,o.alwaysAllowed))return;-1===e.inArray(d,a.acceptedKeys)&&(s.preventDefault(),(n=e.extend({},s)).type=t.events.inputRestricted,o.$el.trigger(n,[o,o.el]))}else if((s.ctrlKey||s.metaKey)&&(s.which===i.A||s.which===i.C||s.which===i.V||s.which>=i.X&&s.which<=i.Z))return;a.hasMappedKeys&&a.mappedKeys.hasOwnProperty(d)&&(o.last.key=a.mappedKeys[d],o.insertText(o.last.key),s.preventDefault()),"function"==typeof r.beforeInsert&&(o.insertText(o.last.key),s.preventDefault()),o.checkMaxLength()}}})).bind("keyup"+s,(function(n){if(o.isCurrent()){switch(o.last.virtual=!1,n.which){case i.tab:if(o.tab&&!r.lockInput){o.shiftActive=n.shiftKey;var a=t.keyaction.tab(o);if(o.tab=!1,!a)return!1}else n.preventDefault();break;case i.escape:return r.ignoreEsc||o.close(!(!r.autoAccept||!r.autoAcceptOnEsc)&&"true"),!1}clearTimeout(o.throttled),o.throttled=setTimeout((function(){o&&o.isVisible()&&o.checkCombos()}),100),o.checkMaxLength(),o.last.preVal=""+o.last.val,o.saveLastChange();var s=e.Event(t.events.kbChange);if(s.action=o.last.key,o.$el.trigger(s,[o,o.el]),"function"==typeof r.change)return s.type=t.events.inputChange,r.change(s,o,o.el),!1;r.acceptValid&&r.autoAcceptOnValid&&"function"==typeof r.validate&&r.validate(o,o.getValue(o.$preview))&&(o.$preview.blur(),o.accept())}})).bind("keydown"+s,(function(e){if(o.last.keyPress=e.which,r.alwaysOpen&&!o.isCurrent()&&o.reveal(),e.which===i.tab)return o.tab=!0,!1;if(r.lockInput||e.timeStamp===o.last.timeStamp)return!r.lockInput;switch(o.last.timeStamp=e.timeStamp,o.last.virtual=!1,e.which){case i.backSpace:t.keyaction.bksp(o,null,e),e.preventDefault();break;case i.enter:t.keyaction.enter(o,null,e);break;case i.capsLock:o.shiftActive=o.capsLock=!o.capsLock,o.showSet();break;case i.V:if(e.ctrlKey||e.metaKey){if(r.preventPaste)return void e.preventDefault();o.checkCombos()}}})).bind("mouseup touchend ".split(" ").join(s+" "),(function(){o.last.virtual=!0,o.saveCaret()})),o.$keyboard.bind("mousedown click touchstart ".split(" ").join(o.namespace+" "),(function(t){t.stopPropagation(),o.isCurrent()||(o.reveal(),e(o.el.ownerDocument).trigger("checkkeyboard"+o.namespace)),o.setFocus()})),r.preventPaste&&(o.$preview.bind("contextmenu"+o.namespace,(function(e){e.preventDefault()})),o.$el.bind("contextmenu"+o.namespace,(function(e){e.preventDefault()})))},o.bindButton=function(n,i){var r="."+t.css.keyButton,a=function(n){n.stopPropagation(),n.$target=e(this).closest("."+t.css.keyboard+", ."+t.css.input),i.call(this,n)};return e.fn.on?o.$keyboard.on(n,r,a):e.fn.delegate&&o.$keyboard.delegate(r,n,a),o},o.unbindButton=function(n){return e.fn.off?o.$keyboard.off(n):e.fn.undelegate&&o.$keyboard.undelegate("."+t.css.keyButton,n),o},o.bindKeys=function(){var n=t.css;o.unbindButton(o.namespace+" "+o.namespace+"kb").bindButton("mouseenter mouseleave touchstart ".split(" ").join(o.namespace+" "),(function(t){if(!r.alwaysOpen&&!r.userClosed||"mouseleave"===t.type||o.isCurrent()||(o.reveal(),o.setFocus()),o.isCurrent()&&!this.disabled){var n,i,a=o.last,s=e(this),l=t.type;r.useWheel&&o.wheel&&(n=o.getLayers(s),i=(n.length?n.map((function(){return e(this).attr("data-value")||""})).get():"")||[s.text()],a.wheel_$Keys=n,a.wheelLayers=i,a.wheelIndex=e.inArray(s.attr("data-value"),i)),"mouseenter"!==l&&"touchstart"!==l||"password"===o.el.type||s.hasClass(r.css.buttonDisabled)||(s.addClass(r.css.buttonHover),r.useWheel&&o.wheel&&s.attr("title",(function(e,t){return o.wheel&&""===t&&o.sets&&i.length>1&&"touchstart"!==l?r.wheelMessage:t}))),"mouseleave"===l&&(s.removeClass("password"===o.el.type?"":r.css.buttonHover),r.useWheel&&o.wheel&&(a.wheelIndex=0,a.wheelLayers=[],a.wheel_$Keys=[],s.attr("title",(function(e,t){return t===r.wheelMessage?"":t})).html(s.attr("data-html"))))}})).bindButton(r.keyBinding.split(" ").join(o.namespace+" ")+o.namespace+" "+t.events.kbRepeater,(function(i){if(i.preventDefault(),!o.$keyboard.is(":visible")||this.disabled)return!1;var a,s=o.last,l=e(this),c=(new Date).getTime();if(r.useWheel&&o.wheel&&(l=s.wheel_$Keys.length&&s.wheelIndex>-1?s.wheel_$Keys.eq(s.wheelIndex):l),a=l.attr("data-action"),!(c-(s.eventTime||0)<r.preventDoubleEventTime)){if(s.eventTime=c,s.event=i,s.virtual=!0,s.$key=l,s.key=l.attr("data-value"),s.keyPress="",o.setFocus(),/^meta/.test(a)&&(a="meta"),a===s.key&&"string"==typeof t.keyaction[a])s.key=a=t.keyaction[a];else if(a in t.keyaction&&"function"==typeof t.keyaction[a]){if(!1===t.keyaction[a](o,this,i))return!1;a=null}return!!o.hasKeyboard()&&(null!=a&&(s.key=e(this).hasClass(n.keyAction)?a:s.key,o.insertText(s.key),o.capsLock||r.stickyShift||i.shiftKey||(o.shiftActive=!1,o.showSet(l.attr("data-name")))),t.caret(o.$preview,s),o.checkCombos(),(i=e.extend({},i,e.Event(t.events.kbChange))).target=o.el,i.action=s.key,o.$el.trigger(i,[o,o.el]),s.preVal=""+s.val,o.saveLastChange(),"function"==typeof r.change?(i.type=t.events.inputChange,r.change(i,o,o.el),!1):void 0)}})).bindButton("mouseup"+o.namespace+" "+"mouseleave touchend touchmove touchcancel ".split(" ").join(o.namespace+"kb "),(function(n){o.last.virtual=!0;var i,a=e(this);if("touchmove"===n.type){if((i=a.offset()).right=i.left+a.outerWidth(),i.bottom=i.top+a.outerHeight(),n.originalEvent.touches[0].pageX>=i.left&&n.originalEvent.touches[0].pageX<i.right&&n.originalEvent.touches[0].pageY>=i.top&&n.originalEvent.touches[0].pageY<i.bottom)return!0}else/(mouseleave|touchend|touchcancel)/i.test(n.type)?a.removeClass(r.css.buttonHover):(!r.noFocus&&o.isCurrent()&&o.isVisible()&&o.$preview.focus(),o.checkCaret&&t.caret(o.$preview,o.last));return o.mouseRepeat=[!1,""],clearTimeout(o.repeater),r.acceptValid&&r.autoAcceptOnValid&&"function"==typeof r.validate&&r.validate(o,o.getValue())&&(o.$preview.blur(),o.accept()),!1})).bindButton("click"+o.namespace,(function(){return!1})).bindButton("mousewheel"+o.namespace,o.throttleEvent((function(t,i){var a=e(this);if(a&&!a.hasClass(n.keyAction)&&o.last.wheel_$Keys[0]===this&&r.useWheel&&o.wheel){i=i||t.deltaY;var s,l=o.last.wheelLayers||[];return l.length>1?((s=o.last.wheelIndex+(i>0?-1:1))>l.length-1&&(s=0),s<0&&(s=l.length-1)):s=0,o.last.wheelIndex=s,a.html(l[s]),!1}}),30)).bindButton("mousedown touchstart ".split(" ").join(o.namespace+"kb "),(function(){var t=e(this);if(t&&(!t.hasClass(n.keyAction)||t.is("."+n.keyPrefix+"tab bksp space enter".split(" ").join(",."+n.keyPrefix))))return 0!==r.repeatRate&&(o.mouseRepeat=[!0,t],setTimeout((function(){o&&o.mouseRepeat[0]&&o.mouseRepeat[1]===t&&!t[0].disabled&&o.repeatKey(t)}),r.repeatDelay)),!1}))},o.throttleEvent=function(e,t){var n;return function(){n||(e.apply(this,arguments),n=!0,setTimeout((function(){n=!1}),t))}},o.execCommand=function(e,t){o.el.ownerDocument.execCommand(e,!1,t),o.el.normalize(),r.reposition&&o.reposition()},o.getValue=function(e){return(e=e||o.$preview)[o.isContentEditable?"text":"val"]()},o.setValue=function(e,n){return n=n||o.$preview,o.isContentEditable?e!==n.text()&&(t.replaceContent(n,e),o.saveCaret()):n.val(e),o},o.insertText=function(e){if(!o.$preview)return o;if("function"==typeof r.beforeInsert&&(e=r.beforeInsert(o.last.event,o,o.el,e)),void 0===e||!1===e)return o.last.key="",o;if(o.isContentEditable)return o.insertContentEditable(e);var n,i=!1,a="\b"===e,s=o.getValue(),l=t.caret(o.$preview),c=s.length;return l.end<l.start&&(l.end=l.start),l.start>c&&(l.end=l.start=c),o.isTextArea&&t.msie&&"\n"===s.substring(l.start,l.start+1)&&(l.start+=1,l.end+=1),n=l.start,"{d}"===e&&(e="",l.end+=1),a&&(e="",i=a&&n===l.end&&n>0),s=s.substring(0,n-(i?1:0))+e+s.substring(l.end),n+=i?-1:e.length,o.setValue(s),o.saveCaret(n,n),o.setScroll(),o},o.insertContentEditable=function(e){return o.$preview.focus(),o.execCommand("insertText",e),o.saveCaret(),o},o.checkMaxLength=function(){if(o.$preview){var e,n,i=o.getValue(),a=o.isContentEditable?t.getEditableLength(o.el):i.length;return!1!==r.maxLength&&a>r.maxLength&&(e=t.caret(o.$preview).start,n=Math.min(e,r.maxLength),r.maxInsert||(i=o.last.val,n=e-1),o.setValue(i.substring(0,r.maxLength)),o.saveCaret(n,n)),o.$decBtn.length&&o.checkDecimal(),o}},o.repeatKey=function(e){e.trigger(t.events.kbRepeater),o.mouseRepeat[0]&&(o.repeater=setTimeout((function(){o&&o.repeatKey(e)}),o.repeatTime))},o.getKeySet=function(){var e=[];return o.altActive&&e.push("alt"),o.shiftActive&&e.push("shift"),o.metaActive&&e.push(o.metaActive),e.length?e.join("+"):"normal"},o.showKeySet=function(e){return"string"==typeof e?(o.last.keyset=[o.shiftActive,o.altActive,o.metaActive],o.shiftActive=/shift/i.test(e),o.altActive=/alt/i.test(e),/\bmeta/.test(e)?(o.metaActive=!0,o.showSet(e.match(/\bmeta[\w-]+/i)[0])):(o.metaActive=!1,o.showSet())):o.showSet(e),o},o.showSet=function(e){if(o.hasKeyboard()){r=o.options;var n=t.css,i="."+n.keyPrefix,a=r.css.buttonActive,s="",l=(o.shiftActive?1:0)+(o.altActive?2:0);if(o.shiftActive||(o.capsLock=!1),o.metaActive?(o.shiftActive&&(e=(e||"").replace("-shift","")),o.altActive&&(e=(e||"").replace("-alt","")),""===(s=/^meta/i.test(e)?e:"")?s=!0===o.metaActive?"":o.metaActive:o.metaActive=s,(!r.stickyShift&&o.last.keyset[2]!==o.metaActive||(o.shiftActive||o.altActive)&&!o.$keyboard.find("."+n.keySet+"-"+s+o.rows[l]).length)&&(o.shiftActive=o.altActive=!1)):!r.stickyShift&&o.last.keyset[2]!==o.metaActive&&o.shiftActive&&(o.shiftActive=o.altActive=!1),s=0!=(l=(o.shiftActive?1:0)+(o.altActive?2:0))||o.metaActive?""===s?"":"-"+s:"-normal",!o.$keyboard.find("."+n.keySet+s+o.rows[l]).length)return o.shiftActive=o.last.keyset[0],o.altActive=o.last.keyset[1],void(o.metaActive=o.last.keyset[2]);o.$keyboard.find(i+"alt,"+i+"shift,."+n.keyAction+"[class*=meta]").removeClass(a).end().find(i+"alt").toggleClass(a,o.altActive).end().find(i+"shift").toggleClass(a,o.shiftActive).end().find(i+"lock").toggleClass(a,o.capsLock).end().find("."+n.keySet).hide().end().find("."+(n.keyAction+i+s).replace("--","-")).addClass(a),o.$keyboard.find("."+n.keySet+s+o.rows[l])[0].style.display="inline-block",o.metaActive&&o.$keyboard.find(i+o.metaActive).toggleClass(a,!1!==o.metaActive),o.last.keyset=[o.shiftActive,o.altActive,o.metaActive],o.$el.trigger(t.events.kbKeysetChange,[o,o.el]),r.reposition&&o.reposition()}},o.checkCombos=function(){if(!(o.isVisible()||o.hasKeyboard()&&o.$keyboard.hasClass(t.css.hasFocus)))return o.getValue(o.$preview||o.$el);var i,a,s,l,c=o.getValue(),u=t.caret(o.$preview),d=t.builtLayouts[o.layout],h=o.isContentEditable?t.getEditableLength(o.el):c.length,p=h;return""===c?(r.acceptValid&&o.checkValid(),c):(u.end<u.start&&(u.end=u.start),u.start>p&&(u.end=u.start=p),t.msie&&"\n"===c.substring(u.start,u.start+1)&&(u.start+=1,u.end+=1),r.useCombos&&(t.msie?c=c.replace(o.regex,(function(e,t,n){return r.combos.hasOwnProperty(t)&&r.combos[t][n]||e})):o.$preview.length&&(a=u.start-(u.start-2>=0?2:0),t.caret(o.$preview,a,u.end),s=(l=function(e){return(e||"").replace(o.regex,(function(e,t,n){return r.combos.hasOwnProperty(t)&&r.combos[t][n]||e}))})((a=t.caret(o.$preview)).text),a&&a.replaceStr&&s!==a.text&&(o.isContentEditable?t.replaceContent(n,l):o.setValue(a.replaceStr(s))),c=o.getValue())),r.restrictInput&&""!==c&&(a=d.acceptedKeys.length,(i=d.acceptedKeysRegex)||(s=e.map(d.acceptedKeys,(function(e){return e.replace(o.escapeRegex,"\\$&")})),o.alwaysAllowed.indexOf(t.keyCodes.enter)>-1&&s.push("\\n"),i=d.acceptedKeysRegex=new RegExp("("+s.join("|")+")","g")),(s=c.match(i))?c=s.join(""):(c="",p=0)),u.start+=h-p,u.end+=h-p,o.setValue(c),o.saveCaret(u.start,u.end),o.setScroll(),o.checkMaxLength(),r.acceptValid&&o.checkValid(),c)},o.checkValid=function(){var e=t.css,n=o.$keyboard.find("."+e.keyPrefix+"accept"),i=!0;"function"==typeof r.validate&&(i=r.validate(o,o.getValue(),!1)),n.toggleClass(e.inputInvalid,!i).toggleClass(e.inputValid,i).attr("title",n.attr("data-title")+" ("+r.display[i?"valid":"invalid"]+")")},o.checkDecimal=function(){o.decimal&&/\./g.test(o.preview.value)||!o.decimal&&/\,/g.test(o.preview.value)?o.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(r.css.buttonHover).addClass(r.css.buttonDisabled):o.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(r.css.buttonDefault).removeClass(r.css.buttonDisabled)},o.getLayers=function(n){var i=t.css,r=n.attr("data-pos");return n.closest("."+i.keyboard).find('button[data-pos="'+r+'"]').filter((function(){return""!==e(this).find("."+i.keyText).text()})).add(n)},o.switchInput=function(t,n){if("function"==typeof r.switchInput)r.switchInput(o,t,n);else{o.$keyboard.length&&o.$keyboard.hide();var i,a=!1,s=e("button, input, select, textarea, a, [contenteditable]").filter(":visible").not(":disabled"),l=s.index(o.$el)+(t?1:-1);if(o.$keyboard.length&&o.$keyboard.show(),l>s.length-1&&(a=r.stopAtEnd,l=0),l<0&&(a=r.stopAtEnd,l=s.length-1),!a){if(!(n=o.close(n)))return;(i=s.eq(l).data("keyboard"))&&i.options.openOn.length?i.focusOn():s.eq(l).focus()}}return!1},o.close=function(e){if(o.isOpen&&o.$keyboard.length){clearTimeout(o.throttled);var n=t.css,i=t.events,a=e?o.checkCombos():o.originalContent;if(e&&"function"==typeof r.validate&&!r.validate(o,a,!0)&&(a=o.originalContent,e=!1,r.cancelClose))return;o.isCurrent(!1),o.isOpen=r.alwaysOpen||r.userClosed,o.isContentEditable&&!e?o.$el.html(a):o.setValue(a,o.$el),o.$el.removeClass(n.isCurrent+" "+n.inputAutoAccepted).addClass(e?!0===e?"":n.inputAutoAccepted:"").trigger(i.inputChange),r.alwaysOpen||o.$el.trigger(i.kbBeforeClose,[o,o.el,e||!1]),t.caret(o.$preview,o.last),o.$el.trigger(e?i.inputAccepted:i.inputCanceled,[o,o.el]).trigger(r.alwaysOpen?i.kbInactive:i.kbHidden,[o,o.el]).blur(),o&&(o.last.eventTime=(new Date).getTime(),r.alwaysOpen||r.userClosed&&"true"===e||!o.$keyboard.length||(o.removeKeyboard(),o.timer=setTimeout((function(){o&&o.bindFocus()}),200)),o.watermark||""!==o.el.value||""===o.inPlaceholder||(o.$el.addClass(n.placeholder),o.setValue(o.inPlaceholder,o.$el)))}return!!e},o.accept=function(){return o.close(!0)},o.checkClose=function(n){if(!o.opening){var i=e.keyboard.css,a=n.$target||e(n.target).closest("."+t.css.keyboard+", ."+t.css.input);if(a.length||(a=e(n.target)),a.length&&a.hasClass(i.keyboard)){var s=a.data("keyboard");s!==o&&!s.$el.hasClass(i.isCurrent)&&s.options.openOn&&n.type===r.openOn&&s.focusOn()}else o.escClose(n,a)}},o.escCloseCallback={keepOpen:function(){return!o.isOpen}},o.escClose=function(n,i){if(o.isOpen){if(n&&"keyup"===n.type)return n.which!==t.keyCodes.escape||r.ignoreEsc?"":o.close(!(!r.autoAccept||!r.autoAcceptOnEsc)&&"true");var a=!1,s=i.length&&i||e(n.target);if(e.each(o.escCloseCallback,(function(e,t){"function"==typeof t&&(a=a||t(s))})),!a&&(!o.isCurrent()&&o.isOpen||o.isOpen&&s[0]!==o.el)){if((r.stayOpen||r.userClosed)&&!s.hasClass(t.css.input))return;if(t.allie&&n.preventDefault(),r.closeByClickEvent){var l=s[0]&&s[0].nodeName.toLowerCase();"input"!==l&&"textarea"!==l&&"click"!==n.type||o.close(!!r.autoAccept&&"true")}else o.close(!!r.autoAccept&&"true")}}},o.keyBtn=e("<button />").attr({role:"button",type:"button","aria-disabled":"false",tabindex:"-1"}).addClass(t.css.keyButton),o.processName=function(e){var t,n,i=(e||"").replace(/[^a-z0-9-_]/gi,""),r=i.length,o=[];if(r>1&&e===i)return e;if(r=e.length){for(t=0;t<r;t++)n=e[t],o.push(/[a-z0-9-_]/i.test(n)?/[-_]/.test(n)&&0!==t?"":n:(0===t?"":"-")+n.charCodeAt(0));return o.join("")}return e},o.processKeys=function(t){var n,i,r=t.indexOf("</"),o={name:t,map:"",title:""};return r>-1||(i=t.split(/:(?!\/\/)/),/\(.+\)/.test(i[0])||/^:\(.+\)/.test(t)||/\([(:)]\)/.test(t)?/\([(:)]\)/.test(t)?(n=i[0].match(/([^(]+)\((.+)\)/))&&n.length?(o.name=n[1],o.map=n[2],o.title=i.length>1?i.slice(1).join(":"):""):(o.name=t.match(/([^(]+)/)[0],":"===o.name&&(i=i.slice(1)),null===n&&(o.map=":",i=i.slice(2)),o.title=i.length?i.join(":"):""):(o.map=t.match(/\(([^()]+?)\)/)[1],""===(n=(t=t.replace(/\(([^()]+)\)/,"")).split(":"))[0]?(o.name=":",i=i.slice(1)):o.name=n[0],o.title=i.length>1?i.slice(1).join(":"):""):(""!==t&&""===i[0]?(o.name=":",i=i.slice(1)):o.name=i[0],o.title=i.length>1?i.slice(1).join(":"):""),o.title=e.trim(o.title).replace(/_/g," ")),o},o.addKey=function(e,n,i){var a,s,l,c={},u=o.processKeys(i?e:n),d=t.css;return!i&&r.display[u.name]?(l=o.processKeys(r.display[u.name])).action=o.processKeys(e).name:(l=u).action=u.name,c.name=o.processName(u.name),""!==l.name&&(""!==l.map?(t.builtLayouts[o.layout].mappedKeys[l.map]=l.name,t.builtLayouts[o.layout].acceptedKeys.push(l.name)):i&&t.builtLayouts[o.layout].acceptedKeys.push(l.name)),a=i?""===c.name?"":d.keyPrefix+c.name:d.keyAction+" "+d.keyPrefix+l.action,a+=(l.name.length>2?" "+d.keyWide:"")+" "+r.css.buttonDefault,c.html='<span class="'+d.keyText+'">'+l.name+"</span>",c.$key=o.keyBtn.clone().attr({"data-value":i?l.name:l.action,"data-name":l.action,"data-pos":o.temp[1]+","+o.temp[2],"data-action":l.action,"data-html":c.html}).addClass(a).html(c.html).appendTo(o.temp[0]),l.map&&c.$key.attr("data-mapped",l.map),(l.title||u.title)&&c.$key.attr({"data-title":u.title||l.title,title:u.title||l.title}),"function"==typeof r.buildKey&&(s=(c=r.buildKey(o,c)).$key.html(),c.$key.attr("data-html",s)),c.$key},o.customHash=function(e){var t,n,i,o,a=[],s=[];for(n in e=void 0===e?r.customLayout:e)e.hasOwnProperty(n)&&a.push(e[n]);if(i=0,0===(o=(s=s.concat.apply(s,a).join(" ")).length))return i;for(t=0;t<o;t++)i=(i<<5)-i+s.charCodeAt(t),i&=i;return i},o.buildKeyboard=function(n,i){e.isEmptyObject(r.display)&&o.updateLanguage();var a,s,l,c,u=t.css,d=0,h=t.builtLayouts[n||o.layout||r.layout]={mappedKeys:{},acceptedKeys:[]},p=h.acceptedKeys=r.restrictInclude&&(""+r.restrictInclude).split(/\s+/)||[],f=u.keyboard+" "+r.css.popup+" "+r.css.container+(r.alwaysOpen||r.userClosed?" "+u.alwaysOpen:""),g=e("<div />").addClass(f).attr({role:"textbox"}).hide();return(a=e.inArray("{space}",p))>-1&&(p[a]=" "),i&&"custom"===r.layout||!t.layouts.hasOwnProperty(r.layout)?(r.layout="custom",f=t.layouts.custom=r.customLayout||{normal:["{cancel}"]}):f=t.layouts[i?r.layout:n||o.layout||r.layout],e.each(f,(function(t,n){if(""!==t&&!/^(name|lang|rtl)$/i.test(t))for("default"===t&&(t="normal"),d++,l=e("<div />").attr("name",t).addClass(u.keySet+" "+u.keySet+"-"+t).appendTo(g).toggle("normal"===t),s=0;s<n.length;s++)c=e.trim(n[s]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g,"{$1:$2}"),o.buildRow(l,s,c.split(/\s+/),p),l.find("."+u.keyButton+",."+u.keySpacer).filter(":last").after('<br class="'+u.endRow+'"/>')})),d>1&&(o.sets=!0),h.hasMappedKeys=!e.isEmptyObject(h.mappedKeys),h.$keyboard=g,g},o.buildRow=function(n,i,a,s){var l,c,u,d,h,p,f=t.css;for(u=0;u<a.length;u++)if(o.temp=[n,i,u],d=!1,0!==a[u].length)if(/^\{\S+\}$/.test(a[u])){if(h=a[u].match(/^\{(\S+)\}$/)[1],/\!\!/.test(h)&&(h=h.replace("!!",""),d=!0),/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i.test(h)&&(p=parseFloat(h.replace(/,/,".").match(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0),e('<span class="'+f.keyText+'"></span>').width(h.match(/px/i)?p+"px":2*p+"em").addClass(f.keySpacer).appendTo(n)),/^empty(:((\d+)?([\.|,]\d+)?)(em|px)?)?$/i.test(h)){p=/:/.test(h)?parseFloat(h.replace(/,/,".").match(/^empty:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0):"",o.addKey(""," ",!0).addClass(r.css.buttonDisabled+" "+r.css.buttonEmpty).attr("aria-disabled",!0).width(p?h.match("px")?p+"px":2*p+"em":"");continue}if(/^meta[\w-]+\:?(\w+)?/i.test(h)){o.addKey(h.split(":")[0],h).addClass(f.keyHasActive);continue}switch((c=h.split(":"))[0].toLowerCase()){case"a":case"accept":o.addKey("accept",h).addClass(r.css.buttonAction+" "+f.keyAction);break;case"alt":case"altgr":o.addKey("alt",h).addClass(f.keyHasActive);break;case"b":case"bksp":o.addKey("bksp",h);break;case"c":case"cancel":o.addKey("cancel",h).addClass(r.css.buttonAction+" "+f.keyAction);break;case"combo":o.addKey("combo",h).addClass(f.keyHasActive).attr("title",(function(e,t){return t+" "+r.display[r.useCombos?"active":"disabled"]})).toggleClass(r.css.buttonActive,r.useCombos);break;case"dec":s.push(o.decimal?".":","),o.addKey("dec",h);break;case"e":case"enter":o.addKey("enter",h).addClass(r.css.buttonAction+" "+f.keyAction);break;case"lock":o.addKey("lock",h).addClass(f.keyHasActive);break;case"s":case"shift":o.addKey("shift",h).addClass(f.keyHasActive);break;case"sign":s.push("-"),o.addKey("sign",h);break;case"space":s.push(" "),o.addKey("space",h);break;case"t":case"tab":o.addKey("tab",h);break;default:t.keyaction.hasOwnProperty(c[0])&&o.addKey(c[0],h).toggleClass(r.css.buttonAction+" "+f.keyAction,d)}}else l=a[u],o.addKey(l,l,!0)},o.removeBindings=function(t){e(document).unbind(t),o.el.ownerDocument!==document&&e(o.el.ownerDocument).unbind(t),e(window).unbind(t),o.$el.unbind(t)},o.removeKeyboard=function(){o.$decBtn=[],r.usePreview&&o.$preview.removeData("keyboard"),o.$preview.unbind(o.namespace+"keybindings"),o.preview=null,o.$preview=null,o.$previewCopy=null,o.$keyboard.removeData("keyboard"),o.$keyboard.remove(),o.$keyboard=[],o.isOpen=!1,o.isCurrent(!1)},o.destroy=function(e){var n,i=t.css,a=o.extensionNamespace.length,s=[i.input,i.locked,i.placeholder,i.noKeyboard,i.alwaysOpen,r.css.input,i.isCurrent].join(" ");for(clearTimeout(o.timer),clearTimeout(o.timer2),clearTimeout(o.timer3),o.$keyboard.length&&o.removeKeyboard(),o.options.openOn&&o.removeBindings(o.options.openOn),o.removeBindings(o.namespace),o.removeBindings(o.namespace+"callbacks"),n=0;n<a;n++)o.removeBindings(o.extensionNamespace[n]);o.el.active=!1,o.$el.removeClass(s).removeAttr("aria-haspopup").removeAttr("role").removeData("keyboard"),o=null,"function"==typeof e&&e()},o.init()};return t.keyCodes={backSpace:8,tab:9,enter:13,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,A:65,Z:90,V:86,C:67,X:88,a:97,z:122},t.css={idSuffix:"_keyboard",initialFocus:"keyboard-init-focus",input:"ui-keyboard-input",inputClone:"ui-keyboard-preview-clone",wrapper:"ui-keyboard-preview-wrapper",preview:"ui-keyboard-preview",keyboard:"ui-keyboard",keySet:"ui-keyboard-keyset",keyButton:"ui-keyboard-button",keyWide:"ui-keyboard-widekey",keyPrefix:"ui-keyboard-",keyText:"ui-keyboard-text",keyHasActive:"ui-keyboard-hasactivestate",keyAction:"ui-keyboard-actionkey",keySpacer:"ui-keyboard-spacer",keyToggle:"ui-keyboard-toggle",keyDisabled:"ui-keyboard-disabled",divWrapperCE:"ui-keyboard-div-wrapper",locked:"ui-keyboard-lockedinput",alwaysOpen:"ui-keyboard-always-open",noKeyboard:"ui-keyboard-nokeyboard",placeholder:"ui-keyboard-placeholder",hasFocus:"ui-keyboard-has-focus",isCurrent:"ui-keyboard-input-current",inputValid:"ui-keyboard-valid-input",inputInvalid:"ui-keyboard-invalid-input",inputAutoAccepted:"ui-keyboard-autoaccepted",endRow:"ui-keyboard-button-endrow"},t.events={kbChange:"keyboardChange",kbBeforeClose:"beforeClose",kbBeforeVisible:"beforeVisible",kbVisible:"visible",kbInit:"initialized",kbInactive:"inactive",kbHidden:"hidden",kbRepeater:"repeater",kbKeysetChange:"keysetChange",inputAccepted:"accepted",inputCanceled:"canceled",inputChange:"change",inputRestricted:"restricted"},t.keyaction={accept:function(e){return e.close(!0),!1},alt:function(e){e.altActive=!e.altActive,e.showSet()},bksp:function(e){e.isContentEditable?(e.execCommand("delete"),e.saveCaret()):e.insertText("\b")},cancel:function(e){return e.close(),!1},clear:function(e){e.$preview[e.isContentEditable?"text":"val"](""),e.$decBtn.length&&e.checkDecimal()},combo:function(e){var n=e.options,i=!n.useCombos,r=e.$keyboard.find("."+t.css.keyPrefix+"combo");return n.useCombos=i,r.toggleClass(n.css.buttonActive,i).attr("title",r.attr("data-title")+" ("+n.display[i?"active":"disabled"]+")"),i&&e.checkCombos(),!1},dec:function(e){e.insertText(e.decimal?".":",")},del:function(e){e.isContentEditable?e.execCommand("forwardDelete"):e.insertText("{d}")},default:function(e){e.shiftActive=e.altActive=e.metaActive=!1,e.showSet()},enter:function(n,i,r){var o=n.options;return r.shiftKey?o.enterNavigation?n.switchInput(!r[o.enterMod],!0):n.close(!0):!o.enterNavigation||n.isTextArea&&!r[o.enterMod]?(n.isTextArea&&e(r.target).closest("button").length&&n.insertText((t.msie?" ":"")+"\n"),void(n.isContentEditable&&!o.enterNavigation&&(n.execCommand("insertHTML",'<div><br class="'+t.css.divWrapperCE+'"></div>'),setTimeout((function(){t.keyaction.right(n),n.saveCaret()}),0)))):n.switchInput(!r[o.enterMod],!!o.autoAccept&&"true")},lock:function(e){e.last.keyset[0]=e.shiftActive=e.capsLock=!e.capsLock,e.showSet()},left:function(e){var n=t.caret(e.$preview);n.start-1>=0&&(e.last.start=e.last.end=n.start-1,t.caret(e.$preview,e.last),e.setScroll())},meta:function(t,n){var i=e(n);t.metaActive=!i.hasClass(t.options.css.buttonActive),t.showSet(i.attr("data-name"))},next:function(e){return e.switchInput(!0,e.options.autoAccept),!1},normal:function(e){e.shiftActive=e.altActive=e.metaActive=!1,e.showSet()},prev:function(e){return e.switchInput(!1,e.options.autoAccept),!1},right:function(e){var n=t.caret(e.$preview),i=e.isContentEditable?t.getEditableLength(e.el):e.getValue().length;n.end+1<=i&&(e.last.start=e.last.end=n.end+1,t.caret(e.$preview,e.last),e.setScroll())},shift:function(e){e.last.keyset[0]=e.shiftActive=!e.shiftActive,e.showSet()},sign:function(e){if((e.decimal?/^[+-]?\d*\.?\d*$/:/^[+-]?\d*,?\d*$/).test(e.getValue())){var n,i=t.caret(e.$preview),r=e.getValue(),o=e.isContentEditable?t.getEditableLength(e.el):r.length;e.setValue(-1*r),n=o-r.length,e.last.start=i.start+n,e.last.end=i.end+n,t.caret(e.$preview,e.last),e.setScroll()}},space:function(e){e.insertText(" ")},tab:function(e){var t=e.options;if(!e.isTextArea){if(t.tabNavigation)return e.switchInput(!e.shiftActive,!0);if(e.isInput)return!1}e.insertText("\t")},toggle:function(e){e.enabled=!e.enabled,e.toggle()},NBSP:"Â ",ZWSP:"â",ZWNJ:"â",ZWJ:"â",LRM:"â",RLM:"â"},t.builtLayouts={},t.layouts={alpha:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}',"{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"],alt:["~ Â¡ Â² Â³ Â¤ â¬ Â¼ Â½ Â¾ â â Â¥ Ã {bksp}","{tab} Ã¤ Ã¥ Ã© Â® Ã¾ Ã¼ Ãº Ã­ Ã³ Ã¶ Â« Â» Â¬","Ã¡ Ã Ã° f g h j k Ã¸ Â¶ Â´ {enter}","{shift} Ã¦ x Â© v b Ã± Âµ Ã§ > Â¿ {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ Â¹ Â² Â³ Â£ â¬ Â¼ Â½ Â¾ â â Â¥ Ã· {bksp}","{tab} Ã Ã Ã Â® Ã Ã Ã Ã Ã Ã Â« Â» Â¦","Ã Â§ Ã F G H J K Ã Â° Â¨ {enter}","{shift} Ã X Â¢ V B Ã Âµ Ã . Â¿ {shift}","{accept} {alt} {space} {alt} {cancel}"]},colemak:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w f p g j l u y ; [ ] \\","{bksp} a r s t d h n e i o ' {enter}","{shift} z x c v b k m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W F P G J L U Y : { } |",'{bksp} A R S T D H N E I O " {enter}',"{shift} Z X C V B K M < > ? {shift}","{accept} {space} {cancel}"]},dvorak:{normal:["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}","{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}",'{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}","{accept} {space} {cancel}"]},num:{normal:["= ( ) {b}","{clear} / * -","7 8 9 +","4 5 6 {sign}","1 2 3 %","0 {dec} {a} {c}"]}},t.language={en:{display:{a:"â:Accept (Shift+Enter)",accept:"Accept:Accept (Shift+Enter)",alt:"Alt:â¥ AltGr",b:"â«:Backspace",bksp:"Bksp:Backspace",c:"â:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)",clear:"C:Clear",combo:"Ã¶:Toggle Combo Keys",dec:".:Decimal",e:"â:Enter",empty:"Â ",enter:"Enter:Enter â",left:"â",lock:"Lock:âª Caps Lock",next:"Next â¨",prev:"â¦ Prev",right:"â",s:"â§:Shift",shift:"Shift:Shift",sign:"Â±:Change Sign",space:"Â :Space",t:"â¥:Tab",tab:"â¥ Tab:Tab",toggle:" ",valid:"valid",invalid:"invalid",active:"active",disabled:"disabled"},wheelMessage:"Use mousewheel to see other keys",comboRegex:/([`\'~\^\"ao])([a-z])/gim,combos:{"`":{a:"Ã ",A:"Ã",e:"Ã¨",E:"Ã",i:"Ã¬",I:"Ã",o:"Ã²",O:"Ã",u:"Ã¹",U:"Ã",y:"á»³",Y:"á»²"},"'":{a:"Ã¡",A:"Ã",e:"Ã©",E:"Ã",i:"Ã­",I:"Ã",o:"Ã³",O:"Ã",u:"Ãº",U:"Ã",y:"Ã½",Y:"Ã"},'"':{a:"Ã¤",A:"Ã",e:"Ã«",E:"Ã",i:"Ã¯",I:"Ã",o:"Ã¶",O:"Ã",u:"Ã¼",U:"Ã",y:"Ã¿",Y:"Å¸"},"^":{a:"Ã¢",A:"Ã",e:"Ãª",E:"Ã",i:"Ã®",I:"Ã",o:"Ã´",O:"Ã",u:"Ã»",U:"Ã",y:"Å·",Y:"Å¶"},"~":{a:"Ã£",A:"Ã",e:"áº½",E:"áº¼",i:"Ä©",I:"Ä¨",o:"Ãµ",O:"Ã",u:"Å©",U:"Å¨",y:"á»¹",Y:"á»¸",n:"Ã±",N:"Ã"}}}},t.defaultOptions={language:null,rtl:!1,layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top",at2:"center bottom"},reposition:!0,usePreview:!0,alwaysOpen:!1,initialFocus:!0,noFocus:!1,stayOpen:!1,userClosed:!1,ignoreEsc:!1,closeByClickEvent:!1,css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix",popup:"",buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active",buttonActive:"ui-state-active",buttonDisabled:"ui-state-disabled",buttonEmpty:"ui-keyboard-empty"},autoAccept:!1,autoAcceptOnEsc:!1,lockInput:!1,restrictInput:!1,restrictInclude:"",acceptValid:!1,autoAcceptOnValid:!1,checkValidOnInit:!0,cancelClose:!0,tabNavigation:!1,enterNavigation:!1,enterMod:"altKey",stopAtEnd:!0,appendLocally:!1,appendTo:"body",wrapBRs:!0,stickyShift:!0,preventPaste:!1,caretToEnd:!1,scrollAdjustment:10,maxLength:!1,maxInsert:!0,repeatDelay:500,repeatRate:20,resetDefault:!0,openOn:"focus",activeOnReadonly:!1,keyBinding:"mousedown touchstart",useWheel:!0,useCombos:!0,validate:function(){return!0}},t.supportedInputTypes=["text","search","url","tel","password"],t.comboRegex=/([`\'~\^\"ao])([a-z])/gim,t.currentKeyboard="",e('\x3c!--[if lte IE 8]><script>jQuery("body").addClass("oldie");<\/script><![endif]--\x3e\x3c!--[if IE]><script>jQuery("body").addClass("ie");<\/script><![endif]--\x3e').appendTo("body").remove(),t.msie=e("body").hasClass("oldie"),t.allie=e("body").hasClass("ie"),t.watermark=void 0!==document.createElement("input").placeholder,t.checkCaretSupport=function(){if("boolean"!=typeof t.checkCaret){var n=document.activeElement,i=e('<div style="height:0px;width:0px;overflow:hidden;position:fixed;top:0;left:-100px;"><input type="text" value="testing"/></div>').prependTo("body");t.caret(i.find("input"),3,3),t.checkCaret=3!==t.caret(i.find("input").hide().show()).start,i.remove(),n&&n.focus&&n.focus()}return t.checkCaret},t.caret=function(e,n,i){if(!e||!e.length||e.is(":hidden")||"hidden"===e.css("visibility"))return{};var r,o,a,s,l=e.data("keyboard"),c=l&&l.options.noFocus,u=/(textarea|input)/i.test(e[0].nodeName);return c||e.focus(),void 0!==n?("object"==typeof n&&"start"in n&&"end"in n?(r=n.start,o=n.end):void 0===i&&(i=n),"number"==typeof n&&"number"==typeof i?(r=n,o=i):"start"===n?r=o=0:"string"==typeof n&&(r=o="end"),u?e.caret(r,o,c):t.setEditableCaret(e,r,o)):(s=u?e.caret():t.getEditableCaret(e[0]),r=s.start,o=s.end,a=u&&e[0].value||e.text()||"",{start:r,end:o,text:a.substring(r,o),replaceStr:function(e){return a.substring(0,r)+e+a.substring(o,a.length)}})},t.isTextNode=function(e){return e&&3===e.nodeType},t.isBlock=function(e,t){var n=e.ownerDocument.defaultView;return t&&1===t.nodeType&&t!==e&&"block"===n.getComputedStyle(t).display?1:0},t.wrapBRs=function(n){var i=e(n).find("br:not(."+t.css.divWrapperCE+")");i.length&&e.each(i,(function(i,r){var o=r.parentNode.childNodes.length;(1!==o||1===o&&!t.isBlock(n,r.parentNode))&&e(r).addClass(t.css.divWrapperCE).wrap("<div>")}))},t.getEditableCaret=function(n){if(!(n=e(n)[0]).isContentEditable)return{};var i,r,o=(e(n).data("keyboard")||{}).options,a=n.ownerDocument.getSelection().getRangeAt(0),s=c(a.startContainer,a.startOffset),l=s.position;function c(i,r){var a,s="",l=!1,c=0,u=e.makeArray(n.childNodes);function d(e){e&&(c+=e,s+=o&&o.replaceCR||"\n")}for(;!l&&u.length;){if((a=u.shift())===i&&(l=!0),d(t.isBlock(n,a.previousSibling)),t.isTextNode(a)){if(c+=l?r:a.length,s+=a.textContent,l)return{position:c,text:s}}else!l&&a.childNodes&&(u=e.makeArray(a.childNodes).concat(u));d(t.isTextNode(a.previousSibling)&&t.isBlock(n,a))}return{position:c,text:s}}return!1!==o.wrapBRs&&t.wrapBRs(n),a.endContainer===a.startContainer&&a.endOffset===a.startOffset?(i=l,r=""):(i=(s=c(a.endContainer,a.endOffset)).position,r=s.text.substring(l,i)),{start:l,end:i,text:r}},t.getEditableLength=function(e){var n=t.setEditableCaret(e,"getMax");return"number"==typeof n?n:null},t.setEditableCaret=function(n,i,r){if(!(n=e(n)[0]).isContentEditable)return{};var o=n.ownerDocument,a=o.createRange(),s=o.getSelection(),l=(e(n).data("keyboard")||{}).options,c=i,u=r,d="",h=p("getMax"===i?"end":i);function p(i){"end"===i?i=n.innerHTML.length:i<0&&(i=0);var r,o,a="",s=!1,c=0,u=0,d=0,h=e.makeArray(n.childNodes);function p(e){return a+=e?l&&l.replaceCR||"\n":"",e>0}function f(e){var t=c+e;return u=d,d+=e,i-t>=0?i-(c=t)<=0:i-t<=0}for(;!s&&h.length;)if(r=h.shift(),p(o=t.isBlock(n,r.previousSibling))&&f(o)&&(s=!0),p(o=t.isTextNode(r.previousSibling)&&t.isBlock(n,r))&&f(o)&&(s=!0),t.isTextNode(r)){if(a+=r.textContent,f(r.length))return{node:r,offset:o=i-c==0&&c-u>=1?r.length:i-c,position:i,text:a}}else!s&&r.childNodes&&(h=e.makeArray(r.childNodes).concat(h));return h.length?{node:r,offset:i-c,position:i,text:a}:{node:r,offset:r&&r.length||0,position:d,text:a}}if(h.node){if(c=h.position,"getMax"===i)return c;a.setStart(h.node,h.offset),void 0!==r&&r!==i&&(h=p(r)),h.node&&(u=h.position,a.setEnd(h.node,h.offset),d=c===u?"":h.text.substring(c,u)),s.removeAllRanges(),s.addRange(a)}return{start:c,end:u,text:d}},t.replaceContent=function(n,i){n=e(n)[0];for(var r,o,a,s=typeof i,l=t.getEditableCaret(n).start,c=0,u=[n];r=u.pop();)if(t.isTextNode(r))"function"===s?l>=c&&l<=c+r.length&&(r.textContent=i(r.textContent)):"string"===s&&(a=i.substring(c,c+r.length))!==r.textContent&&(r.textContent=a),c+=r.length;else if(r&&r.childNodes)for(o=r.childNodes.length;o--;)u.push(r.childNodes[o]);o=t.getEditableCaret(n),t.setEditableCaret(n,o.start,o.start)},e.fn.keyboard=function(t){return this.each((function(){e(this).data("keyboard")||new e.keyboard(this,t)}))},e.fn.getkeyboard=function(){return this.data("keyboard")},e.fn.caret=function(e,t,n){if(void 0===this[0]||this.is(":hidden")||"hidden"===this.css("visibility")||!/(INPUT|TEXTAREA)/i.test(this[0].nodeName))return this;var i,r,o,a,s,l=this[0],c=l.ownerDocument.selection,u=l.scrollTop,d=!1,h=!0;try{d="selectionStart"in l}catch(e){h=!1}return h&&void 0!==e?(/(email|number)/i.test(l.type)||(d?(l.selectionStart=e,l.selectionEnd=t):((i=l.createTextRange()).collapse(!0),i.moveStart("character",e),i.moveEnd("character",t-e),i.select())),n||!this.is(":visible")&&"hidden"===this.css("visibility")||l.focus(),l.scrollTop=u,this):(/(email|number)/i.test(l.type)?e=t=this.val().length:d?(e=l.selectionStart,t=l.selectionEnd):c?"TEXTAREA"===l.nodeName.toUpperCase()?(s=this.val(),(o=(r=c.createRange()).duplicate()).moveToElementText(l),o.setEndPoint("EndToEnd",r),e=o.text.replace(/\r/g,"\n").length,t=e+r.text.replace(/\r/g,"\n").length):(s=this.val().replace(/\r/g,"\n"),(r=c.createRange().duplicate()).moveEnd("character",s.length),e=""===r.text?s.length:s.lastIndexOf(r.text),(r=c.createRange().duplicate()).moveStart("character",-s.length),t=r.text.length):e=t=(l.value||"").length,a=l.value||"",{start:e,end:t,text:a.substring(e,t),replace:function(n){return a.substring(0,e)+n+a.substring(t,a.length)}})},t})?i.apply(t,r):i)||(e.exports=o)},function(e,t){angular.module("evtviewer.tdhop",[])},function(e,t){angular.module("evtviewer.tdhop",[]).service("tdhopViewerModel","$log",(function(){var e={id:"tdhop",name:"Mesh_1_mesh",url:"data/models/singleres/cross.ply",mesh:"Mesh_1_mesh",toolHome:!0,toolZoomin:!0,toolZoomout:!0,toolLighting:!0,toolLightControl:!0,toolMeasure:!0,toolPickPoint:!0,toolPlaneSections:!0,toolSolidColor:!0,toolCamera:!0,toolFullScreen:!0};this.getOptions=function(){return e}}))},function(e,t){angular.module("evtviewer.tdhop").provider("evtTredhop",(function(){this.$get=["config","$ocLazyLoad","$log",function(e,t,n){var i={},r=n.getInstance("evtTredhop");return i.build=function(n){var i=e.tdhopViewerOptions.Model_1?e.tdhopViewerOptions.Model_1.path:"",o=e.tdhopViewerOptions.Model_2?e.tdhopViewerOptions.Model_2.path:"",a=e.tdhopViewerOptions.Hotspots?e.tdhopViewerOptions.Hotspots.path:"",s=e.tdhopViewerOptions.Hotspots?e.tdhopViewerOptions.Hotspots.type:void 0,l=e.tdhopViewerOptions.Hotspots?JSON.stringify(e.tdhopViewerOptions.Hotspots.hotspotsdata):[];r.log("Check hotspotsdata "+l),r.log("Check model path "+i),e.tdhopViewerOptions.id="tdhop";var c=["jquery.js","spidergl.js","presenter.js","nexus.js","ply.js","helpers.js","trackball_sphere.js","trackball_turntable.js","trackball_turntable_pan.js","trackball_pantilt.js","trackball_rail.js","nexus.js","corto.js","meco.js","init.js","meshcoder_worker.js","setup.js"],u=function(e){t.load("js-plugins/tdhop/"+c[e]).then((function(){c[e+1]?u(e+1):(d(),r.log("3dhop viewer setup and initialized"))}))},d=function(){init3dhop(),setup3dhop(i,o,a,l,s)};e.tdhopViewerOptions.toolHome;u(0)},i}]}))},function(e,t,n){angular.module("evtviewer.tdhop").directive("evtTredhop",["evtTredhop","evtInterface","$timeout",function(e,t,i){return{restrict:"AE",scope:{canvas:"@",measurebox:"@",options:"=",name:"="},controllerAs:"vm",controller:"TreDHOPCtrl",template:n(315),transclude:!0,link:function(t,n,r){i((function(){var n=e.build(t);t.$on("$destroy",(function(){n&&tdhop.destroy(n.currentId)}))}),10)}}}])},function(e,t){e.exports='<div id="tdhop" class="3dhop" onmousedown="if (event.preventDefault) event.preventDefault()">\n   <div style="position:absolute; right:10px; top:10px; z-index:2;">\n      \x3c!--COMPASS--\x3e\n      <div\n         style="background-color:rgba(150, 150, 150, 0.8); border-radius: 5px; font-family:verdana; font-size:15px; padding:3px;">\n         <div style="margin: 0 auto;">\n            <canvas id="compassCanvas"\n               style="margin: 4px auto; display: block; background:#555555; width:100; height:100; border:1px solid #000000;"\n               onclick=\'var currpos = presenter.getTrackballPosition(); currpos[0] = 0.0; presenter.animateToTrackballPosition(currpos);\'\n               width="100" height="100"></canvas>\n         </div>\n         <table style="border: \'1\'">\n            <tbody>\n               <tr>\n                  <td></td>\n                  <td>\n                     <button style="margin: 0 auto; cursor:hand;"\n                        onclick="presenter.animateToTrackballPosition([180.0, 0.0, 0.0, 0.12, 0.0, 3.0]);">{{ \'3DHOP.NORTH\' | translate }}</button>\n                  </td>\n                  <td></td>\n               </tr>\n               <tr>\n                  <td>\n                     <button style="margin: 0 auto; cursor:hand;"\n                        onclick="presenter.animateToTrackballPosition([-90.0, 0.0, 0.0, 0.12, 0.0, 3.0]);">{{ \'3DHOP.EAST\' | translate }}</button>\n                  </td>\n                  <td>\n                     <button style="margin: 0 auto; display: block; cursor:hand;"\n                        onclick="presenter.animateToTrackballPosition([0.0, 90.0, -0.1, 0.0, -0.066, 2.0]);">{{ \'3DHOP.TOP\' | translate }}</button>\n                  </td>\n                  <td>\n                     <button style="margin: 0 auto; cursor:hand;"\n                        onclick="presenter.animateToTrackballPosition([90.0, 0.0, 0.0, 0.12, 0.0, 3.0]);">{{ \'3DHOP.WEST\' | translate }}</button>\n                  </td>\n               </tr>\n               <tr>\n                  <td></td>\n                  <td>\n                     <button style="margin: 0 auto; cursor:hand;"\n                        onclick="presenter.animateToTrackballPosition([0.0, 0.0, 0.0, 0.12, 0.0, 3.0]);">{{ \'3DHOP.SOUTH\' | translate }}</button>\n                  </td>\n                  <td></td>\n               </tr>\n            </tbody>\n         </table>\n         \x3c!--input type="checkbox" style="cursor:hand;" onclick="presenter.toggleCameraType();">\n      Orthographic View--\x3e\n      </div>\n      \x3c!--COMPASS--\x3e\n      \x3c!--PREDEFINED VIEWS-- >\n      </br>\n      <div style="background-color:rgba(150, 150, 150, 0.8); border-radius: 5px; font-family:verdana; font-size:15px; padding:3px;">\n      <B>VIEWS</B></br></br>\n\n      <button style="cursor:hand; width:100%;" onclick="\n         presenter.animateToTrackballPosition([-134.06457816074385, -12.887777440509286, -0.0759087076749807, 0.3412565266806582, -0.27139426466935546, 0.2]);"><span>Occhio</span></button></br>\n\n      <button style="cursor:hand; width:100%;" onclick="\n         presenter.animateToTrackballPosition([-30.932175037195172, 21.48969026734013, -0.10514808884296216, 0.24072568682235757, 0.4103747554925059, 0.47158953820000027]);"><span>Base</span></button></br>\n\n      <button style="cursor:hand; width:100%;" onclick="\n         presenter.animateToTrackballPosition([-78.9460382691582, 23.208563652732604, -0.12881082145875608, -0.14276897621084111, -0.20041195051130686, 0.5021485402753604]);"><span>Ala</span></button></br>\n      </div>--\x3e\n   </div>\n   <div id="toolbar">\n\n      <img ng-if="::vm.isToolHomeAvailable()" id="home" class="viewer3dhopBtn" title="{{ \'3DHOP.HOME\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/home.png" />\n      \x3c!--FULLSCREEN--\x3e\n      <img ng-if="::vm.isToolFullScreenAvailable()" id="full_on" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'full_on\')" title="{{ \'3DHOP.EXIT_FULL_SCREEN\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/full_on.png"\n         style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolFullScreenAvailable()" id="full" class="viewer3dhopBtn" ng-click="actionsToolbar(\'full\')"\n         title="{{ \'3DHOP.FULL_SCREEN\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/full.png" /><br />\n      \x3c!--FULLSCREEN--\x3e\n      <div ng-if="::vm.isToolArrowsAvailable()" id="arrows">\n         <div id="movement_control">\n            <img class="move_ left" id="move_left" title="{{ \'3DHOP.MOVE_LEFT\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/arrows.png" />\n            <img class="move_ right" id="move_right" title="{{ \'3DHOP.MOVE_RIGHT\' | translate }}"\n               ng-src="js-plugins/tdhop/skins/dark/arrows.png" /><br />\n            <img class="move_ up" id="move_up" title="{{ \'3DHOP.MOVE_UP\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/arrows.png" />\n            <img class="move_ dawn" id="move_dawn" title="{{ \'3DHOP.MOVE_DOWN\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/arrows.png" />\n         </div>\n      </div>\n      \x3c!--ZOOM--\x3e\n      <img ng-if="::vm.isToolZoominAvailable()" id="zoomin" class="viewer3dhopBtn" title="{{ \'3DHOP.ZOOM_IN\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/zoomin.png" />\n      <img ng-if="::vm.isToolZoomoutAvailable()" id="zoomout" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'zoomout\')" title="{{ \'3DHOP.ZOOM_OUT\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/zoomout.png" /><br />\n      \x3c!--ZOOM--\x3e\n      \x3c!--LIGHT--\x3e\n      <img ng-if="::vm.isToolLightingAvailable()" id="lighting_off" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'lighting_off\')" title="{{ \'3DHOP.ENABLE_LIGHTING\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/lighting_off.png" style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolLightingAvailable()" id="lighting" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'lighting\')" title="{{ \'3DHOP.DISABLE_LIGHTING\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/lighting.png" />\n      <img ng-if="::vm.isToolLightControlAvailable()" id="light_off" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'light_off\')" title="{{ \'3DHOP.DISABLE_LIGHT_CONTROL\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/lightcontrol_on.png" style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolLightControlAvailable()" id="light" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'light\')" title="{{ \'3DHOP.ENABLE_LIGHT_CONTROL\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/lightcontrol.png" /><br />\n      \x3c!--LIGHT--\x3e\n      <img ng-if="::vm.isToolCameraAvailable()" id="perspective" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'perspective\')" title="{{ \'3DHOP.PERSPECTIVE_CAMERA\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/perspective.png" style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolCameraAvailable()" id="orthographic" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'orthographic\')" title="{{ \'3DHOP.ORTHOGRAPHIC_CAMERA\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/orthographic.png" /><br />\n      \x3c!--COLOR--\x3e\n      <img ng-if="::vm.isToolSolidColorAvailable()" id="color_on" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'color_on\')" title="{{ \'3DHOP.MODEL_COLOR\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/color_on.png"\n         style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolSolidColorAvailable()" id="color" class="viewer3dhopBtn" ng-click="actionsToolbar(\'color\')"\n         title="{{ \'3DHOP.SOLID_COLOR\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/color.png" /><br />\n      \x3c!--COLOR--\x3e\n      \x3c!--HOTSPOT--\x3e\n      <img ng-if="::vm.isToolHotspotAvailable()" id="hotspot_on" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'hotspot_on\')" title="{{ \'3DHOP.HIDE_HOTSPOTS\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/pin_on.png"\n         style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolHotspotAvailable()" id="hotspot" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'hotspot\')" title="{{ \'3DHOP.SHOW_HOTSPOTS\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/pin.png" /><br />\n      \x3c!--HOTSPOT--\x3e\n      \x3c!--MEASURE--\x3e\n      <img ng-if="::vm.isToolMeasureAvailable()" id="measure_on" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'measure_on\')" title="{{ \'3DHOP.DISABLE_MEASURE_TOOL\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/measure_on.png" style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolMeasureAvailable()" id="measure" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'measure\')" title="{{ \'3DHOP.ENABLE_MEASURE_TOOL\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/measure.png" /><br />\n      \x3c!--MEASURE--\x3e\n      \x3c!--POINT PICKING--\x3e\n      <img ng-if="::vm.isToolPickPointAvailable()" id="pick_on" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'pick_on\')" title="{{ \'3DHOP.DISABLE_PICKPOINT_MODE\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/pick_on.png" style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolPickPointAvailable()" id="pick" class="viewer3dhopBtn" ng-click="actionsToolbar(\'pick\')"\n         title="{{ \'3DHOP.ENABLE_PICKPOINT_MODE\' | translate }}" ng-src="js-plugins/tdhop/skins/dark/pick.png" /><br />\n      \x3c!--POINT PICKING--\x3e\n      \x3c!--SECTIONS--\x3e\n      <img ng-if="::vm.isToolPlaneSectionsAvailable()" id="sections_on" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'sections_on\')" title="{{ \'3DHOP.DISABLE_PLANE_SECTIONS\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/sections_on.png" style="position:absolute; visibility:hidden;" />\n      <img ng-if="::vm.isToolPlaneSectionsAvailable()" id="sections" class="viewer3dhopBtn"\n         ng-click="actionsToolbar(\'sections\')" title="{{ \'3DHOP.ENABLE_PLANE_SECTIONS\' | translate }}"\n         ng-src="js-plugins/tdhop/skins/dark/sections.png" /><br />\n      \x3c!--SECTIONS--\x3e\n      <div ng-if="::vm.isToolLightControllerAvailable()" ng-click="actionsToolbar" id="lightcontroller">\n         <canvas id="lightcontroller_canvas" width="125" height="125" />\n      </div>\n   </div>\n   <div id="tdhlg"></div>\n   \x3c!--MEASURE--\x3e\n   <div id="measure-box" ng-click="onEndMeasure(\'measure-box\')" class="output-box">{{ \'3DHOP.MEASURED_LENGTH\' | translate }}\n      <hr /><span id="measure-output" ng-click="onEndMeasure(\'measure-output\')" class="output-text"\n         onmousedown="event.stopPropagation()">0.0</span></div>\n   \x3c!--MEASURE--\x3e\n   \x3c!--POINT PICKING--\x3e\n   <div id="pickpoint-box" ng-click="onEndPick(\'pickpoint-box\')" class="output-box">{{ \'3DHOP.XYZ_PICKED_POINT\' | translate }}\n      <hr /><span id="pickpoint-output" ng-click="onEndMeasure(\'pickpoint-output\')" class="output-text"\n         onmousedown="event.stopPropagation()">[ 0 , 0 , 0 ]</span></div>\n   \x3c!--POINT PICKING--\x3e\n   \x3c!--SECTIONS--\x3e\n   <div id="sections-box" ng-click="sectiontoolInit" class="output-box">\n      <table class="output-table" onmousedown="event.stopPropagation()">\n         <tr>\n            <td>{{ \'3DHOP.PLANE\' | translate }}</td>\n            <td>{{ \'3DHOP.POSITION\' | translate }}</td>\n            <td>{{ \'3DHOP.FLIP\' | translate }}</td>\n         </tr>\n         <tr>\n            <td><img id="xplane_on" title="{{ \'3DHOP.DISABLE_X_AXIS_SECTION\' | translate }}" ng-src="js-plugins/tdhop/skins/icons/sectionX_on.png"\n                  onclick="sectionxSwitch()" style="position:absolute; visibility:hidden; border:1px inset;" />\n               <img id="xplane" title="{{ \'3DHOP.ENABLE_X_AXIS_SECTION\' | translate }}" ng-src="js-plugins/tdhop/skins/icons/sectionX.png"\n                  onclick="sectionxSwitch()" /><br /></td>\n            <td><input id="xplaneSlider" class="output-input" type="range" title="{{ \'3DHOP.MOVE_X_AXIS_SECTION_POSITION\' | translate }}" /></td>\n            <td><input id="xplaneFlip" class="output-input" type="checkbox" title="{{ \'3DHOP.FLIP_X_AXIS_SECTION_DIRECTION\' | translate }}" />\n            </td>\n         </tr>\n         <tr>\n            <td><img id="yplane_on" title="{{ \'3DHOP.DISABLE_Y_AXIS_SECTION\' | translate }}" ng-src="js-plugins/tdhop/skins/icons/sectionY_on.png"\n                  onclick="sectionySwitch()" style="position:absolute; visibility:hidden; border:1px inset;" />\n               <img id="yplane" title="{{ \'3DHOP.ENABLE_Y_AXIS_SECTION\' | translate }}" ng-src="js-plugins/tdhop/skins/icons/sectionY.png"\n                  onclick="sectionySwitch()" /><br /></td>\n            <td><input id="yplaneSlider" class="output-input" type="range" title="{{ \'3DHOP.MOVE_Y_AXIS_SECTION_POSITION\' | translate }}" /></td>\n            <td><input id="yplaneFlip" class="output-input" type="checkbox" title="{{ \'3DHOP.FLIP_Y_AXIS_SECTION_DIRECTION\' | translate }}" />\n            </td>\n         </tr>\n         <tr>\n            <td><img id="zplane_on" title="{{ \'3DHOP.DISABLE_Z_AXIS_SECTION\' | translate }}" ng-src="js-plugins/tdhop/skins/icons/sectionZ_on.png"\n                  onclick="sectionzSwitch()" style="position:absolute; visibility:hidden; border:1px inset;" />\n               <img id="zplane" title="{{ \'3DHOP.ENABLE_Z_AXIS_SECTION\' | translate }}" ng-src="js-plugins/tdhop/skins/icons/sectionZ.png"\n                  onclick="sectionzSwitch()" /><br /></td>\n            <td><input id="zplaneSlider" class="output-input" type="range" title="{{ \'3DHOP.MOVE_Z_AXIS_SECTION_POSITION\' | translate }}" /></td>\n            <td><input id="zplaneFlip" class="output-input" type="checkbox" title="{{ \'3DHOP.FLIP_Z_AXIS_SECTION_DIRECTION\' | translate }}" />\n            </td>\n         </tr>\n      </table>\n      <table class="output-table" onmousedown="event.stopPropagation()" style="text-align:right;">\n         <tr>\n            <td>{{ \'3DHOP.SHOW_PLANES\' | translate }}<input id="showPlane" class="output-input" type="checkbox" title="{{ \'3DHOP.SHOW_SECTION_PLANES\' | translate }}"\n                  style="bottom:-3px;" /></td>\n            <td>{{ \'3DHOP.SHOW_EDGES\' | translate }}<input id="showBorder" class="output-input" type="checkbox" title="{{ \'3DHOP.SHOW_SECTION_EDGES\' | translate }}"\n                  style="bottom:-3px;" /></td>\n         </tr>\n      </table>\n   </div>\n   <canvas id="draw-canvas" style="background-image: url(js-plugins/tdhop/skins/backgrounds/light.jpg);"></canvas>\n</div>'},function(e,t){angular.module("evtviewer.tdhop").controller("TreDHOPCtrl",["$scope","$route","evtInterface","$log","config",function(e,t,n,i,r){var o=r.tdhopViewerOptions.Model_1?r.tdhopViewerOptions.Model_1.name:void 0,a=r.tdhopViewerOptions.Model_2?r.tdhopViewerOptions.Model_2.name:void 0;e.change=function(){presenter.setInstanceVisibility(HOP_ALL,!1,!1),presenter.setInstanceVisibility("Mesh_2_mesh",!0,!0)},e.data={model:null,availableOptions:[{id:"Mesh_1_mesh",name:o+" Cross"},{id:"Mesh_2_mesh",name:a+" Cross"}]},e.button={buttonValue:e.data},this.isToolHomeAvailable=function(){return r.tdhopViewerOptions.toolHome},this.isToolZoominAvailable=function(){return r.tdhopViewerOptions.toolZoomin},this.isToolZoomoutAvailable=function(){return r.tdhopViewerOptions.toolZoomout},this.isToolLightingAvailable=function(){return r.tdhopViewerOptions.toolLighting},this.isToolLightControlAvailable=function(){return r.tdhopViewerOptions.toolLightControl},this.isToolPlaneSectionsAvailable=function(){return r.tdhopViewerOptions.toolPlaneSections},this.isToolSolidColorAvailable=function(){return r.tdhopViewerOptions.toolSolidColor},this.isToolCameraAvailable=function(){return r.tdhopViewerOptions.toolCamera},this.isToolMeasureAvailable=function(){return r.tdhopViewerOptions.toolMeasure},this.isToolPickPointAvailable=function(){return r.tdhopViewerOptions.toolPickPoint},this.isToolHotspotAvailable=function(){return r.tdhopViewerOptions.toolHotspot},this.isToolFullScreenAvailable=function(){return r.tdhopViewerOptions.toolFullScreen},this.isToolSwitchModelAvailable=function(){return r.tdhopViewerOptions.toolSwitchModel},this.isToolArrowsAvailable=function(){return r.tdhopViewerOptions.toolArrows},this.isToolLightControllerAvailable=function(){return r.tdhopViewerOptions.toolLightController}}])},function(e,t){angular.module("evtviewer.navBar",[])},function(e,t){angular.module("evtviewer.navBar").constant("NAVBARDEFAULTS",{}).config(["evtNavbarProvider","configProvider","NAVBARDEFAULTS",function(e,t,n){var i=t.makeDefaults("navBar",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.navBar").provider("evtNavbar",(function(){this.defaults;this.setDefaults=function(e){e};this.$get=["parsedData","evtInterface",function(e,t){var n={},i={},r=[],o=0,a=function(){var e=this.uid;n.destroy(e)};return n.build=function(n){var s,l=o++;if(void 0===i[l]){var c=e.getPages(),u=e.getDocuments(),d=t.getState("currentDoc"),h=t.getState("currentPage");return s={uid:l,pageSlider:{value:0,options:{floor:0,ceil:c?c.length:0,translate:function(e,t,n){var i=c[e];return c[i]?c[i].label:e},showSelectionBar:!0,hideLimitLabels:!0}},pagesCollection:c,documentsCollection:u,page:h,doc:d,updateOptions:function(e){this.pageSlider.options=e},updateSlider:function(e){var t=this;if(t.pagesCollection){var n=t.pagesCollection._indexes.indexOf(e);t.pageSlider.value!==n&&(t.pageSlider.value=n),t.folio!==e&&(t.folio=e),t.page=e}},updatePage:function(e){if(e){var n=this.pagesCollection[e];t.updateState("currentPage",n);var i=t.getState("currentDoc"),r=this.pagesCollection[n];r&&(r.docs.length>0&&r.docs.indexOf(i)<0&&t.updateState("currentDoc",r.docs[0]),r.docs.length>1&&t.updateState("currentDoc",r.docs[0])),t.updateUrl()}},updateOptionsValue:function(e,t){this.pageSlider.options=this.pageSlider.options?this.pageSlider.options:{},this.pageSlider.options[e]=t},destroy:a},i[l]=angular.extend(n.vm,s),r.push({id:l}),i[l]}},n.destroy=function(e){delete i[e]},n}]}))},function(e,t){angular.module("evtviewer.navBar").controller("NavbarCtrl",["$log","evtInterface","config",function(e,t,n){var i=e.getInstance("navBar");this.showNavigator=function(){return!t.getState("isThumbNailsOpened")&&!t.getState("isVisCollOpened")},this.config=n,i.log(n,this.config)}])},function(e,t,n){angular.module("evtviewer.navBar").directive("evtNavbar",["$timeout","evtNavbar","parsedData","evtInterface",function(e,t,i,r){return{restrict:"E",scope:{},transclude:!0,template:n(322),controllerAs:"vm",controller:"NavbarCtrl",link:function(n,o,a){var s=t.build(n);n.$watch((function(){return i.getPages()}),(function(t,i){i!==t&&(s.updateOptionsValue("floor",0),s.updateOptionsValue("ceil",t?t.length-1:0),s.updateOptionsValue("translate",(function(e,n,i){var r=t[e];return t[r]?t[r].label:e})),e((function(){n.$broadcast("rzSliderForceRender")})))}),!0),n.$watch((function(){return s.pageSlider.value}),(function(e,t){t!==e&&s.updatePage(e)}),!0),n.$watch((function(){return r.getState("currentPage")}),(function(e,t){t!==e&&s.updateSlider(e)}),!0),n.$watch((function(){return s.showNavigator()}),(function(e,t){t!==e&&s.updateOptionsValue("disabled",!e)}),!0),n.$on("$destroy",(function(){s&&s.destroy()}))}}}])},function(e,t){e.exports='<section class="navBarSliderWrapper">\n\t<button-switch ng-if="vm.config.thumbnailsButton"\n\t\ttitle="{{ \'BUTTONS.THUMBNAILS\' | translate }}"\n\t\tdata-icon="thumb-nails"\n\t\tdata-type="thumbNails"\n\t\tclass="sliders"></button-switch>\n\t<button-switch ng-if="vm.config.viscollButton"\n\t\ttitle="{{ \'BUTTONS.VISCOLL\' | translate }}"\t\t\n\t\tdata-icon="viscoll"\n\t\tdata-type="visColl"\n\t\tclass="sliders"></button-switch>\n\t<div class="navBarSlider">\n\t\t<rzslider rz-slider-model="vm.pageSlider.value" rz-slider-options="vm.pageSlider.options" id="slider" data-folio="{{vm.folio}}"></rzslider>\n\t</div>\n\t\n\t<button-switch data-disabled="{{!vm.showNavigator()}}"\n\t\ttitle="{{ \'BUTTONS.PAGE_FIRST\' | translate }}"\n\t\tdata-icon="first-page" \n\t\tdata-type="firstPage"\n\t\tclass="sliders"></button-switch>\n\t<button-switch data-disabled="{{!vm.showNavigator()}}"\n\t\ttitle="{{ \'BUTTONS.PAGE_PREVIOUS\' | translate }}"\n\t\tdata-icon="prev-page"\n\t\tdata-type="prevPage"\n\t\tclass="sliders"></button-switch>\n\t<button-switch data-disabled="{{!vm.showNavigator()}}"\n\t\ttitle="{{ \'BUTTONS.PAGE_NEXT\' | translate }}"\n\t\tdata-icon="next-page" \n\t\tdata-type="nextPage"\n\t\tclass="sliders"></button-switch>\n\t<button-switch data-disabled="{{!vm.showNavigator()}}"\n\t\ttitle="{{ \'BUTTONS.PAGE_LAST\' | translate }}"\n\t\tdata-icon="last-page" \n\t\tdata-type="lastPage"\n\t\tclass="sliders"></button-switch>\n</section>\n\x3c!-- avanti e fine a sx, dietro e inizio a dx--\x3e'},function(e,t){angular.module("evtviewer.visColl",[])},function(e,t){angular.module("evtviewer.visColl").constant("VISCOLLDEFAULTS",{}).config(["evtViscollProvider","configProvider","VISCOLLDEFAULTS",function(e,t,n){var i=t.makeDefaults("visColl",n);e.setDefaults(i)}])},function(e,t){angular.module("evtviewer.visColl").provider("evtViscoll",(function(){this.defaults;this.setDefaults=function(e){e};this.$get=["$timeout","parsedData",function(e,t){var n={},i={},r=[],o=0,a=function(){var e=this.uid;n.destroy(e)};return n.build=function(n){var s,l=o++;if(void 0===i[l]){return s={uid:l,svgCollection:t.getViscollSvgs(),selectedQuire:void 0,quireOptions:[],selectedFolios:void 0,getSvgByQuire:function(e){return this.svgCollection.svgs[e]&&this.svgCollection.svgs[e].textSvg?this.svgCollection.svgs[e].textSvg.outerHTML:"<span>No data</span>"},getSvgQuireN:function(e){return this.svgCollection.svgs[e].quireN},getQuire:function(e){return this.svgCollection.quires[e]||{}},getQuireBySvgId:function(e){var t=this.getSvgQuireN(e);return this.getQuireByNumber(t)},getQuireByNumber:function(e){for(var t,n=0;!t&&n<this.svgCollection.quires._indexes.length;){var i=this.svgCollection.quires._indexes[n];this.svgCollection.quires[i].n===e&&(t=this.svgCollection.quires[i]),n++}return t},getQuireIdBySvgId:function(e){return this.getQuireBySvgId(e).value},getFilteredQuireLeaves:function(e){for(var t=this.svgCollection.quires[e].leaves,n=[],i=[],r=0;r<t._indexes.length;r++){var o=t._indexes[r],a=t[o];if(a){var s=a.conjoin?t[a.conjoin]:void 0,l=!1;s&&(a.label=a.leafno+" - "+s.leafno,l=i.indexOf(s.value)>-1),l||(n.push(a),i.push(o))}}return{leaves:n,leavesInsertedInSelector:i}},getAllQuireLeaves:function(e){for(var t=this.svgCollection.quires[e].leaves,n=[],i=0;i<t._indexes.length;i++)n.push(t[t._indexes[i]]);return n},isSelectedQuire:function(e){return!this.selectedQuire||e===this.selectedQuire.value},displayResult:function(){var n=this;n.svgCollection=t.getViscollSvgs();var i=[];if(n.svgCollection.quires._indexes)for(var r=0;r<n.svgCollection.quires._indexes.length;r++){var o=n.svgCollection.quires._indexes[r],a=n.svgCollection.quires[o];i.push({value:a.value,label:a.n,title:a.n});var s=n.getFilteredQuireLeaves(o);a.leavesList=s.leaves,a.leavesInsertedInSelector=s.leavesInsertedInSelector}n.quireOptions=i,e((function(){var e=angular.element(".viscollContainer svg > g");e&&(e.click((function(e){try{var t=angular.element(e.delegateTarget).parents(".viscollContainer")[0].id,i=e.delegateTarget.id,r=n.svgCollection.quires[t].leaves[i];if(n.svgCollection.quires[t].leavesInsertedInSelector&&n.svgCollection.quires[t].leavesInsertedInSelector.indexOf(i)>-1)n.setSelectedFolioForQuire(t,r);else{var o=n.svgCollection.quires[t].leaves[r.conjoin];n.setSelectedFolioForQuire(t,o)}}catch(e){console.log(e)}})),e.hover((function(e){try{var t=angular.element(e.delegateTarget).parents(".viscollContainer")[0].id,i=e.delegateTarget.id,r=n.svgCollection.quires[t].leaves[i];if(r){var o=angular.element("#"+r.value),a=angular.element(".over_unit");a&&a.removeClass("over_unit"),o.addClass("over_unit")}if(!n.svgCollection.quires[t].leavesInsertedInSelector||n.svgCollection.quires[t].leavesInsertedInSelector.indexOf(i)<0)angular.element("#"+r.conjoin).addClass("over_unit")}catch(e){console.log(e)}})),e.mouseout((function(e){var t=angular.element(".over_unit");t&&t.removeClass("over_unit")})))}))},setSelectedQuire:function(e){e&&e.value?this.selectedQuire={value:e.value,n:e.label}:this.selectedQuire=void 0},setSelectedFolioForQuire:function(e,t){var n=this;n.selectedFolios=n.selectedFolios?n.selectedFolios:{};var i=n.svgCollection.quires[e].leaves[t.value];if(i){if(!(i.imageId&&i.imageId2&&i.conjoinId&&i.conjoinId2)){var r=n.svgCollection.quires[e].leaves[t.conjoin];r&&(i.imageId||(i.img=r.imgConjoin,i.imageId=r.conjoinId),i.imageId2||(i.img2=r.imgConjoin2,i.imageId2=r.conjoinId2),i.conjoinId||(i.imgConjoin=r.img,i.conjoinId=r.imageId),i.conjoinId2||(i.imgConjoin2=r.img2,i.conjoinId2=r.imageId2))}i.unitN=t.label}n.selectedFolios[e]=i;var o=angular.element("#"+e+" .active_unit");o&&(o.removeClass("active_unit"),o.removeClass("first_unit"),o.removeClass("second_unit"));var a=angular.element("#"+t.value);a&&(a.addClass("active_unit"),a.addClass("first_unit"));try{for(var s,l=n.svgCollection.quires[e],c=0;!s&&c<l.leaves._indexes.length;){var u=l.leaves._indexes[c];l.leaves[u].value===t.value&&(s=l.leaves[u]),c++}if(s&&s.conjoin){var d=angular.element("#"+s.conjoin);d.addClass("active_unit"),d.addClass("second_unit")}}catch(e){console.log(e)}},destroy:a},i[l]=angular.extend(n.vm,s),r.push({id:l}),i[l]}},n.destroy=function(e){delete i[e]},n}]}))},function(e,t){angular.module("evtviewer.visColl").controller("ViscollCtrl",["config","$log","$scope","$filter","evtNavbar","parsedData","evtInterface","evtSelect","evtButtonSwitch",function(e,t,n,i,r,o,a,s,l){t.getInstance("visColl");this.updateCurrentPage=function(e){if(e){var t=o.getPages();for(var n in t)void 0!==t[n].n&&t[n].n===e&&(a.updateState("currentPage",n),a.updateState("isVisCollOpened",!1));var i=l.getByType("visColl");i&&i.forEach((function(e){e.setActive(!1)})),a.updateUrl()}}}])},function(e,t,n){angular.module("evtviewer.visColl").directive("evtViscoll",["evtViscoll","parsedData","evtInterface",function(e,t,i){return{restrict:"E",scope:{},transclude:!0,template:n(328),controllerAs:"vm",controller:"ViscollCtrl",link:function(n,r,o){var a=e.build(n);n.$watch((function(){return t.areViscollSvgsLoaded()}),(function(e,t){t!==e&&!0===e&&a.displayResult()}),!0),n.$watch((function(){return i.getState("currentViewMode")}),(function(e,t){t!==e&&(i.updateState("isThumbNailsOpened",!1),i.updateState("isVisCollOpened",!1))}),!0),n.$on("$destroy",(function(){a&&a.destroy()}))}}}])},function(e,t){e.exports='\x3c!-- <script type="text/javascript" src="./src/visColl/SaxonJS.min.js"><\/script> --\x3e\n<div class="selectorDiv">\n    <form name="quireForm" class="quireSelector">\n        <label for="quireSelect">{{ \'VISCOLL.SELECT_QUIRE\' | translate }}:</label>\n        <evt-select ng-if="vm.quireOptions && vm.quireOptions.length > 0"\n            data-id="viscoll_quire" data-smaller="true"\n            data-type="generic" data-empty-option="true"\n\t\t\tdata-options="vm.quireOptions" \n\t\t\tdata-init="{{vm.selectedQuire.value}}"\n\t\t\ton-option-selected="vm.setSelectedQuire(option)">\n        </evt-select>\n\t</form>\n</div>\n<div class="viscollItemsContainer">\n    <div class="viscollContainer" id="{{quireId}}"\n\t\tng-repeat="quireId in vm.svgCollection.quires._indexes track by $index"\n    \tng-show="vm.isSelectedQuire(quireId)"\n    \tng-class="{\'selected\' : vm.isSelectedQuire(quireId) }">\n        <div class="viscollItem-leftContainer">\n\t\t\t<span class="quireNumber">{{ \'VISCOLL.QUIRE_NUM\' | translate }} {{vm.svgCollection.quires[quireId].n}}</span>\n\t        <div class="visCollValue" type="image/svg+xml" \n\t            compile="::vm.getSvgByQuire(quireId)">\n\t        </div>\n\t    </div>\n        <div class="viscollItem-rightContainer">\n\t        <div class="selectorViscoll">\n\t\t\t\t<span class="viscollNumber">\n\t\t\t\t\t{{ \'VISCOLL.UNIT\' | translate }}:\n\t\t\t\t</span>\n\t\t\t\t<evt-select ng-if="vm.svgCollection.quires[quireId].leavesList && vm.svgCollection.quires[quireId].leavesList.length > 0"\n\t\t\t\t\tdata-id="folioSelect_{{$index}}" data-smaller="true"\n\t\t\t\t\tdata-type="generic" data-empty-option="true" \n\t\t\t\t\tdata-init="{{vm.selectedFolios[quireId].value}}"\n\t\t\t\t\tdata-selected-option="{{vm.selectedFolios[quireId].value}}"\n\t\t\t\t\tdata-options="::vm.svgCollection.quires[quireId].leavesList" \n\t\t\t\t\ton-option-selected="vm.setSelectedFolioForQuire(quireId, option)">\n\t\t\t\t</evt-select>\n\t        </div>\n\t        <div class="imgSelectorViscoll" \n\t        \tng-if="vm.selectedFolios[quireId]">\n\t\t\t\t<figure class="thumbnail thumb_single second_unit {{vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode}}" \n\t\t\t\t\tng-click="vm.updateCurrentPage(vm.selectedFolios[quireId].conjoinId)">\n\t\t\t\t\t<img class="thumb_single_img"\n\t\t\t\t\t\tonerror="this.setAttribute(\'src\', \'images/empty-image.jpg\')"\n\t\t\t\t\t\tng-src="{{vm.selectedFolios[quireId].imgConjoin || \'images/empty-image.jpg\'}}"\n\t\t\t\t\t\ttitle="{{ vm.selectedFolios[quireId].conjoinId ? \'BUTTONS.GO_TO_PAGE\' : \'\' | translate }}"\n\t\t\t\t\t\t></img>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode !== \'notLeaf\'">\n\t\t\t\t\t\t{{ vm.selectedFolios[quireId].conjoinId || \n\t\t\t\t\t\t(vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode === \'original\' ? \'NO_INFO\' : vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode) || \n\t\t\t\t\t\t\'NO_INFO\' | translate}}</figcaption>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode === \'notLeaf\'">\n\t\t\t\t\t\t<i class="icon fa fa-remove"></i></figcaption>\n\t\t\t\t</figure>\n\t\t\t\t<figure class="thumbnail thumb_single first_unit {{vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode}}" \n\t\t\t\t\tng-click="vm.updateCurrentPage(vm.selectedFolios[quireId].imageId)">\n\t\t\t\t\t<img class="thumb_single_img" \n\t\t\t\t\t\tonerror="this.setAttribute(\'src\', \'images/empty-image.jpg\')"\n\t\t\t\t\t\tng-src="{{vm.selectedFolios[quireId].img || \'images/empty-image.jpg\'}}"\n\t\t\t\t\t\ttitle="{{ vm.selectedFolios[quireId].imageId ? \'BUTTONS.GO_TO_PAGE\' : \'\' | translate }}"></img>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode !== \'notLeaf\'">{{vm.selectedFolios[quireId].imageId || \n\t\t\t\t\t\t(vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode === \'original\' ? \'NO_INFO\' : vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode) || \n\t\t\t\t\t\t\'NO_INFO\' | translate}}</figcaption>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode === \'notLeaf\'">\n\t\t\t\t\t\t<i class="icon fa fa-remove"></i></figcaption>\n\t\t\t\t</figure>\n\t\t\t\t<figure class="thumbnail thumb_single first_unit {{vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode}}" \n\t\t\t\t\tng-click="vm.updateCurrentPage(vm.selectedFolios[quireId].imageId2)">\n\t\t\t\t\t<img class="thumb_single_img" \n\t\t\t\t\t\tonerror="this.setAttribute(\'src\', \'images/empty-image.jpg\')"\n\t\t\t\t\t\tng-src="{{vm.selectedFolios[quireId].img2 || \'images/empty-image.jpg\'}}"\n\t\t\t\t\t\ttitle="{{ vm.selectedFolios[quireId].imageId2 ? \'BUTTONS.GO_TO_PAGE\' : \'\' | translate }}"></img>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode !== \'notLeaf\'">\n\t\t\t\t\t\t{{vm.selectedFolios[quireId].imageId2 || \n\t\t\t\t\t\t(vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode === \'original\' ? \'NO_INFO\' : vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode) || \n\t\t\t\t\t\t\'NO_INFO\' | translate}}</figcaption>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].value].mode === \'notLeaf\'">\n\t\t\t\t\t\t<i class="icon fa fa-remove"></i></figcaption>\n\t\t\t\t</figure>\n\t\t\t\t<figure class="thumbnail thumb_single second_unit {{vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode}}" \n\t\t\t\t\tng-click="vm.updateCurrentPage(vm.selectedFolios[quireId].conjoinId2)">\n\t\t\t\t\t<img class="thumb_single_img" \n\t\t\t\t\t\tonerror="this.setAttribute(\'src\', \'images/empty-image.jpg\')"\n\t\t\t\t\t\tng-src="{{vm.selectedFolios[quireId].imgConjoin2 || \'images/empty-image.jpg\'}}"\n\t\t\t\t\t\ttitle="{{ vm.selectedFolios[quireId].conjoinId2 ? \'BUTTONS.GO_TO_PAGE\' : \'\' | translate }}"></img>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode !== \'notLeaf\'">\n\t\t\t\t\t\t{{vm.selectedFolios[quireId].conjoinId2 || \n\t\t\t\t\t\t(vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode === \'original\' ? \'NO_INFO\' : vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode) || \n\t\t\t\t\t\t\'NO_INFO\' | translate}}</figcaption>\n\t\t\t\t\t<figcaption ng-if="vm.svgCollection.quires[quireId].leaves[vm.selectedFolios[quireId].conjoin].mode === \'notLeaf\'">\n\t\t\t\t\t\t<i class="icon fa fa-remove"></i></figcaption>\n\t\t\t\t</figure>\n\t        </div>\n\t        <div  class="imgSelectorViscoll_empty" \n\t        \tng-if="!vm.selectedFolios[quireId]">\n\t        \t<span>{{ \'VISCOLL.SELECT_UNIT_MSG\' | translate }}</span>\n\t        </div>\n\t    </div>\n    </div>\n</div>'}]);
//# sourceMappingURL=evtviewer.bundle.js.map